"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./src/lib/webrtc.ts":
/*!***************************!*\
  !*** ./src/lib/webrtc.ts ***!
  \***************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   webrtcManager: function() { return /* binding */ webrtcManager; }\n/* harmony export */ });\n/* harmony import */ var _nostr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nostr */ \"(app-pages-browser)/./src/lib/nostr.ts\");\n\nconst ICE_CONFIG = {\n    iceServers: [\n        {\n            urls: \"stun:stun.l.google.com:19302\"\n        },\n        {\n            urls: \"stun:stun1.l.google.com:19302\"\n        },\n        {\n            urls: \"stun:stun.cloudflare.com:3478\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:80\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:443\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:443?transport=tcp\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        }\n    ],\n    iceCandidatePoolSize: 10\n};\nconst LS_STALE_CALL_KEY = \"nostr_call_ringing\";\nclass WebRTCManager {\n    get callState() {\n        return this._callState;\n    }\n    get remotePubkey() {\n        return this._remotePubkey;\n    }\n    get callType() {\n        return this._callType;\n    }\n    get callStartTime() {\n        return this._callStartTime;\n    }\n    onStateChange(cb) {\n        this.stateCallbacks.add(cb);\n        return ()=>{\n            this.stateCallbacks.delete(cb);\n        };\n    }\n    onStream(cb) {\n        this.streamCallbacks.add(cb);\n        return ()=>{\n            this.streamCallbacks.delete(cb);\n        };\n    }\n    setState(state, error) {\n        this._callState = state;\n        if (state === \"connected\") {\n            this._callStartTime = Date.now();\n            this.stopRingtone();\n        }\n        if (state === \"idle\" || state === \"ended\") this.stopRingtone();\n        this.stateCallbacks.forEach((cb)=>cb(state, this._remotePubkey, this._callType, error));\n    }\n    notifyStreams() {\n        this.streamCallbacks.forEach((cb)=>cb(this.localStream, this.remoteStream));\n    }\n    playRingtone() {\n        this.stopRingtone();\n        try {\n            this.audioCtx = new AudioContext();\n            this.audioOsc = this.audioCtx.createOscillator();\n            const gain = this.audioCtx.createGain();\n            this.audioOsc.connect(gain);\n            gain.connect(this.audioCtx.destination);\n            this.audioOsc.frequency.value = 440;\n            gain.gain.value = 0.08;\n            this.audioOsc.start();\n            const ctx = this.audioCtx;\n            const pulse = ()=>{\n                if (this._callState !== \"ringing\" || !this.audioCtx) {\n                    try {\n                        var _this_audioOsc;\n                        (_this_audioOsc = this.audioOsc) === null || _this_audioOsc === void 0 ? void 0 : _this_audioOsc.stop();\n                    } catch (e) {}\n                    return;\n                }\n                gain.gain.setValueAtTime(0.08, ctx.currentTime);\n                gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);\n                setTimeout(pulse, 1200);\n            };\n            pulse();\n        } catch (e) {}\n    }\n    stopRingtone() {\n        try {\n            var _this_audioOsc;\n            (_this_audioOsc = this.audioOsc) === null || _this_audioOsc === void 0 ? void 0 : _this_audioOsc.stop();\n        } catch (e) {}\n        try {\n            var _this_audioCtx;\n            (_this_audioCtx = this.audioCtx) === null || _this_audioCtx === void 0 ? void 0 : _this_audioCtx.close();\n        } catch (e) {}\n        this.audioOsc = null;\n        this.audioCtx = null;\n    }\n    init() {\n        if (this._unsubSignal) return;\n        try {\n            const staleCallJSON = localStorage.getItem(LS_STALE_CALL_KEY);\n            if (staleCallJSON) {\n                localStorage.removeItem(LS_STALE_CALL_KEY);\n                const staleCall = JSON.parse(staleCallJSON);\n                if (staleCall && staleCall.caller && Date.now() - staleCall.time < 45000) {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(staleCall.caller, {\n                        type: \"call-reject\"\n                    }).catch(()=>{});\n                }\n            }\n        } catch (e) {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        }\n        this._unsubSignal = _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.onSignal((from, signal)=>{\n            this.handleSignal(from, signal);\n        });\n    }\n    destroy() {\n        if (this._unsubSignal) {\n            this._unsubSignal();\n            this._unsubSignal = null;\n        }\n        this.endCall();\n    }\n    async handleSignal(from, signal) {\n        switch(signal.type){\n            case \"call-request\":\n                if (this._callState !== \"idle\") {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(from, {\n                        type: \"call-reject\"\n                    }).catch(()=>{});\n                    return;\n                }\n                this._remotePubkey = from;\n                this._callType = signal.callType || \"audio\";\n                this.setState(\"ringing\");\n                try {\n                    localStorage.setItem(LS_STALE_CALL_KEY, JSON.stringify({\n                        caller: from,\n                        time: Date.now()\n                    }));\n                } catch (e) {}\n                this.playRingtone();\n                this.callTimeout = setTimeout(()=>{\n                    if (this._callState === \"ringing\") this.rejectCall();\n                }, 45000);\n                break;\n            case \"call-accept\":\n                if (this._callState === \"calling\" && this._remotePubkey === from) {\n                    this.clearRetry();\n                    this.clearCallTimeout();\n                    this.setState(\"connecting\");\n                    await this.startWebRTC(true);\n                }\n                break;\n            case \"call-reject\":\n                if (this._remotePubkey === from) {\n                    this.cleanup(false);\n                    this.setState(\"idle\", \"Звонок отклонён\");\n                }\n                break;\n            case \"call-end\":\n                if (this._remotePubkey === from) this.cleanup(false);\n                break;\n            case \"webrtc-offer\":\n                if (this._remotePubkey === from && signal.sdp) await this.handleOffer(signal.sdp);\n                break;\n            case \"webrtc-answer\":\n                if (this._remotePubkey === from && signal.sdp) await this.handleAnswer(signal.sdp);\n                break;\n            case \"webrtc-ice\":\n                if (this._remotePubkey === from && signal.candidate) await this.handleIceCandidate(signal.candidate);\n                break;\n        }\n    }\n    clearCallTimeout() {\n        if (this.callTimeout) {\n            clearTimeout(this.callTimeout);\n            this.callTimeout = null;\n        }\n    }\n    clearRetry() {\n        if (this.retryInterval) {\n            clearInterval(this.retryInterval);\n            this.retryInterval = null;\n        }\n    }\n    async initiateCall(pubkey, type) {\n        if (this._callState !== \"idle\") return;\n        // Захватываем медиа СРАЗУ — если не получится, сообщаем до начала звонка\n        try {\n            this.preStream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true\n                },\n                video: type === \"video\" ? {\n                    width: {\n                        ideal: 1280\n                    },\n                    height: {\n                        ideal: 720\n                    },\n                    facingMode: \"user\"\n                } : false\n            });\n        } catch (err) {\n            // Если видео не получилось — пробуем только аудио\n            if (type === \"video\") {\n                try {\n                    this.preStream = await navigator.mediaDevices.getUserMedia({\n                        audio: true,\n                        video: false\n                    });\n                    type = \"audio\";\n                } catch (e) {\n                    this.setState(\"idle\", this.mediaErrorMsg(err));\n                    return;\n                }\n            } else {\n                this.setState(\"idle\", this.mediaErrorMsg(err));\n                return;\n            }\n        }\n        this._remotePubkey = pubkey;\n        this._callType = type;\n        this.setState(\"calling\");\n        // Отправляем call-request и повторяем каждые 3 сек (Nostr ненадёжен)\n        const sendReq = ()=>{\n            _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(pubkey, {\n                type: \"call-request\",\n                callType: type\n            }).catch(()=>{});\n        };\n        sendReq();\n        this.retryInterval = setInterval(()=>{\n            if (this._callState === \"calling\") sendReq();\n            else this.clearRetry();\n        }, 3000);\n        // Таймаут 40 сек\n        this.callTimeout = setTimeout(()=>{\n            if (this._callState === \"calling\") {\n                this.cleanup(true);\n                this.setState(\"idle\", \"Нет ответа\");\n            }\n        }, 40000);\n    }\n    async acceptCall() {\n        if (this._callState !== \"ringing\" || !this._remotePubkey) return;\n        try {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        } catch (e) {}\n        this.clearCallTimeout();\n        this.stopRingtone();\n        this.setState(\"connecting\");\n        // Захватываем медиа при принятии\n        try {\n            this.preStream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true\n                },\n                video: this._callType === \"video\" ? {\n                    width: {\n                        ideal: 1280\n                    },\n                    height: {\n                        ideal: 720\n                    },\n                    facingMode: \"user\"\n                } : false\n            });\n        } catch (err) {\n            if (this._callType === \"video\") {\n                try {\n                    this.preStream = await navigator.mediaDevices.getUserMedia({\n                        audio: true\n                    });\n                    this._callType = \"audio\";\n                } catch (e) {\n                    this.cleanup(false);\n                    this.setState(\"idle\", this.mediaErrorMsg(err));\n                    return;\n                }\n            } else {\n                this.cleanup(false);\n                this.setState(\"idle\", this.mediaErrorMsg(err));\n                return;\n            }\n        }\n        await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n            type: \"call-accept\"\n        });\n        await this.startWebRTC(false);\n    }\n    async rejectCall() {\n        if (this._callState !== \"ringing\" || !this._remotePubkey) return;\n        this.clearCallTimeout();\n        this.stopRingtone();\n        _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n            type: \"call-reject\"\n        }).catch(()=>{});\n        this.cleanup(false);\n    }\n    mediaErrorMsg(err) {\n        if (err instanceof DOMException) {\n            if (err.name === \"NotAllowedError\") return \"Доступ к микрофону/камере запрещён. Разрешите в настройках браузера.\";\n            if (err.name === \"NotFoundError\") return \"Микрофон/камера не найдены. Подключите устройство.\";\n            if (err.name === \"NotReadableError\") return \"Устройство занято другим приложением.\";\n            return \"Ошибка: \".concat(err.message);\n        }\n        return \"Не удалось получить доступ к медиа\";\n    }\n    async startWebRTC(isInitiator) {\n        try {\n            this.pc = new RTCPeerConnection(ICE_CONFIG);\n            // Используем предзахваченный стрим\n            this.localStream = this.preStream;\n            this.preStream = null;\n            if (!this.localStream) {\n                this.localStream = await navigator.mediaDevices.getUserMedia({\n                    audio: true,\n                    video: this._callType === \"video\"\n                });\n            }\n            this.localStream.getTracks().forEach((track)=>{\n                this.pc.addTrack(track, this.localStream);\n            });\n            this.remoteStream = new MediaStream();\n            this.pc.ontrack = (event)=>{\n                if (event.streams[0]) {\n                    event.streams[0].getTracks().forEach((track)=>{\n                        this.remoteStream.addTrack(track);\n                    });\n                } else if (event.track) {\n                    this.remoteStream.addTrack(event.track);\n                }\n                this.notifyStreams();\n            };\n            this.pc.onicecandidate = (event)=>{\n                if (event.candidate && this._remotePubkey) {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                        type: \"webrtc-ice\",\n                        candidate: event.candidate.toJSON()\n                    }).catch(()=>{});\n                }\n            };\n            this.pc.oniceconnectionstatechange = ()=>{\n                var _this_pc;\n                const s = (_this_pc = this.pc) === null || _this_pc === void 0 ? void 0 : _this_pc.iceConnectionState;\n                if (s === \"connected\" || s === \"completed\") {\n                    this.setState(\"connected\");\n                } else if (s === \"failed\") {\n                    if (this.pc && isInitiator) {\n                        try {\n                            this.pc.restartIce();\n                        } catch (e) {\n                            this.endCall(\"Соединение прервано\");\n                        }\n                    } else {\n                        this.endCall(\"Соединение прервано\");\n                    }\n                } else if (s === \"disconnected\") {\n                    setTimeout(()=>{\n                        var _this_pc;\n                        if (((_this_pc = this.pc) === null || _this_pc === void 0 ? void 0 : _this_pc.iceConnectionState) === \"disconnected\") this.endCall(\"Соединение потеряно\");\n                    }, 7000);\n                }\n            };\n            this.notifyStreams();\n            if (isInitiator) {\n                const offer = await this.pc.createOffer({\n                    offerToReceiveAudio: true,\n                    offerToReceiveVideo: this._callType === \"video\"\n                });\n                await this.pc.setLocalDescription(offer);\n                await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                    type: \"webrtc-offer\",\n                    sdp: offer.sdp\n                });\n            }\n            for (const c of this.iceCandidateQueue){\n                try {\n                    await this.pc.addIceCandidate(new RTCIceCandidate(c));\n                } catch (e) {}\n            }\n            this.iceCandidateQueue = [];\n        } catch (err) {\n            this.endCall(this.mediaErrorMsg(err));\n        }\n    }\n    async handleOffer(sdp) {\n        if (!this.pc) return;\n        try {\n            await this.pc.setRemoteDescription(new RTCSessionDescription({\n                type: \"offer\",\n                sdp\n            }));\n            const answer = await this.pc.createAnswer();\n            await this.pc.setLocalDescription(answer);\n            await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                type: \"webrtc-answer\",\n                sdp: answer.sdp\n            });\n        } catch (e) {\n            console.error(\"handleOffer:\", e);\n        }\n    }\n    async handleAnswer(sdp) {\n        if (!this.pc) return;\n        try {\n            await this.pc.setRemoteDescription(new RTCSessionDescription({\n                type: \"answer\",\n                sdp\n            }));\n        } catch (e) {\n            console.error(\"handleAnswer:\", e);\n        }\n    }\n    async handleIceCandidate(candidate) {\n        if (!this.pc || !this.pc.remoteDescription) {\n            this.iceCandidateQueue.push(candidate);\n            return;\n        }\n        try {\n            await this.pc.addIceCandidate(new RTCIceCandidate(candidate));\n        } catch (e) {}\n    }\n    endCall(error) {\n        if (this._remotePubkey && this._callState !== \"idle\" && this._callState !== \"ended\") {\n            _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                type: \"call-end\"\n            }).catch(()=>{});\n        }\n        this.cleanup(false);\n        if (error) this.setState(\"idle\", error);\n    }\n    cleanup(silent) {\n        try {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        } catch (e) {}\n        this.clearCallTimeout();\n        this.clearRetry();\n        this.stopRingtone();\n        if (this.preStream) {\n            this.preStream.getTracks().forEach((t)=>t.stop());\n            this.preStream = null;\n        }\n        if (this.localStream) {\n            this.localStream.getTracks().forEach((t)=>t.stop());\n            this.localStream = null;\n        }\n        if (this.remoteStream) {\n            this.remoteStream.getTracks().forEach((t)=>t.stop());\n            this.remoteStream = null;\n        }\n        if (this.pc) {\n            this.pc.close();\n            this.pc = null;\n        }\n        this.iceCandidateQueue = [];\n        this._remotePubkey = null;\n        this._callStartTime = 0;\n        if (!silent) this.setState(\"idle\");\n        this.notifyStreams();\n    }\n    toggleMute() {\n        if (!this.localStream) return false;\n        const t = this.localStream.getAudioTracks()[0];\n        if (t) {\n            t.enabled = !t.enabled;\n            return !t.enabled;\n        }\n        return false;\n    }\n    toggleVideo() {\n        if (!this.localStream) return false;\n        const t = this.localStream.getVideoTracks()[0];\n        if (t) {\n            t.enabled = !t.enabled;\n            return !t.enabled;\n        }\n        return false;\n    }\n    constructor(){\n        this.pc = null;\n        this.localStream = null;\n        this.remoteStream = null;\n        this._callState = \"idle\";\n        this._remotePubkey = null;\n        this._callType = \"audio\";\n        this.stateCallbacks = new Set();\n        this.streamCallbacks = new Set();\n        this.iceCandidateQueue = [];\n        this._callStartTime = 0;\n        this._unsubSignal = null;\n        this.callTimeout = null;\n        this.retryInterval = null;\n        this.audioCtx = null;\n        this.audioOsc = null;\n        // Предзахваченный стрим — берём медиа ДО звонка чтобы потом не ждать\n        this.preStream = null;\n    }\n}\nconst webrtcManager = new WebRTCManager();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvd2VicnRjLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlEO0FBUXpELE1BQU1DLGFBQStCO0lBQ25DQyxZQUFZO1FBQ1Y7WUFBRUMsTUFBTTtRQUErQjtRQUN2QztZQUFFQSxNQUFNO1FBQWdDO1FBQ3hDO1lBQUVBLE1BQU07UUFBZ0M7UUFDeEM7WUFDRUEsTUFBTTtZQUNOQyxVQUFVO1lBQ1ZDLFlBQVk7UUFDZDtRQUNBO1lBQ0VGLE1BQU07WUFDTkMsVUFBVTtZQUNWQyxZQUFZO1FBQ2Q7UUFDQTtZQUNFRixNQUFNO1lBQ05DLFVBQVU7WUFDVkMsWUFBWTtRQUNkO0tBQ0Q7SUFDREMsc0JBQXNCO0FBQ3hCO0FBRUEsTUFBTUMsb0JBQW9CO0FBRTFCLE1BQU1DO0lBbUJKLElBQUlDLFlBQVk7UUFBRSxPQUFPLElBQUksQ0FBQ0MsVUFBVTtJQUFFO0lBQzFDLElBQUlDLGVBQWU7UUFBRSxPQUFPLElBQUksQ0FBQ0MsYUFBYTtJQUFFO0lBQ2hELElBQUlDLFdBQVc7UUFBRSxPQUFPLElBQUksQ0FBQ0MsU0FBUztJQUFFO0lBQ3hDLElBQUlDLGdCQUFnQjtRQUFFLE9BQU8sSUFBSSxDQUFDQyxjQUFjO0lBQUU7SUFFbERDLGNBQWNDLEVBQXFCLEVBQUU7UUFBRSxJQUFJLENBQUNDLGNBQWMsQ0FBQ0MsR0FBRyxDQUFDRjtRQUFLLE9BQU87WUFBUSxJQUFJLENBQUNDLGNBQWMsQ0FBQ0UsTUFBTSxDQUFDSDtRQUFLO0lBQUc7SUFDdEhJLFNBQVNKLEVBQWtCLEVBQUU7UUFBRSxJQUFJLENBQUNLLGVBQWUsQ0FBQ0gsR0FBRyxDQUFDRjtRQUFLLE9BQU87WUFBUSxJQUFJLENBQUNLLGVBQWUsQ0FBQ0YsTUFBTSxDQUFDSDtRQUFLO0lBQUc7SUFFeEdNLFNBQVNDLEtBQWdCLEVBQUVDLEtBQWMsRUFBRTtRQUNqRCxJQUFJLENBQUNoQixVQUFVLEdBQUdlO1FBQ2xCLElBQUlBLFVBQVUsYUFBYTtZQUFFLElBQUksQ0FB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QixhQUF3QjthQUN4QkUsZ0JBQStCO2FBQy9CRSxZQUFzQjthQUN0QkssaUJBQXlDLElBQUlzSTthQUM3Q2xJLGtCQUF1QyxJQUFJa0k7YUFDM0NqQixvQkFBMkMsRUFBRTthQUM3Q3hILGlCQUF5QjthQUN6QnVDLGVBQW9DO2FBQ3BDc0IsY0FBb0Q7YUFDcERZLGdCQUF1RDthQUN2RHRELFdBQWdDO2FBQ2hDRSxXQUFrQztRQUMxQyxxRUFBcUU7YUFDN0R3RCxZQUFnQzs7QUFvVzFDO0FBRU8sTUFBTTZELGdCQUFnQixJQUFJbEosZ0JBQWdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvd2VicnRjLnRzPzMxZDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbm9zdHJDbGllbnQsIHR5cGUgV2ViUlRDU2lnbmFsIH0gZnJvbSAnLi9ub3N0cic7XG5cbmV4cG9ydCB0eXBlIENhbGxTdGF0ZSA9ICdpZGxlJyB8ICdjYWxsaW5nJyB8ICdyaW5naW5nJyB8ICdjb25uZWN0aW5nJyB8ICdjb25uZWN0ZWQnIHwgJ2VuZGVkJztcbmV4cG9ydCB0eXBlIENhbGxUeXBlID0gJ2F1ZGlvJyB8ICd2aWRlbyc7XG5cbnR5cGUgQ2FsbFN0YXRlQ2FsbGJhY2sgPSAoc3RhdGU6IENhbGxTdGF0ZSwgcmVtb3RlUHVia2V5OiBzdHJpbmcgfCBudWxsLCBjYWxsVHlwZTogQ2FsbFR5cGUsIGVycm9yPzogc3RyaW5nKSA9PiB2b2lkO1xudHlwZSBTdHJlYW1DYWxsYmFjayA9IChsb2NhbDogTWVkaWFTdHJlYW0gfCBudWxsLCByZW1vdGU6IE1lZGlhU3RyZWFtIHwgbnVsbCkgPT4gdm9pZDtcblxuY29uc3QgSUNFX0NPTkZJRzogUlRDQ29uZmlndXJhdGlvbiA9IHtcbiAgaWNlU2VydmVyczogW1xuICAgIHsgdXJsczogJ3N0dW46c3R1bi5sLmdvb2dsZS5jb206MTkzMDInIH0sXG4gICAgeyB1cmxzOiAnc3R1bjpzdHVuMS5sLmdvb2dsZS5jb206MTkzMDInIH0sXG4gICAgeyB1cmxzOiAnc3R1bjpzdHVuLmNsb3VkZmxhcmUuY29tOjM0NzgnIH0sXG4gICAge1xuICAgICAgdXJsczogJ3R1cm46b3BlbnJlbGF5Lm1ldGVyZWQuY2E6ODAnLFxuICAgICAgdXNlcm5hbWU6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICAgIGNyZWRlbnRpYWw6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICB9LFxuICAgIHtcbiAgICAgIHVybHM6ICd0dXJuOm9wZW5yZWxheS5tZXRlcmVkLmNhOjQ0MycsXG4gICAgICB1c2VybmFtZTogJ29wZW5yZWxheXByb2plY3QnLFxuICAgICAgY3JlZGVudGlhbDogJ29wZW5yZWxheXByb2plY3QnLFxuICAgIH0sXG4gICAge1xuICAgICAgdXJsczogJ3R1cm46b3BlbnJlbGF5Lm1ldGVyZWQuY2E6NDQzP3RyYW5zcG9ydD10Y3AnLFxuICAgICAgdXNlcm5hbWU6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICAgIGNyZWRlbnRpYWw6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICB9LFxuICBdLFxuICBpY2VDYW5kaWRhdGVQb29sU2l6ZTogMTAsXG59O1xuXG5jb25zdCBMU19TVEFMRV9DQUxMX0tFWSA9ICdub3N0cl9jYWxsX3JpbmdpbmcnO1xuXG5jbGFzcyBXZWJSVENNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBwYzogUlRDUGVlckNvbm5lY3Rpb24gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBsb2NhbFN0cmVhbTogTWVkaWFTdHJlYW0gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZW1vdGVTdHJlYW06IE1lZGlhU3RyZWFtIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX2NhbGxTdGF0ZTogQ2FsbFN0YXRlID0gJ2lkbGUnO1xuICBwcml2YXRlIF9yZW1vdGVQdWJrZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIF9jYWxsVHlwZTogQ2FsbFR5cGUgPSAnYXVkaW8nO1xuICBwcml2YXRlIHN0YXRlQ2FsbGJhY2tzOiBTZXQ8Q2FsbFN0YXRlQ2FsbGJhY2s+ID0gbmV3IFNldCgpO1xuICBwcml2YXRlIHN0cmVhbUNhbGxiYWNrczogU2V0PFN0cmVhbUNhbGxiYWNrPiA9IG5ldyBTZXQoKTtcbiAgcHJpdmF0ZSBpY2VDYW5kaWRhdGVRdWV1ZTogUlRDSWNlQ2FuZGlkYXRlSW5pdFtdID0gW107XG4gIHByaXZhdGUgX2NhbGxTdGFydFRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgX3Vuc3ViU2lnbmFsOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBjYWxsVGltZW91dDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZXRyeUludGVydmFsOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRJbnRlcnZhbD4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhdWRpb0N0eDogQXVkaW9Db250ZXh0IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYXVkaW9Pc2M6IE9zY2lsbGF0b3JOb2RlIHwgbnVsbCA9IG51bGw7XG4gIC8vINCf0YDQtdC00LfQsNGF0LLQsNGH0LXQvdC90YvQuSDRgdGC0YDQuNC8IOKAlCDQsdC10YDRkdC8INC80LXQtNC40LAg0JTQniDQt9Cy0L7QvdC60LAg0YfRgtC+0LHRiyDQv9C+0YLQvtC8INC90LUg0LbQtNCw0YLRjFxuICBwcml2YXRlIHByZVN0cmVhbTogTWVkaWFTdHJlYW0gfCBudWxsID0gbnVsbDtcblxuICBnZXQgY2FsbFN0YXRlKCkgeyByZXR1cm4gdGhpcy5fY2FsbFN0YXRlOyB9XG4gIGdldCByZW1vdGVQdWJrZXkoKSB7IHJldHVybiB0aGlzLl9yZW1vdGVQdWJrZXk7IH1cbiAgZ2V0IGNhbGxUeXBlKCkgeyByZXR1cm4gdGhpcy5fY2FsbFR5cGU7IH1cbiAgZ2V0IGNhbGxTdGFydFRpbWUoKSB7IHJldHVybiB0aGlzLl9jYWxsU3RhcnRUaW1lOyB9XG5cbiAgb25TdGF0ZUNoYW5nZShjYjogQ2FsbFN0YXRlQ2FsbGJhY2spIHsgdGhpcy5zdGF0ZUNhbGxiYWNrcy5hZGQoY2IpOyByZXR1cm4gKCkgPT4geyB0aGlzLnN0YXRlQ2FsbGJhY2tzLmRlbGV0ZShjYik7IH07IH1cbiAgb25TdHJlYW0oY2I6IFN0cmVhbUNhbGxiYWNrKSB7IHRoaXMuc3RyZWFtQ2FsbGJhY2tzLmFkZChjYik7IHJldHVybiAoKSA9PiB7IHRoaXMuc3RyZWFtQ2FsbGJhY2tzLmRlbGV0ZShjYik7IH07IH1cblxuICBwcml2YXRlIHNldFN0YXRlKHN0YXRlOiBDYWxsU3RhdGUsIGVycm9yPzogc3RyaW5nKSB7XG4gICAgdGhpcy5fY2FsbFN0YXRlID0gc3RhdGU7XG4gICAgaWYgKHN0YXRlID09PSAnY29ubmVjdGVkJykgeyB0aGlzLl9jYWxsU3RhcnRUaW1lID0gRGF0ZS5ub3coKTsgdGhpcy5zdG9wUmluZ3RvbmUoKTsgfVxuICAgIGlmIChzdGF0ZSA9PT0gJ2lkbGUnIHx8IHN0YXRlID09PSAnZW5kZWQnKSB0aGlzLnN0b3BSaW5ndG9uZSgpO1xuICAgIHRoaXMuc3RhdGVDYWxsYmFja3MuZm9yRWFjaChjYiA9PiBjYihzdGF0ZSwgdGhpcy5fcmVtb3RlUHVia2V5LCB0aGlzLl9jYWxsVHlwZSwgZXJyb3IpKTtcbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5U3RyZWFtcygpIHtcbiAgICB0aGlzLnN0cmVhbUNhbGxiYWNrcy5mb3JFYWNoKGNiID0+IGNiKHRoaXMubG9jYWxTdHJlYW0sIHRoaXMucmVtb3RlU3RyZWFtKSk7XG4gIH1cblxuICBwcml2YXRlIHBsYXlSaW5ndG9uZSgpIHtcbiAgICB0aGlzLnN0b3BSaW5ndG9uZSgpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmF1ZGlvQ3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuICAgICAgdGhpcy5hdWRpb09zYyA9IHRoaXMuYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpO1xuICAgICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9DdHguY3JlYXRlR2FpbigpO1xuICAgICAgdGhpcy5hdWRpb09zYy5jb25uZWN0KGdhaW4pO1xuICAgICAgZ2Fpbi5jb25uZWN0KHRoaXMuYXVkaW9DdHguZGVzdGluYXRpb24pO1xuICAgICAgdGhpcy5hdWRpb09zYy5mcmVxdWVuY3kudmFsdWUgPSA0NDA7XG4gICAgICBnYWluLmdhaW4udmFsdWUgPSAwLjA4O1xuICAgICAgdGhpcy5hdWRpb09zYy5zdGFydCgpO1xuICAgICAgY29uc3QgY3R4ID0gdGhpcy5hdWRpb0N0eDtcbiAgICAgIGNvbnN0IHB1bHNlID0gKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5fY2FsbFN0YXRlICE9PSAncmluZ2luZycgfHwgIXRoaXMuYXVkaW9DdHgpIHsgdHJ5IHsgdGhpcy5hdWRpb09zYz8uc3RvcCgpOyB9IGNhdGNoIHt9IHJldHVybjsgfVxuICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4wOCwgY3R4LmN1cnJlbnRUaW1lKTtcbiAgICAgICAgZ2Fpbi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMDEsIGN0eC5jdXJyZW50VGltZSArIDAuNSk7XG4gICAgICAgIHNldFRpbWVvdXQocHVsc2UsIDEyMDApO1xuICAgICAgfTtcbiAgICAgIHB1bHNlKCk7XG4gICAgfSBjYXRjaCB7fVxuICB9XG5cbiAgcHJpdmF0ZSBzdG9wUmluZ3RvbmUoKSB7XG4gICAgdHJ5IHsgdGhpcy5hdWRpb09zYz8uc3RvcCgpOyB9IGNhdGNoIHt9XG4gICAgdHJ5IHsgdGhpcy5hdWRpb0N0eD8uY2xvc2UoKTsgfSBjYXRjaCB7fVxuICAgIHRoaXMuYXVkaW9Pc2MgPSBudWxsO1xuICAgIHRoaXMuYXVkaW9DdHggPSBudWxsO1xuICB9XG5cbiAgaW5pdCgpIHtcbiAgICBpZiAodGhpcy5fdW5zdWJTaWduYWwpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGFsZUNhbGxKU09OID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oTFNfU1RBTEVfQ0FMTF9LRVkpO1xuICAgICAgaWYgKHN0YWxlQ2FsbEpTT04pIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTFNfU1RBTEVfQ0FMTF9LRVkpO1xuICAgICAgICBjb25zdCBzdGFsZUNhbGwgPSBKU09OLnBhcnNlKHN0YWxlQ2FsbEpTT04pO1xuICAgICAgICBpZiAoc3RhbGVDYWxsICYmIHN0YWxlQ2FsbC5jYWxsZXIgJiYgKERhdGUubm93KCkgLSBzdGFsZUNhbGwudGltZSA8IDQ1MDAwKSkge1xuICAgICAgICAgIG5vc3RyQ2xpZW50LnNlbmRXZWJSVENTaWduYWwoc3RhbGVDYWxsLmNhbGxlciwgeyB0eXBlOiAnY2FsbC1yZWplY3QnIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKExTX1NUQUxFX0NBTExfS0VZKTtcbiAgICB9XG5cbiAgICB0aGlzLl91bnN1YlNpZ25hbCA9IG5vc3RyQ2xpZW50Lm9uU2lnbmFsKChmcm9tLCBzaWduYWwpID0+IHsgdGhpcy5oYW5kbGVTaWduYWwoZnJvbSwgc2lnbmFsKTsgfSk7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLl91bnN1YlNpZ25hbCkgeyB0aGlzLl91bnN1YlNpZ25hbCgpOyB0aGlzLl91bnN1YlNpZ25hbCA9IG51bGw7IH1cbiAgICB0aGlzLmVuZENhbGwoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlU2lnbmFsKGZyb206IHN0cmluZywgc2lnbmFsOiBXZWJSVENTaWduYWwpIHtcbiAgICBzd2l0Y2ggKHNpZ25hbC50eXBlKSB7XG4gICAgICBjYXNlICdjYWxsLXJlcXVlc3QnOlxuICAgICAgICBpZiAodGhpcy5fY2FsbFN0YXRlICE9PSAnaWRsZScpIHtcbiAgICAgICAgICBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKGZyb20sIHsgdHlwZTogJ2NhbGwtcmVqZWN0JyB9KS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlbW90ZVB1YmtleSA9IGZyb207XG4gICAgICAgIHRoaXMuX2NhbGxUeXBlID0gc2lnbmFsLmNhbGxUeXBlIHx8ICdhdWRpbyc7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoJ3JpbmdpbmcnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMU19TVEFMRV9DQUxMX0tFWSwgSlNPTi5zdHJpbmdpZnkoeyBjYWxsZXI6IGZyb20sIHRpbWU6IERhdGUubm93KCkgfSkpO1xuICAgICAgICB9IGNhdGNoIHt9XG4gICAgICAgIHRoaXMucGxheVJpbmd0b25lKCk7XG4gICAgICAgIHRoaXMuY2FsbFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsgaWYgKHRoaXMuX2NhbGxTdGF0ZSA9PT0gJ3JpbmdpbmcnKSB0aGlzLnJlamVjdENhbGwoKTsgfSwgNDUwMDApO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnY2FsbC1hY2NlcHQnOlxuICAgICAgICBpZiAoKHRoaXMuX2NhbGxTdGF0ZSA9PT0gJ2NhbGxpbmcnKSAmJiB0aGlzLl9yZW1vdGVQdWJrZXkgPT09IGZyb20pIHtcbiAgICAgICAgICB0aGlzLmNsZWFyUmV0cnkoKTtcbiAgICAgICAgICB0aGlzLmNsZWFyQ2FsbFRpbWVvdXQoKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKCdjb25uZWN0aW5nJyk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5zdGFydFdlYlJUQyh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnY2FsbC1yZWplY3QnOlxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlUHVia2V5ID09PSBmcm9tKSB7IHRoaXMuY2xlYW51cChmYWxzZSk7IHRoaXMuc2V0U3RhdGUoJ2lkbGUnLCAn0JfQstC+0L3QvtC6INC+0YLQutC70L7QvdGR0L0nKTsgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnY2FsbC1lbmQnOlxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlUHVia2V5ID09PSBmcm9tKSB0aGlzLmNsZWFudXAoZmFsc2UpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnd2VicnRjLW9mZmVyJzpcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZVB1YmtleSA9PT0gZnJvbSAmJiBzaWduYWwuc2RwKSBhd2FpdCB0aGlzLmhhbmRsZU9mZmVyKHNpZ25hbC5zZHApO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnd2VicnRjLWFuc3dlcic6XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVQdWJrZXkgPT09IGZyb20gJiYgc2lnbmFsLnNkcCkgYXdhaXQgdGhpcy5oYW5kbGVBbnN3ZXIoc2lnbmFsLnNkcCk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICd3ZWJydGMtaWNlJzpcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZVB1YmtleSA9PT0gZnJvbSAmJiBzaWduYWwuY2FuZGlkYXRlKSBhd2FpdCB0aGlzLmhhbmRsZUljZUNhbmRpZGF0ZShzaWduYWwuY2FuZGlkYXRlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjbGVhckNhbGxUaW1lb3V0KCkgeyBpZiAodGhpcy5jYWxsVGltZW91dCkgeyBjbGVhclRpbWVvdXQodGhpcy5jYWxsVGltZW91dCk7IHRoaXMuY2FsbFRpbWVvdXQgPSBudWxsOyB9IH1cbiAgcHJpdmF0ZSBjbGVhclJldHJ5KCkgeyBpZiAodGhpcy5yZXRyeUludGVydmFsKSB7IGNsZWFySW50ZXJ2YWwodGhpcy5yZXRyeUludGVydmFsKTsgdGhpcy5yZXRyeUludGVydmFsID0gbnVsbDsgfSB9XG5cbiAgYXN5bmMgaW5pdGlhdGVDYWxsKHB1YmtleTogc3RyaW5nLCB0eXBlOiBDYWxsVHlwZSkge1xuICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgIT09ICdpZGxlJykgcmV0dXJuO1xuXG4gICAgLy8g0JfQsNGF0LLQsNGC0YvQstCw0LXQvCDQvNC10LTQuNCwINCh0KDQkNCX0KMg4oCUINC10YHQu9C4INC90LUg0L/QvtC70YPRh9C40YLRgdGPLCDRgdC+0L7QsdGJ0LDQtdC8INC00L4g0L3QsNGH0LDQu9CwINC30LLQvtC90LrQsFxuICAgIHRyeSB7XG4gICAgICB0aGlzLnByZVN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHtcbiAgICAgICAgYXVkaW86IHsgZWNob0NhbmNlbGxhdGlvbjogdHJ1ZSwgbm9pc2VTdXBwcmVzc2lvbjogdHJ1ZSwgYXV0b0dhaW5Db250cm9sOiB0cnVlIH0sXG4gICAgICAgIHZpZGVvOiB0eXBlID09PSAndmlkZW8nID8geyB3aWR0aDogeyBpZGVhbDogMTI4MCB9LCBoZWlnaHQ6IHsgaWRlYWw6IDcyMCB9LCBmYWNpbmdNb2RlOiAndXNlcicgfSA6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyDQldGB0LvQuCDQstC40LTQtdC+INC90LUg0L/QvtC70YPRh9C40LvQvtGB0Ywg4oCUINC/0YDQvtCx0YPQtdC8INGC0L7Qu9GM0LrQviDQsNGD0LTQuNC+XG4gICAgICBpZiAodHlwZSA9PT0gJ3ZpZGVvJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoaXMucHJlU3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyBhdWRpbzogdHJ1ZSwgdmlkZW86IGZhbHNlIH0pO1xuICAgICAgICAgIHR5cGUgPSAnYXVkaW8nO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKCdpZGxlJywgdGhpcy5tZWRpYUVycm9yTXNnKGVycikpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSgnaWRsZScsIHRoaXMubWVkaWFFcnJvck1zZyhlcnIpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX3JlbW90ZVB1YmtleSA9IHB1YmtleTtcbiAgICB0aGlzLl9jYWxsVHlwZSA9IHR5cGU7XG4gICAgdGhpcy5zZXRTdGF0ZSgnY2FsbGluZycpO1xuXG4gICAgLy8g0J7RgtC/0YDQsNCy0LvRj9C10LwgY2FsbC1yZXF1ZXN0INC4INC/0L7QstGC0L7RgNGP0LXQvCDQutCw0LbQtNGL0LUgMyDRgdC10LogKE5vc3RyINC90LXQvdCw0LTRkdC20LXQvSlcbiAgICBjb25zdCBzZW5kUmVxID0gKCkgPT4ge1xuICAgICAgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbChwdWJrZXksIHsgdHlwZTogJ2NhbGwtcmVxdWVzdCcsIGNhbGxUeXBlOiB0eXBlIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9O1xuICAgIHNlbmRSZXEoKTtcbiAgICB0aGlzLnJldHJ5SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy5fY2FsbFN0YXRlID09PSAnY2FsbGluZycpIHNlbmRSZXEoKTtcbiAgICAgIGVsc2UgdGhpcy5jbGVhclJldHJ5KCk7XG4gICAgfSwgMzAwMCk7XG5cbiAgICAvLyDQotCw0LnQvNCw0YPRgiA0MCDRgdC10LpcbiAgICB0aGlzLmNhbGxUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy5fY2FsbFN0YXRlID09PSAnY2FsbGluZycpIHtcbiAgICAgICAgdGhpcy5jbGVhbnVwKHRydWUpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKCdpZGxlJywgJ9Cd0LXRgiDQvtGC0LLQtdGC0LAnKTtcbiAgICAgIH1cbiAgICB9LCA0MDAwMCk7XG4gIH1cblxuICBhc3luYyBhY2NlcHRDYWxsKCkge1xuICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgIT09ICdyaW5naW5nJyB8fCAhdGhpcy5fcmVtb3RlUHVia2V5KSByZXR1cm47XG4gICAgdHJ5IHsgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTFNfU1RBTEVfQ0FMTF9LRVkpOyB9IGNhdGNoIHt9XG4gICAgdGhpcy5jbGVhckNhbGxUaW1lb3V0KCk7XG4gICAgdGhpcy5zdG9wUmluZ3RvbmUoKTtcbiAgICB0aGlzLnNldFN0YXRlKCdjb25uZWN0aW5nJyk7XG5cbiAgICAvLyDQl9Cw0YXQstCw0YLRi9Cy0LDQtdC8INC80LXQtNC40LAg0L/RgNC4INC/0YDQuNC90Y/RgtC40LhcbiAgICB0cnkge1xuICAgICAgdGhpcy5wcmVTdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7XG4gICAgICAgIGF1ZGlvOiB7IGVjaG9DYW5jZWxsYXRpb246IHRydWUsIG5vaXNlU3VwcHJlc3Npb246IHRydWUsIGF1dG9HYWluQ29udHJvbDogdHJ1ZSB9LFxuICAgICAgICB2aWRlbzogdGhpcy5fY2FsbFR5cGUgPT09ICd2aWRlbycgPyB7IHdpZHRoOiB7IGlkZWFsOiAxMjgwIH0sIGhlaWdodDogeyBpZGVhbDogNzIwIH0sIGZhY2luZ01vZGU6ICd1c2VyJyB9IDogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmICh0aGlzLl9jYWxsVHlwZSA9PT0gJ3ZpZGVvJykge1xuICAgICAgICB0cnkgeyB0aGlzLnByZVN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUgfSk7IHRoaXMuX2NhbGxUeXBlID0gJ2F1ZGlvJzsgfVxuICAgICAgICBjYXRjaCB7IHRoaXMuY2xlYW51cChmYWxzZSk7IHRoaXMuc2V0U3RhdGUoJ2lkbGUnLCB0aGlzLm1lZGlhRXJyb3JNc2coZXJyKSk7IHJldHVybjsgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jbGVhbnVwKGZhbHNlKTsgdGhpcy5zZXRTdGF0ZSgnaWRsZScsIHRoaXMubWVkaWFFcnJvck1zZyhlcnIpKTsgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IG5vc3RyQ2xpZW50LnNlbmRXZWJSVENTaWduYWwodGhpcy5fcmVtb3RlUHVia2V5LCB7IHR5cGU6ICdjYWxsLWFjY2VwdCcgfSk7XG4gICAgYXdhaXQgdGhpcy5zdGFydFdlYlJUQyhmYWxzZSk7XG4gIH1cblxuICBhc3luYyByZWplY3RDYWxsKCkge1xuICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgIT09ICdyaW5naW5nJyB8fCAhdGhpcy5fcmVtb3RlUHVia2V5KSByZXR1cm47XG4gICAgdGhpcy5jbGVhckNhbGxUaW1lb3V0KCk7IHRoaXMuc3RvcFJpbmd0b25lKCk7XG4gICAgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbCh0aGlzLl9yZW1vdGVQdWJrZXksIHsgdHlwZTogJ2NhbGwtcmVqZWN0JyB9KS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgdGhpcy5jbGVhbnVwKGZhbHNlKTtcbiAgfVxuXG4gIHByaXZhdGUgbWVkaWFFcnJvck1zZyhlcnI6IHVua25vd24pOiBzdHJpbmcge1xuICAgIGlmIChlcnIgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIHtcbiAgICAgIGlmIChlcnIubmFtZSA9PT0gJ05vdEFsbG93ZWRFcnJvcicpIHJldHVybiAn0JTQvtGB0YLRg9C/INC6INC80LjQutGA0L7RhNC+0L3Rgy/QutCw0LzQtdGA0LUg0LfQsNC/0YDQtdGJ0ZHQvS4g0KDQsNC30YDQtdGI0LjRgtC1INCyINC90LDRgdGC0YDQvtC50LrQsNGFINCx0YDQsNGD0LfQtdGA0LAuJztcbiAgICAgIGlmIChlcnIubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSByZXR1cm4gJ9Cc0LjQutGA0L7RhNC+0L0v0LrQsNC80LXRgNCwINC90LUg0L3QsNC50LTQtdC90YsuINCf0L7QtNC60LvRjtGH0LjRgtC1INGD0YHRgtGA0L7QudGB0YLQstC+Lic7XG4gICAgICBpZiAoZXJyLm5hbWUgPT09ICdOb3RSZWFkYWJsZUVycm9yJykgcmV0dXJuICfQo9GB0YLRgNC+0LnRgdGC0LLQviDQt9Cw0L3Rj9GC0L4g0LTRgNGD0LPQuNC8INC/0YDQuNC70L7QttC10L3QuNC10LwuJztcbiAgICAgIHJldHVybiBg0J7RiNC40LHQutCwOiAke2Vyci5tZXNzYWdlfWA7XG4gICAgfVxuICAgIHJldHVybiAn0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LvRg9GH0LjRgtGMINC00L7RgdGC0YPQvyDQuiDQvNC10LTQuNCwJztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc3RhcnRXZWJSVEMoaXNJbml0aWF0b3I6IGJvb2xlYW4pIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5wYyA9IG5ldyBSVENQZWVyQ29ubmVjdGlvbihJQ0VfQ09ORklHKTtcblxuICAgICAgLy8g0JjRgdC/0L7Qu9GM0LfRg9C10Lwg0L/RgNC10LTQt9Cw0YXQstCw0YfQtdC90L3Ri9C5INGB0YLRgNC40LxcbiAgICAgIHRoaXMubG9jYWxTdHJlYW0gPSB0aGlzLnByZVN0cmVhbTtcbiAgICAgIHRoaXMucHJlU3RyZWFtID0gbnVsbDtcblxuICAgICAgaWYgKCF0aGlzLmxvY2FsU3RyZWFtKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7XG4gICAgICAgICAgYXVkaW86IHRydWUsXG4gICAgICAgICAgdmlkZW86IHRoaXMuX2NhbGxUeXBlID09PSAndmlkZW8nLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2NhbFN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKHRyYWNrID0+IHtcbiAgICAgICAgdGhpcy5wYyEuYWRkVHJhY2sodHJhY2ssIHRoaXMubG9jYWxTdHJlYW0hKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnJlbW90ZVN0cmVhbSA9IG5ldyBNZWRpYVN0cmVhbSgpO1xuXG4gICAgICB0aGlzLnBjLm9udHJhY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LnN0cmVhbXNbMF0pIHtcbiAgICAgICAgICBldmVudC5zdHJlYW1zWzBdLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZW1vdGVTdHJlYW0hLmFkZFRyYWNrKHRyYWNrKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50cmFjaykge1xuICAgICAgICAgIHRoaXMucmVtb3RlU3RyZWFtIS5hZGRUcmFjayhldmVudC50cmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ub3RpZnlTdHJlYW1zKCk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLnBjLm9uaWNlY2FuZGlkYXRlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5jYW5kaWRhdGUgJiYgdGhpcy5fcmVtb3RlUHVia2V5KSB7XG4gICAgICAgICAgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbCh0aGlzLl9yZW1vdGVQdWJrZXksIHtcbiAgICAgICAgICAgIHR5cGU6ICd3ZWJydGMtaWNlJyxcbiAgICAgICAgICAgIGNhbmRpZGF0ZTogZXZlbnQuY2FuZGlkYXRlLnRvSlNPTigpLFxuICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdGhpcy5wYy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGM/LmljZUNvbm5lY3Rpb25TdGF0ZTtcbiAgICAgICAgaWYgKHMgPT09ICdjb25uZWN0ZWQnIHx8IHMgPT09ICdjb21wbGV0ZWQnKSB7XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnY29ubmVjdGVkJyk7XG4gICAgICAgIH0gZWxzZSBpZiAocyA9PT0gJ2ZhaWxlZCcpIHtcbiAgICAgICAgICBpZiAodGhpcy5wYyAmJiBpc0luaXRpYXRvcikge1xuICAgICAgICAgICAgdHJ5IHsgdGhpcy5wYy5yZXN0YXJ0SWNlKCk7IH0gY2F0Y2ggeyB0aGlzLmVuZENhbGwoJ9Ch0L7QtdC00LjQvdC10L3QuNC1INC/0YDQtdGA0LLQsNC90L4nKTsgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVuZENhbGwoJ9Ch0L7QtdC00LjQvdC10L3QuNC1INC/0YDQtdGA0LLQsNC90L4nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocyA9PT0gJ2Rpc2Nvbm5lY3RlZCcpIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBjPy5pY2VDb25uZWN0aW9uU3RhdGUgPT09ICdkaXNjb25uZWN0ZWQnKSB0aGlzLmVuZENhbGwoJ9Ch0L7QtdC00LjQvdC10L3QuNC1INC/0L7RgtC10YDRj9C90L4nKTtcbiAgICAgICAgICB9LCA3MDAwKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdGhpcy5ub3RpZnlTdHJlYW1zKCk7XG5cbiAgICAgIGlmIChpc0luaXRpYXRvcikge1xuICAgICAgICBjb25zdCBvZmZlciA9IGF3YWl0IHRoaXMucGMuY3JlYXRlT2ZmZXIoe1xuICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IHRydWUsXG4gICAgICAgICAgb2ZmZXJUb1JlY2VpdmVWaWRlbzogdGhpcy5fY2FsbFR5cGUgPT09ICd2aWRlbycsXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLnBjLnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXIpO1xuICAgICAgICBhd2FpdCBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHRoaXMuX3JlbW90ZVB1YmtleSEsIHtcbiAgICAgICAgICB0eXBlOiAnd2VicnRjLW9mZmVyJyxcbiAgICAgICAgICBzZHA6IG9mZmVyLnNkcCxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoY29uc3QgYyBvZiB0aGlzLmljZUNhbmRpZGF0ZVF1ZXVlKSB7XG4gICAgICAgIHRyeSB7IGF3YWl0IHRoaXMucGMuYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoYykpOyB9IGNhdGNoIHt9XG4gICAgICB9XG4gICAgICB0aGlzLmljZUNhbmRpZGF0ZVF1ZXVlID0gW107XG5cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRoaXMuZW5kQ2FsbCh0aGlzLm1lZGlhRXJyb3JNc2coZXJyKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVPZmZlcihzZHA6IHN0cmluZykge1xuICAgIGlmICghdGhpcy5wYykgcmV0dXJuO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnBjLnNldFJlbW90ZURlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oeyB0eXBlOiAnb2ZmZXInLCBzZHAgfSkpO1xuICAgICAgY29uc3QgYW5zd2VyID0gYXdhaXQgdGhpcy5wYy5jcmVhdGVBbnN3ZXIoKTtcbiAgICAgIGF3YWl0IHRoaXMucGMuc2V0TG9jYWxEZXNjcmlwdGlvbihhbnN3ZXIpO1xuICAgICAgYXdhaXQgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbCh0aGlzLl9yZW1vdGVQdWJrZXkhLCB7IHR5cGU6ICd3ZWJydGMtYW5zd2VyJywgc2RwOiBhbnN3ZXIuc2RwIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHsgY29uc29sZS5lcnJvcignaGFuZGxlT2ZmZXI6JywgZSk7IH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlQW5zd2VyKHNkcDogc3RyaW5nKSB7XG4gICAgaWYgKCF0aGlzLnBjKSByZXR1cm47XG4gICAgdHJ5IHsgYXdhaXQgdGhpcy5wYy5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsgdHlwZTogJ2Fuc3dlcicsIHNkcCB9KSk7IH1cbiAgICBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKCdoYW5kbGVBbnN3ZXI6JywgZSk7IH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlSWNlQ2FuZGlkYXRlKGNhbmRpZGF0ZTogUlRDSWNlQ2FuZGlkYXRlSW5pdCkge1xuICAgIGlmICghdGhpcy5wYyB8fCAhdGhpcy5wYy5yZW1vdGVEZXNjcmlwdGlvbikgeyB0aGlzLmljZUNhbmRpZGF0ZVF1ZXVlLnB1c2goY2FuZGlkYXRlKTsgcmV0dXJuOyB9XG4gICAgdHJ5IHsgYXdhaXQgdGhpcy5wYy5hZGRJY2VDYW5kaWRhdGUobmV3IFJUQ0ljZUNhbmRpZGF0ZShjYW5kaWRhdGUpKTsgfSBjYXRjaCB7fVxuICB9XG5cbiAgZW5kQ2FsbChlcnJvcj86IHN0cmluZykge1xuICAgIGlmICh0aGlzLl9yZW1vdGVQdWJrZXkgJiYgdGhpcy5fY2FsbFN0YXRlICE9PSAnaWRsZScgJiYgdGhpcy5fY2FsbFN0YXRlICE9PSAnZW5kZWQnKSB7XG4gICAgICBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHRoaXMuX3JlbW90ZVB1YmtleSwgeyB0eXBlOiAnY2FsbC1lbmQnIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG4gICAgdGhpcy5jbGVhbnVwKGZhbHNlKTtcbiAgICBpZiAoZXJyb3IpIHRoaXMuc2V0U3RhdGUoJ2lkbGUnLCBlcnJvcik7XG4gIH1cblxuICBwcml2YXRlIGNsZWFudXAoc2lsZW50OiBib29sZWFuKSB7XG4gICAgdHJ5IHsgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTFNfU1RBTEVfQ0FMTF9LRVkpOyB9IGNhdGNoIHt9XG4gICAgdGhpcy5jbGVhckNhbGxUaW1lb3V0KCk7XG4gICAgdGhpcy5jbGVhclJldHJ5KCk7XG4gICAgdGhpcy5zdG9wUmluZ3RvbmUoKTtcbiAgICBpZiAodGhpcy5wcmVTdHJlYW0pIHsgdGhpcy5wcmVTdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCh0ID0+IHQuc3RvcCgpKTsgdGhpcy5wcmVTdHJlYW0gPSBudWxsOyB9XG4gICAgaWYgKHRoaXMubG9jYWxTdHJlYW0pIHsgdGhpcy5sb2NhbFN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKHQgPT4gdC5zdG9wKCkpOyB0aGlzLmxvY2FsU3RyZWFtID0gbnVsbDsgfVxuICAgIGlmICh0aGlzLnJlbW90ZVN0cmVhbSkgeyB0aGlzLnJlbW90ZVN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKHQgPT4gdC5zdG9wKCkpOyB0aGlzLnJlbW90ZVN0cmVhbSA9IG51bGw7IH1cbiAgICBpZiAodGhpcy5wYykgeyB0aGlzLnBjLmNsb3NlKCk7IHRoaXMucGMgPSBudWxsOyB9XG4gICAgdGhpcy5pY2VDYW5kaWRhdGVRdWV1ZSA9IFtdO1xuICAgIHRoaXMuX3JlbW90ZVB1YmtleSA9IG51bGw7XG4gICAgdGhpcy5fY2FsbFN0YXJ0VGltZSA9IDA7XG4gICAgaWYgKCFzaWxlbnQpIHRoaXMuc2V0U3RhdGUoJ2lkbGUnKTtcbiAgICB0aGlzLm5vdGlmeVN0cmVhbXMoKTtcbiAgfVxuXG4gIHRvZ2dsZU11dGUoKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmxvY2FsU3RyZWFtKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgdCA9IHRoaXMubG9jYWxTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKVswXTtcbiAgICBpZiAodCkgeyB0LmVuYWJsZWQgPSAhdC5lbmFibGVkOyByZXR1cm4gIXQuZW5hYmxlZDsgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHRvZ2dsZVZpZGVvKCk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5sb2NhbFN0cmVhbSkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07XG4gICAgaWYgKHQpIHsgdC5lbmFibGVkID0gIXQuZW5hYmxlZDsgcmV0dXJuICF0LmVuYWJsZWQ7IH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHdlYnJ0Y01hbmFnZXIgPSBuZXcgV2ViUlRDTWFuYWdlcigpO1xuIl0sIm5hbWVzIjpbIm5vc3RyQ2xpZW50IiwiSUNFX0NPTkZJRyIsImljZVNlcnZlcnMiLCJ1cmxzIiwidXNlcm5hbWUiLCJjcmVkZW50aWFsIiwiaWNlQ2FuZGlkYXRlUG9vbFNpemUiLCJMU19TVEFMRV9DQUxMX0tFWSIsIldlYlJUQ01hbmFnZXIiLCJjYWxsU3RhdGUiLCJfY2FsbFN0YXRlIiwicmVtb3RlUHVia2V5IiwiX3JlbW90ZVB1YmtleSIsImNhbGxUeXBlIiwiX2NhbGxUeXBlIiwiY2FsbFN0YXJ0VGltZSIsIl9jYWxsU3RhcnRUaW1lIiwib25TdGF0ZUNoYW5nZSIsImNiIiwic3RhdGVDYWxsYmFja3MiLCJhZGQiLCJkZWxldGUiLCJvblN0cmVhbSIsInN0cmVhbUNhbGxiYWNrcyIsInNldFN0YXRlIiwic3RhdGUiLCJlcnJvciIsIkRhdGUiLCJub3ciLCJzdG9wUmluZ3RvbmUiLCJmb3JFYWNoIiwibm90aWZ5U3RyZWFtcyIsImxvY2FsU3RyZWFtIiwicmVtb3RlU3RyZWFtIiwicGxheVJpbmd0b25lIiwiYXVkaW9DdHgiLCJBdWRpb0NvbnRleHQiLCJhdWRpb09zYyIsImNyZWF0ZU9zY2lsbGF0b3IiLCJnYWluIiwiY3JlYXRlR2FpbiIsImNvbm5lY3QiLCJkZXN0aW5hdGlvbiIsImZyZXF1ZW5jeSIsInZhbHVlIiwic3RhcnQiLCJjdHgiLCJwdWxzZSIsInN0b3AiLCJzZXRWYWx1ZUF0VGltZSIsImN1cnJlbnRUaW1lIiwiZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSIsInNldFRpbWVvdXQiLCJjbG9zZSIsImluaXQiLCJfdW5zdWJTaWduYWwiLCJzdGFsZUNhbGxKU09OIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJzdGFsZUNhbGwiLCJKU09OIiwicGFyc2UiLCJjYWxsZXIiLCJ0aW1lIiwic2VuZFdlYlJUQ1NpZ25hbCIsInR5cGUiLCJjYXRjaCIsImUiLCJvblNpZ25hbCIsImZyb20iLCJzaWduYWwiLCJoYW5kbGVTaWduYWwiLCJkZXN0cm95IiwiZW5kQ2FsbCIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJjYWxsVGltZW91dCIsInJlamVjdENhbGwiLCJjbGVhclJldHJ5IiwiY2xlYXJDYWxsVGltZW91dCIsInN0YXJ0V2ViUlRDIiwiY2xlYW51cCIsInNkcCIsImhhbmRsZU9mZmVyIiwiaGFuZGxlQW5zd2VyIiwiY2FuZGlkYXRlIiwiaGFuZGxlSWNlQ2FuZGlkYXRlIiwiY2xlYXJUaW1lb3V0IiwicmV0cnlJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJpbml0aWF0ZUNhbGwiLCJwdWJrZXkiLCJwcmVTdHJlYW0iLCJuYXZpZ2F0b3IiLCJtZWRpYURldmljZXMiLCJnZXRVc2VyTWVkaWEiLCJhdWRpbyIsImVjaG9DYW5jZWxsYXRpb24iLCJub2lzZVN1cHByZXNzaW9uIiwiYXV0b0dhaW5Db250cm9sIiwidmlkZW8iLCJ3aWR0aCIsImlkZWFsIiwiaGVpZ2h0IiwiZmFjaW5nTW9kZSIsImVyciIsIm1lZGlhRXJyb3JNc2ciLCJzZW5kUmVxIiwic2V0SW50ZXJ2YWwiLCJhY2NlcHRDYWxsIiwiRE9NRXhjZXB0aW9uIiwibmFtZSIsIm1lc3NhZ2UiLCJpc0luaXRpYXRvciIsInBjIiwiUlRDUGVlckNvbm5lY3Rpb24iLCJnZXRUcmFja3MiLCJ0cmFjayIsImFkZFRyYWNrIiwiTWVkaWFTdHJlYW0iLCJvbnRyYWNrIiwiZXZlbnQiLCJzdHJlYW1zIiwib25pY2VjYW5kaWRhdGUiLCJ0b0pTT04iLCJvbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSIsInMiLCJpY2VDb25uZWN0aW9uU3RhdGUiLCJyZXN0YXJ0SWNlIiwib2ZmZXIiLCJjcmVhdGVPZmZlciIsIm9mZmVyVG9SZWNlaXZlQXVkaW8iLCJvZmZlclRvUmVjZWl2ZVZpZGVvIiwic2V0TG9jYWxEZXNjcmlwdGlvbiIsImMiLCJpY2VDYW5kaWRhdGVRdWV1ZSIsImFkZEljZUNhbmRpZGF0ZSIsIlJUQ0ljZUNhbmRpZGF0ZSIsInNldFJlbW90ZURlc2NyaXB0aW9uIiwiUlRDU2Vzc2lvbkRlc2NyaXB0aW9uIiwiYW5zd2VyIiwiY3JlYXRlQW5zd2VyIiwiY29uc29sZSIsInJlbW90ZURlc2NyaXB0aW9uIiwicHVzaCIsInNpbGVudCIsInQiLCJ0b2dnbGVNdXRlIiwiZ2V0QXVkaW9UcmFja3MiLCJlbmFibGVkIiwidG9nZ2xlVmlkZW8iLCJnZXRWaWRlb1RyYWNrcyIsIlNldCIsIndlYnJ0Y01hbmFnZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/webrtc.ts\n"));

/***/ })

});