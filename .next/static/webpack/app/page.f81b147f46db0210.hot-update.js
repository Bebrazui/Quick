"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./src/lib/webrtc.ts":
/*!***************************!*\
  !*** ./src/lib/webrtc.ts ***!
  \***************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   webrtcManager: function() { return /* binding */ webrtcManager; }\n/* harmony export */ });\n/* harmony import */ var _nostr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nostr */ \"(app-pages-browser)/./src/lib/nostr.ts\");\n\nconst ICE_CONFIG = {\n    iceServers: [\n        {\n            urls: \"stun:stun.l.google.com:19302\"\n        },\n        {\n            urls: \"stun:stun1.l.google.com:19302\"\n        },\n        {\n            urls: \"stun:stun.cloudflare.com:3478\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:80\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:443\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        },\n        {\n            urls: \"turn:openrelay.metered.ca:443?transport=tcp\",\n            username: \"openrelayproject\",\n            credential: \"openrelayproject\"\n        }\n    ],\n    iceCandidatePoolSize: 10\n};\nconst LS_STALE_CALL_KEY = \"nostr_call_ringing\";\nclass WebRTCManager {\n    get callState() {\n        return this._callState;\n    }\n    get remotePubkey() {\n        return this._remotePubkey;\n    }\n    get callType() {\n        return this._callType;\n    }\n    get callStartTime() {\n        return this._callStartTime;\n    }\n    onStateChange(cb) {\n        this.stateCallbacks.add(cb);\n        return ()=>{\n            this.stateCallbacks.delete(cb);\n        };\n    }\n    onStream(cb) {\n        this.streamCallbacks.add(cb);\n        return ()=>{\n            this.streamCallbacks.delete(cb);\n        };\n    }\n    setState(state, error) {\n        this._callState = state;\n        if (state === \"connected\") {\n            this._callStartTime = Date.now();\n            this.stopRingtone();\n        }\n        if (state === \"idle\" || state === \"ended\") this.stopRingtone();\n        this.stateCallbacks.forEach((cb)=>cb(state, this._remotePubkey, this._callType, error));\n    }\n    notifyStreams() {\n        this.streamCallbacks.forEach((cb)=>cb(this.localStream, this.remoteStream));\n    }\n    playRingtone() {\n        this.stopRingtone();\n        try {\n            this.audioCtx = new AudioContext();\n            this.audioOsc = this.audioCtx.createOscillator();\n            const gain = this.audioCtx.createGain();\n            this.audioOsc.connect(gain);\n            gain.connect(this.audioCtx.destination);\n            this.audioOsc.frequency.value = 440;\n            gain.gain.value = 0.08;\n            this.audioOsc.start();\n            const ctx = this.audioCtx;\n            const pulse = ()=>{\n                if (this._callState !== \"ringing\" || !this.audioCtx) {\n                    try {\n                        var _this_audioOsc;\n                        (_this_audioOsc = this.audioOsc) === null || _this_audioOsc === void 0 ? void 0 : _this_audioOsc.stop();\n                        ctx.close();\n                    } catch (e) {}\n                    return;\n                }\n                gain.gain.setValueAtTime(0.08, ctx.currentTime);\n                gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);\n                setTimeout(pulse, 1200);\n            };\n            pulse();\n        } catch (e) {}\n    }\n    stopRingtone() {\n        try {\n            var _this_audioOsc;\n            (_this_audioOsc = this.audioOsc) === null || _this_audioOsc === void 0 ? void 0 : _this_audioOsc.stop();\n        } catch (e) {}\n        try {\n            var _this_audioCtx;\n            (_this_audioCtx = this.audioCtx) === null || _this_audioCtx === void 0 ? void 0 : _this_audioCtx.close();\n        } catch (e) {}\n        this.audioOsc = null;\n        this.audioCtx = null;\n    }\n    init() {\n        if (this._unsubSignal) return;\n        try {\n            const staleCallJSON = localStorage.getItem(LS_STALE_CALL_KEY);\n            if (staleCallJSON) {\n                localStorage.removeItem(LS_STALE_CALL_KEY);\n                const staleCall = JSON.parse(staleCallJSON);\n                if (staleCall && staleCall.caller && Date.now() - staleCall.time < 45000) {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(staleCall.caller, {\n                        type: \"call-reject\"\n                    }).catch(()=>{});\n                }\n            }\n        } catch (e) {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        }\n        this._unsubSignal = _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.onSignal((from, signal)=>{\n            this.handleSignal(from, signal);\n        });\n    }\n    destroy() {\n        if (this._unsubSignal) {\n            this._unsubSignal();\n            this._unsubSignal = null;\n        }\n        this.endCall();\n    }\n    async handleSignal(from, signal) {\n        switch(signal.type){\n            case \"call-request\":\n                if (this._callState !== \"idle\") {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(from, {\n                        type: \"call-reject\"\n                    }).catch(()=>{});\n                    return;\n                }\n                this._remotePubkey = from;\n                this._callType = signal.callType || \"audio\";\n                this.setState(\"ringing\");\n                try {\n                    localStorage.setItem(LS_STALE_CALL_KEY, JSON.stringify({\n                        caller: from,\n                        time: Date.now()\n                    }));\n                } catch (e) {}\n                this.playRingtone();\n                this.callTimeout = setTimeout(()=>{\n                    if (this._callState === \"ringing\") this.rejectCall();\n                }, 45000);\n                break;\n            case \"call-accept\":\n                if (this._callState === \"calling\" && this._remotePubkey === from) {\n                    this.clearRetry();\n                    this.clearCallTimeout();\n                    this.setState(\"connecting\");\n                    await this.startWebRTC(true);\n                }\n                break;\n            case \"call-reject\":\n                if (this._remotePubkey === from) {\n                    this.cleanup(false);\n                    this.setState(\"idle\", \"Звонок отклонён\");\n                }\n                break;\n            case \"call-end\":\n                if (this._remotePubkey === from) this.cleanup(false);\n                break;\n            case \"webrtc-offer\":\n                if (this._remotePubkey === from && signal.sdp) await this.handleOffer(signal.sdp);\n                break;\n            case \"webrtc-answer\":\n                if (this._remotePubkey === from && signal.sdp) await this.handleAnswer(signal.sdp);\n                break;\n            case \"webrtc-ice\":\n                if (this._remotePubkey === from && signal.candidate) await this.handleIceCandidate(signal.candidate);\n                break;\n        }\n    }\n    clearCallTimeout() {\n        if (this.callTimeout) {\n            clearTimeout(this.callTimeout);\n            this.callTimeout = null;\n        }\n    }\n    clearRetry() {\n        if (this.retryInterval) {\n            clearInterval(this.retryInterval);\n            this.retryInterval = null;\n        }\n    }\n    async initiateCall(pubkey, type) {\n        if (this._callState !== \"idle\") return;\n        // Захватываем медиа СРАЗУ — если не получится, сообщаем до начала звонка\n        try {\n            this.preStream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true\n                },\n                video: type === \"video\" ? {\n                    width: {\n                        ideal: 1280\n                    },\n                    height: {\n                        ideal: 720\n                    },\n                    facingMode: \"user\"\n                } : false\n            });\n        } catch (err) {\n            // Если видео не получилось — пробуем только аудио\n            if (type === \"video\") {\n                try {\n                    this.preStream = await navigator.mediaDevices.getUserMedia({\n                        audio: true,\n                        video: false\n                    });\n                    type = \"audio\";\n                } catch (e) {\n                    this.setState(\"idle\", this.mediaErrorMsg(err));\n                    return;\n                }\n            } else {\n                this.setState(\"idle\", this.mediaErrorMsg(err));\n                return;\n            }\n        }\n        this._remotePubkey = pubkey;\n        this._callType = type;\n        this.setState(\"calling\");\n        // Отправляем call-request и повторяем каждые 3 сек (Nostr ненадёжен)\n        const sendReq = ()=>{\n            _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(pubkey, {\n                type: \"call-request\",\n                callType: type\n            }).catch(()=>{});\n        };\n        sendReq();\n        this.retryInterval = setInterval(()=>{\n            if (this._callState === \"calling\") sendReq();\n            else this.clearRetry();\n        }, 3000);\n        // Таймаут 40 сек\n        this.callTimeout = setTimeout(()=>{\n            if (this._callState === \"calling\") {\n                this.cleanup(true);\n                this.setState(\"idle\", \"Нет ответа\");\n            }\n        }, 40000);\n    }\n    async acceptCall() {\n        if (this._callState !== \"ringing\" || !this._remotePubkey) return;\n        try {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        } catch (e) {}\n        this.clearCallTimeout();\n        this.stopRingtone();\n        this.setState(\"connecting\");\n        // Захватываем медиа при принятии\n        try {\n            this.preStream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true\n                },\n                video: this._callType === \"video\" ? {\n                    width: {\n                        ideal: 1280\n                    },\n                    height: {\n                        ideal: 720\n                    },\n                    facingMode: \"user\"\n                } : false\n            });\n        } catch (err) {\n            if (this._callType === \"video\") {\n                try {\n                    this.preStream = await navigator.mediaDevices.getUserMedia({\n                        audio: true\n                    });\n                    this._callType = \"audio\";\n                } catch (e) {\n                    this.cleanup(false);\n                    this.setState(\"idle\", this.mediaErrorMsg(err));\n                    return;\n                }\n            } else {\n                this.cleanup(false);\n                this.setState(\"idle\", this.mediaErrorMsg(err));\n                return;\n            }\n        }\n        await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n            type: \"call-accept\"\n        });\n        await this.startWebRTC(false);\n    }\n    async rejectCall() {\n        if (this._callState !== \"ringing\" || !this._remotePubkey) return;\n        this.clearCallTimeout();\n        this.stopRingtone();\n        _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n            type: \"call-reject\"\n        }).catch(()=>{});\n        this.cleanup(false);\n    }\n    mediaErrorMsg(err) {\n        if (err instanceof DOMException) {\n            if (err.name === \"NotAllowedError\") return \"Доступ к микрофону/камере запрещён. Разрешите в настройках браузера.\";\n            if (err.name === \"NotFoundError\") return \"Микрофон/камера не найдены. Подключите устройство.\";\n            if (err.name === \"NotReadableError\") return \"Устройство занято другим приложением.\";\n            return \"Ошибка: \".concat(err.message);\n        }\n        return \"Не удалось получить доступ к медиа\";\n    }\n    async startWebRTC(isInitiator) {\n        try {\n            this.pc = new RTCPeerConnection(ICE_CONFIG);\n            // Используем предзахваченный стрим\n            this.localStream = this.preStream;\n            this.preStream = null;\n            if (!this.localStream) {\n                this.localStream = await navigator.mediaDevices.getUserMedia({\n                    audio: true,\n                    video: this._callType === \"video\"\n                });\n            }\n            this.localStream.getTracks().forEach((track)=>{\n                this.pc.addTrack(track, this.localStream);\n            });\n            this.remoteStream = new MediaStream();\n            this.pc.ontrack = (event)=>{\n                if (event.streams[0]) {\n                    event.streams[0].getTracks().forEach((track)=>{\n                        this.remoteStream.addTrack(track);\n                    });\n                } else if (event.track) {\n                    this.remoteStream.addTrack(event.track);\n                }\n                this.notifyStreams();\n            };\n            this.pc.onicecandidate = (event)=>{\n                if (event.candidate && this._remotePubkey) {\n                    _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                        type: \"webrtc-ice\",\n                        candidate: event.candidate.toJSON()\n                    }).catch(()=>{});\n                }\n            };\n            this.pc.oniceconnectionstatechange = ()=>{\n                var _this_pc;\n                const s = (_this_pc = this.pc) === null || _this_pc === void 0 ? void 0 : _this_pc.iceConnectionState;\n                if (s === \"connected\" || s === \"completed\") {\n                    this.setState(\"connected\");\n                } else if (s === \"failed\") {\n                    if (this.pc && isInitiator) {\n                        try {\n                            this.pc.restartIce();\n                        } catch (e) {\n                            this.endCall(\"Соединение прервано\");\n                        }\n                    } else {\n                        this.endCall(\"Соединение прервано\");\n                    }\n                } else if (s === \"disconnected\") {\n                    setTimeout(()=>{\n                        var _this_pc;\n                        if (((_this_pc = this.pc) === null || _this_pc === void 0 ? void 0 : _this_pc.iceConnectionState) === \"disconnected\") this.endCall(\"Соединение потеряно\");\n                    }, 7000);\n                }\n            };\n            this.notifyStreams();\n            if (isInitiator) {\n                const offer = await this.pc.createOffer({\n                    offerToReceiveAudio: true,\n                    offerToReceiveVideo: this._callType === \"video\"\n                });\n                await this.pc.setLocalDescription(offer);\n                await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                    type: \"webrtc-offer\",\n                    sdp: offer.sdp\n                });\n            }\n            for (const c of this.iceCandidateQueue){\n                try {\n                    await this.pc.addIceCandidate(new RTCIceCandidate(c));\n                } catch (e) {}\n            }\n            this.iceCandidateQueue = [];\n        } catch (err) {\n            this.endCall(this.mediaErrorMsg(err));\n        }\n    }\n    async handleOffer(sdp) {\n        if (!this.pc) return;\n        try {\n            await this.pc.setRemoteDescription(new RTCSessionDescription({\n                type: \"offer\",\n                sdp\n            }));\n            const answer = await this.pc.createAnswer();\n            await this.pc.setLocalDescription(answer);\n            await _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                type: \"webrtc-answer\",\n                sdp: answer.sdp\n            });\n        } catch (e) {\n            console.error(\"handleOffer:\", e);\n        }\n    }\n    async handleAnswer(sdp) {\n        if (!this.pc) return;\n        try {\n            await this.pc.setRemoteDescription(new RTCSessionDescription({\n                type: \"answer\",\n                sdp\n            }));\n        } catch (e) {\n            console.error(\"handleAnswer:\", e);\n        }\n    }\n    async handleIceCandidate(candidate) {\n        if (!this.pc || !this.pc.remoteDescription) {\n            this.iceCandidateQueue.push(candidate);\n            return;\n        }\n        try {\n            await this.pc.addIceCandidate(new RTCIceCandidate(candidate));\n        } catch (e) {}\n    }\n    endCall(error) {\n        if (this._remotePubkey && this._callState !== \"idle\" && this._callState !== \"ended\") {\n            _nostr__WEBPACK_IMPORTED_MODULE_0__.nostrClient.sendWebRTCSignal(this._remotePubkey, {\n                type: \"call-end\"\n            }).catch(()=>{});\n        }\n        this.cleanup(false);\n        if (error) this.setState(\"idle\", error);\n    }\n    cleanup(silent) {\n        try {\n            localStorage.removeItem(LS_STALE_CALL_KEY);\n        } catch (e) {}\n        this.clearCallTimeout();\n        this.clearRetry();\n        this.stopRingtone();\n        if (this.preStream) {\n            this.preStream.getTracks().forEach((t)=>t.stop());\n            this.preStream = null;\n        }\n        if (this.localStream) {\n            this.localStream.getTracks().forEach((t)=>t.stop());\n            this.localStream = null;\n        }\n        if (this.remoteStream) {\n            this.remoteStream.getTracks().forEach((t)=>t.stop());\n            this.remoteStream = null;\n        }\n        if (this.pc) {\n            this.pc.close();\n            this.pc = null;\n        }\n        this.iceCandidateQueue = [];\n        this._remotePubkey = null;\n        this._callStartTime = 0;\n        if (!silent) this.setState(\"idle\");\n        this.notifyStreams();\n    }\n    toggleMute() {\n        if (!this.localStream) return false;\n        const t = this.localStream.getAudioTracks()[0];\n        if (t) {\n            t.enabled = !t.enabled;\n            return !t.enabled;\n        }\n        return false;\n    }\n    toggleVideo() {\n        if (!this.localStream) return false;\n        const t = this.localStream.getVideoTracks()[0];\n        if (t) {\n            t.enabled = !t.enabled;\n            return !t.enabled;\n        }\n        return false;\n    }\n    constructor(){\n        this.pc = null;\n        this.localStream = null;\n        this.remoteStream = null;\n        this._callState = \"idle\";\n        this._remotePubkey = null;\n        this._callType = \"audio\";\n        this.stateCallbacks = new Set();\n        this.streamCallbacks = new Set();\n        this.iceCandidateQueue = [];\n        this._callStartTime = 0;\n        this._unsubSignal = null;\n        this.callTimeout = null;\n        this.retryInterval = null;\n        this.audioCtx = null;\n        this.audioOsc = null;\n        // Предзахваченный стрим — берём медиа ДО звонка чтобы потом не ждать\n        this.preStream = null;\n    }\n}\nconst webrtcManager = new WebRTCManager();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvd2VicnRjLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlEO0FBUXpELE1BQU1DLGFBQStCO0lBQ25DQyxZQUFZO1FBQ1Y7WUFBRUMsTUFBTTtRQUErQjtRQUN2QztZQUFFQSxNQUFNO1FBQWdDO1FBQ3hDO1lBQUVBLE1BQU07UUFBZ0M7UUFDeEM7WUFDRUEsTUFBTTtZQUNOQyxVQUFVO1lBQ1ZDLFlBQVk7UUFDZDtRQUNBO1lBQ0VGLE1BQU07WUFDTkMsVUFBVTtZQUNWQyxZQUFZO1FBQ2Q7UUFDQTtZQUNFRixNQUFNO1lBQ05DLFVBQVU7WUFDVkMsWUFBWTtRQUNkO0tBQ0Q7SUFDREMsc0JBQXNCO0FBQ3hCO0FBRUEsTUFBTUMsb0JBQW9CO0FBRTFCLE1BQU1DO0lBbUJKLElBQUlDLFlBQVk7UUFBRSxPQUFPLElBQUksQ0FBQ0MsVUFBVTtJQUFFO0lBQzFDLElBQUlDLGVBQWU7UUFBRSxPQUFPLElBQUksQ0FBQ0MsYUFBYTtJQUFFO0lBQ2hELElBQUlDLFdBQVc7UUFBRSxPQUFPLElBQUksQ0FBQ0MsU0FBUztJQUFFO0lBQ3hDLElBQUlDLGdCQUFnQjtRQUFFLE9BQU8sSUFBSSxDQUFDQyxjQUFjO0lBQUU7SUFFbERDLGNBQWNDLEVBQXFCLEVBQUU7UUFBRSxJQUFJLENBQUNDLGNBQWMsQ0FBQ0MsR0FBRyxDQUFDRjtRQUFLLE9BQU87WUFBUSxJQUFJLENBQUNDLGNBQWMsQ0FBQ0UsTUFBTSxDQUFDSDtRQUFLO0lBQUc7SUFDdEhJLFNBQVNKLEVBQWtCLEVBQUU7UUFBRSxJQUFJLENBQUNLLGVBQWUsQ0FBQ0gsR0FBRyxDQUFDRjtRQUFLLE9BQU87WUFBUSxJQUFJLENBQUNLLGVBQWUsQ0FBQ0YsTUFBTSxDQUFDSDtRQUFLO0lBQUc7SUFFeEdNLFNBQVNDLEtBQWdCLEVBQUVDLEtBQWMsRUFBRTtRQUNqRCxJQUFJLENBQUNoQixVQUFVLEdBQUdlO1FBQ2xCLElBQUlBLFVBQVUsYUFBYTtZQUFFLElBQUksQ0FB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bENDLGVBQW1DO2FBQ25DdkIsYUFBd0I7YUFDeEJFLGdCQUErQjthQUMvQkUsWUFBc0I7YUFDdEJLLGlCQUF5QyxJQUFJc0k7YUFDN0NsSSxrQkFBdUMsSUFBSWtJO2FBQzNDakIsb0JBQTJDLEVBQUU7YUFDN0N4SCxpQkFBeUI7YUFDekJ1QyxlQUFvQzthQUNwQ3NCLGNBQW9EO2FBQ3BEWSxnQkFBdUQ7YUFDdkR0RCxXQUFnQzthQUNoQ0UsV0FBa0M7UUFDMUMscUVBQXFFO2FBQzdEd0QsWUFBZ0M7O0FBb1cxQztBQUVPLE1BQU02RCxnQkFBZ0IsSUFBSWxKLGdCQUFnQiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvbGliL3dlYnJ0Yy50cz8zMWQ1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG5vc3RyQ2xpZW50LCB0eXBlIFdlYlJUQ1NpZ25hbCB9IGZyb20gJy4vbm9zdHInO1xuXG5leHBvcnQgdHlwZSBDYWxsU3RhdGUgPSAnaWRsZScgfCAnY2FsbGluZycgfCAncmluZ2luZycgfCAnY29ubmVjdGluZycgfCAnY29ubmVjdGVkJyB8ICdlbmRlZCc7XG5leHBvcnQgdHlwZSBDYWxsVHlwZSA9ICdhdWRpbycgfCAndmlkZW8nO1xuXG50eXBlIENhbGxTdGF0ZUNhbGxiYWNrID0gKHN0YXRlOiBDYWxsU3RhdGUsIHJlbW90ZVB1YmtleTogc3RyaW5nIHwgbnVsbCwgY2FsbFR5cGU6IENhbGxUeXBlLCBlcnJvcj86IHN0cmluZykgPT4gdm9pZDtcbnR5cGUgU3RyZWFtQ2FsbGJhY2sgPSAobG9jYWw6IE1lZGlhU3RyZWFtIHwgbnVsbCwgcmVtb3RlOiBNZWRpYVN0cmVhbSB8IG51bGwpID0+IHZvaWQ7XG5cbmNvbnN0IElDRV9DT05GSUc6IFJUQ0NvbmZpZ3VyYXRpb24gPSB7XG4gIGljZVNlcnZlcnM6IFtcbiAgICB7IHVybHM6ICdzdHVuOnN0dW4ubC5nb29nbGUuY29tOjE5MzAyJyB9LFxuICAgIHsgdXJsczogJ3N0dW46c3R1bjEubC5nb29nbGUuY29tOjE5MzAyJyB9LFxuICAgIHsgdXJsczogJ3N0dW46c3R1bi5jbG91ZGZsYXJlLmNvbTozNDc4JyB9LFxuICAgIHtcbiAgICAgIHVybHM6ICd0dXJuOm9wZW5yZWxheS5tZXRlcmVkLmNhOjgwJyxcbiAgICAgIHVzZXJuYW1lOiAnb3BlbnJlbGF5cHJvamVjdCcsXG4gICAgICBjcmVkZW50aWFsOiAnb3BlbnJlbGF5cHJvamVjdCcsXG4gICAgfSxcbiAgICB7XG4gICAgICB1cmxzOiAndHVybjpvcGVucmVsYXkubWV0ZXJlZC5jYTo0NDMnLFxuICAgICAgdXNlcm5hbWU6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICAgIGNyZWRlbnRpYWw6ICdvcGVucmVsYXlwcm9qZWN0JyxcbiAgICB9LFxuICAgIHtcbiAgICAgIHVybHM6ICd0dXJuOm9wZW5yZWxheS5tZXRlcmVkLmNhOjQ0Mz90cmFuc3BvcnQ9dGNwJyxcbiAgICAgIHVzZXJuYW1lOiAnb3BlbnJlbGF5cHJvamVjdCcsXG4gICAgICBjcmVkZW50aWFsOiAnb3BlbnJlbGF5cHJvamVjdCcsXG4gICAgfSxcbiAgXSxcbiAgaWNlQ2FuZGlkYXRlUG9vbFNpemU6IDEwLFxufTtcblxuY29uc3QgTFNfU1RBTEVfQ0FMTF9LRVkgPSAnbm9zdHJfY2FsbF9yaW5naW5nJztcblxuY2xhc3MgV2ViUlRDTWFuYWdlciB7XG4gIHByaXZhdGUgcGM6IFJUQ1BlZXJDb25uZWN0aW9uIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbG9jYWxTdHJlYW06IE1lZGlhU3RyZWFtIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcmVtb3RlU3RyZWFtOiBNZWRpYVN0cmVhbSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIF9jYWxsU3RhdGU6IENhbGxTdGF0ZSA9ICdpZGxlJztcbiAgcHJpdmF0ZSBfcmVtb3RlUHVia2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBfY2FsbFR5cGU6IENhbGxUeXBlID0gJ2F1ZGlvJztcbiAgcHJpdmF0ZSBzdGF0ZUNhbGxiYWNrczogU2V0PENhbGxTdGF0ZUNhbGxiYWNrPiA9IG5ldyBTZXQoKTtcbiAgcHJpdmF0ZSBzdHJlYW1DYWxsYmFja3M6IFNldDxTdHJlYW1DYWxsYmFjaz4gPSBuZXcgU2V0KCk7XG4gIHByaXZhdGUgaWNlQ2FuZGlkYXRlUXVldWU6IFJUQ0ljZUNhbmRpZGF0ZUluaXRbXSA9IFtdO1xuICBwcml2YXRlIF9jYWxsU3RhcnRUaW1lOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIF91bnN1YlNpZ25hbDogKCgpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgY2FsbFRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcmV0cnlJbnRlcnZhbDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0SW50ZXJ2YWw+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYXVkaW9DdHg6IEF1ZGlvQ29udGV4dCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGF1ZGlvT3NjOiBPc2NpbGxhdG9yTm9kZSB8IG51bGwgPSBudWxsO1xuICAvLyDQn9GA0LXQtNC30LDRhdCy0LDRh9C10L3QvdGL0Lkg0YHRgtGA0LjQvCDigJQg0LHQtdGA0ZHQvCDQvNC10LTQuNCwINCU0J4g0LfQstC+0L3QutCwINGH0YLQvtCx0Ysg0L/QvtGC0L7QvCDQvdC1INC20LTQsNGC0YxcbiAgcHJpdmF0ZSBwcmVTdHJlYW06IE1lZGlhU3RyZWFtIHwgbnVsbCA9IG51bGw7XG5cbiAgZ2V0IGNhbGxTdGF0ZSgpIHsgcmV0dXJuIHRoaXMuX2NhbGxTdGF0ZTsgfVxuICBnZXQgcmVtb3RlUHVia2V5KCkgeyByZXR1cm4gdGhpcy5fcmVtb3RlUHVia2V5OyB9XG4gIGdldCBjYWxsVHlwZSgpIHsgcmV0dXJuIHRoaXMuX2NhbGxUeXBlOyB9XG4gIGdldCBjYWxsU3RhcnRUaW1lKCkgeyByZXR1cm4gdGhpcy5fY2FsbFN0YXJ0VGltZTsgfVxuXG4gIG9uU3RhdGVDaGFuZ2UoY2I6IENhbGxTdGF0ZUNhbGxiYWNrKSB7IHRoaXMuc3RhdGVDYWxsYmFja3MuYWRkKGNiKTsgcmV0dXJuICgpID0+IHsgdGhpcy5zdGF0ZUNhbGxiYWNrcy5kZWxldGUoY2IpOyB9OyB9XG4gIG9uU3RyZWFtKGNiOiBTdHJlYW1DYWxsYmFjaykgeyB0aGlzLnN0cmVhbUNhbGxiYWNrcy5hZGQoY2IpOyByZXR1cm4gKCkgPT4geyB0aGlzLnN0cmVhbUNhbGxiYWNrcy5kZWxldGUoY2IpOyB9OyB9XG5cbiAgcHJpdmF0ZSBzZXRTdGF0ZShzdGF0ZTogQ2FsbFN0YXRlLCBlcnJvcj86IHN0cmluZykge1xuICAgIHRoaXMuX2NhbGxTdGF0ZSA9IHN0YXRlO1xuICAgIGlmIChzdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcpIHsgdGhpcy5fY2FsbFN0YXJ0VGltZSA9IERhdGUubm93KCk7IHRoaXMuc3RvcFJpbmd0b25lKCk7IH1cbiAgICBpZiAoc3RhdGUgPT09ICdpZGxlJyB8fCBzdGF0ZSA9PT0gJ2VuZGVkJykgdGhpcy5zdG9wUmluZ3RvbmUoKTtcbiAgICB0aGlzLnN0YXRlQ2FsbGJhY2tzLmZvckVhY2goY2IgPT4gY2Ioc3RhdGUsIHRoaXMuX3JlbW90ZVB1YmtleSwgdGhpcy5fY2FsbFR5cGUsIGVycm9yKSk7XG4gIH1cblxuICBwcml2YXRlIG5vdGlmeVN0cmVhbXMoKSB7XG4gICAgdGhpcy5zdHJlYW1DYWxsYmFja3MuZm9yRWFjaChjYiA9PiBjYih0aGlzLmxvY2FsU3RyZWFtLCB0aGlzLnJlbW90ZVN0cmVhbSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBwbGF5UmluZ3RvbmUoKSB7XG4gICAgdGhpcy5zdG9wUmluZ3RvbmUoKTtcbiAgICB0cnkge1xuICAgICAgdGhpcy5hdWRpb0N0eCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICAgIHRoaXMuYXVkaW9Pc2MgPSB0aGlzLmF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTtcbiAgICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTtcbiAgICAgIHRoaXMuYXVkaW9Pc2MuY29ubmVjdChnYWluKTtcbiAgICAgIGdhaW4uY29ubmVjdCh0aGlzLmF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTtcbiAgICAgIHRoaXMuYXVkaW9Pc2MuZnJlcXVlbmN5LnZhbHVlID0gNDQwO1xuICAgICAgZ2Fpbi5nYWluLnZhbHVlID0gMC4wODtcbiAgICAgIHRoaXMuYXVkaW9Pc2Muc3RhcnQoKTtcbiAgICAgIGNvbnN0IGN0eCA9IHRoaXMuYXVkaW9DdHg7XG4gICAgICBjb25zdCBwdWxzZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuX2NhbGxTdGF0ZSAhPT0gJ3JpbmdpbmcnIHx8ICF0aGlzLmF1ZGlvQ3R4KSB7IHRyeSB7IHRoaXMuYXVkaW9Pc2M/LnN0b3AoKTsgY3R4LmNsb3NlKCk7IH0gY2F0Y2gge30gcmV0dXJuOyB9XG4gICAgICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLjA4LCBjdHguY3VycmVudFRpbWUpO1xuICAgICAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgY3R4LmN1cnJlbnRUaW1lICsgMC41KTtcbiAgICAgICAgc2V0VGltZW91dChwdWxzZSwgMTIwMCk7XG4gICAgICB9O1xuICAgICAgcHVsc2UoKTtcbiAgICB9IGNhdGNoIHt9XG4gIH1cblxuICBwcml2YXRlIHN0b3BSaW5ndG9uZSgpIHtcbiAgICB0cnkgeyB0aGlzLmF1ZGlvT3NjPy5zdG9wKCk7IH0gY2F0Y2gge31cbiAgICB0cnkgeyB0aGlzLmF1ZGlvQ3R4Py5jbG9zZSgpOyB9IGNhdGNoIHt9XG4gICAgdGhpcy5hdWRpb09zYyA9IG51bGw7XG4gICAgdGhpcy5hdWRpb0N0eCA9IG51bGw7XG4gIH1cblxuICBpbml0KCkge1xuICAgIGlmICh0aGlzLl91bnN1YlNpZ25hbCkgcmV0dXJuO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YWxlQ2FsbEpTT04gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMU19TVEFMRV9DQUxMX0tFWSk7XG4gICAgICBpZiAoc3RhbGVDYWxsSlNPTikge1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMU19TVEFMRV9DQUxMX0tFWSk7XG4gICAgICAgIGNvbnN0IHN0YWxlQ2FsbCA9IEpTT04ucGFyc2Uoc3RhbGVDYWxsSlNPTik7XG4gICAgICAgIGlmIChzdGFsZUNhbGwgJiYgc3RhbGVDYWxsLmNhbGxlciAmJiAoRGF0ZS5ub3coKSAtIHN0YWxlQ2FsbC50aW1lIDwgNDUwMDApKSB7XG4gICAgICAgICAgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbChzdGFsZUNhbGwuY2FsbGVyLCB7IHR5cGU6ICdjYWxsLXJlamVjdCcgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTFNfU1RBTEVfQ0FMTF9LRVkpO1xuICAgIH1cblxuICAgIHRoaXMuX3Vuc3ViU2lnbmFsID0gbm9zdHJDbGllbnQub25TaWduYWwoKGZyb20sIHNpZ25hbCkgPT4geyB0aGlzLmhhbmRsZVNpZ25hbChmcm9tLCBzaWduYWwpOyB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuX3Vuc3ViU2lnbmFsKSB7IHRoaXMuX3Vuc3ViU2lnbmFsKCk7IHRoaXMuX3Vuc3ViU2lnbmFsID0gbnVsbDsgfVxuICAgIHRoaXMuZW5kQ2FsbCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTaWduYWwoZnJvbTogc3RyaW5nLCBzaWduYWw6IFdlYlJUQ1NpZ25hbCkge1xuICAgIHN3aXRjaCAoc2lnbmFsLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2NhbGwtcmVxdWVzdCc6XG4gICAgICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgIT09ICdpZGxlJykge1xuICAgICAgICAgIG5vc3RyQ2xpZW50LnNlbmRXZWJSVENTaWduYWwoZnJvbSwgeyB0eXBlOiAnY2FsbC1yZWplY3QnIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVtb3RlUHVia2V5ID0gZnJvbTtcbiAgICAgICAgdGhpcy5fY2FsbFR5cGUgPSBzaWduYWwuY2FsbFR5cGUgfHwgJ2F1ZGlvJztcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSgncmluZ2luZycpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKExTX1NUQUxFX0NBTExfS0VZLCBKU09OLnN0cmluZ2lmeSh7IGNhbGxlcjogZnJvbSwgdGltZTogRGF0ZS5ub3coKSB9KSk7XG4gICAgICAgIH0gY2F0Y2gge31cbiAgICAgICAgdGhpcy5wbGF5UmluZ3RvbmUoKTtcbiAgICAgICAgdGhpcy5jYWxsVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4geyBpZiAodGhpcy5fY2FsbFN0YXRlID09PSAncmluZ2luZycpIHRoaXMucmVqZWN0Q2FsbCgpOyB9LCA0NTAwMCk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdjYWxsLWFjY2VwdCc6XG4gICAgICAgIGlmICgodGhpcy5fY2FsbFN0YXRlID09PSAnY2FsbGluZycpICYmIHRoaXMuX3JlbW90ZVB1YmtleSA9PT0gZnJvbSkge1xuICAgICAgICAgIHRoaXMuY2xlYXJSZXRyeSgpO1xuICAgICAgICAgIHRoaXMuY2xlYXJDYWxsVGltZW91dCgpO1xuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2Nvbm5lY3RpbmcnKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnN0YXJ0V2ViUlRDKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdjYWxsLXJlamVjdCc6XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVQdWJrZXkgPT09IGZyb20pIHsgdGhpcy5jbGVhbnVwKGZhbHNlKTsgdGhpcy5zZXRTdGF0ZSgnaWRsZScsICfQl9Cy0L7QvdC+0Log0L7RgtC60LvQvtC90ZHQvScpOyB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdjYWxsLWVuZCc6XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVQdWJrZXkgPT09IGZyb20pIHRoaXMuY2xlYW51cChmYWxzZSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICd3ZWJydGMtb2ZmZXInOlxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlUHVia2V5ID09PSBmcm9tICYmIHNpZ25hbC5zZHApIGF3YWl0IHRoaXMuaGFuZGxlT2ZmZXIoc2lnbmFsLnNkcCk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICd3ZWJydGMtYW5zd2VyJzpcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZVB1YmtleSA9PT0gZnJvbSAmJiBzaWduYWwuc2RwKSBhd2FpdCB0aGlzLmhhbmRsZUFuc3dlcihzaWduYWwuc2RwKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3dlYnJ0Yy1pY2UnOlxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlUHVia2V5ID09PSBmcm9tICYmIHNpZ25hbC5jYW5kaWRhdGUpIGF3YWl0IHRoaXMuaGFuZGxlSWNlQ2FuZGlkYXRlKHNpZ25hbC5jYW5kaWRhdGUpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNsZWFyQ2FsbFRpbWVvdXQoKSB7IGlmICh0aGlzLmNhbGxUaW1lb3V0KSB7IGNsZWFyVGltZW91dCh0aGlzLmNhbGxUaW1lb3V0KTsgdGhpcy5jYWxsVGltZW91dCA9IG51bGw7IH0gfVxuICBwcml2YXRlIGNsZWFyUmV0cnkoKSB7IGlmICh0aGlzLnJldHJ5SW50ZXJ2YWwpIHsgY2xlYXJJbnRlcnZhbCh0aGlzLnJldHJ5SW50ZXJ2YWwpOyB0aGlzLnJldHJ5SW50ZXJ2YWwgPSBudWxsOyB9IH1cblxuICBhc3luYyBpbml0aWF0ZUNhbGwocHVia2V5OiBzdHJpbmcsIHR5cGU6IENhbGxUeXBlKSB7XG4gICAgaWYgKHRoaXMuX2NhbGxTdGF0ZSAhPT0gJ2lkbGUnKSByZXR1cm47XG5cbiAgICAvLyDQl9Cw0YXQstCw0YLRi9Cy0LDQtdC8INC80LXQtNC40LAg0KHQoNCQ0JfQoyDigJQg0LXRgdC70Lgg0L3QtSDQv9C+0LvRg9GH0LjRgtGB0Y8sINGB0L7QvtCx0YnQsNC10Lwg0LTQviDQvdCw0YfQsNC70LAg0LfQstC+0L3QutCwXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMucHJlU3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoe1xuICAgICAgICBhdWRpbzogeyBlY2hvQ2FuY2VsbGF0aW9uOiB0cnVlLCBub2lzZVN1cHByZXNzaW9uOiB0cnVlLCBhdXRvR2FpbkNvbnRyb2w6IHRydWUgfSxcbiAgICAgICAgdmlkZW86IHR5cGUgPT09ICd2aWRlbycgPyB7IHdpZHRoOiB7IGlkZWFsOiAxMjgwIH0sIGhlaWdodDogeyBpZGVhbDogNzIwIH0sIGZhY2luZ01vZGU6ICd1c2VyJyB9IDogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIC8vINCV0YHQu9C4INCy0LjQtNC10L4g0L3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDigJQg0L/RgNC+0LHRg9C10Lwg0YLQvtC70YzQutC+INCw0YPQtNC40L5cbiAgICAgIGlmICh0eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhpcy5wcmVTdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7IGF1ZGlvOiB0cnVlLCB2aWRlbzogZmFsc2UgfSk7XG4gICAgICAgICAgdHlwZSA9ICdhdWRpbyc7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ2lkbGUnLCB0aGlzLm1lZGlhRXJyb3JNc2coZXJyKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNldFN0YXRlKCdpZGxlJywgdGhpcy5tZWRpYUVycm9yTXNnKGVycikpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5fcmVtb3RlUHVia2V5ID0gcHVia2V5O1xuICAgIHRoaXMuX2NhbGxUeXBlID0gdHlwZTtcbiAgICB0aGlzLnNldFN0YXRlKCdjYWxsaW5nJyk7XG5cbiAgICAvLyDQntGC0L/RgNCw0LLQu9GP0LXQvCBjYWxsLXJlcXVlc3Qg0Lgg0L/QvtCy0YLQvtGA0Y/QtdC8INC60LDQttC00YvQtSAzINGB0LXQuiAoTm9zdHIg0L3QtdC90LDQtNGR0LbQtdC9KVxuICAgIGNvbnN0IHNlbmRSZXEgPSAoKSA9PiB7XG4gICAgICBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHB1YmtleSwgeyB0eXBlOiAnY2FsbC1yZXF1ZXN0JywgY2FsbFR5cGU6IHR5cGUgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgIH07XG4gICAgc2VuZFJlcSgpO1xuICAgIHRoaXMucmV0cnlJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgPT09ICdjYWxsaW5nJykgc2VuZFJlcSgpO1xuICAgICAgZWxzZSB0aGlzLmNsZWFyUmV0cnkoKTtcbiAgICB9LCAzMDAwKTtcblxuICAgIC8vINCi0LDQudC80LDRg9GCIDQwINGB0LXQulxuICAgIHRoaXMuY2FsbFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICh0aGlzLl9jYWxsU3RhdGUgPT09ICdjYWxsaW5nJykge1xuICAgICAgICB0aGlzLmNsZWFudXAodHJ1ZSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoJ2lkbGUnLCAn0J3QtdGCINC+0YLQstC10YLQsCcpO1xuICAgICAgfVxuICAgIH0sIDQwMDAwKTtcbiAgfVxuXG4gIGFzeW5jIGFjY2VwdENhbGwoKSB7XG4gICAgaWYgKHRoaXMuX2NhbGxTdGF0ZSAhPT0gJ3JpbmdpbmcnIHx8ICF0aGlzLl9yZW1vdGVQdWJrZXkpIHJldHVybjtcbiAgICB0cnkgeyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMU19TVEFMRV9DQUxMX0tFWSk7IH0gY2F0Y2gge31cbiAgICB0aGlzLmNsZWFyQ2FsbFRpbWVvdXQoKTtcbiAgICB0aGlzLnN0b3BSaW5ndG9uZSgpO1xuICAgIHRoaXMuc2V0U3RhdGUoJ2Nvbm5lY3RpbmcnKTtcblxuICAgIC8vINCX0LDRhdCy0LDRgtGL0LLQsNC10Lwg0LzQtdC00LjQsCDQv9GA0Lgg0L/RgNC40L3Rj9GC0LjQuFxuICAgIHRyeSB7XG4gICAgICB0aGlzLnByZVN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHtcbiAgICAgICAgYXVkaW86IHsgZWNob0NhbmNlbGxhdGlvbjogdHJ1ZSwgbm9pc2VTdXBwcmVzc2lvbjogdHJ1ZSwgYXV0b0dhaW5Db250cm9sOiB0cnVlIH0sXG4gICAgICAgIHZpZGVvOiB0aGlzLl9jYWxsVHlwZSA9PT0gJ3ZpZGVvJyA/IHsgd2lkdGg6IHsgaWRlYWw6IDEyODAgfSwgaGVpZ2h0OiB7IGlkZWFsOiA3MjAgfSwgZmFjaW5nTW9kZTogJ3VzZXInIH0gOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKHRoaXMuX2NhbGxUeXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgIHRyeSB7IHRoaXMucHJlU3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyBhdWRpbzogdHJ1ZSB9KTsgdGhpcy5fY2FsbFR5cGUgPSAnYXVkaW8nOyB9XG4gICAgICAgIGNhdGNoIHsgdGhpcy5jbGVhbnVwKGZhbHNlKTsgdGhpcy5zZXRTdGF0ZSgnaWRsZScsIHRoaXMubWVkaWFFcnJvck1zZyhlcnIpKTsgcmV0dXJuOyB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNsZWFudXAoZmFsc2UpOyB0aGlzLnNldFN0YXRlKCdpZGxlJywgdGhpcy5tZWRpYUVycm9yTXNnKGVycikpOyByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgbm9zdHJDbGllbnQuc2VuZFdlYlJUQ1NpZ25hbCh0aGlzLl9yZW1vdGVQdWJrZXksIHsgdHlwZTogJ2NhbGwtYWNjZXB0JyB9KTtcbiAgICBhd2FpdCB0aGlzLnN0YXJ0V2ViUlRDKGZhbHNlKTtcbiAgfVxuXG4gIGFzeW5jIHJlamVjdENhbGwoKSB7XG4gICAgaWYgKHRoaXMuX2NhbGxTdGF0ZSAhPT0gJ3JpbmdpbmcnIHx8ICF0aGlzLl9yZW1vdGVQdWJrZXkpIHJldHVybjtcbiAgICB0aGlzLmNsZWFyQ2FsbFRpbWVvdXQoKTsgdGhpcy5zdG9wUmluZ3RvbmUoKTtcbiAgICBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHRoaXMuX3JlbW90ZVB1YmtleSwgeyB0eXBlOiAnY2FsbC1yZWplY3QnIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICB0aGlzLmNsZWFudXAoZmFsc2UpO1xuICB9XG5cbiAgcHJpdmF0ZSBtZWRpYUVycm9yTXNnKGVycjogdW5rbm93bik6IHN0cmluZyB7XG4gICAgaWYgKGVyciBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbikge1xuICAgICAgaWYgKGVyci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJykgcmV0dXJuICfQlNC+0YHRgtGD0L8g0Log0LzQuNC60YDQvtGE0L7QvdGDL9C60LDQvNC10YDQtSDQt9Cw0L/RgNC10YnRkdC9LiDQoNCw0LfRgNC10YjQuNGC0LUg0LIg0L3QsNGB0YLRgNC+0LnQutCw0YUg0LHRgNCw0YPQt9C10YDQsC4nO1xuICAgICAgaWYgKGVyci5uYW1lID09PSAnTm90Rm91bmRFcnJvcicpIHJldHVybiAn0JzQuNC60YDQvtGE0L7QvS/QutCw0LzQtdGA0LAg0L3QtSDQvdCw0LnQtNC10L3Riy4g0J/QvtC00LrQu9GO0YfQuNGC0LUg0YPRgdGC0YDQvtC50YHRgtCy0L4uJztcbiAgICAgIGlmIChlcnIubmFtZSA9PT0gJ05vdFJlYWRhYmxlRXJyb3InKSByZXR1cm4gJ9Cj0YHRgtGA0L7QudGB0YLQstC+INC30LDQvdGP0YLQviDQtNGA0YPQs9C40Lwg0L/RgNC40LvQvtC20LXQvdC40LXQvC4nO1xuICAgICAgcmV0dXJuIGDQntGI0LjQsdC60LA6ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICB9XG4gICAgcmV0dXJuICfQndC1INGD0LTQsNC70L7RgdGMINC/0L7Qu9GD0YfQuNGC0Ywg0LTQvtGB0YLRg9C/INC6INC80LXQtNC40LAnO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzdGFydFdlYlJUQyhpc0luaXRpYXRvcjogYm9vbGVhbikge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnBjID0gbmV3IFJUQ1BlZXJDb25uZWN0aW9uKElDRV9DT05GSUcpO1xuXG4gICAgICAvLyDQmNGB0L/QvtC70YzQt9GD0LXQvCDQv9GA0LXQtNC30LDRhdCy0LDRh9C10L3QvdGL0Lkg0YHRgtGA0LjQvFxuICAgICAgdGhpcy5sb2NhbFN0cmVhbSA9IHRoaXMucHJlU3RyZWFtO1xuICAgICAgdGhpcy5wcmVTdHJlYW0gPSBudWxsO1xuXG4gICAgICBpZiAoIXRoaXMubG9jYWxTdHJlYW0pIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHtcbiAgICAgICAgICBhdWRpbzogdHJ1ZSxcbiAgICAgICAgICB2aWRlbzogdGhpcy5fY2FsbFR5cGUgPT09ICd2aWRlbycsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxvY2FsU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICB0aGlzLnBjIS5hZGRUcmFjayh0cmFjaywgdGhpcy5sb2NhbFN0cmVhbSEpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMucmVtb3RlU3RyZWFtID0gbmV3IE1lZGlhU3RyZWFtKCk7XG5cbiAgICAgIHRoaXMucGMub250cmFjayA9IChldmVudCkgPT4ge1xuICAgICAgICBpZiAoZXZlbnQuc3RyZWFtc1swXSkge1xuICAgICAgICAgIGV2ZW50LnN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaCh0cmFjayA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbW90ZVN0cmVhbSEuYWRkVHJhY2sodHJhY2spO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRyYWNrKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdGVTdHJlYW0hLmFkZFRyYWNrKGV2ZW50LnRyYWNrKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vdGlmeVN0cmVhbXMoKTtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMucGMub25pY2VjYW5kaWRhdGUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmNhbmRpZGF0ZSAmJiB0aGlzLl9yZW1vdGVQdWJrZXkpIHtcbiAgICAgICAgICBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHRoaXMuX3JlbW90ZVB1YmtleSwge1xuICAgICAgICAgICAgdHlwZTogJ3dlYnJ0Yy1pY2UnLFxuICAgICAgICAgICAgY2FuZGlkYXRlOiBldmVudC5jYW5kaWRhdGUudG9KU09OKCksXG4gICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB0aGlzLnBjLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzID0gdGhpcy5wYz8uaWNlQ29ubmVjdGlvblN0YXRlO1xuICAgICAgICBpZiAocyA9PT0gJ2Nvbm5lY3RlZCcgfHwgcyA9PT0gJ2NvbXBsZXRlZCcpIHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKCdjb25uZWN0ZWQnKTtcbiAgICAgICAgfSBlbHNlIGlmIChzID09PSAnZmFpbGVkJykge1xuICAgICAgICAgIGlmICh0aGlzLnBjICYmIGlzSW5pdGlhdG9yKSB7XG4gICAgICAgICAgICB0cnkgeyB0aGlzLnBjLnJlc3RhcnRJY2UoKTsgfSBjYXRjaCB7IHRoaXMuZW5kQ2FsbCgn0KHQvtC10LTQuNC90LXQvdC40LUg0L/RgNC10YDQstCw0L3QvicpOyB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZW5kQ2FsbCgn0KHQvtC10LTQuNC90LXQvdC40LUg0L/RgNC10YDQstCw0L3QvicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChzID09PSAnZGlzY29ubmVjdGVkJykge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMucGM/LmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2Rpc2Nvbm5lY3RlZCcpIHRoaXMuZW5kQ2FsbCgn0KHQvtC10LTQuNC90LXQvdC40LUg0L/QvtGC0LXRgNGP0L3QvicpO1xuICAgICAgICAgIH0sIDcwMDApO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB0aGlzLm5vdGlmeVN0cmVhbXMoKTtcblxuICAgICAgaWYgKGlzSW5pdGlhdG9yKSB7XG4gICAgICAgIGNvbnN0IG9mZmVyID0gYXdhaXQgdGhpcy5wYy5jcmVhdGVPZmZlcih7XG4gICAgICAgICAgb2ZmZXJUb1JlY2VpdmVBdWRpbzogdHJ1ZSxcbiAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiB0aGlzLl9jYWxsVHlwZSA9PT0gJ3ZpZGVvJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMucGMuc2V0TG9jYWxEZXNjcmlwdGlvbihvZmZlcik7XG4gICAgICAgIGF3YWl0IG5vc3RyQ2xpZW50LnNlbmRXZWJSVENTaWduYWwodGhpcy5fcmVtb3RlUHVia2V5ISwge1xuICAgICAgICAgIHR5cGU6ICd3ZWJydGMtb2ZmZXInLFxuICAgICAgICAgIHNkcDogb2ZmZXIuc2RwLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZm9yIChjb25zdCBjIG9mIHRoaXMuaWNlQ2FuZGlkYXRlUXVldWUpIHtcbiAgICAgICAgdHJ5IHsgYXdhaXQgdGhpcy5wYy5hZGRJY2VDYW5kaWRhdGUobmV3IFJUQ0ljZUNhbmRpZGF0ZShjKSk7IH0gY2F0Y2gge31cbiAgICAgIH1cbiAgICAgIHRoaXMuaWNlQ2FuZGlkYXRlUXVldWUgPSBbXTtcblxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhpcy5lbmRDYWxsKHRoaXMubWVkaWFFcnJvck1zZyhlcnIpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGhhbmRsZU9mZmVyKHNkcDogc3RyaW5nKSB7XG4gICAgaWYgKCF0aGlzLnBjKSByZXR1cm47XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucGMuc2V0UmVtb3RlRGVzY3JpcHRpb24obmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7IHR5cGU6ICdvZmZlcicsIHNkcCB9KSk7XG4gICAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzLnBjLmNyZWF0ZUFuc3dlcigpO1xuICAgICAgYXdhaXQgdGhpcy5wYy5zZXRMb2NhbERlc2NyaXB0aW9uKGFuc3dlcik7XG4gICAgICBhd2FpdCBub3N0ckNsaWVudC5zZW5kV2ViUlRDU2lnbmFsKHRoaXMuX3JlbW90ZVB1YmtleSEsIHsgdHlwZTogJ3dlYnJ0Yy1hbnN3ZXInLCBzZHA6IGFuc3dlci5zZHAgfSk7XG4gICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKCdoYW5kbGVPZmZlcjonLCBlKTsgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBbnN3ZXIoc2RwOiBzdHJpbmcpIHtcbiAgICBpZiAoIXRoaXMucGMpIHJldHVybjtcbiAgICB0cnkgeyBhd2FpdCB0aGlzLnBjLnNldFJlbW90ZURlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oeyB0eXBlOiAnYW5zd2VyJywgc2RwIH0pKTsgfVxuICAgIGNhdGNoIChlKSB7IGNvbnNvbGUuZXJyb3IoJ2hhbmRsZUFuc3dlcjonLCBlKTsgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVJY2VDYW5kaWRhdGUoY2FuZGlkYXRlOiBSVENJY2VDYW5kaWRhdGVJbml0KSB7XG4gICAgaWYgKCF0aGlzLnBjIHx8ICF0aGlzLnBjLnJlbW90ZURlc2NyaXB0aW9uKSB7IHRoaXMuaWNlQ2FuZGlkYXRlUXVldWUucHVzaChjYW5kaWRhdGUpOyByZXR1cm47IH1cbiAgICB0cnkgeyBhd2FpdCB0aGlzLnBjLmFkZEljZUNhbmRpZGF0ZShuZXcgUlRDSWNlQ2FuZGlkYXRlKGNhbmRpZGF0ZSkpOyB9IGNhdGNoIHt9XG4gIH1cblxuICBlbmRDYWxsKGVycm9yPzogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuX3JlbW90ZVB1YmtleSAmJiB0aGlzLl9jYWxsU3RhdGUgIT09ICdpZGxlJyAmJiB0aGlzLl9jYWxsU3RhdGUgIT09ICdlbmRlZCcpIHtcbiAgICAgIG5vc3RyQ2xpZW50LnNlbmRXZWJSVENTaWduYWwodGhpcy5fcmVtb3RlUHVia2V5LCB7IHR5cGU6ICdjYWxsLWVuZCcgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgIH1cbiAgICB0aGlzLmNsZWFudXAoZmFsc2UpO1xuICAgIGlmIChlcnJvcikgdGhpcy5zZXRTdGF0ZSgnaWRsZScsIGVycm9yKTtcbiAgfVxuXG4gIHByaXZhdGUgY2xlYW51cChzaWxlbnQ6IGJvb2xlYW4pIHtcbiAgICB0cnkgeyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMU19TVEFMRV9DQUxMX0tFWSk7IH0gY2F0Y2gge31cbiAgICB0aGlzLmNsZWFyQ2FsbFRpbWVvdXQoKTtcbiAgICB0aGlzLmNsZWFyUmV0cnkoKTtcbiAgICB0aGlzLnN0b3BSaW5ndG9uZSgpO1xuICAgIGlmICh0aGlzLnByZVN0cmVhbSkgeyB0aGlzLnByZVN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKHQgPT4gdC5zdG9wKCkpOyB0aGlzLnByZVN0cmVhbSA9IG51bGw7IH1cbiAgICBpZiAodGhpcy5sb2NhbFN0cmVhbSkgeyB0aGlzLmxvY2FsU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godCA9PiB0LnN0b3AoKSk7IHRoaXMubG9jYWxTdHJlYW0gPSBudWxsOyB9XG4gICAgaWYgKHRoaXMucmVtb3RlU3RyZWFtKSB7IHRoaXMucmVtb3RlU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godCA9PiB0LnN0b3AoKSk7IHRoaXMucmVtb3RlU3RyZWFtID0gbnVsbDsgfVxuICAgIGlmICh0aGlzLnBjKSB7IHRoaXMucGMuY2xvc2UoKTsgdGhpcy5wYyA9IG51bGw7IH1cbiAgICB0aGlzLmljZUNhbmRpZGF0ZVF1ZXVlID0gW107XG4gICAgdGhpcy5fcmVtb3RlUHVia2V5ID0gbnVsbDtcbiAgICB0aGlzLl9jYWxsU3RhcnRUaW1lID0gMDtcbiAgICBpZiAoIXNpbGVudCkgdGhpcy5zZXRTdGF0ZSgnaWRsZScpO1xuICAgIHRoaXMubm90aWZ5U3RyZWFtcygpO1xuICB9XG5cbiAgdG9nZ2xlTXV0ZSgpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMubG9jYWxTdHJlYW0pIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCB0ID0gdGhpcy5sb2NhbFN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO1xuICAgIGlmICh0KSB7IHQuZW5hYmxlZCA9ICF0LmVuYWJsZWQ7IHJldHVybiAhdC5lbmFibGVkOyB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdG9nZ2xlVmlkZW8oKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmxvY2FsU3RyZWFtKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgdCA9IHRoaXMubG9jYWxTdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVswXTtcbiAgICBpZiAodCkgeyB0LmVuYWJsZWQgPSAhdC5lbmFibGVkOyByZXR1cm4gIXQuZW5hYmxlZDsgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgd2VicnRjTWFuYWdlciA9IG5ldyBXZWJSVENNYW5hZ2VyKCk7XG4iXSwibmFtZXMiOlsibm9zdHJDbGllbnQiLCJJQ0VfQ09ORklHIiwiaWNlU2VydmVycyIsInVybHMiLCJ1c2VybmFtZSIsImNyZWRlbnRpYWwiLCJpY2VDYW5kaWRhdGVQb29sU2l6ZSIsIkxTX1NUQUxFX0NBTExfS0VZIiwiV2ViUlRDTWFuYWdlciIsImNhbGxTdGF0ZSIsIl9jYWxsU3RhdGUiLCJyZW1vdGVQdWJrZXkiLCJfcmVtb3RlUHVia2V5IiwiY2FsbFR5cGUiLCJfY2FsbFR5cGUiLCJjYWxsU3RhcnRUaW1lIiwiX2NhbGxTdGFydFRpbWUiLCJvblN0YXRlQ2hhbmdlIiwiY2IiLCJzdGF0ZUNhbGxiYWNrcyIsImFkZCIsImRlbGV0ZSIsIm9uU3RyZWFtIiwic3RyZWFtQ2FsbGJhY2tzIiwic2V0U3RhdGUiLCJzdGF0ZSIsImVycm9yIiwiRGF0ZSIsIm5vdyIsInN0b3BSaW5ndG9uZSIsImZvckVhY2giLCJub3RpZnlTdHJlYW1zIiwibG9jYWxTdHJlYW0iLCJyZW1vdGVTdHJlYW0iLCJwbGF5UmluZ3RvbmUiLCJhdWRpb0N0eCIsIkF1ZGlvQ29udGV4dCIsImF1ZGlvT3NjIiwiY3JlYXRlT3NjaWxsYXRvciIsImdhaW4iLCJjcmVhdGVHYWluIiwiY29ubmVjdCIsImRlc3RpbmF0aW9uIiwiZnJlcXVlbmN5IiwidmFsdWUiLCJzdGFydCIsImN0eCIsInB1bHNlIiwic3RvcCIsImNsb3NlIiwic2V0VmFsdWVBdFRpbWUiLCJjdXJyZW50VGltZSIsImV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUiLCJzZXRUaW1lb3V0IiwiaW5pdCIsIl91bnN1YlNpZ25hbCIsInN0YWxlQ2FsbEpTT04iLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicmVtb3ZlSXRlbSIsInN0YWxlQ2FsbCIsIkpTT04iLCJwYXJzZSIsImNhbGxlciIsInRpbWUiLCJzZW5kV2ViUlRDU2lnbmFsIiwidHlwZSIsImNhdGNoIiwiZSIsIm9uU2lnbmFsIiwiZnJvbSIsInNpZ25hbCIsImhhbmRsZVNpZ25hbCIsImRlc3Ryb3kiLCJlbmRDYWxsIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImNhbGxUaW1lb3V0IiwicmVqZWN0Q2FsbCIsImNsZWFyUmV0cnkiLCJjbGVhckNhbGxUaW1lb3V0Iiwic3RhcnRXZWJSVEMiLCJjbGVhbnVwIiwic2RwIiwiaGFuZGxlT2ZmZXIiLCJoYW5kbGVBbnN3ZXIiLCJjYW5kaWRhdGUiLCJoYW5kbGVJY2VDYW5kaWRhdGUiLCJjbGVhclRpbWVvdXQiLCJyZXRyeUludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImluaXRpYXRlQ2FsbCIsInB1YmtleSIsInByZVN0cmVhbSIsIm5hdmlnYXRvciIsIm1lZGlhRGV2aWNlcyIsImdldFVzZXJNZWRpYSIsImF1ZGlvIiwiZWNob0NhbmNlbGxhdGlvbiIsIm5vaXNlU3VwcHJlc3Npb24iLCJhdXRvR2FpbkNvbnRyb2wiLCJ2aWRlbyIsIndpZHRoIiwiaWRlYWwiLCJoZWlnaHQiLCJmYWNpbmdNb2RlIiwiZXJyIiwibWVkaWFFcnJvck1zZyIsInNlbmRSZXEiLCJzZXRJbnRlcnZhbCIsImFjY2VwdENhbGwiLCJET01FeGNlcHRpb24iLCJuYW1lIiwibWVzc2FnZSIsImlzSW5pdGlhdG9yIiwicGMiLCJSVENQZWVyQ29ubmVjdGlvbiIsImdldFRyYWNrcyIsInRyYWNrIiwiYWRkVHJhY2siLCJNZWRpYVN0cmVhbSIsIm9udHJhY2siLCJldmVudCIsInN0cmVhbXMiLCJvbmljZWNhbmRpZGF0ZSIsInRvSlNPTiIsIm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlIiwicyIsImljZUNvbm5lY3Rpb25TdGF0ZSIsInJlc3RhcnRJY2UiLCJvZmZlciIsImNyZWF0ZU9mZmVyIiwib2ZmZXJUb1JlY2VpdmVBdWRpbyIsIm9mZmVyVG9SZWNlaXZlVmlkZW8iLCJzZXRMb2NhbERlc2NyaXB0aW9uIiwiYyIsImljZUNhbmRpZGF0ZVF1ZXVlIiwiYWRkSWNlQ2FuZGlkYXRlIiwiUlRDSWNlQ2FuZGlkYXRlIiwic2V0UmVtb3RlRGVzY3JpcHRpb24iLCJSVENTZXNzaW9uRGVzY3JpcHRpb24iLCJhbnN3ZXIiLCJjcmVhdGVBbnN3ZXIiLCJjb25zb2xlIiwicmVtb3RlRGVzY3JpcHRpb24iLCJwdXNoIiwic2lsZW50IiwidCIsInRvZ2dsZU11dGUiLCJnZXRBdWRpb1RyYWNrcyIsImVuYWJsZWQiLCJ0b2dnbGVWaWRlbyIsImdldFZpZGVvVHJhY2tzIiwiU2V0Iiwid2VicnRjTWFuYWdlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/webrtc.ts\n"));

/***/ })

});