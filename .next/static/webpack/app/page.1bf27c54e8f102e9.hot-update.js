"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic-off.js":
/*!*************************************************************!*\
  !*** ./node_modules/lucide-react/dist/esm/icons/mic-off.js ***!
  \*************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ MicOff; }\n/* harmony export */ });\n/* harmony import */ var _createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../createLucideIcon.js */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/createLucideIcon.js\");\n/**\n * @license lucide-react v0.395.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */ \nconst MicOff = (0,_createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"MicOff\", [\n    [\n        \"line\",\n        {\n            x1: \"2\",\n            x2: \"22\",\n            y1: \"2\",\n            y2: \"22\",\n            key: \"a6p6uj\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2\",\n            key: \"80xlxr\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M5 10v2a7 7 0 0 0 12 5\",\n            key: \"p2k8kg\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M15 9.34V5a3 3 0 0 0-5.68-1.33\",\n            key: \"1gzdoj\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M9 9v3a3 3 0 0 0 5.12 2.12\",\n            key: \"r2i35w\"\n        }\n    ],\n    [\n        \"line\",\n        {\n            x1: \"12\",\n            x2: \"12\",\n            y1: \"19\",\n            y2: \"22\",\n            key: \"x3vr5v\"\n        }\n    ]\n]);\n //# sourceMappingURL=mic-off.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sdWNpZGUtcmVhY3QvZGlzdC9lc20vaWNvbnMvbWljLW9mZi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWFNLE1BQUFBLFNBQVNDLGdFQUFnQkEsQ0FBQyxVQUFVO0lBQ3hDO1FBQUM7UUFBUTtZQUFFQyxJQUFJO1lBQUtDLElBQUk7WUFBTUMsSUFBSTtZQUFLQyxJQUFJO1lBQU1DLEtBQUs7UUFBQTtLQUFVO0lBQ2hFO1FBQUM7UUFBUTtZQUFFQyxHQUFHO1lBQXlDRCxLQUFLO1FBQUE7S0FBVTtJQUN0RTtRQUFDO1FBQVE7WUFBRUMsR0FBRztZQUEwQkQsS0FBSztRQUFBO0tBQVU7SUFDdkQ7UUFBQztRQUFRO1lBQUVDLEdBQUc7WUFBa0NELEtBQUs7UUFBQTtLQUFVO0lBQy9EO1FBQUM7UUFBUTtZQUFFQyxHQUFHO1lBQThCRCxLQUFLO1FBQUE7S0FBVTtJQUMzRDtRQUFDO1FBQVE7WUFBRUosSUFBSTtZQUFNQyxJQUFJO1lBQU1DLElBQUk7WUFBTUMsSUFBSTtZQUFNQyxLQUFLO1FBQUE7S0FBVTtDQUNuRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vLi4vc3JjL2ljb25zL21pYy1vZmYudHM/ODA3MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3JlYXRlTHVjaWRlSWNvbiBmcm9tICcuLi9jcmVhdGVMdWNpZGVJY29uJztcblxuLyoqXG4gKiBAY29tcG9uZW50IEBuYW1lIE1pY09mZlxuICogQGRlc2NyaXB0aW9uIEx1Y2lkZSBTVkcgaWNvbiBjb21wb25lbnQsIHJlbmRlcnMgU1ZHIEVsZW1lbnQgd2l0aCBjaGlsZHJlbi5cbiAqXG4gKiBAcHJldmlldyAhW2ltZ10oZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlBZ2VHMXNibk05SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSWdvZ0lIZHBaSFJvUFNJeU5DSUtJQ0JvWldsbmFIUTlJakkwSWdvZ0lIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSUtJQ0JtYVd4c1BTSnViMjVsSWdvZ0lITjBjbTlyWlQwaUl6QXdNQ0lnYzNSNWJHVTlJbUpoWTJ0bmNtOTFibVF0WTI5c2IzSTZJQ05tWm1ZN0lHSnZjbVJsY2kxeVlXUnBkWE02SURKd2VDSUtJQ0J6ZEhKdmEyVXRkMmxrZEdnOUlqSWlDaUFnYzNSeWIydGxMV3hwYm1WallYQTlJbkp2ZFc1a0lnb2dJSE4wY205clpTMXNhVzVsYW05cGJqMGljbTkxYm1RaUNqNEtJQ0E4YkdsdVpTQjRNVDBpTWlJZ2VESTlJakl5SWlCNU1UMGlNaUlnZVRJOUlqSXlJaUF2UGdvZ0lEeHdZWFJvSUdROUlrMHhPQzQ0T1NBeE15NHlNMEUzTGpFeUlEY3VNVElnTUNBd0lEQWdNVGtnTVRKMkxUSWlJQzgrQ2lBZ1BIQmhkR2dnWkQwaVRUVWdNVEIyTW1FM0lEY2dNQ0F3SURBZ01USWdOU0lnTHo0S0lDQThjR0YwYUNCa1BTSk5NVFVnT1M0ek5GWTFZVE1nTXlBd0lEQWdNQzAxTGpZNExURXVNek1pSUM4K0NpQWdQSEJoZEdnZ1pEMGlUVGtnT1hZellUTWdNeUF3SURBZ01DQTFMakV5SURJdU1USWlJQzgrQ2lBZ1BHeHBibVVnZURFOUlqRXlJaUI0TWowaU1USWlJSGt4UFNJeE9TSWdlVEk5SWpJeUlpQXZQZ284TDNOMlp6NEspIC0gaHR0cHM6Ly9sdWNpZGUuZGV2L2ljb25zL21pYy1vZmZcbiAqIEBzZWUgaHR0cHM6Ly9sdWNpZGUuZGV2L2d1aWRlL3BhY2thZ2VzL2x1Y2lkZS1yZWFjdCAtIERvY3VtZW50YXRpb25cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgLSBMdWNpZGUgaWNvbnMgcHJvcHMgYW5kIGFueSB2YWxpZCBTVkcgYXR0cmlidXRlXG4gKiBAcmV0dXJucyB7SlNYLkVsZW1lbnR9IEpTWCBFbGVtZW50XG4gKlxuICovXG5jb25zdCBNaWNPZmYgPSBjcmVhdGVMdWNpZGVJY29uKCdNaWNPZmYnLCBbXG4gIFsnbGluZScsIHsgeDE6ICcyJywgeDI6ICcyMicsIHkxOiAnMicsIHkyOiAnMjInLCBrZXk6ICdhNnA2dWonIH1dLFxuICBbJ3BhdGgnLCB7IGQ6ICdNMTguODkgMTMuMjNBNy4xMiA3LjEyIDAgMCAwIDE5IDEydi0yJywga2V5OiAnODB4bHhyJyB9XSxcbiAgWydwYXRoJywgeyBkOiAnTTUgMTB2MmE3IDcgMCAwIDAgMTIgNScsIGtleTogJ3AyazhrZycgfV0sXG4gIFsncGF0aCcsIHsgZDogJ00xNSA5LjM0VjVhMyAzIDAgMCAwLTUuNjgtMS4zMycsIGtleTogJzFnemRvaicgfV0sXG4gIFsncGF0aCcsIHsgZDogJ005IDl2M2EzIDMgMCAwIDAgNS4xMiAyLjEyJywga2V5OiAncjJpMzV3JyB9XSxcbiAgWydsaW5lJywgeyB4MTogJzEyJywgeDI6ICcxMicsIHkxOiAnMTknLCB5MjogJzIyJywga2V5OiAneDN2cjV2JyB9XSxcbl0pO1xuXG5leHBvcnQgZGVmYXVsdCBNaWNPZmY7XG4iXSwibmFtZXMiOlsiTWljT2ZmIiwiY3JlYXRlTHVjaWRlSWNvbiIsIngxIiwieDIiLCJ5MSIsInkyIiwia2V5IiwiZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic-off.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic.js":
/*!*********************************************************!*\
  !*** ./node_modules/lucide-react/dist/esm/icons/mic.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Mic; }\n/* harmony export */ });\n/* harmony import */ var _createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../createLucideIcon.js */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/createLucideIcon.js\");\n/**\n * @license lucide-react v0.395.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */ \nconst Mic = (0,_createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"Mic\", [\n    [\n        \"path\",\n        {\n            d: \"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\",\n            key: \"131961\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M19 10v2a7 7 0 0 1-14 0v-2\",\n            key: \"1vc78b\"\n        }\n    ],\n    [\n        \"line\",\n        {\n            x1: \"12\",\n            x2: \"12\",\n            y1: \"19\",\n            y2: \"22\",\n            key: \"x3vr5v\"\n        }\n    ]\n]);\n //# sourceMappingURL=mic.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sdWNpZGUtcmVhY3QvZGlzdC9lc20vaWNvbnMvbWljLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBYU0sTUFBQUEsTUFBTUMsZ0VBQWdCQSxDQUFDLE9BQU87SUFDbEM7UUFBQztRQUFRO1lBQUVDLEdBQUc7WUFBd0RDLEtBQUs7UUFBQTtLQUFVO0lBQ3JGO1FBQUM7UUFBUTtZQUFFRCxHQUFHO1lBQThCQyxLQUFLO1FBQUE7S0FBVTtJQUMzRDtRQUFDO1FBQVE7WUFBRUMsSUFBSTtZQUFNQyxJQUFJO1lBQU1DLElBQUk7WUFBTUMsSUFBSTtZQUFNSixLQUFLO1FBQUE7S0FBVTtDQUNuRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vLi4vc3JjL2ljb25zL21pYy50cz8xMGJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVMdWNpZGVJY29uIGZyb20gJy4uL2NyZWF0ZUx1Y2lkZUljb24nO1xuXG4vKipcbiAqIEBjb21wb25lbnQgQG5hbWUgTWljXG4gKiBAZGVzY3JpcHRpb24gTHVjaWRlIFNWRyBpY29uIGNvbXBvbmVudCwgcmVuZGVycyBTVkcgRWxlbWVudCB3aXRoIGNoaWxkcmVuLlxuICpcbiAqIEBwcmV2aWV3ICFbaW1nXShkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUFnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JZ29nSUhkcFpIUm9QU0l5TkNJS0lDQm9aV2xuYUhROUlqSTBJZ29nSUhacFpYZENiM2c5SWpBZ01DQXlOQ0F5TkNJS0lDQm1hV3hzUFNKdWIyNWxJZ29nSUhOMGNtOXJaVDBpSXpBd01DSWdjM1I1YkdVOUltSmhZMnRuY205MWJtUXRZMjlzYjNJNklDTm1abVk3SUdKdmNtUmxjaTF5WVdScGRYTTZJREp3ZUNJS0lDQnpkSEp2YTJVdGQybGtkR2c5SWpJaUNpQWdjM1J5YjJ0bExXeHBibVZqWVhBOUluSnZkVzVrSWdvZ0lITjBjbTlyWlMxc2FXNWxhbTlwYmowaWNtOTFibVFpQ2o0S0lDQThjR0YwYUNCa1BTSk5NVElnTW1FeklETWdNQ0F3SURBdE15QXpkamRoTXlBeklEQWdNQ0F3SURZZ01GWTFZVE1nTXlBd0lEQWdNQzB6TFROYUlpQXZQZ29nSUR4d1lYUm9JR1E5SWsweE9TQXhNSFl5WVRjZ055QXdJREFnTVMweE5DQXdkaTB5SWlBdlBnb2dJRHhzYVc1bElIZ3hQU0l4TWlJZ2VESTlJakV5SWlCNU1UMGlNVGtpSUhreVBTSXlNaUlnTHo0S1BDOXpkbWMrQ2c9PSkgLSBodHRwczovL2x1Y2lkZS5kZXYvaWNvbnMvbWljXG4gKiBAc2VlIGh0dHBzOi8vbHVjaWRlLmRldi9ndWlkZS9wYWNrYWdlcy9sdWNpZGUtcmVhY3QgLSBEb2N1bWVudGF0aW9uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzIC0gTHVjaWRlIGljb25zIHByb3BzIGFuZCBhbnkgdmFsaWQgU1ZHIGF0dHJpYnV0ZVxuICogQHJldHVybnMge0pTWC5FbGVtZW50fSBKU1ggRWxlbWVudFxuICpcbiAqL1xuY29uc3QgTWljID0gY3JlYXRlTHVjaWRlSWNvbignTWljJywgW1xuICBbJ3BhdGgnLCB7IGQ6ICdNMTIgMmEzIDMgMCAwIDAtMyAzdjdhMyAzIDAgMCAwIDYgMFY1YTMgMyAwIDAgMC0zLTNaJywga2V5OiAnMTMxOTYxJyB9XSxcbiAgWydwYXRoJywgeyBkOiAnTTE5IDEwdjJhNyA3IDAgMCAxLTE0IDB2LTInLCBrZXk6ICcxdmM3OGInIH1dLFxuICBbJ2xpbmUnLCB7IHgxOiAnMTInLCB4MjogJzEyJywgeTE6ICcxOScsIHkyOiAnMjInLCBrZXk6ICd4M3ZyNXYnIH1dLFxuXSk7XG5cbmV4cG9ydCBkZWZhdWx0IE1pYztcbiJdLCJuYW1lcyI6WyJNaWMiLCJjcmVhdGVMdWNpZGVJY29uIiwiZCIsImtleSIsIngxIiwieDIiLCJ5MSIsInkyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/phone-off.js":
/*!***************************************************************!*\
  !*** ./node_modules/lucide-react/dist/esm/icons/phone-off.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ PhoneOff; }\n/* harmony export */ });\n/* harmony import */ var _createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../createLucideIcon.js */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/createLucideIcon.js\");\n/**\n * @license lucide-react v0.395.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */ \nconst PhoneOff = (0,_createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"PhoneOff\", [\n    [\n        \"path\",\n        {\n            d: \"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91\",\n            key: \"z86iuo\"\n        }\n    ],\n    [\n        \"line\",\n        {\n            x1: \"22\",\n            x2: \"2\",\n            y1: \"2\",\n            y2: \"22\",\n            key: \"11kh81\"\n        }\n    ]\n]);\n //# sourceMappingURL=phone-off.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sdWNpZGUtcmVhY3QvZGlzdC9lc20vaWNvbnMvcGhvbmUtb2ZmLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBYU0sTUFBQUEsV0FBV0MsZ0VBQWdCQSxDQUFDLFlBQVk7SUFDNUM7UUFDRTtRQUNBO1lBQ0VDLEdBQUc7WUFDSEMsS0FBSztRQUNQO0tBQ0Y7SUFDQTtRQUFDO1FBQVE7WUFBRUMsSUFBSTtZQUFNQyxJQUFJO1lBQUtDLElBQUk7WUFBS0MsSUFBSTtZQUFNSixLQUFLO1FBQUE7S0FBVTtDQUNqRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vLi4vc3JjL2ljb25zL3Bob25lLW9mZi50cz9hZDEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVMdWNpZGVJY29uIGZyb20gJy4uL2NyZWF0ZUx1Y2lkZUljb24nO1xuXG4vKipcbiAqIEBjb21wb25lbnQgQG5hbWUgUGhvbmVPZmZcbiAqIEBkZXNjcmlwdGlvbiBMdWNpZGUgU1ZHIGljb24gY29tcG9uZW50LCByZW5kZXJzIFNWRyBFbGVtZW50IHdpdGggY2hpbGRyZW4uXG4gKlxuICogQHByZXZpZXcgIVtpbWddKGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklnb2dJSGRwWkhSb1BTSXlOQ0lLSUNCb1pXbG5hSFE5SWpJMElnb2dJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lLSUNCbWFXeHNQU0p1YjI1bElnb2dJSE4wY205clpUMGlJekF3TUNJZ2MzUjViR1U5SW1KaFkydG5jbTkxYm1RdFkyOXNiM0k2SUNObVptWTdJR0p2Y21SbGNpMXlZV1JwZFhNNklESndlQ0lLSUNCemRISnZhMlV0ZDJsa2RHZzlJaklpQ2lBZ2MzUnliMnRsTFd4cGJtVmpZWEE5SW5KdmRXNWtJZ29nSUhOMGNtOXJaUzFzYVc1bGFtOXBiajBpY205MWJtUWlDajRLSUNBOGNHRjBhQ0JrUFNKTk1UQXVOamdnTVRNdU16RmhNVFlnTVRZZ01DQXdJREFnTXk0ME1TQXlMalpzTVM0eU55MHhMakkzWVRJZ01pQXdJREFnTVNBeUxqRXhMUzQwTlNBeE1pNDROQ0F4TWk0NE5DQXdJREFnTUNBeUxqZ3hMamNnTWlBeUlEQWdNQ0F4SURFdU56SWdNbll6WVRJZ01pQXdJREFnTVMweUxqRTRJRElnTVRrdU56a2dNVGt1TnprZ01DQXdJREV0T0M0Mk15MHpMakEzSURFNUxqUXlJREU1TGpReUlEQWdNQ0F4TFRNdU16TXRNaTQyTjIwdE1pNDJOeTB6TGpNMFlURTVMamM1SURFNUxqYzVJREFnTUNBeExUTXVNRGN0T0M0Mk0wRXlJRElnTUNBd0lERWdOQzR4TVNBeWFETmhNaUF5SURBZ01DQXhJRElnTVM0M01pQXhNaTQ0TkNBeE1pNDROQ0F3SURBZ01DQXVOeUF5TGpneElESWdNaUF3SURBZ01TMHVORFVnTWk0eE1VdzRMakE1SURrdU9URWlJQzgrQ2lBZ1BHeHBibVVnZURFOUlqSXlJaUI0TWowaU1pSWdlVEU5SWpJaUlIa3lQU0l5TWlJZ0x6NEtQQzl6ZG1jK0NnPT0pIC0gaHR0cHM6Ly9sdWNpZGUuZGV2L2ljb25zL3Bob25lLW9mZlxuICogQHNlZSBodHRwczovL2x1Y2lkZS5kZXYvZ3VpZGUvcGFja2FnZXMvbHVjaWRlLXJlYWN0IC0gRG9jdW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyAtIEx1Y2lkZSBpY29ucyBwcm9wcyBhbmQgYW55IHZhbGlkIFNWRyBhdHRyaWJ1dGVcbiAqIEByZXR1cm5zIHtKU1guRWxlbWVudH0gSlNYIEVsZW1lbnRcbiAqXG4gKi9cbmNvbnN0IFBob25lT2ZmID0gY3JlYXRlTHVjaWRlSWNvbignUGhvbmVPZmYnLCBbXG4gIFtcbiAgICAncGF0aCcsXG4gICAge1xuICAgICAgZDogJ00xMC42OCAxMy4zMWExNiAxNiAwIDAgMCAzLjQxIDIuNmwxLjI3LTEuMjdhMiAyIDAgMCAxIDIuMTEtLjQ1IDEyLjg0IDEyLjg0IDAgMCAwIDIuODEuNyAyIDIgMCAwIDEgMS43MiAydjNhMiAyIDAgMCAxLTIuMTggMiAxOS43OSAxOS43OSAwIDAgMS04LjYzLTMuMDcgMTkuNDIgMTkuNDIgMCAwIDEtMy4zMy0yLjY3bS0yLjY3LTMuMzRhMTkuNzkgMTkuNzkgMCAwIDEtMy4wNy04LjYzQTIgMiAwIDAgMSA0LjExIDJoM2EyIDIgMCAwIDEgMiAxLjcyIDEyLjg0IDEyLjg0IDAgMCAwIC43IDIuODEgMiAyIDAgMCAxLS40NSAyLjExTDguMDkgOS45MScsXG4gICAgICBrZXk6ICd6ODZpdW8nLFxuICAgIH0sXG4gIF0sXG4gIFsnbGluZScsIHsgeDE6ICcyMicsIHgyOiAnMicsIHkxOiAnMicsIHkyOiAnMjInLCBrZXk6ICcxMWtoODEnIH1dLFxuXSk7XG5cbmV4cG9ydCBkZWZhdWx0IFBob25lT2ZmO1xuIl0sIm5hbWVzIjpbIlBob25lT2ZmIiwiY3JlYXRlTHVjaWRlSWNvbiIsImQiLCJrZXkiLCJ4MSIsIngyIiwieTEiLCJ5MiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/phone-off.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/video-off.js":
/*!***************************************************************!*\
  !*** ./node_modules/lucide-react/dist/esm/icons/video-off.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ VideoOff; }\n/* harmony export */ });\n/* harmony import */ var _createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../createLucideIcon.js */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/createLucideIcon.js\");\n/**\n * @license lucide-react v0.395.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */ \nconst VideoOff = (0,_createLucideIcon_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"VideoOff\", [\n    [\n        \"path\",\n        {\n            d: \"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196\",\n            key: \"w8jjjt\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2\",\n            key: \"1xawa7\"\n        }\n    ],\n    [\n        \"path\",\n        {\n            d: \"m2 2 20 20\",\n            key: \"1ooewy\"\n        }\n    ]\n]);\n //# sourceMappingURL=video-off.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sdWNpZGUtcmVhY3QvZGlzdC9lc20vaWNvbnMvdmlkZW8tb2ZmLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBYU0sTUFBQUEsV0FBV0MsZ0VBQWdCQSxDQUFDLFlBQVk7SUFDNUM7UUFDRTtRQUNBO1lBQUVDLEdBQUc7WUFBc0VDLEtBQUs7UUFBUztLQUMzRjtJQUNBO1FBQUM7UUFBUTtZQUFFRCxHQUFHO1lBQTBEQyxLQUFLO1FBQUE7S0FBVTtJQUN2RjtRQUFDO1FBQVE7WUFBRUQsR0FBRztZQUFjQyxLQUFLO1FBQUE7S0FBVTtDQUM1QyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vLi4vc3JjL2ljb25zL3ZpZGVvLW9mZi50cz9kZDQxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVMdWNpZGVJY29uIGZyb20gJy4uL2NyZWF0ZUx1Y2lkZUljb24nO1xuXG4vKipcbiAqIEBjb21wb25lbnQgQG5hbWUgVmlkZW9PZmZcbiAqIEBkZXNjcmlwdGlvbiBMdWNpZGUgU1ZHIGljb24gY29tcG9uZW50LCByZW5kZXJzIFNWRyBFbGVtZW50IHdpdGggY2hpbGRyZW4uXG4gKlxuICogQHByZXZpZXcgIVtpbWddKGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklnb2dJSGRwWkhSb1BTSXlOQ0lLSUNCb1pXbG5hSFE5SWpJMElnb2dJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lLSUNCbWFXeHNQU0p1YjI1bElnb2dJSE4wY205clpUMGlJekF3TUNJZ2MzUjViR1U5SW1KaFkydG5jbTkxYm1RdFkyOXNiM0k2SUNObVptWTdJR0p2Y21SbGNpMXlZV1JwZFhNNklESndlQ0lLSUNCemRISnZhMlV0ZDJsa2RHZzlJaklpQ2lBZ2MzUnliMnRsTFd4cGJtVmpZWEE5SW5KdmRXNWtJZ29nSUhOMGNtOXJaUzFzYVc1bGFtOXBiajBpY205MWJtUWlDajRLSUNBOGNHRjBhQ0JrUFNKTk1UQXVOallnTmtneE5HRXlJRElnTUNBd0lERWdNaUF5ZGpJdU5XdzFMakkwT0MwekxqQTJNa0V1TlM0MUlEQWdNQ0F4SURJeUlEY3VPRGQyT0M0eE9UWWlJQzgrQ2lBZ1BIQmhkR2dnWkQwaVRURTJJREUyWVRJZ01pQXdJREFnTVMweUlESklOR0V5SURJZ01DQXdJREV0TWkweVZqaGhNaUF5SURBZ01DQXhJREl0TW1neUlpQXZQZ29nSUR4d1lYUm9JR1E5SW0weUlESWdNakFnTWpBaUlDOCtDand2YzNablBnbz0pIC0gaHR0cHM6Ly9sdWNpZGUuZGV2L2ljb25zL3ZpZGVvLW9mZlxuICogQHNlZSBodHRwczovL2x1Y2lkZS5kZXYvZ3VpZGUvcGFja2FnZXMvbHVjaWRlLXJlYWN0IC0gRG9jdW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyAtIEx1Y2lkZSBpY29ucyBwcm9wcyBhbmQgYW55IHZhbGlkIFNWRyBhdHRyaWJ1dGVcbiAqIEByZXR1cm5zIHtKU1guRWxlbWVudH0gSlNYIEVsZW1lbnRcbiAqXG4gKi9cbmNvbnN0IFZpZGVvT2ZmID0gY3JlYXRlTHVjaWRlSWNvbignVmlkZW9PZmYnLCBbXG4gIFtcbiAgICAncGF0aCcsXG4gICAgeyBkOiAnTTEwLjY2IDZIMTRhMiAyIDAgMCAxIDIgMnYyLjVsNS4yNDgtMy4wNjJBLjUuNSAwIDAgMSAyMiA3Ljg3djguMTk2Jywga2V5OiAndzhqamp0JyB9LFxuICBdLFxuICBbJ3BhdGgnLCB7IGQ6ICdNMTYgMTZhMiAyIDAgMCAxLTIgMkg0YTIgMiAwIDAgMS0yLTJWOGEyIDIgMCAwIDEgMi0yaDInLCBrZXk6ICcxeGF3YTcnIH1dLFxuICBbJ3BhdGgnLCB7IGQ6ICdtMiAyIDIwIDIwJywga2V5OiAnMW9vZXd5JyB9XSxcbl0pO1xuXG5leHBvcnQgZGVmYXVsdCBWaWRlb09mZjtcbiJdLCJuYW1lcyI6WyJWaWRlb09mZiIsImNyZWF0ZUx1Y2lkZUljb24iLCJkIiwia2V5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/video-off.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/components/ChatView.tsx":
/*!*************************************!*\
  !*** ./src/components/ChatView.tsx ***!
  \*************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ ChatView; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var framer_motion__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! framer-motion */ \"(app-pages-browser)/./node_modules/framer-motion/dist/es/components/AnimatePresence/index.mjs\");\n/* harmony import */ var framer_motion__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! framer-motion */ \"(app-pages-browser)/./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/arrow-left.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/menu.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/hash.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/search.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/x.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/check.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/copy.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/download.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/reply.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/loader-circle.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/image.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/paperclip.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowLeft,Check,Copy,Download,Hash,Image,Loader2,Menu,Paperclip,Reply,Search,Send,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/send.js\");\n/* harmony import */ var next_image__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/image */ \"(app-pages-browser)/./node_modules/next/dist/api/image.js\");\n/* harmony import */ var _lib_nostr__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/nostr */ \"(app-pages-browser)/./src/lib/nostr.ts\");\n/* harmony import */ var _lib_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../lib/store */ \"(app-pages-browser)/./src/lib/store.ts\");\n/* harmony import */ var _lib_chunkStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../lib/chunkStore */ \"(app-pages-browser)/./src/lib/chunkStore.ts\");\n/* harmony import */ var _lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../lib/fileUtils */ \"(app-pages-browser)/./src/lib/fileUtils.ts\");\n/* harmony import */ var _Avatar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Avatar */ \"(app-pages-browser)/./src/components/Avatar.tsx\");\n/* harmony import */ var _VideoCall__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./VideoCall */ \"(app-pages-browser)/./src/components/VideoCall.tsx\");\n\nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\n\n\n\nfunction Highlight(param) {\n    let { text, highlight } = param;\n    if (!highlight.trim()) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n            children: text\n        }, void 0, false, {\n            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n            lineNumber: 37,\n            columnNumber: 12\n        }, this);\n    }\n    const regex = new RegExp(\"(\".concat(highlight, \")\"), \"gi\");\n    const parts = text.split(regex);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n        children: parts.map((part, i)=>regex.test(part) ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"mark\", {\n                className: \"bg-yellow-300 text-black rounded-sm\",\n                children: part\n            }, i, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 46,\n                columnNumber: 11\n            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                children: part\n            }, i, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 50,\n                columnNumber: 11\n            }, this))\n    }, void 0, false, {\n        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n        lineNumber: 43,\n        columnNumber: 5\n    }, this);\n}\n_c = Highlight;\nfunction ChatView() {\n    _s();\n    const { activeChat, contacts, channels } = (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.useAppState)();\n    const isChannel = !!activeChat && activeChat.startsWith(\"channel:\");\n    const channelId = isChannel ? activeChat.slice(\"channel:\".length) : \"\";\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [sending, setSending] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [pendingAttachment, setPendingAttachment] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [sendProgress, setSendProgress] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [replyTo, setReplyTo] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [previewImage, setPreviewImage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [copied, setCopied] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [searchQuery, setSearchQuery] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isSearchVisible, setIsSearchVisible] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const imageInputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const fileInputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const searchInputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const contact = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>contacts.find((c)=>c.pubkey === activeChat), [\n        contacts,\n        activeChat\n    ]);\n    const channel = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>channels.find((c)=>c.id === channelId), [\n        channels,\n        channelId\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (isSearchVisible) {\n            var _searchInputRef_current;\n            (_searchInputRef_current = searchInputRef.current) === null || _searchInputRef_current === void 0 ? void 0 : _searchInputRef_current.focus();\n        }\n    }, [\n        isSearchVisible\n    ]);\n    const filteredMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{\n        if (!searchQuery.trim()) return messages;\n        return messages.filter((msg)=>{\n            var _msg_content;\n            return (_msg_content = msg.content) === null || _msg_content === void 0 ? void 0 : _msg_content.toLowerCase().includes(searchQuery.toLowerCase());\n        });\n    }, [\n        messages,\n        searchQuery\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!activeChat) return;\n        if (isChannel) {\n            setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getChannelMessages)(channelId));\n        } else {\n            setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getMessages)(activeChat));\n            _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.requestProfile(activeChat);\n        }\n        setPendingAttachment(null);\n        setSendProgress(null);\n        setReplyTo(null);\n        setError(\"\");\n    }, [\n        activeChat,\n        isChannel,\n        channelId\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const unsubMsg = _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.onMessage((msg)=>{\n            (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.addMessage)(msg);\n            if (!activeChat || isChannel) return;\n            setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getMessages)(activeChat));\n        });\n        const unsubChannel = _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.onChannelMessage((msg)=>{\n            (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.addChannelMessage)(msg);\n            if (!channelId || !isChannel || msg.channelId !== channelId) return;\n            setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getChannelMessages)(channelId));\n        });\n        return ()=>{\n            unsubMsg();\n            unsubChannel();\n        };\n    }, [\n        activeChat,\n        isChannel,\n        channelId\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const unsub = _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.onProfile((pubkey, profile)=>{\n            (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.updateContactProfile)(pubkey, profile.name, profile.picture, profile.about);\n        });\n        return unsub;\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!activeChat) return;\n        setMessages(isChannel ? (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getChannelMessages)(channelId) : (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getMessages)(activeChat));\n    }, [\n        activeChat,\n        contacts,\n        channels,\n        isChannel,\n        channelId\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        var _messagesEndRef_current;\n        if (searchQuery) return;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    }, [\n        messages,\n        searchQuery\n    ]);\n    const handleSend = async ()=>{\n        if (!input.trim() && !pendingAttachment || !activeChat || sending) return;\n        const text = input.trim();\n        setInput(\"\");\n        setSending(true);\n        setError(\"\");\n        setSendProgress(null);\n        try {\n            if (isChannel) {\n                if (pendingAttachment) throw new Error(\"Attachments are not supported in public channels.\");\n                const msg = await _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.sendChannelMessage(channelId, text, replyTo || undefined);\n                (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.addChannelMessage)(msg);\n                setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getChannelMessages)(channelId));\n            } else if (pendingAttachment) {\n                const msg = await _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.sendAttachment(activeChat, pendingAttachment, text, (sent, total)=>setSendProgress({\n                        sent,\n                        total\n                    }), replyTo || undefined);\n                (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.addMessage)(msg);\n                setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getMessages)(activeChat));\n                setPendingAttachment(null);\n            } else {\n                const msg = await _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.sendDirectMessage(activeChat, text, replyTo || undefined);\n                (0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.addMessage)(msg);\n                setMessages((0,_lib_store__WEBPACK_IMPORTED_MODULE_4__.getMessages)(activeChat));\n            }\n            setReplyTo(null);\n            setSendProgress(null);\n        } catch (err) {\n            setError(err.message || \"Failed to send\");\n        } finally{\n            setSending(false);\n        }\n    };\n    const handleFileSelect = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (e)=>{\n        var _e_target_files;\n        const file = (_e_target_files = e.target.files) === null || _e_target_files === void 0 ? void 0 : _e_target_files[0];\n        if (!file) return;\n        e.target.value = \"\";\n        setError(\"\");\n        try {\n            const attachment = await (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.processFile)(file);\n            if (attachment) setPendingAttachment(attachment);\n        } catch (err) {\n            setError(err.message);\n        }\n    }, []);\n    const handleCopy = async (text, id)=>{\n        await navigator.clipboard.writeText(text);\n        setCopied(id);\n        setTimeout(()=>setCopied(\"\"), 1400);\n    };\n    const handleDownload = async (msg)=>{\n        if (!msg.attachment) return;\n        if (msg.attachment.chunked && msg.attachment.transferId) {\n            await (0,_lib_chunkStore__WEBPACK_IMPORTED_MODULE_5__.downloadChunkedTransfer)(msg.attachment.transferId, msg.attachment.name, msg.attachment.mimeType);\n            return;\n        }\n        (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.downloadAttachment)(msg.attachment);\n    };\n    if (!activeChat) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"flex-1 flex items-center justify-center bg-bg\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"text-center px-4\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                        className: \"text-2xl font-bold text-text mb-2\",\n                        style: {\n                            fontFamily: \"Space Grotesk\"\n                        },\n                        children: \"Anonymous Decentralized Messenger\"\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 213,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-text-secondary text-sm\",\n                        children: \"Choose contact or channel to start.\"\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 214,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 212,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n            lineNumber: 211,\n            columnNumber: 7\n        }, this);\n    }\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex-1 flex flex-col bg-bg h-full\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"px-4 py-3 border-b border-border bg-bg-secondary/50 backdrop-blur-sm flex items-center gap-3\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: _lib_store__WEBPACK_IMPORTED_MODULE_4__.goBackToSidebar,\n                        className: \"p-2 rounded-lg hover:bg-bg-hover text-text-secondary md:hidden\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {\n                            className: \"w-5 h-5\"\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 224,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 223,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: _lib_store__WEBPACK_IMPORTED_MODULE_4__.toggleSidebar,\n                        className: \"p-2 rounded-lg hover:bg-bg-hover text-text-secondary hidden lg:block\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {\n                            className: \"w-5 h-5\"\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 227,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 226,\n                        columnNumber: 9\n                    }, this),\n                    isChannel ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"w-8 h-8 rounded-full bg-cyan/15 border border-cyan/25 flex items-center justify-center\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n                            className: \"w-4 h-4 text-cyan\"\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 232,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 231,\n                        columnNumber: 11\n                    }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_Avatar__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n                        pubkey: activeChat,\n                        name: contact === null || contact === void 0 ? void 0 : contact.name,\n                        picture: contact === null || contact === void 0 ? void 0 : contact.picture,\n                        size: \"sm\",\n                        showBorder: true\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 235,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex-1 min-w-0\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                            initial: false,\n                            mode: \"wait\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                                initial: {\n                                    opacity: 0,\n                                    y: -10\n                                },\n                                animate: {\n                                    opacity: 1,\n                                    y: 0\n                                },\n                                exit: {\n                                    opacity: 0,\n                                    y: 10\n                                },\n                                transition: {\n                                    duration: 0.2\n                                },\n                                className: \"w-full\",\n                                children: isSearchVisible ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"relative w-full\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_14__[\"default\"], {\n                                            className: \"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 250,\n                                            columnNumber: 19\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                            ref: searchInputRef,\n                                            type: \"text\",\n                                            value: searchQuery,\n                                            onChange: (e)=>setSearchQuery(e.target.value),\n                                            placeholder: \"Search in chat...\",\n                                            className: \"w-full bg-bg-tertiary border border-border rounded-lg pl-8 pr-8 py-1 text-sm text-text placeholder:text-text-muted focus:outline-none focus:border-accent/50\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 251,\n                                            columnNumber: 19\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                            onClick: ()=>{\n                                                setIsSearchVisible(false);\n                                                setSearchQuery(\"\");\n                                            },\n                                            className: \"absolute right-2 top-1/2 -translate-y-1/2 p-0.5 text-text-muted hover:text-text\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {\n                                                className: \"w-4 h-4\"\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 260,\n                                                columnNumber: 21\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 259,\n                                            columnNumber: 19\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 249,\n                                    columnNumber: 17\n                                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"text-sm font-medium text-text truncate\",\n                                            children: isChannel ? \"# \".concat((channel === null || channel === void 0 ? void 0 : channel.name) || _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.shortenKey(channelId)) : (contact === null || contact === void 0 ? void 0 : contact.name) || _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.shortenKey(activeChat)\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 265,\n                                            columnNumber: 19\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"text-[10px] text-text-muted\",\n                                            children: isChannel ? \"Public channel over relays\" : \"Encrypted DM over relays\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 268,\n                                            columnNumber: 19\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 264,\n                                    columnNumber: 17\n                                }, this)\n                            }, isSearchVisible ? \"search\" : \"title\", false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 240,\n                                columnNumber: 13\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 239,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 238,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-1\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: ()=>setIsSearchVisible(!isSearchVisible),\n                                className: \"p-2 rounded-lg hover:bg-bg-hover transition-colors \".concat(isSearchVisible ? \"bg-bg-tertiary text-accent\" : \"text-text-muted hover:text-text-secondary\"),\n                                title: \"Search\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_14__[\"default\"], {\n                                    className: \"w-4 h-4\"\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 279,\n                                    columnNumber: 13\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 278,\n                                columnNumber: 11\n                            }, this),\n                            !isChannel && _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.privateKey && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_VideoCall__WEBPACK_IMPORTED_MODULE_8__.VideoCall, {\n                                        privateKey: _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.privateKey,\n                                        recipientPubkey: activeChat\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 283,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: ()=>handleCopy(activeChat, \"header\"),\n                                        className: \"p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-text-secondary transition-colors\",\n                                        title: \"Copy key\",\n                                        children: copied === \"header\" ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_16__[\"default\"], {\n                                            className: \"w-4 h-4 text-green\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 285,\n                                            columnNumber: 40\n                                        }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_17__[\"default\"], {\n                                            className: \"w-4 h-4\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 285,\n                                            columnNumber: 83\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 284,\n                                        columnNumber: 15\n                                    }, this)\n                                ]\n                            }, void 0, true)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 277,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 222,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex-1 overflow-y-auto px-4 py-4 space-y-2\",\n                children: [\n                    filteredMessages.map((msg)=>{\n                        const isMe = msg.from === _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.publicKey;\n                        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                            initial: {\n                                opacity: 0,\n                                y: 8\n                            },\n                            animate: {\n                                opacity: 1,\n                                y: 0\n                            },\n                            className: \"flex \".concat(isMe ? \"justify-end\" : \"justify-start\"),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"group relative max-w-[78%] rounded-2xl text-sm overflow-hidden \".concat(isMe ? \"bg-accent text-white rounded-br-md\" : \"bg-bg-secondary border border-border text-text rounded-bl-md\"),\n                                children: [\n                                    msg.replyTo && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"mx-2 mt-2 px-2 py-1 rounded-md text-[11px] \".concat(isMe ? \"bg-white/15 text-white/80\" : \"bg-bg-tertiary text-text-secondary\"),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                className: \"font-medium truncate\",\n                                                children: msg.replyTo.from === _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.publicKey ? \"You\" : _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.shortenKey(msg.replyTo.from)\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 300,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                className: \"truncate\",\n                                                children: msg.replyTo.text\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 301,\n                                                columnNumber: 21\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 299,\n                                        columnNumber: 19\n                                    }, this),\n                                    msg.msgType === \"image\" && msg.attachment && !msg.attachment.chunked && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"cursor-pointer\",\n                                        onClick: ()=>setPreviewImage(\"data:\".concat(msg.attachment.mimeType, \";base64,\").concat(msg.attachment.data)),\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_image__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                                            src: \"data:\".concat(msg.attachment.mimeType, \";base64,\").concat(msg.attachment.data),\n                                            alt: msg.attachment.name,\n                                            width: 300,\n                                            height: 200,\n                                            className: \"max-w-full max-h-64 rounded-t-2xl object-cover\"\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 307,\n                                            columnNumber: 21\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 306,\n                                        columnNumber: 19\n                                    }, this),\n                                    msg.attachment && msg.msgType === \"file\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex items-center gap-3 px-3.5 pt-3 cursor-pointer\",\n                                        onClick: ()=>handleDownload(msg),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"w-10 h-10 rounded-xl flex items-center justify-center text-lg \".concat(isMe ? \"bg-white/15\" : \"bg-bg-tertiary\"),\n                                                children: (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.getFileIcon)(msg.attachment.mimeType)\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 313,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"flex-1 min-w-0\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                        className: \"text-xs font-medium truncate \".concat(isMe ? \"text-white\" : \"text-text\"),\n                                                        children: msg.attachment.name\n                                                    }, void 0, false, {\n                                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                        lineNumber: 317,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                        className: \"text-[10px] \".concat(isMe ? \"text-white/60\" : \"text-text-muted\"),\n                                                        children: (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.formatFileSize)(msg.attachment.size)\n                                                    }, void 0, false, {\n                                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                        lineNumber: 318,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 316,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_18__[\"default\"], {\n                                                className: \"w-4 h-4 shrink-0 \".concat(isMe ? \"text-white/60\" : \"text-text-muted\")\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 320,\n                                                columnNumber: 21\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 312,\n                                        columnNumber: 19\n                                    }, this),\n                                    msg.attachment && msg.msgType === \"image\" && msg.attachment.chunked && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex items-center gap-3 px-3.5 pt-3 cursor-pointer\",\n                                        onClick: ()=>handleDownload(msg),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"w-10 h-10 rounded-xl flex items-center justify-center text-lg \".concat(isMe ? \"bg-white/15\" : \"bg-bg-tertiary\"),\n                                                children: \"\\uD83D\\uDDBC\"\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 326,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"flex-1 min-w-0\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                        className: \"text-xs font-medium truncate \".concat(isMe ? \"text-white\" : \"text-text\"),\n                                                        children: msg.attachment.name\n                                                    }, void 0, false, {\n                                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                        lineNumber: 328,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                        className: \"text-[10px] \".concat(isMe ? \"text-white/60\" : \"text-text-muted\"),\n                                                        children: \"Chunked image, click to download\"\n                                                    }, void 0, false, {\n                                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                        lineNumber: 329,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 327,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_18__[\"default\"], {\n                                                className: \"w-4 h-4 shrink-0 \".concat(isMe ? \"text-white/60\" : \"text-text-muted\")\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 331,\n                                                columnNumber: 21\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 325,\n                                        columnNumber: 19\n                                    }, this),\n                                    msg.content && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"px-3.5 py-2.5\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                            className: \"whitespace-pre-wrap break-words\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Highlight, {\n                                                text: msg.content,\n                                                highlight: searchQuery\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 338,\n                                                columnNumber: 23\n                                            }, this)\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 337,\n                                            columnNumber: 21\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 336,\n                                        columnNumber: 19\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex items-center gap-1 px-3.5 pb-2 \".concat(isMe ? \"justify-end\" : \"justify-start\"),\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            className: \"text-[10px] \".concat(isMe ? \"text-white/50\" : \"text-text-muted\"),\n                                            children: new Date(msg.timestamp).toLocaleTimeString([], {\n                                                hour: \"2-digit\",\n                                                minute: \"2-digit\"\n                                            })\n                                        }, void 0, false, {\n                                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                            lineNumber: 344,\n                                            columnNumber: 19\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 343,\n                                        columnNumber: 17\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"absolute top-1 \".concat(isMe ? \"left-0 -translate-x-9\" : \"right-0 translate-x-9\", \" flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-opacity\"),\n                                        children: [\n                                            msg.content && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: ()=>handleCopy(msg.content, msg.id),\n                                                className: \"p-1 rounded bg-bg-secondary border border-border\",\n                                                children: copied === msg.id ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_16__[\"default\"], {\n                                                    className: \"w-3 h-3 text-green\"\n                                                }, void 0, false, {\n                                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                    lineNumber: 352,\n                                                    columnNumber: 44\n                                                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_17__[\"default\"], {\n                                                    className: \"w-3 h-3 text-text-muted\"\n                                                }, void 0, false, {\n                                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                    lineNumber: 352,\n                                                    columnNumber: 87\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 351,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: ()=>{\n                                                    var _msg_attachment;\n                                                    return setReplyTo({\n                                                        id: msg.id,\n                                                        from: msg.from,\n                                                        text: msg.content || ((_msg_attachment = msg.attachment) === null || _msg_attachment === void 0 ? void 0 : _msg_attachment.name) || \"\"\n                                                    });\n                                                },\n                                                className: \"p-1 rounded bg-bg-secondary border border-border\",\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_19__[\"default\"], {\n                                                    className: \"w-3 h-3 text-text-muted\"\n                                                }, void 0, false, {\n                                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                    lineNumber: 356,\n                                                    columnNumber: 21\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 355,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 349,\n                                        columnNumber: 17\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 297,\n                                columnNumber: 15\n                            }, this)\n                        }, msg.id, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 296,\n                            columnNumber: 13\n                        }, this);\n                    }),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        ref: messagesEndRef\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 363,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 292,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                children: replyTo && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                    initial: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    animate: {\n                        height: \"auto\",\n                        opacity: 1\n                    },\n                    exit: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    className: \"px-4 py-2 border-t border-border bg-bg-secondary/40 overflow-hidden\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-start justify-between gap-3\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"min-w-0\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-[11px] text-text-muted\",\n                                        children: [\n                                            \"Reply to \",\n                                            replyTo.from === _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.publicKey ? \"you\" : _lib_nostr__WEBPACK_IMPORTED_MODULE_3__.nostrClient.shortenKey(replyTo.from)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 371,\n                                        columnNumber: 17\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-xs text-text-secondary truncate\",\n                                        children: replyTo.text || \"(attachment)\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 372,\n                                        columnNumber: 17\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 370,\n                                columnNumber: 15\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: ()=>setReplyTo(null),\n                                className: \"p-1.5 rounded hover:bg-bg-hover\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {\n                                    className: \"w-3.5 h-3.5 text-text-muted\"\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 374,\n                                    columnNumber: 100\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 374,\n                                columnNumber: 15\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 369,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 368,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 366,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                children: pendingAttachment && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                    initial: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    animate: {\n                        height: \"auto\",\n                        opacity: 1\n                    },\n                    exit: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    className: \"px-4 border-t border-border bg-bg-secondary/30 overflow-hidden\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"py-3 flex items-center gap-3\",\n                        children: [\n                            pendingAttachment.type === \"image\" && pendingAttachment.data ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-16 h-16 rounded-xl overflow-hidden border border-border shrink-0\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_image__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                                    src: \"data:\".concat(pendingAttachment.mimeType, \";base64,\").concat(pendingAttachment.data),\n                                    alt: \"Attachment preview\",\n                                    width: 64,\n                                    height: 64,\n                                    className: \"w-full h-full object-cover\"\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 386,\n                                    columnNumber: 19\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 385,\n                                columnNumber: 17\n                            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-16 h-16 rounded-xl bg-bg-tertiary border border-border flex items-center justify-center text-2xl shrink-0\",\n                                children: (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.getFileIcon)(pendingAttachment.mimeType)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 389,\n                                columnNumber: 17\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex-1 min-w-0\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-sm text-text truncate\",\n                                        children: pendingAttachment.name\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 392,\n                                        columnNumber: 17\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-xs text-text-muted\",\n                                        children: (0,_lib_fileUtils__WEBPACK_IMPORTED_MODULE_6__.formatFileSize)(pendingAttachment.size)\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 393,\n                                        columnNumber: 17\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 391,\n                                columnNumber: 15\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: ()=>setPendingAttachment(null),\n                                className: \"p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-red transition-colors\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {\n                                    className: \"w-4 h-4\"\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 396,\n                                    columnNumber: 17\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 395,\n                                columnNumber: 15\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 383,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 382,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 380,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                children: sendProgress && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                    initial: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    animate: {\n                        height: \"auto\",\n                        opacity: 1\n                    },\n                    exit: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    className: \"px-4 border-t border-border bg-bg-secondary/30 overflow-hidden\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"py-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center justify-between text-xs text-text-secondary mb-1\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        className: \"flex items-center gap-1.5\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_20__[\"default\"], {\n                                                className: \"w-3 h-3 animate-spin\"\n                                            }, void 0, false, {\n                                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                                lineNumber: 409,\n                                                columnNumber: 19\n                                            }, this),\n                                            \"Uploading...\"\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 408,\n                                        columnNumber: 17\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                        children: [\n                                            sendProgress.sent,\n                                            \"/\",\n                                            sendProgress.total,\n                                            \" chunks\"\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 412,\n                                        columnNumber: 17\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 407,\n                                columnNumber: 15\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-full h-1.5 bg-bg-tertiary rounded-full overflow-hidden\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                                    className: \"h-full bg-accent rounded-full\",\n                                    initial: {\n                                        width: 0\n                                    },\n                                    animate: {\n                                        width: \"\".concat(sendProgress.sent / sendProgress.total * 100, \"%\")\n                                    },\n                                    transition: {\n                                        duration: 0.2\n                                    }\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 415,\n                                    columnNumber: 17\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 414,\n                                columnNumber: 15\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 406,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 405,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 403,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                children: error && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                    initial: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    animate: {\n                        height: \"auto\",\n                        opacity: 1\n                    },\n                    exit: {\n                        height: 0,\n                        opacity: 0\n                    },\n                    className: \"px-4 py-2 bg-red-dim border-t border-red/20\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-xs text-red\",\n                        children: error\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                        lineNumber: 425,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 424,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 422,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"px-4 py-3 border-t border-border bg-bg-secondary/30\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-end gap-2\",\n                    children: [\n                        !isChannel && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex items-center gap-0.5 pb-1\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>{\n                                        var _imageInputRef_current;\n                                        return (_imageInputRef_current = imageInputRef.current) === null || _imageInputRef_current === void 0 ? void 0 : _imageInputRef_current.click();\n                                    },\n                                    className: \"p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-accent transition-colors\",\n                                    title: \"Send image\",\n                                    disabled: sending,\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_21__[\"default\"], {\n                                        className: \"w-5 h-5\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 435,\n                                        columnNumber: 17\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 434,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>{\n                                        var _fileInputRef_current;\n                                        return (_fileInputRef_current = fileInputRef.current) === null || _fileInputRef_current === void 0 ? void 0 : _fileInputRef_current.click();\n                                    },\n                                    className: \"p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-accent transition-colors\",\n                                    title: \"Send file\",\n                                    disabled: sending,\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_22__[\"default\"], {\n                                        className: \"w-5 h-5\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                        lineNumber: 438,\n                                        columnNumber: 17\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                    lineNumber: 437,\n                                    columnNumber: 15\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 433,\n                            columnNumber: 13\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                            ref: imageInputRef,\n                            type: \"file\",\n                            accept: \"image/*\",\n                            className: \"hidden\",\n                            onChange: handleFileSelect\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 443,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                            ref: fileInputRef,\n                            type: \"file\",\n                            className: \"hidden\",\n                            onChange: handleFileSelect\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 444,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"textarea\", {\n                            value: input,\n                            onChange: (e)=>setInput(e.target.value),\n                            onKeyDown: (e)=>{\n                                if (e.key === \"Enter\" && !e.shiftKey) {\n                                    e.preventDefault();\n                                    handleSend();\n                                }\n                            },\n                            placeholder: pendingAttachment ? \"Add caption...\" : isChannel ? \"Post message to channel...\" : \"Write message...\",\n                            rows: 1,\n                            disabled: sending,\n                            className: \"flex-1 bg-bg-tertiary border border-border rounded-xl px-4 py-3 text-sm text-text placeholder:text-text-muted focus:outline-none focus:border-accent/50 resize-none max-h-32 disabled:opacity-50\",\n                            style: {\n                                minHeight: \"44px\"\n                            }\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 446,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.button, {\n                            whileHover: {\n                                scale: sending ? 1 : 1.05\n                            },\n                            whileTap: {\n                                scale: sending ? 1 : 0.95\n                            },\n                            onClick: handleSend,\n                            disabled: !input.trim() && !pendingAttachment || sending,\n                            className: \"p-3 bg-accent hover:bg-accent-hover disabled:opacity-30 disabled:cursor-not-allowed text-white rounded-xl transition-colors shrink-0\",\n                            children: sending ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_20__[\"default\"], {\n                                className: \"w-5 h-5 animate-spin\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 463,\n                                columnNumber: 24\n                            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_23__[\"default\"], {\n                                className: \"w-5 h-5\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 463,\n                                columnNumber: 71\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 462,\n                            columnNumber: 11\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 431,\n                    columnNumber: 9\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 430,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_12__.AnimatePresence, {\n                children: previewImage && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                    initial: {\n                        opacity: 0\n                    },\n                    animate: {\n                        opacity: 1\n                    },\n                    exit: {\n                        opacity: 0\n                    },\n                    className: \"fixed inset-0 z-[90] flex items-center justify-center bg-black/90 backdrop-blur-sm p-4\",\n                    onClick: ()=>setPreviewImage(null),\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                            className: \"absolute top-4 right-4 p-2 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors z-10\",\n                            onClick: ()=>setPreviewImage(null),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowLeft_Check_Copy_Download_Hash_Image_Loader2_Menu_Paperclip_Reply_Search_Send_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {\n                                className: \"w-6 h-6\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 472,\n                                columnNumber: 15\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 471,\n                            columnNumber: 13\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_13__.motion.div, {\n                            initial: {\n                                scale: 0.9\n                            },\n                            animate: {\n                                scale: 1\n                            },\n                            exit: {\n                                scale: 0.9\n                            },\n                            className: \"relative max-w-full max-h-full\",\n                            onClick: (e)=>e.stopPropagation(),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(next_image__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                                src: previewImage,\n                                alt: \"Image preview\",\n                                layout: \"fill\",\n                                objectFit: \"contain\",\n                                className: \"rounded-lg\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                                lineNumber: 475,\n                                columnNumber: 15\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                            lineNumber: 474,\n                            columnNumber: 13\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                    lineNumber: 470,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n                lineNumber: 468,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/home/user/nostr/src/components/ChatView.tsx\",\n        lineNumber: 221,\n        columnNumber: 5\n    }, this);\n}\n_s(ChatView, \"hwBQUE+ZsNwOzg+t9gKZLTUJAks=\", false, function() {\n    return [\n        _lib_store__WEBPACK_IMPORTED_MODULE_4__.useAppState\n    ];\n});\n_c1 = ChatView;\nvar _c, _c1;\n$RefreshReg$(_c, \"Highlight\");\n$RefreshReg$(_c1, \"ChatView\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL0NoYXRWaWV3LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTBFO0FBQ2xCO0FBZWxDO0FBQ2E7QUFDNEQ7QUFVekU7QUFDc0M7QUFDb0M7QUFDbEU7QUFDVTtBQUV4QyxTQUFTc0MsVUFBVSxLQUF3RDtRQUF4RCxFQUFFQyxJQUFJLEVBQUVDLFNBQVMsRUFBdUMsR0FBeEQ7SUFDakIsSUFBSSxDQUFDQSxVQUFVQyxJQUFJLElBQUk7UUFDckIscUJBQU8sOERBQUNDO3NCQUFNSDs7Ozs7O0lBQ2hCO0lBQ0EsTUFBTUksUUFBUSxJQUFJQyxPQUFPLElBQWMsT0FBVkosV0FBVSxNQUFJO0lBQzNDLE1BQU1LLFFBQVFOLEtBQUtPLEtBQUssQ0FBQ0g7SUFFekIscUJBQ0UsOERBQUNEO2tCQUNFRyxNQUFNRSxHQUFHLENBQUMsQ0FBQ0MsTUFBTUMsSUFDaEJOLE1BQU1PLElBQUksQ0FBQ0Ysc0JBQ1QsOERBQUNHO2dCQUFhQyxXQUFVOzBCQUNyQko7ZUFEUUM7Ozs7cUNBSVgsOERBQUNQOzBCQUFjTTtlQUFKQzs7Ozs7Ozs7OztBQUtyQjtLQXBCU1g7QUFzQk0sU0FBU2U7O0lBQ3RCLE1BQU0sRUFBRUMsVUFBVSxFQUFFQyxRQUFRLEVBQUVDLFFBQVEsRUFBRSxHQUFHMUIsdURBQVdBO0lBQ3RELE1BQU0yQixZQUFZLENBQUMsQ0FBQ0gsY0FBY0EsV0FBV0ksVUFBVSxDQUFDO0lBQ3hELE1BQU1DLFlBQVlGLFlBQVlILFdBQVlNLEtBQUssQ0FBQyxXQUFXQyxNQUFNLElBQUk7SUFFckUsTUFBTSxDQUFDQyxPQUFPQyxTQUFTLEdBQUczRCwrQ0FBUUEsQ0FBQztJQUNuQyxNQUFNLENBQUM0RCxTQUFTQyxXQUFXLEdBQUc3RCwrQ0FBUUEsQ0FBQztJQUN2QyxNQUFNLENBQUM4RCxVQUFVQyxZQUFZLEdBQUcvRCwrQ0FBUUEsQ0FBa0IsRUFBRTtJQUM1RCxNQUFN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RTtvQkFBR3BHLFdBQVU7b0JBQXlGK0YsU0FBUyxJQUFNeEUsZ0JBQWdCOztzQ0FDcE4sOERBQUN1RTs0QkFBTzlGLFdBQVU7NEJBQXdHK0YsU0FBUyxJQUFNeEUsZ0JBQWdCO3NDQUN2Siw0RUFBQ3ZELGdLQUFDQTtnQ0FBQ2dDLFdBQVU7Ozs7Ozs7Ozs7O3NDQUVmLDhEQUFDOUMsa0RBQU1BLENBQUN1SSxHQUFHOzRCQUFDUyxTQUFTO2dDQUFFeUMsT0FBTzs0QkFBSTs0QkFBR3JDLFNBQVM7Z0NBQUVxQyxPQUFPOzRCQUFFOzRCQUFHcEMsTUFBTTtnQ0FBRW9DLE9BQU87NEJBQUk7NEJBQUczSSxXQUFVOzRCQUFpQytGLFNBQVNyQixDQUFBQSxJQUFLQSxFQUFFbUUsZUFBZTtzQ0FDMUosNEVBQUM1SyxrREFBU0E7Z0NBQUNzSixLQUFLakc7Z0NBQWNrRyxLQUFJO2dDQUFnQnNCLFFBQU87Z0NBQU9DLFdBQVU7Z0NBQVUvSSxXQUFVOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTzVHO0dBemF3QkM7O1FBQ3FCdkIsbURBQVdBOzs7TUFEaEN1QiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvY29tcG9uZW50cy9DaGF0Vmlldy50c3g/NDFiNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQW5pbWF0ZVByZXNlbmNlLCBtb3Rpb24gfSBmcm9tICdmcmFtZXItbW90aW9uJztcbmltcG9ydCB7XG4gIEFycm93TGVmdCxcbiAgQ2hlY2ssXG4gIENvcHksXG4gIERvd25sb2FkLFxuICBIYXNoLFxuICBJbWFnZSBhcyBJbWFnZUljb24sXG4gIExvYWRlcjIsXG4gIE1lbnUsXG4gIFBhcGVyY2xpcCxcbiAgUmVwbHksXG4gIFNlbmQsXG4gIFNlYXJjaCxcbiAgWCxcbn0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCBOZXh0SW1hZ2UgZnJvbSAnbmV4dC9pbWFnZSc7XG5pbXBvcnQgeyBub3N0ckNsaWVudCwgdHlwZSBBdHRhY2htZW50LCB0eXBlIERpcmVjdE1lc3NhZ2UsIHR5cGUgUmVwbHlSZWYgfSBmcm9tICcuLi9saWIvbm9zdHInO1xuaW1wb3J0IHtcbiAgYWRkQ2hhbm5lbE1lc3NhZ2UsXG4gIGFkZE1lc3NhZ2UsXG4gIGdldENoYW5uZWxNZXNzYWdlcyxcbiAgZ2V0TWVzc2FnZXMsXG4gIGdvQmFja1RvU2lkZWJhcixcbiAgdG9nZ2xlU2lkZWJhcixcbiAgdXBkYXRlQ29udGFjdFByb2ZpbGUsXG4gIHVzZUFwcFN0YXRlLFxufSBmcm9tICcuLi9saWIvc3RvcmUnO1xuaW1wb3J0IHsgZG93bmxvYWRDaHVua2VkVHJhbnNmZXIgfSBmcm9tICcuLi9saWIvY2h1bmtTdG9yZSc7XG5pbXBvcnQgeyBkb3dubG9hZEF0dGFjaG1lbnQsIGZvcm1hdEZpbGVTaXplLCBnZXRGaWxlSWNvbiwgcHJvY2Vzc0ZpbGUgfSBmcm9tICcuLi9saWIvZmlsZVV0aWxzJztcbmltcG9ydCBBdmF0YXIgZnJvbSAnLi9BdmF0YXInO1xuaW1wb3J0IHsgVmlkZW9DYWxsIH0gZnJvbSAnLi9WaWRlb0NhbGwnO1xuXG5mdW5jdGlvbiBIaWdobGlnaHQoeyB0ZXh0LCBoaWdobGlnaHQgfTogeyB0ZXh0OiBzdHJpbmc7IGhpZ2hsaWdodDogc3RyaW5nIH0pIHtcbiAgaWYgKCFoaWdobGlnaHQudHJpbSgpKSB7XG4gICAgcmV0dXJuIDxzcGFuPnt0ZXh0fTwvc3Bhbj47XG4gIH1cbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAoJHtoaWdobGlnaHR9KWAsICdnaScpO1xuICBjb25zdCBwYXJ0cyA9IHRleHQuc3BsaXQocmVnZXgpO1xuXG4gIHJldHVybiAoXG4gICAgPHNwYW4+XG4gICAgICB7cGFydHMubWFwKChwYXJ0LCBpKSA9PlxuICAgICAgICByZWdleC50ZXN0KHBhcnQpID8gKFxuICAgICAgICAgIDxtYXJrIGtleT17aX0gY2xhc3NOYW1lPVwiYmcteWVsbG93LTMwMCB0ZXh0LWJsYWNrIHJvdW5kZWQtc21cIj5cbiAgICAgICAgICAgIHtwYXJ0fVxuICAgICAgICAgIDwvbWFyaz5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8c3BhbiBrZXk9e2l9PntwYXJ0fTwvc3Bhbj5cbiAgICAgICAgKSxcbiAgICAgICl9XG4gICAgPC9zcGFuPlxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDaGF0VmlldygpIHtcbiAgY29uc3QgeyBhY3RpdmVDaGF0LCBjb250YWN0cywgY2hhbm5lbHMgfSA9IHVzZUFwcFN0YXRlKCk7XG4gIGNvbnN0IGlzQ2hhbm5lbCA9ICEhYWN0aXZlQ2hhdCAmJiBhY3RpdmVDaGF0LnN0YXJ0c1dpdGgoJ2NoYW5uZWw6Jyk7XG4gIGNvbnN0IGNoYW5uZWxJZCA9IGlzQ2hhbm5lbCA/IGFjdGl2ZUNoYXQhLnNsaWNlKCdjaGFubmVsOicubGVuZ3RoKSA6ICcnO1xuXG4gIGNvbnN0IFtpbnB1dCwgc2V0SW5wdXRdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbc2VuZGluZywgc2V0U2VuZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGU8RGlyZWN0TWVzc2FnZVtdPihbXSk7XG4gIGNvbnN0IFtwZW5kaW5nQXR0YWNobWVudCwgc2V0UGVuZGluZ0F0dGFjaG1lbnRdID0gdXNlU3RhdGU8QXR0YWNobWVudCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbc2VuZFByb2dyZXNzLCBzZXRTZW5kUHJvZ3Jlc3NdID0gdXNlU3RhdGU8eyBzZW50OiBudW1iZXI7IHRvdGFsOiBudW1iZXIgfSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbcmVwbHlUbywgc2V0UmVwbHlUb10gPSB1c2VTdGF0ZTxSZXBseVJlZiB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbcHJldmlld0ltYWdlLCBzZXRQcmV2aWV3SW1hZ2VdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbY29waWVkLCBzZXRDb3BpZWRdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbc2VhcmNoUXVlcnksIHNldFNlYXJjaFF1ZXJ5XSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW2lzU2VhcmNoVmlzaWJsZSwgc2V0SXNTZWFyY2hWaXNpYmxlXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBtZXNzYWdlc0VuZFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IGltYWdlSW5wdXRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IGZpbGVJbnB1dFJlZiA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50PihudWxsKTtcbiAgY29uc3Qgc2VhcmNoSW5wdXRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbCk7XG5cbiAgY29uc3QgY29udGFjdCA9IHVzZU1lbW8oKCkgPT4gY29udGFjdHMuZmluZChjID0+IGMucHVia2V5ID09PSBhY3RpdmVDaGF0KSwgW2NvbnRhY3RzLCBhY3RpdmVDaGF0XSk7XG4gIGNvbnN0IGNoYW5uZWwgPSB1c2VNZW1vKCgpID0+IGNoYW5uZWxzLmZpbmQoYyA9PiBjLmlkID09PSBjaGFubmVsSWQpLCBbY2hhbm5lbHMsIGNoYW5uZWxJZF0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGlzU2VhcmNoVmlzaWJsZSkge1xuICAgICAgc2VhcmNoSW5wdXRSZWYuY3VycmVudD8uZm9jdXMoKTtcbiAgICB9XG4gIH0sIFtpc1NlYXJjaFZpc2libGVdKTtcblxuICBjb25zdCBmaWx0ZXJlZE1lc3NhZ2VzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKCFzZWFyY2hRdWVyeS50cmltKCkpIHJldHVybiBtZXNzYWdlcztcbiAgICByZXR1cm4gbWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cuY29udGVudD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hRdWVyeS50b0xvd2VyQ2FzZSgpKSk7XG4gIH0sIFttZXNzYWdlcywgc2VhcmNoUXVlcnldKTtcblxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFhY3RpdmVDaGF0KSByZXR1cm47XG4gICAgaWYgKGlzQ2hhbm5lbCkge1xuICAgICAgc2V0TWVzc2FnZXMoZ2V0Q2hhbm5lbE1lc3NhZ2VzKGNoYW5uZWxJZCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRNZXNzYWdlcyhnZXRNZXNzYWdlcyhhY3RpdmVDaGF0KSk7XG4gICAgICBub3N0ckNsaWVudC5yZXF1ZXN0UHJvZmlsZShhY3RpdmVDaGF0KTtcbiAgICB9XG4gICAgc2V0UGVuZGluZ0F0dGFjaG1lbnQobnVsbCk7XG4gICAgc2V0U2VuZFByb2dyZXNzKG51bGwpO1xuICAgIHNldFJlcGx5VG8obnVsbCk7XG4gICAgc2V0RXJyb3IoJycpO1xuICB9LCBbYWN0aXZlQ2hhdCwgaXNDaGFubmVsLCBjaGFubmVsSWRdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHVuc3ViTXNnID0gbm9zdHJDbGllbnQub25NZXNzYWdlKG1zZyA9PiB7XG4gICAgICBhZGRNZXNzYWdlKG1zZyk7XG4gICAgICBpZiAoIWFjdGl2ZUNoYXQgfHwgaXNDaGFubmVsKSByZXR1cm47XG4gICAgICBzZXRNZXNzYWdlcyhnZXRNZXNzYWdlcyhhY3RpdmVDaGF0KSk7XG4gICAgfSk7XG4gICAgY29uc3QgdW5zdWJDaGFubmVsID0gbm9zdHJDbGllbnQub25DaGFubmVsTWVzc2FnZShtc2cgPT4ge1xuICAgICAgYWRkQ2hhbm5lbE1lc3NhZ2UobXNnKTtcbiAgICAgIGlmICghY2hhbm5lbElkIHx8ICFpc0NoYW5uZWwgfHwgbXNnLmNoYW5uZWxJZCAhPT0gY2hhbm5lbElkKSByZXR1cm47XG4gICAgICBzZXRNZXNzYWdlcyhnZXRDaGFubmVsTWVzc2FnZXMoY2hhbm5lbElkKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVuc3ViTXNnKCk7XG4gICAgICB1bnN1YkNoYW5uZWwoKTtcbiAgICB9O1xuICB9LCBbYWN0aXZlQ2hhdCwgaXNDaGFubmVsLCBjaGFubmVsSWRdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHVuc3ViID0gbm9zdHJDbGllbnQub25Qcm9maWxlKChwdWJrZXksIHByb2ZpbGUpID0+IHtcbiAgICAgIHVwZGF0ZUNvbnRhY3RQcm9maWxlKHB1YmtleSwgcHJvZmlsZS5uYW1lLCBwcm9maWxlLnBpY3R1cmUsIHByb2ZpbGUuYWJvdXQpO1xuICAgIH0pO1xuICAgIHJldHVybiB1bnN1YjtcbiAgfSwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFhY3RpdmVDaGF0KSByZXR1cm47XG4gICAgc2V0TWVzc2FnZXMoaXNDaGFubmVsID8gZ2V0Q2hhbm5lbE1lc3NhZ2VzKGNoYW5uZWxJZCkgOiBnZXRNZXNzYWdlcyhhY3RpdmVDaGF0KSk7XG4gIH0sIFthY3RpdmVDaGF0LCBjb250YWN0cywgY2hhbm5lbHMsIGlzQ2hhbm5lbCwgY2hhbm5lbElkXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc2VhcmNoUXVlcnkpIHJldHVybjtcbiAgICBtZXNzYWdlc0VuZFJlZi5jdXJyZW50Py5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgfSwgW21lc3NhZ2VzLCBzZWFyY2hRdWVyeV0pO1xuXG4gIGNvbnN0IGhhbmRsZVNlbmQgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCghaW5wdXQudHJpbSgpICYmICFwZW5kaW5nQXR0YWNobWVudCkgfHwgIWFjdGl2ZUNoYXQgfHwgc2VuZGluZykgcmV0dXJuO1xuICAgIGNvbnN0IHRleHQgPSBpbnB1dC50cmltKCk7XG4gICAgc2V0SW5wdXQoJycpO1xuICAgIHNldFNlbmRpbmcodHJ1ZSk7XG4gICAgc2V0RXJyb3IoJycpO1xuICAgIHNldFNlbmRQcm9ncmVzcyhudWxsKTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoaXNDaGFubmVsKSB7XG4gICAgICAgIGlmIChwZW5kaW5nQXR0YWNobWVudCkgdGhyb3cgbmV3IEVycm9yKCdBdHRhY2htZW50cyBhcmUgbm90IHN1cHBvcnRlZCBpbiBwdWJsaWMgY2hhbm5lbHMuJyk7XG4gICAgICAgIGNvbnN0IG1zZyA9IGF3YWl0IG5vc3RyQ2xpZW50LnNlbmRDaGFubmVsTWVzc2FnZShjaGFubmVsSWQsIHRleHQsIHJlcGx5VG8gfHwgdW5kZWZpbmVkKTtcbiAgICAgICAgYWRkQ2hhbm5lbE1lc3NhZ2UobXNnKTtcbiAgICAgICAgc2V0TWVzc2FnZXMoZ2V0Q2hhbm5lbE1lc3NhZ2VzKGNoYW5uZWxJZCkpO1xuICAgICAgfSBlbHNlIGlmIChwZW5kaW5nQXR0YWNobWVudCkge1xuICAgICAgICBjb25zdCBtc2cgPSBhd2FpdCBub3N0ckNsaWVudC5zZW5kQXR0YWNobWVudChcbiAgICAgICAgICBhY3RpdmVDaGF0LFxuICAgICAgICAgIHBlbmRpbmdBdHRhY2htZW50LFxuICAgICAgICAgIHRleHQsXG4gICAgICAgICAgKHNlbnQsIHRvdGFsKSA9PiBzZXRTZW5kUHJvZ3Jlc3MoeyBzZW50LCB0b3RhbCB9KSxcbiAgICAgICAgICByZXBseVRvIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgKTtcbiAgICAgICAgYWRkTWVzc2FnZShtc2cpO1xuICAgICAgICBzZXRNZXNzYWdlcyhnZXRNZXNzYWdlcyhhY3RpdmVDaGF0KSk7XG4gICAgICAgIHNldFBlbmRpbmdBdHRhY2htZW50KG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbXNnID0gYXdhaXQgbm9zdHJDbGllbnQuc2VuZERpcmVjdE1lc3NhZ2UoYWN0aXZlQ2hhdCwgdGV4dCwgcmVwbHlUbyB8fCB1bmRlZmluZWQpO1xuICAgICAgICBhZGRNZXNzYWdlKG1zZyk7XG4gICAgICAgIHNldE1lc3NhZ2VzKGdldE1lc3NhZ2VzKGFjdGl2ZUNoYXQpKTtcbiAgICAgIH1cbiAgICAgIHNldFJlcGx5VG8obnVsbCk7XG4gICAgICBzZXRTZW5kUHJvZ3Jlc3MobnVsbCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBzZXRFcnJvcigoZXJyIGFzIEVycm9yKS5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gc2VuZCcpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRTZW5kaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlRmlsZVNlbGVjdCA9IHVzZUNhbGxiYWNrKGFzeW5jIChlOiBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xuICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlcz8uWzBdO1xuICAgIGlmICghZmlsZSkgcmV0dXJuO1xuICAgIGUudGFyZ2V0LnZhbHVlID0gJyc7XG4gICAgc2V0RXJyb3IoJycpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhdHRhY2htZW50ID0gYXdhaXQgcHJvY2Vzc0ZpbGUoZmlsZSk7XG4gICAgICBpZiAoYXR0YWNobWVudCkgc2V0UGVuZGluZ0F0dGFjaG1lbnQoYXR0YWNobWVudCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBzZXRFcnJvcigoZXJyIGFzIEVycm9yKS5tZXNzYWdlKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBoYW5kbGVDb3B5ID0gYXN5bmMgKHRleHQ6IHN0cmluZywgaWQ6IHN0cmluZykgPT4ge1xuICAgIGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHQpO1xuICAgIHNldENvcGllZChpZCk7XG4gICAgc2V0VGltZW91dCgoKSA9PiBzZXRDb3BpZWQoJycpLCAxNDAwKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVEb3dubG9hZCA9IGFzeW5jIChtc2c6IERpcmVjdE1lc3NhZ2UpID0+IHtcbiAgICBpZiAoIW1zZy5hdHRhY2htZW50KSByZXR1cm47XG4gICAgaWYgKG1zZy5hdHRhY2htZW50LmNodW5rZWQgJiYgbXNnLmF0dGFjaG1lbnQudHJhbnNmZXJJZCkge1xuICAgICAgYXdhaXQgZG93bmxvYWRDaHVua2VkVHJhbnNmZXIobXNnLmF0dGFjaG1lbnQudHJhbnNmZXJJZCwgbXNnLmF0dGFjaG1lbnQubmFtZSwgbXNnLmF0dGFjaG1lbnQubWltZVR5cGUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkb3dubG9hZEF0dGFjaG1lbnQobXNnLmF0dGFjaG1lbnQpO1xuICB9O1xuXG4gIGlmICghYWN0aXZlQ2hhdCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1iZ1wiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHB4LTRcIj5cbiAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC0yeGwgZm9udC1ib2xkIHRleHQtdGV4dCBtYi0yXCIgc3R5bGU9e3sgZm9udEZhbWlseTogJ1NwYWNlIEdyb3Rlc2snIH19PkFub255bW91cyBEZWNlbnRyYWxpemVkIE1lc3NlbmdlcjwvaDI+XG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC10ZXh0LXNlY29uZGFyeSB0ZXh0LXNtXCI+Q2hvb3NlIGNvbnRhY3Qgb3IgY2hhbm5lbCB0byBzdGFydC48L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBmbGV4LWNvbCBiZy1iZyBoLWZ1bGxcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHgtNCBweS0zIGJvcmRlci1iIGJvcmRlci1ib3JkZXIgYmctYmctc2Vjb25kYXJ5LzUwIGJhY2tkcm9wLWJsdXItc20gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTNcIj5cbiAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtnb0JhY2tUb1NpZGViYXJ9IGNsYXNzTmFtZT1cInAtMiByb3VuZGVkLWxnIGhvdmVyOmJnLWJnLWhvdmVyIHRleHQtdGV4dC1zZWNvbmRhcnkgbWQ6aGlkZGVuXCI+XG4gICAgICAgICAgPEFycm93TGVmdCBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDxidXR0b24gb25DbGljaz17dG9nZ2xlU2lkZWJhcn0gY2xhc3NOYW1lPVwicC0yIHJvdW5kZWQtbGcgaG92ZXI6YmctYmctaG92ZXIgdGV4dC10ZXh0LXNlY29uZGFyeSBoaWRkZW4gbGc6YmxvY2tcIj5cbiAgICAgICAgICA8TWVudSBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cbiAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAge2lzQ2hhbm5lbCA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctOCBoLTggcm91bmRlZC1mdWxsIGJnLWN5YW4vMTUgYm9yZGVyIGJvcmRlci1jeWFuLzI1IGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XG4gICAgICAgICAgICA8SGFzaCBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtY3lhblwiIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPEF2YXRhciBwdWJrZXk9e2FjdGl2ZUNoYXR9IG5hbWU9e2NvbnRhY3Q/Lm5hbWV9IHBpY3R1cmU9e2NvbnRhY3Q/LnBpY3R1cmV9IHNpemU9XCJzbVwiIHNob3dCb3JkZXIgLz5cbiAgICAgICAgKX1cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XG4gICAgICAgICAgPEFuaW1hdGVQcmVzZW5jZSBpbml0aWFsPXtmYWxzZX0gbW9kZT1cIndhaXRcIj5cbiAgICAgICAgICAgIDxtb3Rpb24uZGl2XG4gICAgICAgICAgICAgIGtleT17aXNTZWFyY2hWaXNpYmxlID8gJ3NlYXJjaCcgOiAndGl0bGUnfVxuICAgICAgICAgICAgICBpbml0aWFsPXt7IG9wYWNpdHk6IDAsIHk6IC0xMCB9fVxuICAgICAgICAgICAgICBhbmltYXRlPXt7IG9wYWNpdHk6IDEsIHk6IDAgfX1cbiAgICAgICAgICAgICAgZXhpdD17eyBvcGFjaXR5OiAwLCB5OiAxMCB9fVxuICAgICAgICAgICAgICB0cmFuc2l0aW9uPXt7IGR1cmF0aW9uOiAwLjIgfX1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2lzU2VhcmNoVmlzaWJsZSA/IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlIHctZnVsbFwiPlxuICAgICAgICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9XCJhYnNvbHV0ZSBsZWZ0LTIgdG9wLTEvMiAtdHJhbnNsYXRlLXktMS8yIHctNCBoLTQgdGV4dC10ZXh0LW11dGVkXCIgLz5cbiAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICByZWY9e3NlYXJjaElucHV0UmVmfVxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtzZWFyY2hRdWVyeX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2UgPT4gc2V0U2VhcmNoUXVlcnkoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlYXJjaCBpbiBjaGF0Li4uXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGJnLWJnLXRlcnRpYXJ5IGJvcmRlciBib3JkZXItYm9yZGVyIHJvdW5kZWQtbGcgcGwtOCBwci04IHB5LTEgdGV4dC1zbSB0ZXh0LXRleHQgcGxhY2Vob2xkZXI6dGV4dC10ZXh0LW11dGVkIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpib3JkZXItYWNjZW50LzUwXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHsgc2V0SXNTZWFyY2hWaXNpYmxlKGZhbHNlKTsgc2V0U2VhcmNoUXVlcnkoJycpOyB9fSBjbGFzc05hbWU9XCJhYnNvbHV0ZSByaWdodC0yIHRvcC0xLzIgLXRyYW5zbGF0ZS15LTEvMiBwLTAuNSB0ZXh0LXRleHQtbXV0ZWQgaG92ZXI6dGV4dC10ZXh0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxYIGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LXRleHQgdHJ1bmNhdGVcIj5cbiAgICAgICAgICAgICAgICAgICAge2lzQ2hhbm5lbCA/IGAjICR7Y2hhbm5lbD8ubmFtZSB8fCBub3N0ckNsaWVudC5zaG9ydGVuS2V5KGNoYW5uZWxJZCl9YCA6IChjb250YWN0Py5uYW1lIHx8IG5vc3RyQ2xpZW50LnNob3J0ZW5LZXkoYWN0aXZlQ2hhdCkpfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtWzEwcHhdIHRleHQtdGV4dC1tdXRlZFwiPlxuICAgICAgICAgICAgICAgICAgICB7aXNDaGFubmVsID8gJ1B1YmxpYyBjaGFubmVsIG92ZXIgcmVsYXlzJyA6ICdFbmNyeXB0ZWQgRE0gb3ZlciByZWxheXMnfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L21vdGlvbi5kaXY+XG4gICAgICAgICAgPC9BbmltYXRlUHJlc2VuY2U+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTFcIj5cbiAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldElzU2VhcmNoVmlzaWJsZSghaXNTZWFyY2hWaXNpYmxlKX0gY2xhc3NOYW1lPXtgcC0yIHJvdW5kZWQtbGcgaG92ZXI6YmctYmctaG92ZXIgdHJhbnNpdGlvbi1jb2xvcnMgJHtpc1NlYXJjaFZpc2libGUgPyAnYmctYmctdGVydGlhcnkgdGV4dC1hY2NlbnQnIDogJ3RleHQtdGV4dC1tdXRlZCBob3Zlcjp0ZXh0LXRleHQtc2Vjb25kYXJ5J31gfSB0aXRsZT1cIlNlYXJjaFwiPlxuICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9XCJ3LTQgaC00XCIgLz5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICB7IWlzQ2hhbm5lbCAmJiBub3N0ckNsaWVudC5wcml2YXRlS2V5ICYmIChcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIDxWaWRlb0NhbGwgcHJpdmF0ZUtleT17bm9zdHJDbGllbnQucHJpdmF0ZUtleX0gcmVjaXBpZW50UHVia2V5PXthY3RpdmVDaGF0fSAvPlxuICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNvcHkoYWN0aXZlQ2hhdCwgJ2hlYWRlcicpfSBjbGFzc05hbWU9XCJwLTIgcm91bmRlZC1sZyBob3ZlcjpiZy1iZy1ob3ZlciB0ZXh0LXRleHQtbXV0ZWQgaG92ZXI6dGV4dC10ZXh0LXNlY29uZGFyeSB0cmFuc2l0aW9uLWNvbG9yc1wiIHRpdGxlPVwiQ29weSBrZXlcIj5cbiAgICAgICAgICAgICAgICB7Y29waWVkID09PSAnaGVhZGVyJyA/IDxDaGVjayBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtZ3JlZW5cIiAvPiA6IDxDb3B5IGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPn1cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBvdmVyZmxvdy15LWF1dG8gcHgtNCBweS00IHNwYWNlLXktMlwiPlxuICAgICAgICB7ZmlsdGVyZWRNZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICBjb25zdCBpc01lID0gbXNnLmZyb20gPT09IG5vc3RyQ2xpZW50LnB1YmxpY0tleTtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPG1vdGlvbi5kaXYga2V5PXttc2cuaWR9IGluaXRpYWw9e3sgb3BhY2l0eTogMCwgeTogOCB9fSBhbmltYXRlPXt7IG9wYWNpdHk6IDEsIHk6IDAgfX0gY2xhc3NOYW1lPXtgZmxleCAke2lzTWUgPyAnanVzdGlmeS1lbmQnIDogJ2p1c3RpZnktc3RhcnQnfWB9PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YGdyb3VwIHJlbGF0aXZlIG1heC13LVs3OCVdIHJvdW5kZWQtMnhsIHRleHQtc20gb3ZlcmZsb3ctaGlkZGVuICR7aXNNZSA/ICdiZy1hY2NlbnQgdGV4dC13aGl0ZSByb3VuZGVkLWJyLW1kJyA6ICdiZy1iZy1zZWNvbmRhcnkgYm9yZGVyIGJvcmRlci1ib3JkZXIgdGV4dC10ZXh0IHJvdW5kZWQtYmwtbWQnfWB9PlxuICAgICAgICAgICAgICAgIHttc2cucmVwbHlUbyAmJiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YG14LTIgbXQtMiBweC0yIHB5LTEgcm91bmRlZC1tZCB0ZXh0LVsxMXB4XSAke2lzTWUgPyAnYmctd2hpdGUvMTUgdGV4dC13aGl0ZS84MCcgOiAnYmctYmctdGVydGlhcnkgdGV4dC10ZXh0LXNlY29uZGFyeSd9YH0+XG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRydW5jYXRlXCI+e21zZy5yZXBseVRvLmZyb20gPT09IG5vc3RyQ2xpZW50LnB1YmxpY0tleSA/ICdZb3UnIDogbm9zdHJDbGllbnQuc2hvcnRlbktleShtc2cucmVwbHlUby5mcm9tKX08L3A+XG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRydW5jYXRlXCI+e21zZy5yZXBseVRvLnRleHR9PC9wPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgIHttc2cubXNnVHlwZSA9PT0gJ2ltYWdlJyAmJiBtc2cuYXR0YWNobWVudCAmJiAhbXNnLmF0dGFjaG1lbnQuY2h1bmtlZCAmJiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImN1cnNvci1wb2ludGVyXCIgb25DbGljaz17KCkgPT4gc2V0UHJldmlld0ltYWdlKGBkYXRhOiR7bXNnLmF0dGFjaG1lbnQhLm1pbWVUeXBlfTtiYXNlNjQsJHttc2cuYXR0YWNobWVudCEuZGF0YX1gKX0+XG4gICAgICAgICAgICAgICAgICAgIDxOZXh0SW1hZ2Ugc3JjPXtgZGF0YToke21zZy5hdHRhY2htZW50Lm1pbWVUeXBlfTtiYXNlNjQsJHttc2cuYXR0YWNobWVudC5kYXRhfWB9IGFsdD17bXNnLmF0dGFjaG1lbnQubmFtZX0gd2lkdGg9ezMwMH0gaGVpZ2h0PXsyMDB9IGNsYXNzTmFtZT1cIm1heC13LWZ1bGwgbWF4LWgtNjQgcm91bmRlZC10LTJ4bCBvYmplY3QtY292ZXJcIiAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgIHttc2cuYXR0YWNobWVudCAmJiBtc2cubXNnVHlwZSA9PT0gJ2ZpbGUnICYmIChcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgcHgtMy41IHB0LTMgY3Vyc29yLXBvaW50ZXJcIiBvbkNsaWNrPXsoKSA9PiBoYW5kbGVEb3dubG9hZChtc2cpfT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2B3LTEwIGgtMTAgcm91bmRlZC14bCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LWxnICR7aXNNZSA/ICdiZy13aGl0ZS8xNScgOiAnYmctYmctdGVydGlhcnknfWB9PlxuICAgICAgICAgICAgICAgICAgICAgIHtnZXRGaWxlSWNvbihtc2cuYXR0YWNobWVudC5taW1lVHlwZSl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgdGV4dC14cyBmb250LW1lZGl1bSB0cnVuY2F0ZSAke2lzTWUgPyAndGV4dC13aGl0ZScgOiAndGV4dC10ZXh0J31gfT57bXNnLmF0dGFjaG1lbnQubmFtZX08L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgdGV4dC1bMTBweF0gJHtpc01lID8gJ3RleHQtd2hpdGUvNjAnIDogJ3RleHQtdGV4dC1tdXRlZCd9YH0+e2Zvcm1hdEZpbGVTaXplKG1zZy5hdHRhY2htZW50LnNpemUpfTwvcD5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxEb3dubG9hZCBjbGFzc05hbWU9e2B3LTQgaC00IHNocmluay0wICR7aXNNZSA/ICd0ZXh0LXdoaXRlLzYwJyA6ICd0ZXh0LXRleHQtbXV0ZWQnfWB9IC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAge21zZy5hdHRhY2htZW50ICYmIG1zZy5tc2dUeXBlID09PSAnaW1hZ2UnICYmIG1zZy5hdHRhY2htZW50LmNodW5rZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBweC0zLjUgcHQtMyBjdXJzb3ItcG9pbnRlclwiIG9uQ2xpY2s9eygpID0+IGhhbmRsZURvd25sb2FkKG1zZyl9PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHctMTAgaC0xMCByb3VuZGVkLXhsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRleHQtbGcgJHtpc01lID8gJ2JnLXdoaXRlLzE1JyA6ICdiZy1iZy10ZXJ0aWFyeSd9YH0+8J+WvO+4jzwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgdGV4dC14cyBmb250LW1lZGl1bSB0cnVuY2F0ZSAke2lzTWUgPyAndGV4dC13aGl0ZScgOiAndGV4dC10ZXh0J31gfT57bXNnLmF0dGFjaG1lbnQubmFtZX08L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPXtgdGV4dC1bMTBweF0gJHtpc01lID8gJ3RleHQtd2hpdGUvNjAnIDogJ3RleHQtdGV4dC1tdXRlZCd9YH0+Q2h1bmtlZCBpbWFnZSwgY2xpY2sgdG8gZG93bmxvYWQ8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8RG93bmxvYWQgY2xhc3NOYW1lPXtgdy00IGgtNCBzaHJpbmstMCAke2lzTWUgPyAndGV4dC13aGl0ZS82MCcgOiAndGV4dC10ZXh0LW11dGVkJ31gfSAvPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgIHttc2cuY29udGVudCAmJiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB4LTMuNSBweS0yLjVcIj5cbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwid2hpdGVzcGFjZS1wcmUtd3JhcCBicmVhay13b3Jkc1wiPlxuICAgICAgICAgICAgICAgICAgICAgIDxIaWdobGlnaHQgdGV4dD17bXNnLmNvbnRlbnR9IGhpZ2hsaWdodD17c2VhcmNoUXVlcnl9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YGZsZXggaXRlbXMtY2VudGVyIGdhcC0xIHB4LTMuNSBwYi0yICR7aXNNZSA/ICdqdXN0aWZ5LWVuZCcgOiAnanVzdGlmeS1zdGFydCd9YH0+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9e2B0ZXh0LVsxMHB4XSAke2lzTWUgPyAndGV4dC13aGl0ZS81MCcgOiAndGV4dC10ZXh0LW11dGVkJ31gfT5cbiAgICAgICAgICAgICAgICAgICAge25ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pfVxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BhYnNvbHV0ZSB0b3AtMSAke2lzTWUgPyAnbGVmdC0wIC10cmFuc2xhdGUteC05JyA6ICdyaWdodC0wIHRyYW5zbGF0ZS14LTknfSBmbGV4IGZsZXgtY29sIGdhcC0xIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHlgfT5cbiAgICAgICAgICAgICAgICAgIHttc2cuY29udGVudCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gaGFuZGxlQ29weShtc2cuY29udGVudCwgbXNnLmlkKX0gY2xhc3NOYW1lPVwicC0xIHJvdW5kZWQgYmctYmctc2Vjb25kYXJ5IGJvcmRlciBib3JkZXItYm9yZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAge2NvcGllZCA9PT0gbXNnLmlkID8gPENoZWNrIGNsYXNzTmFtZT1cInctMyBoLTMgdGV4dC1ncmVlblwiIC8+IDogPENvcHkgY2xhc3NOYW1lPVwidy0zIGgtMyB0ZXh0LXRleHQtbXV0ZWRcIiAvPn1cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRSZXBseVRvKHsgaWQ6IG1zZy5pZCwgZnJvbTogbXNnLmZyb20sIHRleHQ6IG1zZy5jb250ZW50IHx8IG1zZy5hdHRhY2htZW50Py5uYW1lIHx8ICcnIH0pfSBjbGFzc05hbWU9XCJwLTEgcm91bmRlZCBiZy1iZy1zZWNvbmRhcnkgYm9yZGVyIGJvcmRlci1ib3JkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPFJlcGx5IGNsYXNzTmFtZT1cInctMyBoLTMgdGV4dC10ZXh0LW11dGVkXCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvbW90aW9uLmRpdj5cbiAgICAgICAgICApO1xuICAgICAgICB9KX1cbiAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSAvPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxBbmltYXRlUHJlc2VuY2U+XG4gICAgICAgIHtyZXBseVRvICYmIChcbiAgICAgICAgICA8bW90aW9uLmRpdiBpbml0aWFsPXt7IGhlaWdodDogMCwgb3BhY2l0eTogMCB9fSBhbmltYXRlPXt7IGhlaWdodDogJ2F1dG8nLCBvcGFjaXR5OiAxIH19IGV4aXQ9e3sgaGVpZ2h0OiAwLCBvcGFjaXR5OiAwIH19IGNsYXNzTmFtZT1cInB4LTQgcHktMiBib3JkZXItdCBib3JkZXItYm9yZGVyIGJnLWJnLXNlY29uZGFyeS80MCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1zdGFydCBqdXN0aWZ5LWJldHdlZW4gZ2FwLTNcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtaW4tdy0wXCI+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1bMTFweF0gdGV4dC10ZXh0LW11dGVkXCI+UmVwbHkgdG8ge3JlcGx5VG8uZnJvbSA9PT0gbm9zdHJDbGllbnQucHVibGljS2V5ID8gJ3lvdScgOiBub3N0ckNsaWVudC5zaG9ydGVuS2V5KHJlcGx5VG8uZnJvbSl9PC9wPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC10ZXh0LXNlY29uZGFyeSB0cnVuY2F0ZVwiPntyZXBseVRvLnRleHQgfHwgJyhhdHRhY2htZW50KSd9PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBzZXRSZXBseVRvKG51bGwpfSBjbGFzc05hbWU9XCJwLTEuNSByb3VuZGVkIGhvdmVyOmJnLWJnLWhvdmVyXCI+PFggY2xhc3NOYW1lPVwidy0zLjUgaC0zLjUgdGV4dC10ZXh0LW11dGVkXCIgLz48L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvbW90aW9uLmRpdj5cbiAgICAgICAgKX1cbiAgICAgIDwvQW5pbWF0ZVByZXNlbmNlPlxuXG4gICAgICA8QW5pbWF0ZVByZXNlbmNlPlxuICAgICAgICB7cGVuZGluZ0F0dGFjaG1lbnQgJiYgKFxuICAgICAgICAgIDxtb3Rpb24uZGl2IGluaXRpYWw9e3sgaGVpZ2h0OiAwLCBvcGFjaXR5OiAwIH19IGFuaW1hdGU9e3sgaGVpZ2h0OiAnYXV0bycsIG9wYWNpdHk6IDEgfX0gZXhpdD17eyBoZWlnaHQ6IDAsIG9wYWNpdHk6IDAgfX0gY2xhc3NOYW1lPVwicHgtNCBib3JkZXItdCBib3JkZXItYm9yZGVyIGJnLWJnLXNlY29uZGFyeS8zMCBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHktMyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtM1wiPlxuICAgICAgICAgICAgICB7cGVuZGluZ0F0dGFjaG1lbnQudHlwZSA9PT0gJ2ltYWdlJyAmJiBwZW5kaW5nQXR0YWNobWVudC5kYXRhID8gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xNiBoLTE2IHJvdW5kZWQteGwgb3ZlcmZsb3ctaGlkZGVuIGJvcmRlciBib3JkZXItYm9yZGVyIHNocmluay0wXCI+XG4gICAgICAgICAgICAgICAgICA8TmV4dEltYWdlIHNyYz17YGRhdGE6JHtwZW5kaW5nQXR0YWNobWVudC5taW1lVHlwZX07YmFzZTY0LCR7cGVuZGluZ0F0dGFjaG1lbnQuZGF0YX1gfSBhbHQ9XCJBdHRhY2htZW50IHByZXZpZXdcIiB3aWR0aD17NjR9IGhlaWdodD17NjR9IGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyXCIgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTYgaC0xNiByb3VuZGVkLXhsIGJnLWJnLXRlcnRpYXJ5IGJvcmRlciBib3JkZXItYm9yZGVyIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRleHQtMnhsIHNocmluay0wXCI+e2dldEZpbGVJY29uKHBlbmRpbmdBdHRhY2htZW50Lm1pbWVUeXBlKX08L2Rpdj5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgbWluLXctMFwiPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC10ZXh0IHRydW5jYXRlXCI+e3BlbmRpbmdBdHRhY2htZW50Lm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC10ZXh0LW11dGVkXCI+e2Zvcm1hdEZpbGVTaXplKHBlbmRpbmdBdHRhY2htZW50LnNpemUpfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0UGVuZGluZ0F0dGFjaG1lbnQobnVsbCl9IGNsYXNzTmFtZT1cInAtMiByb3VuZGVkLWxnIGhvdmVyOmJnLWJnLWhvdmVyIHRleHQtdGV4dC1tdXRlZCBob3Zlcjp0ZXh0LXJlZCB0cmFuc2l0aW9uLWNvbG9yc1wiPlxuICAgICAgICAgICAgICAgIDxYIGNsYXNzTmFtZT1cInctNCBoLTRcIiAvPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvbW90aW9uLmRpdj5cbiAgICAgICAgKX1cbiAgICAgIDwvQW5pbWF0ZVByZXNlbmNlPlxuXG4gICAgICA8QW5pbWF0ZVByZXNlbmNlPlxuICAgICAgICB7c2VuZFByb2dyZXNzICYmIChcbiAgICAgICAgICA8bW90aW9uLmRpdiBpbml0aWFsPXt7IGhlaWdodDogMCwgb3BhY2l0eTogMCB9fSBhbmltYXRlPXt7IGhlaWdodDogJ2F1dG8nLCBvcGFjaXR5OiAxIH19IGV4aXQ9e3sgaGVpZ2h0OiAwLCBvcGFjaXR5OiAwIH19IGNsYXNzTmFtZT1cInB4LTQgYm9yZGVyLXQgYm9yZGVyLWJvcmRlciBiZy1iZy1zZWNvbmRhcnkvMzAgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB5LTJcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gdGV4dC14cyB0ZXh0LXRleHQtc2Vjb25kYXJ5IG1iLTFcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMS41XCI+XG4gICAgICAgICAgICAgICAgICA8TG9hZGVyMiBjbGFzc05hbWU9XCJ3LTMgaC0zIGFuaW1hdGUtc3BpblwiIC8+XG4gICAgICAgICAgICAgICAgICBVcGxvYWRpbmcuLi5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPHNwYW4+e3NlbmRQcm9ncmVzcy5zZW50fS97c2VuZFByb2dyZXNzLnRvdGFsfSBjaHVua3M8L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCBoLTEuNSBiZy1iZy10ZXJ0aWFyeSByb3VuZGVkLWZ1bGwgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICAgICAgICAgICAgPG1vdGlvbi5kaXYgY2xhc3NOYW1lPVwiaC1mdWxsIGJnLWFjY2VudCByb3VuZGVkLWZ1bGxcIiBpbml0aWFsPXt7IHdpZHRoOiAwIH19IGFuaW1hdGU9e3sgd2lkdGg6IGAkeyhzZW5kUHJvZ3Jlc3Muc2VudCAvIHNlbmRQcm9ncmVzcy50b3RhbCkgKiAxMDB9JWAgfX0gdHJhbnNpdGlvbj17eyBkdXJhdGlvbjogMC4yIH19IC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9tb3Rpb24uZGl2PlxuICAgICAgICApfVxuICAgICAgPC9BbmltYXRlUHJlc2VuY2U+XG5cbiAgICAgIDxBbmltYXRlUHJlc2VuY2U+XG4gICAgICAgIHtlcnJvciAmJiAoXG4gICAgICAgICAgPG1vdGlvbi5kaXYgaW5pdGlhbD17eyBoZWlnaHQ6IDAsIG9wYWNpdHk6IDAgfX0gYW5pbWF0ZT17eyBoZWlnaHQ6ICdhdXRvJywgb3BhY2l0eTogMSB9fSBleGl0PXt7IGhlaWdodDogMCwgb3BhY2l0eTogMCB9fSBjbGFzc05hbWU9XCJweC00IHB5LTIgYmctcmVkLWRpbSBib3JkZXItdCBib3JkZXItcmVkLzIwXCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtcmVkXCI+e2Vycm9yfTwvcD5cbiAgICAgICAgICA8L21vdGlvbi5kaXY+XG4gICAgICAgICl9XG4gICAgICA8L0FuaW1hdGVQcmVzZW5jZT5cblxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJweC00IHB5LTMgYm9yZGVyLXQgYm9yZGVyLWJvcmRlciBiZy1iZy1zZWNvbmRhcnkvMzBcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWVuZCBnYXAtMlwiPlxuICAgICAgICAgIHshaXNDaGFubmVsICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTAuNSBwYi0xXCI+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gaW1hZ2VJbnB1dFJlZi5jdXJyZW50Py5jbGljaygpfSBjbGFzc05hbWU9XCJwLTIgcm91bmRlZC1sZyBob3ZlcjpiZy1iZy1ob3ZlciB0ZXh0LXRleHQtbXV0ZWQgaG92ZXI6dGV4dC1hY2NlbnQgdHJhbnNpdGlvbi1jb2xvcnNcIiB0aXRsZT1cIlNlbmQgaW1hZ2VcIiBkaXNhYmxlZD17c2VuZGluZ30+XG4gICAgICAgICAgICAgICAgPEltYWdlSWNvbiBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gZmlsZUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCl9IGNsYXNzTmFtZT1cInAtMiByb3VuZGVkLWxnIGhvdmVyOmJnLWJnLWhvdmVyIHRleHQtdGV4dC1tdXRlZCBob3Zlcjp0ZXh0LWFjY2VudCB0cmFuc2l0aW9uLWNvbG9yc1wiIHRpdGxlPVwiU2VuZCBmaWxlXCIgZGlzYWJsZWQ9e3NlbmRpbmd9PlxuICAgICAgICAgICAgICAgIDxQYXBlcmNsaXAgY2xhc3NOYW1lPVwidy01IGgtNVwiIC8+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIDxpbnB1dCByZWY9e2ltYWdlSW5wdXRSZWZ9IHR5cGU9XCJmaWxlXCIgYWNjZXB0PVwiaW1hZ2UvKlwiIGNsYXNzTmFtZT1cImhpZGRlblwiIG9uQ2hhbmdlPXtoYW5kbGVGaWxlU2VsZWN0fSAvPlxuICAgICAgICAgIDxpbnB1dCByZWY9e2ZpbGVJbnB1dFJlZn0gdHlwZT1cImZpbGVcIiBjbGFzc05hbWU9XCJoaWRkZW5cIiBvbkNoYW5nZT17aGFuZGxlRmlsZVNlbGVjdH0gLz5cblxuICAgICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgICAgdmFsdWU9e2lucHV0fVxuICAgICAgICAgICAgb25DaGFuZ2U9e2UgPT4gc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgb25LZXlEb3duPXtlID0+IHtcbiAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGhhbmRsZVNlbmQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtwZW5kaW5nQXR0YWNobWVudCA/ICdBZGQgY2FwdGlvbi4uLicgOiAoaXNDaGFubmVsID8gJ1Bvc3QgbWVzc2FnZSB0byBjaGFubmVsLi4uJyA6ICdXcml0ZSBtZXNzYWdlLi4uJyl9XG4gICAgICAgICAgICByb3dzPXsxfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e3NlbmRpbmd9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTEgYmctYmctdGVydGlhcnkgYm9yZGVyIGJvcmRlci1ib3JkZXIgcm91bmRlZC14bCBweC00IHB5LTMgdGV4dC1zbSB0ZXh0LXRleHQgcGxhY2Vob2xkZXI6dGV4dC10ZXh0LW11dGVkIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpib3JkZXItYWNjZW50LzUwIHJlc2l6ZS1ub25lIG1heC1oLTMyIGRpc2FibGVkOm9wYWNpdHktNTBcIlxuICAgICAgICAgICAgc3R5bGU9e3sgbWluSGVpZ2h0OiAnNDRweCcgfX1cbiAgICAgICAgICAvPlxuXG4gICAgICAgICAgPG1vdGlvbi5idXR0b24gd2hpbGVIb3Zlcj17eyBzY2FsZTogc2VuZGluZyA/IDEgOiAxLjA1IH19IHdoaWxlVGFwPXt7IHNjYWxlOiBzZW5kaW5nID8gMSA6IDAuOTUgfX0gb25DbGljaz17aGFuZGxlU2VuZH0gZGlzYWJsZWQ9eyghaW5wdXQudHJpbSgpICYmICFwZW5kaW5nQXR0YWNobWVudCkgfHwgc2VuZGluZ30gY2xhc3NOYW1lPVwicC0zIGJnLWFjY2VudCBob3ZlcjpiZy1hY2NlbnQtaG92ZXIgZGlzYWJsZWQ6b3BhY2l0eS0zMCBkaXNhYmxlZDpjdXJzb3Itbm90LWFsbG93ZWQgdGV4dC13aGl0ZSByb3VuZGVkLXhsIHRyYW5zaXRpb24tY29sb3JzIHNocmluay0wXCI+XG4gICAgICAgICAgICB7c2VuZGluZyA/IDxMb2FkZXIyIGNsYXNzTmFtZT1cInctNSBoLTUgYW5pbWF0ZS1zcGluXCIgLz4gOiA8U2VuZCBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz59XG4gICAgICAgICAgPC9tb3Rpb24uYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8QW5pbWF0ZVByZXNlbmNlPlxuICAgICAgICB7cHJldmlld0ltYWdlICYmIChcbiAgICAgICAgICA8bW90aW9uLmRpdiBpbml0aWFsPXt7IG9wYWNpdHk6IDAgfX0gYW5pbWF0ZT17eyBvcGFjaXR5OiAxIH19IGV4aXQ9e3sgb3BhY2l0eTogMCB9fSBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIHotWzkwXSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1ibGFjay85MCBiYWNrZHJvcC1ibHVyLXNtIHAtNFwiIG9uQ2xpY2s9eygpID0+IHNldFByZXZpZXdJbWFnZShudWxsKX0+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImFic29sdXRlIHRvcC00IHJpZ2h0LTQgcC0yIHJvdW5kZWQtbGcgYmctd2hpdGUvMTAgdGV4dC13aGl0ZSBob3ZlcjpiZy13aGl0ZS8yMCB0cmFuc2l0aW9uLWNvbG9ycyB6LTEwXCIgb25DbGljaz17KCkgPT4gc2V0UHJldmlld0ltYWdlKG51bGwpfT5cbiAgICAgICAgICAgICAgPFggY2xhc3NOYW1lPVwidy02IGgtNlwiIC8+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDxtb3Rpb24uZGl2IGluaXRpYWw9e3sgc2NhbGU6IDAuOSB9fSBhbmltYXRlPXt7IHNjYWxlOiAxIH19IGV4aXQ9e3sgc2NhbGU6IDAuOSB9fSBjbGFzc05hbWU9XCJyZWxhdGl2ZSBtYXgtdy1mdWxsIG1heC1oLWZ1bGxcIiBvbkNsaWNrPXtlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCl9PlxuICAgICAgICAgICAgICA8TmV4dEltYWdlIHNyYz17cHJldmlld0ltYWdlfSBhbHQ9XCJJbWFnZSBwcmV2aWV3XCIgbGF5b3V0PVwiZmlsbFwiIG9iamVjdEZpdD1cImNvbnRhaW5cIiBjbGFzc05hbWU9XCJyb3VuZGVkLWxnXCIgLz5cbiAgICAgICAgICAgIDwvbW90aW9uLmRpdj5cbiAgICAgICAgICA8L21vdGlvbi5kaXY+XG4gICAgICAgICl9XG4gICAgICA8L0FuaW1hdGVQcmVzZW5jZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ1c2VDYWxsYmFjayIsInVzZUVmZmVjdCIsInVzZU1lbW8iLCJ1c2VSZWYiLCJ1c2VTdGF0ZSIsIkFuaW1hdGVQcmVzZW5jZSIsIm1vdGlvbiIsIkFycm93TGVmdCIsIkNoZWNrIiwiQ29weSIsIkRvd25sb2FkIiwiSGFzaCIsIkltYWdlIiwiSW1hZ2VJY29uIiwiTG9hZGVyMiIsIk1lbnUiLCJQYXBlcmNsaXAiLCJSZXBseSIsIlNlbmQiLCJTZWFyY2giLCJYIiwiTmV4dEltYWdlIiwibm9zdHJDbGllbnQiLCJhZGRDaGFubmVsTWVzc2FnZSIsImFkZE1lc3NhZ2UiLCJnZXRDaGFubmVsTWVzc2FnZXMiLCJnZXRNZXNzYWdlcyIsImdvQmFja1RvU2lkZWJhciIsInRvZ2dsZVNpZGViYXIiLCJ1cGRhdGVDb250YWN0UHJvZmlsZSIsInVzZUFwcFN0YXRlIiwiZG93bmxvYWRDaHVua2VkVHJhbnNmZXIiLCJkb3dubG9hZEF0dGFjaG1lbnQiLCJmb3JtYXRGaWxlU2l6ZSIsImdldEZpbGVJY29uIiwicHJvY2Vzc0ZpbGUiLCJBdmF0YXIiLCJWaWRlb0NhbGwiLCJIaWdobGlnaHQiLCJ0ZXh0IiwiaGlnaGxpZ2h0IiwidHJpbSIsInNwYW4iLCJyZWdleCIsIlJlZ0V4cCIsInBhcnRzIiwic3BsaXQiLCJtYXAiLCJwYXJ0IiwiaSIsInRlc3QiLCJtYXJrIiwiY2xhc3NOYW1lIiwiQ2hhdFZpZXciLCJhY3RpdmVDaGF0IiwiY29udGFjdHMiLCJjaGFubmVscyIsImlzQ2hhbm5lbCIsInN0YXJ0c1dpdGgiLCJjaGFubmVsSWQiLCJzbGljZSIsImxlbmd0aCIsImlucHV0Iiwic2V0SW5wdXQiLCJzZW5kaW5nIiwic2V0U2VuZGluZyIsIm1lc3NhZ2VzIiwic2V0TWVzc2FnZXMiLCJwZW5kaW5nQXR0YWNobWVudCIsInNldFBlbmRpbmdBdHRhY2htZW50Iiwic2VuZFByb2dyZXNzIiwic2V0U2VuZFByb2dyZXNzIiwicmVwbHlUbyIsInNldFJlcGx5VG8iLCJwcmV2aWV3SW1hZ2UiLCJzZXRQcmV2aWV3SW1hZ2UiLCJlcnJvciIsInNldEVycm9yIiwiY29waWVkIiwic2V0Q29waWVkIiwic2VhcmNoUXVlcnkiLCJzZXRTZWFyY2hRdWVyeSIsImlzU2VhcmNoVmlzaWJsZSIsInNldElzU2VhcmNoVmlzaWJsZSIsIm1lc3NhZ2VzRW5kUmVmIiwiaW1hZ2VJbnB1dFJlZiIsImZpbGVJbnB1dFJlZiIsInNlYXJjaElucHV0UmVmIiwiY29udGFjdCIsImZpbmQiLCJjIiwicHVia2V5IiwiY2hhbm5lbCIsImlkIiwiY3VycmVudCIsImZvY3VzIiwiZmlsdGVyZWRNZXNzYWdlcyIsImZpbHRlciIsIm1zZyIsImNvbnRlbnQiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmVxdWVzdFByb2ZpbGUiLCJ1bnN1Yk1zZyIsIm9uTWVzc2FnZSIsInVuc3ViQ2hhbm5lbCIsIm9uQ2hhbm5lbE1lc3NhZ2UiLCJ1bnN1YiIsIm9uUHJvZmlsZSIsInByb2ZpbGUiLCJuYW1lIiwicGljdHVyZSIsImFib3V0Iiwic2Nyb2xsSW50b1ZpZXciLCJiZWhhdmlvciIsImhhbmRsZVNlbmQiLCJFcnJvciIsInNlbmRDaGFubmVsTWVzc2FnZSIsInVuZGVmaW5lZCIsInNlbmRBdHRhY2htZW50Iiwic2VudCIsInRvdGFsIiwic2VuZERpcmVjdE1lc3NhZ2UiLCJlcnIiLCJtZXNzYWdlIiwiaGFuZGxlRmlsZVNlbGVjdCIsImUiLCJmaWxlIiwidGFyZ2V0IiwiZmlsZXMiLCJ2YWx1ZSIsImF0dGFjaG1lbnQiLCJoYW5kbGVDb3B5IiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwid3JpdGVUZXh0Iiwic2V0VGltZW91dCIsImhhbmRsZURvd25sb2FkIiwiY2h1bmtlZCIsInRyYW5zZmVySWQiLCJtaW1lVHlwZSIsImRpdiIsImgyIiwic3R5bGUiLCJmb250RmFtaWx5IiwicCIsImJ1dHRvbiIsIm9uQ2xpY2siLCJzaXplIiwic2hvd0JvcmRlciIsImluaXRpYWwiLCJtb2RlIiwib3BhY2l0eSIsInkiLCJhbmltYXRlIiwiZXhpdCIsInRyYW5zaXRpb24iLCJkdXJhdGlvbiIsInJlZiIsInR5cGUiLCJvbkNoYW5nZSIsInBsYWNlaG9sZGVyIiwic2hvcnRlbktleSIsInRpdGxlIiwicHJpdmF0ZUtleSIsInJlY2lwaWVudFB1YmtleSIsImlzTWUiLCJmcm9tIiwicHVibGljS2V5IiwibXNnVHlwZSIsImRhdGEiLCJzcmMiLCJhbHQiLCJ3aWR0aCIsImhlaWdodCIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJob3VyIiwibWludXRlIiwiY2xpY2siLCJkaXNhYmxlZCIsImFjY2VwdCIsInRleHRhcmVhIiwib25LZXlEb3duIiwia2V5Iiwic2hpZnRLZXkiLCJwcmV2ZW50RGVmYXVsdCIsInJvd3MiLCJtaW5IZWlnaHQiLCJ3aGlsZUhvdmVyIiwic2NhbGUiLCJ3aGlsZVRhcCIsInN0b3BQcm9wYWdhdGlvbiIsImxheW91dCIsIm9iamVjdEZpdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/ChatView.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/components/VideoCall.tsx":
/*!**************************************!*\
  !*** ./src/components/VideoCall.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VideoCall: function() { return /* binding */ VideoCall; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _hooks_useCall__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../hooks/useCall */ \"(app-pages-browser)/./src/hooks/useCall.ts\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/phone-off.js\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/phone.js\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic-off.js\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/mic.js\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/video-off.js\");\n/* harmony import */ var _barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! __barrel_optimize__?names=Mic,MicOff,Phone,PhoneOff,Video,VideoOff!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/video.js\");\n\nvar _s = $RefreshSig$();\n\n\n\nconst VideoCall = (param)=>{\n    let { privateKey, recipientPubkey } = param;\n    _s();\n    const { callState, localStream, remoteStream, formattedDuration, isMuted, isVideoOff, incomingCall, startCall, acceptCall, rejectCall, endCall, toggleMute, toggleVideo } = (0,_hooks_useCall__WEBPACK_IMPORTED_MODULE_2__.useCall)(privateKey);\n    const localVideoRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const remoteVideoRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    //    video \n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (localVideoRef.current && localStream) {\n            localVideoRef.current.srcObject = localStream;\n        }\n    }, [\n        localStream\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (remoteVideoRef.current && remoteStream) {\n            remoteVideoRef.current.srcObject = remoteStream;\n        }\n    }, [\n        remoteStream\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: [\n            incomingCall && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed inset-0 z-[100] flex items-center justify-center bg-black/50\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"bg-white rounded-lg p-8 shadow-2xl text-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                            className: \"text-xl font-bold\",\n                            children: [\n                                \" \",\n                                incomingCall.callType === \"video\" ? \"\" : \"\",\n                                \" \"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                            lineNumber: 49,\n                            columnNumber: 13\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                            className: \"text-gray-600 mt-2\",\n                            children: [\n                                \" \",\n                                incomingCall.callerPubkey.slice(0, 16),\n                                \"...\"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                            lineNumber: 50,\n                            columnNumber: 13\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"mt-6 flex justify-center gap-4\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    className: \"bg-red-500 text-white rounded-full p-4\",\n                                    onClick: rejectCall,\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {}, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                        lineNumber: 53,\n                                        columnNumber: 17\n                                    }, undefined)\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 52,\n                                    columnNumber: 15\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    className: \"bg-green-500 text-white rounded-full p-4\",\n                                    onClick: acceptCall,\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {}, void 0, false, {\n                                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                        lineNumber: 56,\n                                        columnNumber: 17\n                                    }, undefined)\n                                }, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 55,\n                                    columnNumber: 15\n                                }, undefined)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                            lineNumber: 51,\n                            columnNumber: 13\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                    lineNumber: 48,\n                    columnNumber: 11\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                lineNumber: 47,\n                columnNumber: 9\n            }, undefined),\n            callState !== \"idle\" && !incomingCall && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed inset-0 z-[100] bg-black text-white flex flex-col\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"video\", {\n                        ref: remoteVideoRef,\n                        autoPlay: true,\n                        playsInline: true,\n                        className: \"w-full h-full object-cover\"\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 67,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"video\", {\n                        ref: localVideoRef,\n                        autoPlay: true,\n                        playsInline: true,\n                        muted: true,\n                        className: \"absolute top-4 right-4 w-1/4 max-w-xs border-2 border-white rounded-lg\"\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 75,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"absolute top-4 left-4 bg-black/50 p-2 rounded\",\n                        children: [\n                            callState === \"calling\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                children: \" ...\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 85,\n                                columnNumber: 41\n                            }, undefined),\n                            callState === \"connecting\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                children: \"...\"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 86,\n                                columnNumber: 44\n                            }, undefined),\n                            callState === \"connected\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                children: formattedDuration\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 87,\n                                columnNumber: 43\n                            }, undefined),\n                            callState === \"ended\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                children: \" \"\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 88,\n                                columnNumber: 39\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 84,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"absolute bottom-8 left-1/2 -translate-x-1/2 flex gap-4\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                className: \"p-4 rounded-full \".concat(isMuted ? \"bg-red-500\" : \"bg-gray-700\"),\n                                onClick: toggleMute,\n                                children: isMuted ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {}, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 97,\n                                    columnNumber: 26\n                                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {}, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 97,\n                                    columnNumber: 39\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 93,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                className: \"p-4 rounded-full \".concat(isVideoOff ? \"bg-red-500\" : \"bg-gray-700\"),\n                                onClick: toggleVideo,\n                                children: isVideoOff ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {}, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 104,\n                                    columnNumber: 29\n                                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {}, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 104,\n                                    columnNumber: 44\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 100,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                className: \"p-4 rounded-full bg-red-600\",\n                                onClick: ()=>endCall(),\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {}, void 0, false, {\n                                    fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                    lineNumber: 108,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                                lineNumber: 107,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 92,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                lineNumber: 65,\n                columnNumber: 9\n            }, undefined),\n            callState === \"idle\" && recipientPubkey && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex gap-2\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        className: \"bg-blue-500 text-white p-2 rounded\",\n                        onClick: ()=>startCall(recipientPubkey, \"audio\"),\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {}, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                            lineNumber: 118,\n                            columnNumber: 13\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 117,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        className: \"bg-blue-500 text-white p-2 rounded\",\n                        onClick: ()=>startCall(recipientPubkey, \"video\"),\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Mic_MicOff_Phone_PhoneOff_Video_VideoOff_lucide_react__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {}, void 0, false, {\n                            fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                            lineNumber: 121,\n                            columnNumber: 13\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                        lineNumber: 120,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/user/nostr/src/components/VideoCall.tsx\",\n                lineNumber: 116,\n                columnNumber: 9\n            }, undefined)\n        ]\n    }, void 0, true);\n};\n_s(VideoCall, \"7YEAtnJZ3P6ufgYPcghRQxk62lE=\", false, function() {\n    return [\n        _hooks_useCall__WEBPACK_IMPORTED_MODULE_2__.useCall\n    ];\n});\n_c = VideoCall;\nvar _c;\n$RefreshReg$(_c, \"VideoCall\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL1ZpZGVvQ2FsbC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFpRDtBQUNOO0FBQ2tDO0FBT3RFLE1BQU1VLFlBQXNDO1FBQUMsRUFBRUMsVUFBVSxFQUFFQyxlQUFlLEVBQUU7O0lBQ2pGLE1BQU0sRUFDSkMsU0FBUyxFQUNUQyxXQUFXLEVBQ1hDLFlBQVksRUFDWkMsaUJBQWlCLEVBQ2pCQyxPQUFPLEVBQ1BDLFVBQVUsRUFDVkMsWUFBWSxFQUNaQyxTQUFTLEVBQ1RDLFVBQVUsRUFDVkMsVUFBVSxFQUNWQyxPQUFPLEVBQ1BDLFVBQVUsRUFDVkMsV0FBVyxFQUNaLEdBQUd0Qix1REFBT0EsQ0FBQ1E7SUFFWixNQUFNZSxnQkFBZ0J6Qiw2Q0FBTUEsQ0FBbUI7SUFDL0MsTUFBTTBCLGlCQUFpQjFCLDZDQUFNQSxDQUFtQjtJQUVoRCx1Q0FBdUM7SUFDdkNDLGdEQUFTQSxDQUFDO1FBQ1IsSUFBSXdCLGNBQWNFLE9BQU8sSUFBSWQsYUFBYTtZQUN4Q1ksY0FBY0UsT0FBTyxDQUFDQyxTQUFTLEdBQUdmO1FBQ3BDO0lBQ0YsR0FBRztRQUFDQTtLQUFZO0lBRWhCWixnREFBU0EsQ0FBQztRQUNSLElBQUl5QixlQUFlQyxPQUFPLElBQUliLGNBQWM7WUFDMUNZLGVBQWVDLE9BQU8sQ0FBQ0MsU0FBUyxHQUFHZDtRQUNyQztJQUNGLEdBQUc7UUFBQ0E7S0FBYTtJQUVqQixxQkFDRTs7WUFFR0ksOEJBQ0MsOERBQUNXO2dCQUFJQyxXQUFVOzBCQUNiLDRFQUFDRDtvQkFBSUMsV0FBVTs7c0NBQ2IsOERBQUNDOzRCQUFHRCxXQUFVOztnQ0FBb0I7Z0NBQVVaLGFBQWFjLFFBQVEsS0FBSyxVQUFVLFVBQVU7Z0NBQVE7Ozs7Ozs7c0NBQ2xHLDhEQUFDQzs0QkFBRUgsV0FBVTs7Z0NBQXFCO2dDQUFJWixhQUFhZ0IsWUFBWSxDQUFDQyxLQUFLLENBQUMsR0FBRztnQ0FBSTs7Ozs7OztzQ0FDN0UsOERBQUNOOzRCQUFJQyxXQUFVOzs4Q0FDYiw4REFBQ007b0NBQU9OLFdBQVU7b0NBQXlDTyxTQUFTaEI7OENBQ2xFLDRFQUFDakIsb0hBQVFBOzs7Ozs7Ozs7OzhDQUVYLDhEQUFDZ0M7b0NBQU9OLFdBQVU7b0NBQTJDTyxTQUFTakI7OENBQ3BFLDRFQUFDakIsb0hBQUtBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7WUFRZlMsY0FBYyxVQUFVLENBQUNNLDhCQUN4Qiw4REFBQ1c7Z0JBQUlDLFdBQVU7O2tDQUViLDhEQUFDUTt3QkFDQ0MsS0FBS2I7d0JBQ0xjLFFBQVE7d0JBQ1JDLFdBQVc7d0JBQ1hYLFdBQVU7Ozs7OztrQ0FJWiw4REFBQ1E7d0JBQ0NDLEtBQUtkO3dCQUNMZSxRQUFRO3dCQUNSQyxXQUFXO3dCQUNYQyxLQUFLO3dCQUNMWixXQUFVOzs7Ozs7a0NBSVosOERBQUNEO3dCQUFJQyxXQUFVOzs0QkFDWmxCLGNBQWMsMkJBQWEsOERBQUNxQjswQ0FBRTs7Ozs7OzRCQUM5QnJCLGNBQWMsOEJBQWdCLDhEQUFDcUI7MENBQUU7Ozs7Ozs0QkFDakNyQixjQUFjLDZCQUFlLDhEQUFDcUI7MENBQUdsQjs7Ozs7OzRCQUNqQ0gsY0FBYyx5QkFBVyw4REFBQ3FCOzBDQUFFOzs7Ozs7Ozs7Ozs7a0NBSS9CLDhEQUFDSjt3QkFBSUMsV0FBVTs7MENBQ2IsOERBQUNNO2dDQUNDTixXQUFXLG9CQUEyRCxPQUF2Q2QsVUFBVSxlQUFlO2dDQUN4RHFCLFNBQVNkOzBDQUVSUCx3QkFBVSw4REFBQ1Isb0hBQU1BOzs7OzhEQUFNLDhEQUFDRCxvSEFBR0E7Ozs7Ozs7Ozs7MENBRzlCLDhEQUFDNkI7Z0NBQ0NOLFdBQVcsb0JBQThELE9BQTFDYixhQUFhLGVBQWU7Z0NBQzNEb0IsU0FBU2I7MENBRVJQLDJCQUFhLDhEQUFDWCxvSEFBUUE7Ozs7OERBQU0sOERBQUNELG9IQUFLQTs7Ozs7Ozs7OzswQ0FHckMsOERBQUMrQjtnQ0FBT04sV0FBVTtnQ0FBOEJPLFNBQVMsSUFBTWY7MENBQzdELDRFQUFDbEIsb0hBQVFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1lBT2hCUSxjQUFjLFVBQVVELGlDQUN2Qiw4REFBQ2tCO2dCQUFJQyxXQUFVOztrQ0FDYiw4REFBQ007d0JBQU9OLFdBQVU7d0JBQXFDTyxTQUFTLElBQU1sQixVQUFVUixpQkFBaUI7a0NBQy9GLDRFQUFDUixvSEFBS0E7Ozs7Ozs7Ozs7a0NBRVIsOERBQUNpQzt3QkFBT04sV0FBVTt3QkFBcUNPLFNBQVMsSUFBTWxCLFVBQVVSLGlCQUFpQjtrQ0FDL0YsNEVBQUNOLG9IQUFLQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTWxCLEVBQUU7R0FySFdJOztRQWVQUCxtREFBT0E7OztLQWZBTyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvY29tcG9uZW50cy9WaWRlb0NhbGwudHN4P2RhZjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVJlZiwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlQ2FsbCB9IGZyb20gJy4uL2hvb2tzL3VzZUNhbGwnO1xuaW1wb3J0IHsgUGhvbmUsIFBob25lT2ZmLCBWaWRlbywgVmlkZW9PZmYsIE1pYywgTWljT2ZmIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcblxuaW50ZXJmYWNlIFZpZGVvQ2FsbFByb3BzIHtcbiAgcHJpdmF0ZUtleTogVWludDhBcnJheTtcbiAgcmVjaXBpZW50UHVia2V5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgVmlkZW9DYWxsOiBSZWFjdC5GQzxWaWRlb0NhbGxQcm9wcz4gPSAoeyBwcml2YXRlS2V5LCByZWNpcGllbnRQdWJrZXkgfSkgPT4ge1xuICBjb25zdCB7XG4gICAgY2FsbFN0YXRlLFxuICAgIGxvY2FsU3RyZWFtLFxuICAgIHJlbW90ZVN0cmVhbSxcbiAgICBmb3JtYXR0ZWREdXJhdGlvbixcbiAgICBpc011dGVkLFxuICAgIGlzVmlkZW9PZmYsXG4gICAgaW5jb21pbmdDYWxsLFxuICAgIHN0YXJ0Q2FsbCxcbiAgICBhY2NlcHRDYWxsLFxuICAgIHJlamVjdENhbGwsXG4gICAgZW5kQ2FsbCxcbiAgICB0b2dnbGVNdXRlLFxuICAgIHRvZ2dsZVZpZGVvLFxuICB9ID0gdXNlQ2FsbChwcml2YXRlS2V5KTtcblxuICBjb25zdCBsb2NhbFZpZGVvUmVmID0gdXNlUmVmPEhUTUxWaWRlb0VsZW1lbnQ+KG51bGwpO1xuICBjb25zdCByZW1vdGVWaWRlb1JlZiA9IHVzZVJlZjxIVE1MVmlkZW9FbGVtZW50PihudWxsKTtcblxuICAvLyDQn9GA0LjQstGP0LfRi9Cy0LDQtdC8INC/0L7RgtC+0LrQuCDQuiB2aWRlbyDRjdC70LXQvNC10L3RgtCw0LxcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAobG9jYWxWaWRlb1JlZi5jdXJyZW50ICYmIGxvY2FsU3RyZWFtKSB7XG4gICAgICBsb2NhbFZpZGVvUmVmLmN1cnJlbnQuc3JjT2JqZWN0ID0gbG9jYWxTdHJlYW07XG4gICAgfVxuICB9LCBbbG9jYWxTdHJlYW1dKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChyZW1vdGVWaWRlb1JlZi5jdXJyZW50ICYmIHJlbW90ZVN0cmVhbSkge1xuICAgICAgcmVtb3RlVmlkZW9SZWYuY3VycmVudC5zcmNPYmplY3QgPSByZW1vdGVTdHJlYW07XG4gICAgfVxuICB9LCBbcmVtb3RlU3RyZWFtXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgey8qID09PT09PT09PT09PT0g0JLRhdC+0LTRj9GJ0LjQuSDQt9Cy0L7QvdC+0LogPT09PT09PT09PT09PSAqL31cbiAgICAgIHtpbmNvbWluZ0NhbGwgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgei1bMTAwXSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1ibGFjay81MFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctd2hpdGUgcm91bmRlZC1sZyBwLTggc2hhZG93LTJ4bCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQteGwgZm9udC1ib2xkXCI+0JLRhdC+0LTRj9GJ0LjQuSB7aW5jb21pbmdDYWxsLmNhbGxUeXBlID09PSAndmlkZW8nID8gJ9Cy0LjQtNC10L4nIDogJ9Cw0YPQtNC40L4nfSDQt9Cy0L7QvdC+0Lo8L2gzPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTYwMCBtdC0yXCI+0L7RgiB7aW5jb21pbmdDYWxsLmNhbGxlclB1YmtleS5zbGljZSgwLCAxNil9Li4uPC9wPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC02IGZsZXgganVzdGlmeS1jZW50ZXIgZ2FwLTRcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJiZy1yZWQtNTAwIHRleHQtd2hpdGUgcm91bmRlZC1mdWxsIHAtNFwiIG9uQ2xpY2s9e3JlamVjdENhbGx9PlxuICAgICAgICAgICAgICAgIDxQaG9uZU9mZiAvPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJiZy1ncmVlbi01MDAgdGV4dC13aGl0ZSByb3VuZGVkLWZ1bGwgcC00XCIgb25DbGljaz17YWNjZXB0Q2FsbH0+XG4gICAgICAgICAgICAgICAgPFBob25lIC8+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgey8qID09PT09PT09PT09PT0g0JDQutGC0LjQstC90YvQuSDQt9Cy0L7QvdC+0LogPT09PT09PT09PT09PSAqL31cbiAgICAgIHtjYWxsU3RhdGUgIT09ICdpZGxlJyAmJiAhaW5jb21pbmdDYWxsICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIHotWzEwMF0gYmctYmxhY2sgdGV4dC13aGl0ZSBmbGV4IGZsZXgtY29sXCI+XG4gICAgICAgICAgey8qINCj0LTQsNC70ZHQvdC90L7QtSDQstC40LTQtdC+ICjQv9C+0LvQvdGL0Lkg0Y3QutGA0LDQvSkgKi99XG4gICAgICAgICAgPHZpZGVvXG4gICAgICAgICAgICByZWY9e3JlbW90ZVZpZGVvUmVmfVxuICAgICAgICAgICAgYXV0b1BsYXlcbiAgICAgICAgICAgIHBsYXlzSW5saW5lXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIG9iamVjdC1jb3ZlclwiXG4gICAgICAgICAgLz5cblxuICAgICAgICAgIHsvKiDQm9C+0LrQsNC70YzQvdC+0LUg0LLQuNC00LXQviAoUGlQKSAqL31cbiAgICAgICAgICA8dmlkZW9cbiAgICAgICAgICAgIHJlZj17bG9jYWxWaWRlb1JlZn1cbiAgICAgICAgICAgIGF1dG9QbGF5XG4gICAgICAgICAgICBwbGF5c0lubGluZVxuICAgICAgICAgICAgbXV0ZWRcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHRvcC00IHJpZ2h0LTQgdy0xLzQgbWF4LXcteHMgYm9yZGVyLTIgYm9yZGVyLXdoaXRlIHJvdW5kZWQtbGdcIlxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICB7Lyog0KHRgtCw0YLRg9GBINC30LLQvtC90LrQsCAqL31cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFic29sdXRlIHRvcC00IGxlZnQtNCBiZy1ibGFjay81MCBwLTIgcm91bmRlZFwiPlxuICAgICAgICAgICAge2NhbGxTdGF0ZSA9PT0gJ2NhbGxpbmcnICYmIDxwPtCh0L7QstC10YDRiNC10L3QuNC1INCy0YvQt9C+0LLQsC4uLjwvcD59XG4gICAgICAgICAgICB7Y2FsbFN0YXRlID09PSAnY29ubmVjdGluZycgJiYgPHA+0KHQvtC10LTQuNC90LXQvdC40LUuLi48L3A+fVxuICAgICAgICAgICAge2NhbGxTdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcgJiYgPHA+e2Zvcm1hdHRlZER1cmF0aW9ufTwvcD59XG4gICAgICAgICAgICB7Y2FsbFN0YXRlID09PSAnZW5kZWQnICYmIDxwPtCX0LLQvtC90L7QuiDQt9Cw0LLQtdGA0YjQtdC9PC9wPn1cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiDQn9Cw0L3QtdC70Ywg0YPQv9GA0LDQstC70LXQvdC40Y8gKi99XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBib3R0b20tOCBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIGZsZXggZ2FwLTRcIj5cbiAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgcC00IHJvdW5kZWQtZnVsbCAke2lzTXV0ZWQgPyAnYmctcmVkLTUwMCcgOiAnYmctZ3JheS03MDAnfWB9XG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3RvZ2dsZU11dGV9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpc011dGVkID8gPE1pY09mZiAvPiA6IDxNaWMgLz59XG4gICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2BwLTQgcm91bmRlZC1mdWxsICR7aXNWaWRlb09mZiA/ICdiZy1yZWQtNTAwJyA6ICdiZy1ncmF5LTcwMCd9YH1cbiAgICAgICAgICAgICAgb25DbGljaz17dG9nZ2xlVmlkZW99XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpc1ZpZGVvT2ZmID8gPFZpZGVvT2ZmIC8+IDogPFZpZGVvIC8+fVxuICAgICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwicC00IHJvdW5kZWQtZnVsbCBiZy1yZWQtNjAwXCIgb25DbGljaz17KCkgPT4gZW5kQ2FsbCgpfT5cbiAgICAgICAgICAgICAgPFBob25lT2ZmIC8+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7LyogPT09PT09PT09PT09PSDQmtC90L7Qv9C60Lgg0L3QsNGH0LDQu9CwINC30LLQvtC90LrQsCA9PT09PT09PT09PT09ICovfVxuICAgICAge2NhbGxTdGF0ZSA9PT0gJ2lkbGUnICYmIHJlY2lwaWVudFB1YmtleSAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMlwiPlxuICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYmctYmx1ZS01MDAgdGV4dC13aGl0ZSBwLTIgcm91bmRlZFwiIG9uQ2xpY2s9eygpID0+IHN0YXJ0Q2FsbChyZWNpcGllbnRQdWJrZXksICdhdWRpbycpfT5cbiAgICAgICAgICAgIDxQaG9uZSAvPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYmctYmx1ZS01MDAgdGV4dC13aGl0ZSBwLTIgcm91bmRlZFwiIG9uQ2xpY2s9eygpID0+IHN0YXJ0Q2FsbChyZWNpcGllbnRQdWJrZXksICd2aWRlbycpfT5cbiAgICAgICAgICAgIDxWaWRlbyAvPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC8+XG4gICk7XG59O1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwidXNlUmVmIiwidXNlRWZmZWN0IiwidXNlQ2FsbCIsIlBob25lIiwiUGhvbmVPZmYiLCJWaWRlbyIsIlZpZGVvT2ZmIiwiTWljIiwiTWljT2ZmIiwiVmlkZW9DYWxsIiwicHJpdmF0ZUtleSIsInJlY2lwaWVudFB1YmtleSIsImNhbGxTdGF0ZSIsImxvY2FsU3RyZWFtIiwicmVtb3RlU3RyZWFtIiwiZm9ybWF0dGVkRHVyYXRpb24iLCJpc011dGVkIiwiaXNWaWRlb09mZiIsImluY29taW5nQ2FsbCIsInN0YXJ0Q2FsbCIsImFjY2VwdENhbGwiLCJyZWplY3RDYWxsIiwiZW5kQ2FsbCIsInRvZ2dsZU11dGUiLCJ0b2dnbGVWaWRlbyIsImxvY2FsVmlkZW9SZWYiLCJyZW1vdGVWaWRlb1JlZiIsImN1cnJlbnQiLCJzcmNPYmplY3QiLCJkaXYiLCJjbGFzc05hbWUiLCJoMyIsImNhbGxUeXBlIiwicCIsImNhbGxlclB1YmtleSIsInNsaWNlIiwiYnV0dG9uIiwib25DbGljayIsInZpZGVvIiwicmVmIiwiYXV0b1BsYXkiLCJwbGF5c0lubGluZSIsIm11dGVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/VideoCall.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/hooks/useCall.ts":
/*!******************************!*\
  !*** ./src/hooks/useCall.ts ***!
  \******************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useCall: function() { return /* binding */ useCall; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_call_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/call-manager */ \"(app-pages-browser)/./src/lib/call-manager.ts\");\n/* harmony import */ var _lib_nostr_signaling__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/nostr-signaling */ \"(app-pages-browser)/./src/lib/nostr-signaling.ts\");\n\n\n\nfunction useCall(privateKey, relayUrl) {\n    const [callState, setCallState] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\"idle\");\n    const [localStream, setLocalStream] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [remoteStream, setRemoteStream] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [duration, setDuration] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0);\n    const [isMuted, setIsMuted] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [isVideoOff, setIsVideoOff] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [incomingCall, setIncomingCall] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const managerRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const signalingRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const signaling = new _lib_nostr_signaling__WEBPACK_IMPORTED_MODULE_2__.NostrSignaling(privateKey, relayUrl);\n        signalingRef.current = signaling;\n        const manager = new _lib_call_manager__WEBPACK_IMPORTED_MODULE_1__.CallManager(signaling, {\n            onStateChange: setCallState,\n            onLocalStream: setLocalStream,\n            onRemoteStream: setRemoteStream,\n            onCallDuration: setDuration,\n            onError: setError,\n            onIncomingCall: (callerPubkey, callId, callType)=>{\n                setIncomingCall({\n                    callerPubkey,\n                    callId,\n                    callType\n                });\n            }\n        });\n        managerRef.current = manager;\n        return ()=>{\n            manager.endCall(true);\n            signaling.destroy();\n        };\n    }, [\n        privateKey,\n        relayUrl\n    ]);\n    const startCall = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((recipientPubkey, type)=>{\n        var _managerRef_current;\n        (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.startCall(recipientPubkey, type);\n    }, []);\n    const acceptCall = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        var _managerRef_current;\n        (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.acceptCall();\n        setIncomingCall(null);\n    }, []);\n    const rejectCall = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        var _managerRef_current;\n        (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.rejectCall();\n        setIncomingCall(null);\n    }, []);\n    const endCall = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        var _managerRef_current;\n        (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.endCall(true);\n    }, []);\n    const toggleMute = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        var _managerRef_current;\n        const muted = (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.toggleMute();\n        setIsMuted(muted !== null && muted !== void 0 ? muted : false);\n    }, []);\n    const toggleVideo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        var _managerRef_current;\n        const off = (_managerRef_current = managerRef.current) === null || _managerRef_current === void 0 ? void 0 : _managerRef_current.toggleVideo();\n        setIsVideoOff(off !== null && off !== void 0 ? off : false);\n    }, []);\n    const formatDuration = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((secs)=>{\n        const m = Math.floor(secs / 60).toString().padStart(2, \"0\");\n        const s = (secs % 60).toString().padStart(2, \"0\");\n        return \"\".concat(m, \":\").concat(s);\n    }, []);\n    return {\n        callState,\n        localStream,\n        remoteStream,\n        duration,\n        formattedDuration: formatDuration(duration),\n        isMuted,\n        isVideoOff,\n        error,\n        incomingCall,\n        startCall,\n        acceptCall,\n        rejectCall,\n        endCall,\n        toggleMute,\n        toggleVideo\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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REFBV0EsQ0FBQyxDQUFDZ0Q7UUFDbEMsTUFBTUMsSUFBSUMsS0FBS0MsS0FBSyxDQUFDSCxPQUFPLElBQUlJLFFBQVEsR0FBR0MsUUFBUSxDQUFDLEdBQUc7UUFDdkQsTUFBTUMsSUFBSSxDQUFDTixPQUFPLEVBQUMsRUFBR0ksUUFBUSxHQUFHQyxRQUFRLENBQUMsR0FBRztRQUM3QyxPQUFPLEdBQVFDLE9BQUxMLEdBQUUsS0FBSyxPQUFGSztJQUNqQixHQUFHLEVBQUU7SUFFTCxPQUFPO1FBQ0xoRDtRQUNBRTtRQUNBRTtRQUNBRTtRQUNBMkMsbUJBQW1CUixlQUFlbkM7UUFDbENFO1FBQ0FFO1FBQ0FFO1FBQ0FFO1FBQ0FrQjtRQUNBRztRQUNBQztRQUNBTjtRQUNBTztRQUNBRTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2hvb2tzL3VzZUNhbGwudHM/MjI2OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ2FsbE1hbmFnZXIsIENhbGxTdGF0ZSwgQ2FsbFR5cGUgfSBmcm9tICcuLi9saWIvY2FsbC1tYW5hZ2VyJztcbmltcG9ydCB7IE5vc3RyU2lnbmFsaW5nIH0gZnJvbSAnLi4vbGliL25vc3RyLXNpZ25hbGluZyc7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYWxsKHByaXZhdGVLZXk6IFVpbnQ4QXJyYXksIHJlbGF5VXJsPzogc3RyaW5nKSB7XG4gIGNvbnN0IFtjYWxsU3RhdGUsIHNldENhbGxTdGF0ZV0gPSB1c2VTdGF0ZTxDYWxsU3RhdGU+KCdpZGxlJyk7XG4gIGNvbnN0IFtsb2NhbFN0cmVhbSwgc2V0TG9jYWxTdHJlYW1dID0gdXNlU3RhdGU8TWVkaWFTdHJlYW0gfCBudWxsPihudWxsKTtcbiAgY29uc3QgW3JlbW90ZVN0cmVhbSwgc2V0UmVtb3RlU3RyZWFtXSA9IHVzZVN0YXRlPE1lZGlhU3RyZWFtIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtkdXJhdGlvbiwgc2V0RHVyYXRpb25dID0gdXNlU3RhdGUoMCk7XG4gIGNvbnN0IFtpc011dGVkLCBzZXRJc011dGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzVmlkZW9PZmYsIHNldElzVmlkZW9PZmZdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaW5jb21pbmdDYWxsLCBzZXRJbmNvbWluZ0NhbGxdID0gdXNlU3RhdGU8e1xuICAgIGNhbGxlclB1YmtleTogc3RyaW5nO1xuICAgIGNhbGxJZDogc3RyaW5nO1xuICAgIGNhbGxUeXBlOiBDYWxsVHlwZTtcbiAgfSB8IG51bGw+KG51bGwpO1xuXG4gIGNvbnN0IG1hbmFnZXJSZWYgPSB1c2VSZWY8Q2FsbE1hbmFnZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3Qgc2lnbmFsaW5nUmVmID0gdXNlUmVmPE5vc3RyU2lnbmFsaW5nIHwgbnVsbD4obnVsbCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBzaWduYWxpbmcgPSBuZXcgTm9zdHJTaWduYWxpbmcocHJpdmF0ZUtleSwgcmVsYXlVcmwpO1xuICAgIHNpZ25hbGluZ1JlZi5jdXJyZW50ID0gc2lnbmFsaW5nO1xuXG4gICAgY29uc3QgbWFuYWdlciA9IG5ldyBDYWxsTWFuYWdlcihzaWduYWxpbmcsIHtcbiAgICAgIG9uU3RhdGVDaGFuZ2U6IHNldENhbGxTdGF0ZSxcbiAgICAgIG9uTG9jYWxTdHJlYW06IHNldExvY2FsU3RyZWFtLFxuICAgICAgb25SZW1vdGVTdHJlYW06IHNldFJlbW90ZVN0cmVhbSxcbiAgICAgIG9uQ2FsbER1cmF0aW9uOiBzZXREdXJhdGlvbixcbiAgICAgIG9uRXJyb3I6IHNldEVycm9yLFxuICAgICAgb25JbmNvbWluZ0NhbGw6IChjYWxsZXJQdWJrZXksIGNhbGxJZCwgY2FsbFR5cGUpID0+IHtcbiAgICAgICAgc2V0SW5jb21pbmdDYWxsKHsgY2FsbGVyUHVia2V5LCBjYWxsSWQsIGNhbGxUeXBlIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBtYW5hZ2VyUmVmLmN1cnJlbnQgPSBtYW5hZ2VyO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG1hbmFnZXIuZW5kQ2FsbCh0cnVlKTtcbiAgICAgIHNpZ25hbGluZy5kZXN0cm95KCk7XG4gICAgfTtcbiAgfSwgW3ByaXZhdGVLZXksIHJlbGF5VXJsXSk7XG5cbiAgY29uc3Qgc3RhcnRDYWxsID0gdXNlQ2FsbGJhY2soKHJlY2lwaWVudFB1YmtleTogc3RyaW5nLCB0eXBlOiBDYWxsVHlwZSkgPT4ge1xuICAgIG1hbmFnZXJSZWYuY3VycmVudD8uc3RhcnRDYWxsKHJlY2lwaWVudFB1YmtleSwgdHlwZSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBhY2NlcHRDYWxsID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIG1hbmFnZXJSZWYuY3VycmVudD8uYWNjZXB0Q2FsbCgpO1xuICAgIHNldEluY29taW5nQ2FsbChudWxsKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHJlamVjdENhbGwgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgbWFuYWdlclJlZi5jdXJyZW50Py5yZWplY3RDYWxsKCk7XG4gICAgc2V0SW5jb21pbmdDYWxsKG51bGwpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgZW5kQ2FsbCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBtYW5hZ2VyUmVmLmN1cnJlbnQ/LmVuZENhbGwodHJ1ZSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCB0b2dnbGVNdXRlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IG11dGVkID0gbWFuYWdlclJlZi5jdXJyZW50Py50b2dnbGVNdXRlKCk7XG4gICAgc2V0SXNNdXRlZChtdXRlZCA/PyBmYWxzZSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCB0b2dnbGVWaWRlbyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBvZmYgPSBtYW5hZ2VyUmVmLmN1cnJlbnQ/LnRvZ2dsZVZpZGVvKCk7XG4gICAgc2V0SXNWaWRlb09mZihvZmYgPz8gZmFsc2UpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgZm9ybWF0RHVyYXRpb24gPSB1c2VDYWxsYmFjaygoc2VjczogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgbSA9IE1hdGguZmxvb3Ioc2VjcyAvIDYwKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgY29uc3QgcyA9IChzZWNzICUgNjApLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICByZXR1cm4gYCR7bX06JHtzfWA7XG4gIH0sIFtdKTtcblxuICByZXR1cm4ge1xuICAgIGNhbGxTdGF0ZSxcbiAgICBsb2NhbFN0cmVhbSxcbiAgICByZW1vdGVTdHJlYW0sXG4gICAgZHVyYXRpb24sXG4gICAgZm9ybWF0dGVkRHVyYXRpb246IGZvcm1hdER1cmF0aW9uKGR1cmF0aW9uKSxcbiAgICBpc011dGVkLFxuICAgIGlzVmlkZW9PZmYsXG4gICAgZXJyb3IsXG4gICAgaW5jb21pbmdDYWxsLFxuICAgIHN0YXJ0Q2FsbCxcbiAgICBhY2NlcHRDYWxsLFxuICAgIHJlamVjdENhbGwsXG4gICAgZW5kQ2FsbCxcbiAgICB0b2dnbGVNdXRlLFxuICAgIHRvZ2dsZVZpZGVvLFxuICB9O1xufVxuIl0sIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlUmVmIiwidXNlQ2FsbGJhY2siLCJDYWxsTWFuYWdlciIsIk5vc3RyU2lnbmFsaW5nIiwidXNlQ2FsbCIsInByaXZhdGVLZXkiLCJyZWxheVVybCIsImNhbGxTdGF0ZSIsInNldENhbGxTdGF0ZSIsImxvY2FsU3RyZWFtIiwic2V0TG9jYWxTdHJlYW0iLCJyZW1vdGVTdHJlYW0iLCJzZXRSZW1vdGVTdHJlYW0iLCJkdXJhdGlvbiIsInNldER1cmF0aW9uIiwiaXNNdXRlZCIsInNldElzTXV0ZWQiLCJpc1ZpZGVvT2ZmIiwic2V0SXNWaWRlb09mZiIsImVycm9yIiwic2V0RXJyb3IiLCJpbmNvbWluZ0NhbGwiLCJzZXRJbmNvbWluZ0NhbGwiLCJtYW5hZ2VyUmVmIiwic2lnbmFsaW5nUmVmIiwic2lnbmFsaW5nIiwiY3VycmVudCIsIm1hbmFnZXIiLCJvblN0YXRlQ2hhbmdlIiwib25Mb2NhbFN0cmVhbSIsIm9uUmVtb3RlU3RyZWFtIiwib25DYWxsRHVyYXRpb24iLCJvbkVycm9yIiwib25JbmNvbWluZ0NhbGwiLCJjYWxsZXJQdWJrZXkiLCJjYWxsSWQiLCJjYWxsVHlwZSIsImVuZENhbGwiLCJkZXN0cm95Iiwic3RhcnRDYWxsIiwicmVjaXBpZW50UHVia2V5IiwidHlwZSIsImFjY2VwdENhbGwiLCJyZWplY3RDYWxsIiwidG9nZ2xlTXV0ZSIsIm11dGVkIiwidG9nZ2xlVmlkZW8iLCJvZmYiLCJmb3JtYXREdXJhdGlvbiIsInNlY3MiLCJtIiwiTWF0aCIsImZsb29yIiwidG9TdHJpbmciLCJwYWRTdGFydCIsInMiLCJmb3JtYXR0ZWREdXJhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/hooks/useCall.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/lib/call-manager.ts":
/*!*********************************!*\
  !*** ./src/lib/call-manager.ts ***!
  \*********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CallManager: function() { return /* binding */ CallManager; }\n/* harmony export */ });\nclass CallManager {\n    setupSignalingHandlers() {\n        this.signaling.onOffer = async (sdp, callerPubkey, callId)=>{\n            var _sdp_sdp;\n            if (this.callState !== \"idle\") {\n                //     \n                await this.signaling.sendReject(callerPubkey, callId);\n                return;\n            }\n            this.currentCallId = callId;\n            this.currentPeerPubkey = callerPubkey;\n            //     SDP\n            const hasVideo = ((_sdp_sdp = sdp.sdp) === null || _sdp_sdp === void 0 ? void 0 : _sdp_sdp.includes(\"m=video\")) || false;\n            this.callType = hasVideo ? \"video\" : \"audio\";\n            this.setState(\"ringing\");\n            //  offer  \n            this._pendingOffer = sdp;\n            this.handlers.onIncomingCall(callerPubkey, callId, this.callType);\n        };\n        this.signaling.onAnswer = async (sdp, senderPubkey, callId)=>{\n            if (callId !== this.currentCallId) return;\n            if (this.peerConnection) {\n                await this.peerConnection.setRemoteDescription(new RTCSessionDescription(sdp));\n                //   ICE \n                await this.processIceCandidateQueue();\n                this.setState(\"connecting\");\n            }\n        };\n        this.signaling.onIceCandidate = async (candidate, senderPubkey)=>{\n            var _this_peerConnection;\n            if (senderPubkey !== this.currentPeerPubkey) return;\n            if ((_this_peerConnection = this.peerConnection) === null || _this_peerConnection === void 0 ? void 0 : _this_peerConnection.remoteDescription) {\n                await this.peerConnection.addIceCandidate(new RTCIceCandidate(candidate));\n            } else {\n                // ,  remote description   \n                this.iceCandidateQueue.push(candidate);\n            }\n        };\n        this.signaling.onHangup = (senderPubkey, callId)=>{\n            if (senderPubkey === this.currentPeerPubkey) {\n                this.endCall(false);\n            }\n        };\n        this.signaling.onReject = (senderPubkey, callId)=>{\n            if (callId === this.currentCallId) {\n                this.endCall(false);\n            }\n        };\n    }\n    async startCall(recipientPubkey) {\n        let type = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"audio\";\n        if (this.callState !== \"idle\") {\n            throw new Error(\"Already in a call\");\n        }\n        try {\n            this.callType = type;\n            this.currentCallId = this.generateCallId();\n            this.currentPeerPubkey = recipientPubkey;\n            this.localStream = await this.getMediaStream(type);\n            this.handlers.onLocalStream(this.localStream);\n            this.createPeerConnection();\n            this.localStream.getTracks().forEach((track)=>{\n                this.peerConnection.addTrack(track, this.localStream);\n            });\n            const offer = await this.peerConnection.createOffer({\n                offerToReceiveAudio: true,\n                offerToReceiveVideo: type === \"video\"\n            });\n            await this.peerConnection.setLocalDescription(offer);\n            await this.signaling.sendOffer(recipientPubkey, offer, this.currentCallId);\n            this.setState(\"calling\");\n            setTimeout(()=>{\n                if (this.callState === \"calling\") {\n                    this.endCall(true);\n                }\n            }, 30000);\n        } catch (err) {\n            this.handlers.onError(err.message);\n            this.endCall(false);\n        }\n    }\n    async acceptCall() {\n        if (this.callState !== \"ringing\" || !this._pendingOffer) {\n            throw new Error(\"No incoming call to accept\");\n        }\n        try {\n            this.localStream = await this.getMediaStream(this.callType);\n            this.handlers.onLocalStream(this.localStream);\n            this.createPeerConnection();\n            this.localStream.getTracks().forEach((track)=>{\n                this.peerConnection.addTrack(track, this.localStream);\n            });\n            await this.peerConnection.setRemoteDescription(new RTCSessionDescription(this._pendingOffer));\n            await this.processIceCandidateQueue();\n            const answer = await this.peerConnection.createAnswer();\n            await this.peerConnection.setLocalDescription(answer);\n            await this.signaling.sendAnswer(this.currentPeerPubkey, answer, this.currentCallId);\n            this._pendingOffer = null;\n            this.setState(\"connecting\");\n        } catch (err) {\n            this.handlers.onError(err.message);\n            this.endCall(false);\n        }\n    }\n    async rejectCall() {\n        if (this.callState !== \"ringing\") return;\n        await this.signaling.sendReject(this.currentPeerPubkey, this.currentCallId);\n        this.endCall(false);\n    }\n    async endCall() {\n        let sendSignal = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : true;\n        var _this_localStream, _this_remoteStream, _this_peerConnection;\n        if (sendSignal && this.currentPeerPubkey && this.currentCallId) {\n            await this.signaling.sendHangup(this.currentPeerPubkey, this.currentCallId);\n        }\n        (_this_localStream = this.localStream) === null || _this_localStream === void 0 ? void 0 : _this_localStream.getTracks().forEach((t)=>t.stop());\n        (_this_remoteStream = this.remoteStream) === null || _this_remoteStream === void 0 ? void 0 : _this_remoteStream.getTracks().forEach((t)=>t.stop());\n        (_this_peerConnection = this.peerConnection) === null || _this_peerConnection === void 0 ? void 0 : _this_peerConnection.close();\n        if (this.durationTimer) {\n            clearInterval(this.durationTimer);\n        }\n        this.peerConnection = null;\n        this.localStream = null;\n        this.remoteStream = null;\n        this.currentCallId = null;\n        this.currentPeerPubkey = null;\n        this._pendingOffer = null;\n        this.iceCandidateQueue = [];\n        this.setState(\"ended\");\n        setTimeout(()=>this.setState(\"idle\"), 1000);\n    }\n    toggleMute() {\n        if (!this.localStream) return false;\n        const audioTrack = this.localStream.getAudioTracks()[0];\n        if (audioTrack) {\n            audioTrack.enabled = !audioTrack.enabled;\n            return !audioTrack.enabled; // true = muted\n        }\n        return false;\n    }\n    toggleVideo() {\n        if (!this.localStream) return false;\n        const videoTrack = this.localStream.getVideoTracks()[0];\n        if (videoTrack) {\n            videoTrack.enabled = !videoTrack.enabled;\n            return !videoTrack.enabled; // true = camera off\n        }\n        return false;\n    }\n    createPeerConnection() {\n        this.peerConnection = new RTCPeerConnection(this.rtcConfig);\n        this.peerConnection.onicecandidate = async (event)=>{\n            if (event.candidate && this.currentPeerPubkey && this.currentCallId) {\n                await this.signaling.sendIceCandidate(this.currentPeerPubkey, event.candidate.toJSON(), this.currentCallId);\n            }\n        };\n        this.peerConnection.ontrack = (event)=>{\n            this.remoteStream = event.streams[0];\n            this.handlers.onRemoteStream(this.remoteStream);\n        };\n        this.peerConnection.onconnectionstatechange = ()=>{\n            var _this_peerConnection;\n            const state = (_this_peerConnection = this.peerConnection) === null || _this_peerConnection === void 0 ? void 0 : _this_peerConnection.connectionState;\n            console.log(\"Connection state:\", state);\n            switch(state){\n                case \"connected\":\n                    this.setState(\"connected\");\n                    this.startDurationTimer();\n                    break;\n                case \"disconnected\":\n                case \"failed\":\n                    this.endCall(true);\n                    break;\n            }\n        };\n        this.peerConnection.oniceconnectionstatechange = ()=>{\n            var _this_peerConnection;\n            console.log(\"ICE state:\", (_this_peerConnection = this.peerConnection) === null || _this_peerConnection === void 0 ? void 0 : _this_peerConnection.iceConnectionState);\n        };\n    }\n    async getMediaStream(type) {\n        const constraints = {\n            audio: {\n                echoCancellation: true,\n                noiseSuppression: true,\n                autoGainControl: true\n            },\n            video: type === \"video\" ? {\n                width: {\n                    ideal: 1280,\n                    max: 1920\n                },\n                height: {\n                    ideal: 720,\n                    max: 1080\n                },\n                frameRate: {\n                    ideal: 30,\n                    max: 60\n                },\n                facingMode: \"user\"\n            } : false\n        };\n        return navigator.mediaDevices.getUserMedia(constraints);\n    }\n    async processIceCandidateQueue() {\n        for (const candidate of this.iceCandidateQueue){\n            var _this_peerConnection;\n            await ((_this_peerConnection = this.peerConnection) === null || _this_peerConnection === void 0 ? void 0 : _this_peerConnection.addIceCandidate(new RTCIceCandidate(candidate)));\n        }\n        this.iceCandidateQueue = [];\n    }\n    setState(state) {\n        this.callState = state;\n        this.handlers.onStateChange(state);\n    }\n    startDurationTimer() {\n        this.callStartTime = Date.now();\n        this.durationTimer = window.setInterval(()=>{\n            const seconds = Math.floor((Date.now() - this.callStartTime) / 1000);\n            this.handlers.onCallDuration(seconds);\n        }, 1000);\n    }\n    generateCallId() {\n        return \"call-\".concat(Date.now(), \"-\").concat(Math.random().toString(36).substring(2, 9));\n    }\n    get state() {\n        return this.callState;\n    }\n    get isVideoCall() {\n        return this.callType === \"video\";\n    }\n    constructor(signaling, handlers){\n        this.peerConnection = null;\n        this.localStream = null;\n        this.remoteStream = null;\n        this.callState = \"idle\";\n        this.currentCallId = null;\n        this.currentPeerPubkey = null;\n        this.callType = \"audio\";\n        this.durationTimer = null;\n        this.callStartTime = 0;\n        this.iceCandidateQueue = [];\n        // STUN/TURN \n        this.rtcConfig = {\n            iceServers: [\n                {\n                    urls: \"stun:stun.l.google.com:19302\"\n                },\n                {\n                    urls: \"stun:stun1.l.google.com:19302\"\n                },\n                {\n                    urls: \"stun:stun2.l.google.com:19302\"\n                },\n                {\n                    urls: \"stun:stun3.l.google.com:19302\"\n                },\n                {\n                    urls: \"stun:stun4.l.google.com:19302\"\n                }\n            ],\n            iceCandidatePoolSize: 10\n        };\n        this._pendingOffer = null;\n        this.signaling = signaling;\n        this.handlers = handlers;\n        this.setupSignalingHandlers();\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvY2FsbC1tYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFxQk8sTUFBTUE7SUFnQ0hDLHlCQUF5QjtRQUMvQixJQUFJLENBQUNDLFNBQVMsQ0FBQ0MsT0FBTyxHQUFHLE9BQU9DLEtBQUtDLGNBQWNDO2dCQVdoQ0Y7WUFWakIsSUFBSSxJQUFJLENBQUNHLFNBQVMsS0FBSyxRQUFRO2dCQUM3QiwyQkFBMkI7Z0JBQzNCLE1BQU0sSUFBSSxDQUFDTCxTQUFTLENBQUNNLFVBQVUsQ0FBQ0gsY0FBY0M7Z0JBQzlDO1lBQ0Y7WUFFQSxJQUFJLENBQUNHLGFBQWEsR0FBR0g7WUFDckIsSUFBSSxDQUFDSSxpQkFBaUIsR0FBR0w7WUFFekIsK0JBQStCO1lBQy9CLE1BQU1NLFdBQVdQLEVBQUFBLFdBQUFBLElBQUlBLEdBQUcsY0FBUEEsK0JBQUFBLFNBQVNRLFFBQVEsQ0FBQyxlQUFjO1lBQ2pELElBQUksQ0FBQ0MsUUFBUSxHQUFHRixXQUFXLFVBQVU7WUFFckMsSUFBSSxDQUFDRyxRQUFRLENBQUM7WUFFZCwrQkFBK0I7WUFDL0IsSUFBSSxDQUFDQyxhQUFhLEdBQUdYO1lBRXJCLElBQUksQ0FBQ1ksUUFBUSxDQUFDQyxjQUFjLENBQUNaLGNBQWNDLFFBQVEsSUFBSSxDQUFDTyxRQUFRO1FBQ2xFO1FBRUEsSUFBSSxDQUFDWCxTQUFTLENBQUNnQixRQUFRLEdBQUcsT0FBT2QsS0FBS2UsY0FBY2I7WUFDbEQsSUFBSUEsV0FBVyxJQUFJLENBQUNHLGFBQWEsRUFBRTtZQUVuQyxJQUFJLElBQUksQ0FBQ1csY0FBYyxFQUFFO2dCQUN2QixNQUFNLElBQUksQ0FBQ0EsY0FBYyxDQUFDQyxvQkFBb0IsQ0FDNUMsSUFBSUMsc0JBQXNCbEI7Z0JBRzVCLHdDQUF3QztnQkFDeEMsTUFBTSxJQUFJLENBQUNtQix3QkFBd0I7Z0JBRW5DLElBQUksQ0FBQ1QsUUFBUSxDQUFDO1lBQ2hCO1FBQ0Y7UUFFQSxJQUFJLENBQUNaLFNB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LEtBQUssSUFBSSxDQUFDRixhQUFhLElBQUk7WUFDL0QsSUFBSSxDQUFDOUYsUUFBUSxDQUFDc0csY0FBYyxDQUFDSDtRQUMvQixHQUFHO0lBQ0w7SUFFUTdFLGlCQUF5QjtRQUMvQixPQUFPLFFBQXNCOEUsT0FBZEwsS0FBS0MsR0FBRyxJQUFHLEtBQThDLE9BQTNDSSxLQUFLRyxNQUFNLEdBQUdDLFFBQVEsQ0FBQyxJQUFJQyxTQUFTLENBQUMsR0FBRztJQUN2RTtJQUVBLElBQUlsQyxRQUFtQjtRQUNyQixPQUFPLElBQUksQ0FBQ2hGLFNBQVM7SUFDdkI7SUFFQSxJQUFJbUgsY0FBdUI7UUFDekIsT0FBTyxJQUFJLENBQUM3RyxRQUFRLEtBQUs7SUFDM0I7SUFwVEE4RyxZQUFZekgsU0FBeUIsRUFBRWMsUUFBMkIsQ0FBRTthQXhCNURJLGlCQUEyQzthQUMzQ21CLGNBQWtDO2FBQ2xDMkIsZUFBbUM7YUFDbkMzRCxZQUF1QjthQUN2QkUsZ0JBQStCO2FBQy9CQyxvQkFBbUM7YUFDbkNHLFdBQXFCO2FBQ3JCdUQsZ0JBQStCO2FBQy9CMEMsZ0JBQXdCO2FBQ3hCakYsb0JBQTJDLEVBQUU7UUFHckQsb0JBQW9CO2FBQ0hpRCxZQUE4QjtZQUM3QzhDLFlBQVk7Z0JBQ1Y7b0JBQUVDLE1BQU07Z0JBQStCO2dCQUN2QztvQkFBRUEsTUFBTTtnQkFBZ0M7Z0JBQ3hDO29CQUFFQSxNQUFNO2dCQUFnQztnQkFDeEM7b0JBQUVBLE1BQU07Z0JBQWdDO2dCQUN4QztvQkFBRUEsTUFBTTtnQkFBZ0M7YUFDekM7WUFDREMsc0JBQXNCO1FBQ3hCO2FBd0VRL0csZ0JBQWtEO1FBckV4RCxJQUFJLENBQUNiLFNBQVMsR0FBR0E7UUFDakIsSUFBSSxDQUFDYyxRQUFRLEdBQUdBO1FBQ2hCLElBQUksQ0FBQ2Ysc0JBQXNCO0lBQzdCO0FBaVRGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvY2FsbC1tYW5hZ2VyLnRzPzU3MTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm9zdHJTaWduYWxpbmcgfSBmcm9tICcuL25vc3RyLXNpZ25hbGluZyc7XG5cbmV4cG9ydCB0eXBlIENhbGxTdGF0ZSA9IFxuICB8ICdpZGxlJyBcbiAgfCAnY2FsbGluZycgXG4gIHwgJ3JpbmdpbmcnIFxuICB8ICdjb25uZWN0aW5nJyBcbiAgfCAnY29ubmVjdGVkJyBcbiAgfCAnZW5kZWQnO1xuXG5leHBvcnQgdHlwZSBDYWxsVHlwZSA9ICdhdWRpbycgfCAndmlkZW8nO1xuXG5pbnRlcmZhY2UgQ2FsbEV2ZW50SGFuZGxlcnMge1xuICBvblN0YXRlQ2hhbmdlOiAoc3RhdGU6IENhbGxTdGF0ZSkgPT4gdm9pZDtcbiAgb25SZW1vdGVTdHJlYW06IChzdHJlYW06IE1lZGlhU3RyZWFtKSA9PiB2b2lkO1xuICBvbkxvY2FsU3RyZWFtOiAoc3RyZWFtOiBNZWRpYVN0cmVhbSkgPT4gdm9pZDtcbiAgb25DYWxsRHVyYXRpb246IChzZWNvbmRzOiBudW1iZXIpID0+IHZvaWQ7XG4gIG9uRXJyb3I6IChlcnJvcjogc3RyaW5nKSA9PiB2b2lkO1xuICBvbkluY29taW5nQ2FsbDogKGNhbGxlclB1YmtleTogc3RyaW5nLCBjYWxsSWQ6IHN0cmluZywgY2FsbFR5cGU6IENhbGxUeXBlKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQ2FsbE1hbmFnZXIge1xuICBwcml2YXRlIHNpZ25hbGluZzogTm9zdHJTaWduYWxpbmc7XG4gIHByaXZhdGUgcGVlckNvbm5lY3Rpb246IFJUQ1BlZXJDb25uZWN0aW9uIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbG9jYWxTdHJlYW06IE1lZGlhU3RyZWFtIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcmVtb3RlU3RyZWFtOiBNZWRpYVN0cmVhbSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGNhbGxTdGF0ZTogQ2FsbFN0YXRlID0gJ2lkbGUnO1xuICBwcml2YXRlIGN1cnJlbnRDYWxsSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGN1cnJlbnRQZWVyUHVia2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBjYWxsVHlwZTogQ2FsbFR5cGUgPSAnYXVkaW8nO1xuICBwcml2YXRlIGR1cmF0aW9uVGltZXI6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGNhbGxTdGFydFRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaWNlQ2FuZGlkYXRlUXVldWU6IFJUQ0ljZUNhbmRpZGF0ZUluaXRbXSA9IFtdO1xuICBwcml2YXRlIGhhbmRsZXJzOiBDYWxsRXZlbnRIYW5kbGVycztcblxuICAvLyBTVFVOL1RVUk4g0YHQtdGA0LLQtdGA0YtcbiAgcHJpdmF0ZSByZWFkb25seSBydGNDb25maWc6IFJUQ0NvbmZpZ3VyYXRpb24gPSB7XG4gICAgaWNlU2VydmVyczogW1xuICAgICAgeyB1cmxzOiAnc3R1bjpzdHVuLmwuZ29vZ2xlLmNvbToxOTMwMicgfSxcbiAgICAgIHsgdXJsczogJ3N0dW46c3R1bjEubC5nb29nbGUuY29tOjE5MzAyJyB9LFxuICAgICAgeyB1cmxzOiAnc3R1bjpzdHVuMi5sLmdvb2dsZS5jb206MTkzMDInIH0sXG4gICAgICB7IHVybHM6ICdzdHVuOnN0dW4zLmwuZ29vZ2xlLmNvbToxOTMwMicgfSxcbiAgICAgIHsgdXJsczogJ3N0dW46c3R1bjQubC5nb29nbGUuY29tOjE5MzAyJyB9LFxuICAgIF0sXG4gICAgaWNlQ2FuZGlkYXRlUG9vbFNpemU6IDEwLFxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHNpZ25hbGluZzogTm9zdHJTaWduYWxpbmcsIGhhbmRsZXJzOiBDYWxsRXZlbnRIYW5kbGVycykge1xuICAgIHRoaXMuc2lnbmFsaW5nID0gc2lnbmFsaW5nO1xuICAgIHRoaXMuaGFuZGxlcnMgPSBoYW5kbGVycztcbiAgICB0aGlzLnNldHVwU2lnbmFsaW5nSGFuZGxlcnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBTaWduYWxpbmdIYW5kbGVycygpIHtcbiAgICB0aGlzLnNpZ25hbGluZy5vbk9mZmVyID0gYXN5bmMgKHNkcCwgY2FsbGVyUHVia2V5LCBjYWxsSWQpID0+IHtcbiAgICAgIGlmICh0aGlzLmNhbGxTdGF0ZSAhPT0gJ2lkbGUnKSB7XG4gICAgICAgIC8vINCj0LbQtSDQsiDQt9Cy0L7QvdC60LUg4oCUINC+0YLQutC70L7QvdGP0LXQvFxuICAgICAgICBhd2FpdCB0aGlzLnNpZ25hbGluZy5zZW5kUmVqZWN0KGNhbGxlclB1YmtleSwgY2FsbElkKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmN1cnJlbnRDYWxsSWQgPSBjYWxsSWQ7XG4gICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5ID0gY2FsbGVyUHVia2V5O1xuICAgICAgXG4gICAgICAvLyDQntC/0YDQtdC00LXQu9GP0LXQvCDRgtC40L8g0LfQstC+0L3QutCwINC40LcgU0RQXG4gICAgICBjb25zdCBoYXNWaWRlbyA9IHNkcC5zZHA/LmluY2x1ZGVzKCdtPXZpZGVvJykgfHwgZmFsc2U7XG4gICAgICB0aGlzLmNhbGxUeXBlID0gaGFzVmlkZW8gPyAndmlkZW8nIDogJ2F1ZGlvJztcbiAgICAgIFxuICAgICAgdGhpcy5zZXRTdGF0ZSgncmluZ2luZycpO1xuICAgICAgXG4gICAgICAvLyDQodC+0YXRgNCw0L3Rj9C10Lwgb2ZmZXIg0LTQu9GPINC/0YDQuNC90Y/RgtC40Y9cbiAgICAgIHRoaXMuX3BlbmRpbmdPZmZlciA9IHNkcDtcbiAgICAgIFxuICAgICAgdGhpcy5oYW5kbGVycy5vbkluY29taW5nQ2FsbChjYWxsZXJQdWJrZXksIGNhbGxJZCwgdGhpcy5jYWxsVHlwZSk7XG4gICAgfTtcblxuICAgIHRoaXMuc2lnbmFsaW5nLm9uQW5zd2VyID0gYXN5bmMgKHNkcCwgc2VuZGVyUHVia2V5LCBjYWxsSWQpID0+IHtcbiAgICAgIGlmIChjYWxsSWQgIT09IHRoaXMuY3VycmVudENhbGxJZCkgcmV0dXJuO1xuICAgICAgXG4gICAgICBpZiAodGhpcy5wZWVyQ29ubmVjdGlvbikge1xuICAgICAgICBhd2FpdCB0aGlzLnBlZXJDb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKFxuICAgICAgICAgIG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8g0J7QsdGA0LDQsdCw0YLRi9Cy0LDQtdC8INC+0YLQu9C+0LbQtdC90L3Ri9C1IElDRSDQutCw0L3QtNC40LTQsNGC0YtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzSWNlQ2FuZGlkYXRlUXVldWUoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoJ2Nvbm5lY3RpbmcnKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5zaWduYWxpbmcub25JY2VDYW5kaWRhdGUgPSBhc3luYyAoY2FuZGlkYXRlLCBzZW5kZXJQdWJrZXkpID0+IHtcbiAgICAgIGlmIChzZW5kZXJQdWJrZXkgIT09IHRoaXMuY3VycmVudFBlZXJQdWJrZXkpIHJldHVybjtcbiAgICAgIFxuICAgICAgaWYgKHRoaXMucGVlckNvbm5lY3Rpb24/LnJlbW90ZURlc2NyaXB0aW9uKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKFxuICAgICAgICAgIG5ldyBSVENJY2VDYW5kaWRhdGUoY2FuZGlkYXRlKVxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g0J7RgtC60LvQsNC00YvQstCw0LXQvCwg0LXRgdC70LggcmVtb3RlIGRlc2NyaXB0aW9uINC10YnRkSDQvdC1INGD0YHRgtCw0L3QvtCy0LvQtdC9XG4gICAgICAgIHRoaXMuaWNlQ2FuZGlkYXRlUXVldWUucHVzaChjYW5kaWRhdGUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLnNpZ25hbGluZy5vbkhhbmd1cCA9IChzZW5kZXJQdWJrZXksIGNhbGxJZCkgPT4ge1xuICAgICAgaWYgKHNlbmRlclB1YmtleSA9PT0gdGhpcy5jdXJyZW50UGVlclB1YmtleSkge1xuICAgICAgICB0aGlzLmVuZENhbGwoZmFsc2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLnNpZ25hbGluZy5vblJlamVjdCA9IChzZW5kZXJQdWJrZXksIGNhbGxJZCkgPT4ge1xuICAgICAgaWYgKGNhbGxJZCA9PT0gdGhpcy5jdXJyZW50Q2FsbElkKSB7XG4gICAgICAgIHRoaXMuZW5kQ2FsbChmYWxzZSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgX3BlbmRpbmdPZmZlcjogUlRDU2Vzc2lvbkRlc2NyaXB0aW9uSW5pdCB8IG51bGwgPSBudWxsO1xuXG4gIGFzeW5jIHN0YXJ0Q2FsbChyZWNpcGllbnRQdWJrZXk6IHN0cmluZywgdHlwZTogQ2FsbFR5cGUgPSAnYXVkaW8nKSB7XG4gICAgaWYgKHRoaXMuY2FsbFN0YXRlICE9PSAnaWRsZScpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQWxyZWFkeSBpbiBhIGNhbGwnKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5jYWxsVHlwZSA9IHR5cGU7XG4gICAgICB0aGlzLmN1cnJlbnRDYWxsSWQgPSB0aGlzLmdlbmVyYXRlQ2FsbElkKCk7XG4gICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5ID0gcmVjaXBpZW50UHVia2V5O1xuXG4gICAgICB0aGlzLmxvY2FsU3RyZWFtID0gYXdhaXQgdGhpcy5nZXRNZWRpYVN0cmVhbSh0eXBlKTtcbiAgICAgIHRoaXMuaGFuZGxlcnMub25Mb2NhbFN0cmVhbSh0aGlzLmxvY2FsU3RyZWFtKTtcblxuICAgICAgdGhpcy5jcmVhdGVQZWVyQ29ubmVjdGlvbigpO1xuXG4gICAgICB0aGlzLmxvY2FsU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICB0aGlzLnBlZXJDb25uZWN0aW9uIS5hZGRUcmFjayh0cmFjaywgdGhpcy5sb2NhbFN0cmVhbSEpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9mZmVyID0gYXdhaXQgdGhpcy5wZWVyQ29ubmVjdGlvbiEuY3JlYXRlT2ZmZXIoe1xuICAgICAgICBvZmZlclRvUmVjZWl2ZUF1ZGlvOiB0cnVlLFxuICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiB0eXBlID09PSAndmlkZW8nLFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHRoaXMucGVlckNvbm5lY3Rpb24hLnNldExvY2FsRGVzY3JpcHRpb24ob2ZmZXIpO1xuXG4gICAgICBhd2FpdCB0aGlzLnNpZ25hbGluZy5zZW5kT2ZmZXIoXG4gICAgICAgIHJlY2lwaWVudFB1YmtleSwgXG4gICAgICAgIG9mZmVyLCBcbiAgICAgICAgdGhpcy5jdXJyZW50Q2FsbElkXG4gICAgICApO1xuXG4gICAgICB0aGlzLnNldFN0YXRlKCdjYWxsaW5nJyk7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5jYWxsU3RhdGUgPT09ICdjYWxsaW5nJykge1xuICAgICAgICAgIHRoaXMuZW5kQ2FsbCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSwgMzAwMDApO1xuXG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgIHRoaXMuaGFuZGxlcnMub25FcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICB0aGlzLmVuZENhbGwoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFjY2VwdENhbGwoKSB7XG4gICAgaWYgKHRoaXMuY2FsbFN0YXRlICE9PSAncmluZ2luZycgfHwgIXRoaXMuX3BlbmRpbmdPZmZlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBpbmNvbWluZyBjYWxsIHRvIGFjY2VwdCcpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmxvY2FsU3RyZWFtID0gYXdhaXQgdGhpcy5nZXRNZWRpYVN0cmVhbSh0aGlzLmNhbGxUeXBlKTtcbiAgICAgIHRoaXMuaGFuZGxlcnMub25Mb2NhbFN0cmVhbSh0aGlzLmxvY2FsU3RyZWFtKTtcblxuICAgICAgdGhpcy5jcmVhdGVQZWVyQ29ubmVjdGlvbigpO1xuXG4gICAgICB0aGlzLmxvY2FsU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICB0aGlzLnBlZXJDb25uZWN0aW9uIS5hZGRUcmFjayh0cmFjaywgdGhpcy5sb2NhbFN0cmVhbSEpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHRoaXMucGVlckNvbm5lY3Rpb24hLnNldFJlbW90ZURlc2NyaXB0aW9uKFxuICAgICAgICBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHRoaXMuX3BlbmRpbmdPZmZlcilcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc0ljZUNhbmRpZGF0ZVF1ZXVlKCk7XG5cbiAgICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IHRoaXMucGVlckNvbm5lY3Rpb24hLmNyZWF0ZUFuc3dlcigpO1xuICAgICAgYXdhaXQgdGhpcy5wZWVyQ29ubmVjdGlvbiEuc2V0TG9jYWxEZXNjcmlwdGlvbihhbnN3ZXIpO1xuXG4gICAgICBhd2FpdCB0aGlzLnNpZ25hbGluZy5zZW5kQW5zd2VyKFxuICAgICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5ISwgXG4gICAgICAgIGFuc3dlciwgXG4gICAgICAgIHRoaXMuY3VycmVudENhbGxJZCFcbiAgICAgICk7XG5cbiAgICAgIHRoaXMuX3BlbmRpbmdPZmZlciA9IG51bGw7XG4gICAgICB0aGlzLnNldFN0YXRlKCdjb25uZWN0aW5nJyk7XG5cbiAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgdGhpcy5oYW5kbGVycy5vbkVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgIHRoaXMuZW5kQ2FsbChmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVqZWN0Q2FsbCgpIHtcbiAgICBpZiAodGhpcy5jYWxsU3RhdGUgIT09ICdyaW5naW5nJykgcmV0dXJuO1xuICAgIFxuICAgIGF3YWl0IHRoaXMuc2lnbmFsaW5nLnNlbmRSZWplY3QoXG4gICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5ISwgXG4gICAgICB0aGlzLmN1cnJlbnRDYWxsSWQhXG4gICAgKTtcbiAgICB0aGlzLmVuZENhbGwoZmFsc2UpO1xuICB9XG5cbiAgYXN5bmMgZW5kQ2FsbChzZW5kU2lnbmFsOiBib29sZWFuID0gdHJ1ZSkge1xuICAgIGlmIChzZW5kU2lnbmFsICYmIHRoaXMuY3VycmVudFBlZXJQdWJrZXkgJiYgdGhpcy5jdXJyZW50Q2FsbElkKSB7XG4gICAgICBhd2FpdCB0aGlzLnNpZ25hbGluZy5zZW5kSGFuZ3VwKFxuICAgICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5LCBcbiAgICAgICAgdGhpcy5jdXJyZW50Q2FsbElkXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMubG9jYWxTdHJlYW0/LmdldFRyYWNrcygpLmZvckVhY2godCA9PiB0LnN0b3AoKSk7XG4gICAgdGhpcy5yZW1vdGVTdHJlYW0/LmdldFRyYWNrcygpLmZvckVhY2godCA9PiB0LnN0b3AoKSk7XG5cbiAgICB0aGlzLnBlZXJDb25uZWN0aW9uPy5jbG9zZSgpO1xuXG4gICAgaWYgKHRoaXMuZHVyYXRpb25UaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmR1cmF0aW9uVGltZXIpO1xuICAgIH1cblxuICAgIHRoaXMucGVlckNvbm5lY3Rpb24gPSBudWxsO1xuICAgIHRoaXMubG9jYWxTdHJlYW0gPSBudWxsO1xuICAgIHRoaXMucmVtb3RlU3RyZWFtID0gbnVsbDtcbiAgICB0aGlzLmN1cnJlbnRDYWxsSWQgPSBudWxsO1xuICAgIHRoaXMuY3VycmVudFBlZXJQdWJrZXkgPSBudWxsO1xuICAgIHRoaXMuX3BlbmRpbmdPZmZlciA9IG51bGw7XG4gICAgdGhpcy5pY2VDYW5kaWRhdGVRdWV1ZSA9IFtdO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSgnZW5kZWQnKTtcbiAgICBcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc2V0U3RhdGUoJ2lkbGUnKSwgMTAwMCk7XG4gIH1cblxuICB0b2dnbGVNdXRlKCk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5sb2NhbFN0cmVhbSkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIGNvbnN0IGF1ZGlvVHJhY2sgPSB0aGlzLmxvY2FsU3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG4gICAgaWYgKGF1ZGlvVHJhY2spIHtcbiAgICAgIGF1ZGlvVHJhY2suZW5hYmxlZCA9ICFhdWRpb1RyYWNrLmVuYWJsZWQ7XG4gICAgICByZXR1cm4gIWF1ZGlvVHJhY2suZW5hYmxlZDsgLy8gdHJ1ZSA9IG11dGVkXG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHRvZ2dsZVZpZGVvKCk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5sb2NhbFN0cmVhbSkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIGNvbnN0IHZpZGVvVHJhY2sgPSB0aGlzLmxvY2FsU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07XG4gICAgaWYgKHZpZGVvVHJhY2spIHtcbiAgICAgIHZpZGVvVHJhY2suZW5hYmxlZCA9ICF2aWRlb1RyYWNrLmVuYWJsZWQ7XG4gICAgICByZXR1cm4gIXZpZGVvVHJhY2suZW5hYmxlZDsgLy8gdHJ1ZSA9IGNhbWVyYSBvZmZcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVQZWVyQ29ubmVjdGlvbigpIHtcbiAgICB0aGlzLnBlZXJDb25uZWN0aW9uID0gbmV3IFJUQ1BlZXJDb25uZWN0aW9uKHRoaXMucnRjQ29uZmlnKTtcblxuICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25pY2VjYW5kaWRhdGUgPSBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC5jYW5kaWRhdGUgJiYgdGhpcy5jdXJyZW50UGVlclB1YmtleSAmJiB0aGlzLmN1cnJlbnRDYWxsSWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zaWduYWxpbmcuc2VuZEljZUNhbmRpZGF0ZShcbiAgICAgICAgICB0aGlzLmN1cnJlbnRQZWVyUHVia2V5LFxuICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS50b0pTT04oKSxcbiAgICAgICAgICB0aGlzLmN1cnJlbnRDYWxsSWRcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbnRyYWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnJlbW90ZVN0cmVhbSA9IGV2ZW50LnN0cmVhbXNbMF07XG4gICAgICB0aGlzLmhhbmRsZXJzLm9uUmVtb3RlU3RyZWFtKHRoaXMucmVtb3RlU3RyZWFtKTtcbiAgICB9O1xuXG4gICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5wZWVyQ29ubmVjdGlvbj8uY29ubmVjdGlvblN0YXRlO1xuICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3Rpb24gc3RhdGU6Jywgc3RhdGUpO1xuXG4gICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgIGNhc2UgJ2Nvbm5lY3RlZCc6XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSgnY29ubmVjdGVkJyk7XG4gICAgICAgICAgdGhpcy5zdGFydER1cmF0aW9uVGltZXIoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGlzY29ubmVjdGVkJzpcbiAgICAgICAgY2FzZSAnZmFpbGVkJzpcbiAgICAgICAgICB0aGlzLmVuZENhbGwodHJ1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnSUNFIHN0YXRlOicsIHRoaXMucGVlckNvbm5lY3Rpb24/LmljZUNvbm5lY3Rpb25TdGF0ZSk7XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0TWVkaWFTdHJlYW0odHlwZTogQ2FsbFR5cGUpOiBQcm9taXNlPE1lZGlhU3RyZWFtPiB7XG4gICAgY29uc3QgY29uc3RyYWludHM6IE1lZGlhU3RyZWFtQ29uc3RyYWludHMgPSB7XG4gICAgICBhdWRpbzoge1xuICAgICAgICBlY2hvQ2FuY2VsbGF0aW9uOiB0cnVlLFxuICAgICAgICBub2lzZVN1cHByZXNzaW9uOiB0cnVlLFxuICAgICAgICBhdXRvR2FpbkNvbnRyb2w6IHRydWUsXG4gICAgICB9LFxuICAgICAgdmlkZW86IHR5cGUgPT09ICd2aWRlbycgPyB7XG4gICAgICAgIHdpZHRoOiB7IGlkZWFsOiAxMjgwLCBtYXg6IDE5MjAgfSxcbiAgICAgICAgaGVpZ2h0OiB7IGlkZWFsOiA3MjAsIG1heDogMTA4MCB9LFxuICAgICAgICBmcmFtZVJhdGU6IHsgaWRlYWw6IDMwLCBtYXg6IDYwIH0sXG4gICAgICAgIGZhY2luZ01vZGU6ICd1c2VyJyxcbiAgICAgIH0gOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc0ljZUNhbmRpZGF0ZVF1ZXVlKCkge1xuICAgIGZvciAoY29uc3QgY2FuZGlkYXRlIG9mIHRoaXMuaWNlQ2FuZGlkYXRlUXVldWUpIHtcbiAgICAgIGF3YWl0IHRoaXMucGVlckNvbm5lY3Rpb24/LmFkZEljZUNhbmRpZGF0ZShcbiAgICAgICAgbmV3IFJUQ0ljZUNhbmRpZGF0ZShjYW5kaWRhdGUpXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLmljZUNhbmRpZGF0ZVF1ZXVlID0gW107XG4gIH1cblxuICBwcml2YXRlIHNldFN0YXRlKHN0YXRlOiBDYWxsU3RhdGUpIHtcbiAgICB0aGlzLmNhbGxTdGF0ZSA9IHN0YXRlO1xuICAgIHRoaXMuaGFuZGxlcnMub25TdGF0ZUNoYW5nZShzdGF0ZSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXJ0RHVyYXRpb25UaW1lcigpIHtcbiAgICB0aGlzLmNhbGxTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuZHVyYXRpb25UaW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBjb25zdCBzZWNvbmRzID0gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIHRoaXMuY2FsbFN0YXJ0VGltZSkgLyAxMDAwKTtcbiAgICAgIHRoaXMuaGFuZGxlcnMub25DYWxsRHVyYXRpb24oc2Vjb25kcyk7XG4gICAgfSwgMTAwMCk7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2FsbElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBjYWxsLSR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgOSl9YDtcbiAgfVxuXG4gIGdldCBzdGF0ZSgpOiBDYWxsU3RhdGUge1xuICAgIHJldHVybiB0aGlzLmNhbGxTdGF0ZTtcbiAgfVxuXG4gIGdldCBpc1ZpZGVvQ2FsbCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jYWxsVHlwZSA9PT0gJ3ZpZGVvJztcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhbGxNYW5hZ2VyIiwic2V0dXBTaWduYWxpbmdIYW5kbGVycyIsInNpZ25hbGluZyIsIm9uT2ZmZXIiLCJzZHAiLCJjYWxsZXJQdWJrZXkiLCJjYWxsSWQiLCJjYWxsU3RhdGUiLCJzZW5kUmVqZWN0IiwiY3VycmVudENhbGxJZCIsImN1cnJlbnRQZWVyUHVia2V5IiwiaGFzVmlkZW8iLCJpbmNsdWRlcyIsImNhbGxUeXBlIiwic2V0U3RhdGUiLCJfcGVuZGluZ09mZmVyIiwiaGFuZGxlcnMiLCJvbkluY29taW5nQ2FsbCIsIm9uQW5zd2VyIiwic2VuZGVyUHVia2V5IiwicGVlckNvbm5lY3Rpb24iLCJzZXRSZW1vdGVEZXNjcmlwdGlvbiIsIlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiIsInByb2Nlc3NJY2VDYW5kaWRhdGVRdWV1ZSIsIm9uSWNlQ2FuZGlkYXRlIiwiY2FuZGlkYXRlIiwicmVtb3RlRGVzY3JpcHRpb24iLCJhZGRJY2VDYW5kaWRhdGUiLCJSVENJY2VDYW5kaWRhdGUiLCJpY2VDYW5kaWRhdGVRdWV1ZSIsInB1c2giLCJvbkhhbmd1cCIsImVuZENhbGwiLCJvblJlamVjdCIsInN0YXJ0Q2FsbCIsInJlY2lwaWVudFB1YmtleSIsInR5cGUiLCJFcnJvciIsImdlbmVyYXRlQ2FsbElkIiwibG9jYWxTdHJlYW0iLCJnZXRNZWRpYVN0cmVhbSIsIm9uTG9jYWxTdHJlYW0iLCJjcmVhdGVQZWVyQ29ubmVjdGlvbiIsImdldFRyYWNrcyIsImZvckVhY2giLCJ0cmFjayIsImFkZFRyYWNrIiwib2ZmZXIiLCJjcmVhdGVPZmZlciIsIm9mZmVyVG9SZWNlaXZlQXVkaW8iLCJvZmZlclRvUmVjZWl2ZVZpZGVvIiwic2V0TG9jYWxEZXNjcmlwdGlvbiIsInNlbmRPZmZlciIsInNldFRpbWVvdXQiLCJlcnIiLCJvbkVycm9yIiwibWVzc2FnZSIsImFjY2VwdENhbGwiLCJhbnN3ZXIiLCJjcmVhdGVBbnN3ZXIiLCJzZW5kQW5zd2VyIiwicmVqZWN0Q2FsbCIsInNlbmRTaWduYWwiLCJzZW5kSGFuZ3VwIiwidCIsInN0b3AiLCJyZW1vdGVTdHJlYW0iLCJjbG9zZSIsImR1cmF0aW9uVGltZXIiLCJjbGVhckludGVydmFsIiwidG9nZ2xlTXV0ZSIsImF1ZGlvVHJhY2siLCJnZXRBdWRpb1RyYWNrcyIsImVuYWJsZWQiLCJ0b2dnbGVWaWRlbyIsInZpZGVvVHJhY2siLCJnZXRWaWRlb1RyYWNrcyIsIlJUQ1BlZXJDb25uZWN0aW9uIiwicnRjQ29uZmlnIiwib25pY2VjYW5kaWRhdGUiLCJldmVudCIsInNlbmRJY2VDYW5kaWRhdGUiLCJ0b0pTT04iLCJvbnRyYWNrIiwic3RyZWFtcyIsIm9uUmVtb3RlU3RyZWFtIiwib25jb25uZWN0aW9uc3RhdGVjaGFuZ2UiLCJzdGF0ZSIsImNvbm5lY3Rpb25TdGF0ZSIsImNvbnNvbGUiLCJsb2ciLCJzdGFydER1cmF0aW9uVGltZXIiLCJvbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSIsImljZUNvbm5lY3Rpb25TdGF0ZSIsImNvbnN0cmFpbnRzIiwiYXVkaW8iLCJlY2hvQ2FuY2VsbGF0aW9uIiwibm9pc2VTdXBwcmVzc2lvbiIsImF1dG9HYWluQ29udHJvbCIsInZpZGVvIiwid2lkdGgiLCJpZGVhbCIsIm1heCIsImhlaWdodCIsImZyYW1lUmF0ZSIsImZhY2luZ01vZGUiLCJuYXZpZ2F0b3IiLCJtZWRpYURldmljZXMiLCJnZXRVc2VyTWVkaWEiLCJvblN0YXRlQ2hhbmdlIiwiY2FsbFN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ3aW5kb3ciLCJzZXRJbnRlcnZhbCIsInNlY29uZHMiLCJNYXRoIiwiZmxvb3IiLCJvbkNhbGxEdXJhdGlvbiIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiaXNWaWRlb0NhbGwiLCJjb25zdHJ1Y3RvciIsImljZVNlcnZlcnMiLCJ1cmxzIiwiaWNlQ2FuZGlkYXRlUG9vbFNpemUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/call-manager.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/lib/nostr-signaling.ts":
/*!************************************!*\
  !*** ./src/lib/nostr-signaling.ts ***!
  \************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NostrSignaling: function() { return /* binding */ NostrSignaling; }\n/* harmony export */ });\n/* harmony import */ var nostr_tools__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nostr-tools */ \"(app-pages-browser)/./node_modules/nostr-tools/lib/esm/index.js\");\n\nclass NostrSignaling {\n    connectRelay() {\n        const ws = new WebSocket(this.relayUrl);\n        ws.onopen = ()=>{\n            console.log(\"Connected to Nostr relay\");\n            this.subscribeToSignaling();\n        };\n        ws.onmessage = (event)=>{\n            this.handleRelayMessage(JSON.parse(event.data));\n        };\n        ws.onclose = ()=>{\n            console.log(\"Disconnected from relay, reconnecting...\");\n            setTimeout(()=>{\n                this.ws = this.connectRelay();\n            }, 3000);\n        };\n        return ws;\n    }\n    subscribeToSignaling() {\n        this.subscriptionId = \"call-\".concat(Date.now());\n        const filter = {\n            kinds: [\n                25050,\n                25051,\n                25052,\n                25053,\n                25054\n            ],\n            \"#p\": [\n                this.publicKey\n            ],\n            since: Math.floor(Date.now() / 1000) - 30\n        };\n        this.ws.send(JSON.stringify([\n            \"REQ\",\n            this.subscriptionId,\n            filter\n        ]));\n    }\n    async handleRelayMessage(message) {\n        if (message[0] !== \"EVENT\") return;\n        const event = message[2];\n        //    \n        if (event.pubkey === this.publicKey) return;\n        try {\n            var _event_tags_find;\n            //   (NIP-04)\n            const decrypted = await nostr_tools__WEBPACK_IMPORTED_MODULE_0__.nip04.decrypt(this.privateKey, event.pubkey, event.content);\n            const data = JSON.parse(decrypted);\n            const callId = ((_event_tags_find = event.tags.find((t)=>t[0] === \"call-id\")) === null || _event_tags_find === void 0 ? void 0 : _event_tags_find[1]) || \"\";\n            switch(event.kind){\n                case 25050:\n                    var _this_onOffer, _this;\n                    (_this_onOffer = (_this = this).onOffer) === null || _this_onOffer === void 0 ? void 0 : _this_onOffer.call(_this, data.sdp, event.pubkey, callId);\n                    break;\n                case 25051:\n                    var _this_onAnswer, _this1;\n                    (_this_onAnswer = (_this1 = this).onAnswer) === null || _this_onAnswer === void 0 ? void 0 : _this_onAnswer.call(_this1, data.sdp, event.pubkey, callId);\n                    break;\n                case 25052:\n                    var _this_onIceCandidate, _this2;\n                    (_this_onIceCandidate = (_this2 = this).onIceCandidate) === null || _this_onIceCandidate === void 0 ? void 0 : _this_onIceCandidate.call(_this2, data.candidate, event.pubkey);\n                    break;\n                case 25053:\n                    var _this_onHangup, _this3;\n                    (_this_onHangup = (_this3 = this).onHangup) === null || _this_onHangup === void 0 ? void 0 : _this_onHangup.call(_this3, event.pubkey, callId);\n                    break;\n                case 25054:\n                    var _this_onReject, _this4;\n                    (_this_onReject = (_this4 = this).onReject) === null || _this_onReject === void 0 ? void 0 : _this_onReject.call(_this4, event.pubkey, callId);\n                    break;\n            }\n        } catch (err) {\n            console.error(\"Failed to process signaling event:\", err);\n        }\n    }\n    async sendSignalingEvent(kind, recipientPubkey, data, callId) {\n        //   (NIP-04)\n        const encrypted = await nostr_tools__WEBPACK_IMPORTED_MODULE_0__.nip04.encrypt(this.privateKey, recipientPubkey, JSON.stringify(data));\n        const event = (0,nostr_tools__WEBPACK_IMPORTED_MODULE_0__.finalizeEvent)({\n            kind,\n            created_at: Math.floor(Date.now() / 1000),\n            tags: [\n                [\n                    \"p\",\n                    recipientPubkey\n                ],\n                [\n                    \"call-id\",\n                    callId\n                ],\n                [\n                    \"expiration\",\n                    String(Math.floor(Date.now() / 1000) + 300)\n                ]\n            ],\n            content: encrypted\n        }, this.privateKey);\n        this.ws.send(JSON.stringify([\n            \"EVENT\",\n            event\n        ]));\n    }\n    async sendOffer(recipientPubkey, sdp, callId) {\n        await this.sendSignalingEvent(25050, recipientPubkey, {\n            sdp\n        }, callId);\n    }\n    async sendAnswer(recipientPubkey, sdp, callId) {\n        await this.sendSignalingEvent(25051, recipientPubkey, {\n            sdp\n        }, callId);\n    }\n    async sendIceCandidate(recipientPubkey, candidate, callId) {\n        await this.sendSignalingEvent(25052, recipientPubkey, {\n            candidate\n        }, callId);\n    }\n    async sendHangup(recipientPubkey, callId) {\n        await this.sendSignalingEvent(25053, recipientPubkey, {}, callId);\n    }\n    async sendReject(recipientPubkey, callId) {\n        await this.sendSignalingEvent(25054, recipientPubkey, {}, callId);\n    }\n    destroy() {\n        if (this.subscriptionId) {\n            this.ws.send(JSON.stringify([\n                \"CLOSE\",\n                this.subscriptionId\n            ]));\n        }\n        this.ws.close();\n    }\n    constructor(privateKey, relayUrl = \"wss://relay.damus.io\"){\n        this.subscriptionId = null;\n        // Callbacks\n        this.onOffer = null;\n        this.onAnswer = null;\n        this.onIceCandidate = null;\n        this.onHangup = null;\n        this.onReject = null;\n        this.privateKey = privateKey;\n        this.publicKey = (0,nostr_tools__WEBPACK_IMPORTED_MODULE_0__.getPublicKey)(privateKey);\n        this.relayUrl = relayUrl;\n        this.ws = this.connectRelay();\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvbm9zdHItc2lnbmFsaW5nLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWlFO0FBWTFELE1BQU1HO0lBcUJIQyxlQUEwQjtRQUNoQyxNQUFNQyxLQUFLLElBQUlDLFVBQVUsSUFBSSxDQUFDQyxRQUFRO1FBRXRDRixHQUFHRyxNQUFNLEdBQUc7WUFDVkMsUUFBUUMsR0FBRyxDQUFDO1lBQ1osSUFBSSxDQUFDQyxvQkFBb0I7UUFDM0I7UUFFQU4sR0FBR08sU0FBUyxHQUFHLENBQUNDO1lBQ2QsSUFBSSxDQUFDQyxrQkFBa0IsQ0FBQ0MsS0FBS0MsS0FBSyxDQUFDSCxNQUFNSSxJQUFJO1FBQy9DO1FBRUFaLEdBQUdhLE9BQU8sR0FBRztZQUNYVCxRQUFRQyxHQUFHLENBQUM7WUFDWlMsV0FBVztnQkFDVCxJQUFJLENBQUNkLEVBQUUsR0FBRyxJQUFJLENBQUNELFlBQVk7WUFDN0IsR0FBRztRQUNMO1FBRUEsT0FBT0M7SUFDVDtJQUVRTSx1QkFBdUI7UUFDN0IsSUFBSSxDQUFDUyxjQUFjLEdBQUcsUUFBbUIsT0FBWEMsS0FBS0MsR0FBRztRQUV0QyxNQUFNQyxTQUFTO1lBQ2JDLE9BQU87Z0JBQUM7Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87YUFBTTtZQUMxQyxNQUFNO2dCQUFDLElBQUksQ0FBQ0MsU0FBUzthQUFDO1lBQ3RCQyxPQUFPQyxLQUFLQyxLQUFLLENBQUNQLEtBQUtDLEdBQUcsS0FBSyxRQUFRO1FBQ3pDO1FBRUEsSUFBSSxDQUFDakIsRUFBRSxDQUFDd0IsSUFBSSxDQUFDZCxLQUFLZSxTQUFTLENBQUM7WUFBQztZQUFPLElBQUksQ0FBQ1YsY0FBYztZQUFFRztTQUFPO0lBQ2xFO0lBRUEsTUFBY1QsbUJBQW1CaUIsT0FBYyxFQUFFO1FBQy9DLElBQUlBLE9BQU8sQ0FBQyxFQUFFLEtBQUssU0FBUztRQUU1QixNQUFNbEIsUUFBUWtCLE9BQU8sQ0FBQyxFQUFFO1FBRXhCLCtCQUErQjtRQUMvQixJ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RUFBRWYsTUFBYyxFQUFFO1FBQ3hELE1BQU0sSUFBSSxDQUFDYyxrQkFBa0IsQ0FBQyxPQUFPQyxpQkFBaUIsQ0FBQyxHQUFHZjtJQUM1RDtJQUVBLE1BQU13QixXQUFXVCxlQUF1QixFQUFFZixNQUFjLEVBQUU7UUFDeEQsTUFBTSxJQUFJLENBQUNjLGtCQUFrQixDQUFDLE9BQU9DLGlCQUFpQixDQUFDLEdBQUdmO0lBQzVEO0lBRUF5QixVQUFVO1FBQ1IsSUFBSSxJQUFJLENBQUMxQyxjQUFjLEVBQUU7WUFDdkIsSUFBSSxDQUFDZixFQUFFLENBQUN3QixJQUFJLENBQUNkLEtBQUtlLFNBQVMsQ0FBQztnQkFBQztnQkFBUyxJQUFJLENBQUNWLGNBQWM7YUFBQztRQUM1RDtRQUNBLElBQUksQ0FBQ2YsRUFBRSxDQUFDMEQsS0FBSztJQUNmO0lBcklBQyxZQUFZN0IsVUFBc0IsRUFBRTVCLFdBQW1CLHNCQUFzQixDQUFFO2FBVHZFYSxpQkFBZ0M7UUFFeEMsWUFBWTthQUNac0IsVUFBcUc7YUFDckdFLFdBQXVHO2FBQ3ZHQyxpQkFBMEY7YUFDMUZFLFdBQW9FO2FBQ3BFQyxXQUFvRTtRQUdsRSxJQUFJLENBQUNiLFVBQVUsR0FBR0E7UUFDbEIsSUFBSSxDQUFDVixTQUFTLEdBQUd6Qix5REFBWUEsQ0FBQ21DO1FBQzlCLElBQUksQ0FBQzVCLFFBQVEsR0FBR0E7UUFDaEIsSUFBSSxDQUFDRixFQUFFLEdBQUcsSUFBSSxDQUFDRCxZQUFZO0lBQzdCO0FBaUlGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvbm9zdHItc2lnbmFsaW5nLnRzP2RiMWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0UHVibGljS2V5LCBuaXAwNCwgZmluYWxpemVFdmVudCB9IGZyb20gJ25vc3RyLXRvb2xzJztcblxuaW50ZXJmYWNlIE5vc3RyRXZlbnQge1xuICBraW5kOiBudW1iZXI7XG4gIGNyZWF0ZWRfYXQ6IG51bWJlcjtcbiAgdGFnczogc3RyaW5nW11bXTtcbiAgY29udGVudDogc3RyaW5nO1xuICBwdWJrZXk/OiBzdHJpbmc7XG4gIGlkPzogc3RyaW5nO1xuICBzaWc/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBOb3N0clNpZ25hbGluZyB7XG4gIHByaXZhdGUgd3M6IFdlYlNvY2tldDtcbiAgcHJpdmF0ZSBwcml2YXRlS2V5OiBVaW50OEFycmF5O1xuICBwcml2YXRlIHB1YmxpY0tleTogc3RyaW5nO1xuICBwcml2YXRlIHJlbGF5VXJsOiBzdHJpbmc7XG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBcbiAgLy8gQ2FsbGJhY2tzXG4gIG9uT2ZmZXI6ICgob2ZmZXI6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbkluaXQsIGNhbGxlclB1YmtleTogc3RyaW5nLCBjYWxsSWQ6IHN0cmluZykgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgb25BbnN3ZXI6ICgoYW5zd2VyOiBSVENTZXNzaW9uRGVzY3JpcHRpb25Jbml0LCBjYWxsZXJQdWJrZXk6IHN0cmluZywgY2FsbElkOiBzdHJpbmcpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG4gIG9uSWNlQ2FuZGlkYXRlOiAoKGNhbmRpZGF0ZTogUlRDSWNlQ2FuZGlkYXRlSW5pdCwgc2VuZGVyUHVia2V5OiBzdHJpbmcpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG4gIG9uSGFuZ3VwOiAoKHNlbmRlclB1YmtleTogc3RyaW5nLCBjYWxsSWQ6IHN0cmluZykgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgb25SZWplY3Q6ICgoc2VuZGVyUHVia2V5OiBzdHJpbmcsIGNhbGxJZDogc3RyaW5nKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGVLZXk6IFVpbnQ4QXJyYXksIHJlbGF5VXJsOiBzdHJpbmcgPSAnd3NzOi8vcmVsYXkuZGFtdXMuaW8nKSB7XG4gICAgdGhpcy5wcml2YXRlS2V5ID0gcHJpdmF0ZUtleTtcbiAgICB0aGlzLnB1YmxpY0tleSA9IGdldFB1YmxpY0tleShwcml2YXRlS2V5KTtcbiAgICB0aGlzLnJlbGF5VXJsID0gcmVsYXlVcmw7XG4gICAgdGhpcy53cyA9IHRoaXMuY29ubmVjdFJlbGF5KCk7XG4gIH1cblxuICBwcml2YXRlIGNvbm5lY3RSZWxheSgpOiBXZWJTb2NrZXQge1xuICAgIGNvbnN0IHdzID0gbmV3IFdlYlNvY2tldCh0aGlzLnJlbGF5VXJsKTtcbiAgICBcbiAgICB3cy5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE5vc3RyIHJlbGF5Jyk7XG4gICAgICB0aGlzLnN1YnNjcmliZVRvU2lnbmFsaW5nKCk7XG4gICAgfTtcblxuICAgIHdzLm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVSZWxheU1lc3NhZ2UoSlNPTi5wYXJzZShldmVudC5kYXRhKSk7XG4gICAgfTtcblxuICAgIHdzLm9uY2xvc2UgPSAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnRGlzY29ubmVjdGVkIGZyb20gcmVsYXksIHJlY29ubmVjdGluZy4uLicpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMud3MgPSB0aGlzLmNvbm5lY3RSZWxheSgpO1xuICAgICAgfSwgMzAwMCk7XG4gICAgfTtcblxuICAgIHJldHVybiB3cztcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlVG9TaWduYWxpbmcoKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25JZCA9IGBjYWxsLSR7RGF0ZS5ub3coKX1gO1xuICAgIFxuICAgIGNvbnN0IGZpbHRlciA9IHtcbiAgICAgIGtpbmRzOiBbMjUwNTAsIDI1MDUxLCAyNTA1MiwgMjUwNTMsIDI1MDU0XSxcbiAgICAgICcjcCc6IFt0aGlzLnB1YmxpY0tleV0sXG4gICAgICBzaW5jZTogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgLSAzMCwgLy8g0KLQvtC70YzQutC+INC/0L7RgdC70LXQtNC90LjQtSAzMCDRgdC10LpcbiAgICB9O1xuXG4gICAgdGhpcy53cy5zZW5kKEpTT04uc3RyaW5naWZ5KFsnUkVRJywgdGhpcy5zdWJzY3JpcHRpb25JZCwgZmlsdGVyXSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVSZWxheU1lc3NhZ2UobWVzc2FnZTogYW55W10pIHtcbiAgICBpZiAobWVzc2FnZVswXSAhPT0gJ0VWRU5UJykgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IGV2ZW50ID0gbWVzc2FnZVsyXSBhcyBOb3N0ckV2ZW50O1xuICAgIFxuICAgIC8vINCd0LUg0L7QsdGA0LDQsdCw0YLRi9Cy0LDQtdC8INGB0LLQvtC4INGB0L7QsdGL0YLQuNGPXG4gICAgaWYgKGV2ZW50LnB1YmtleSA9PT0gdGhpcy5wdWJsaWNLZXkpIHJldHVybjtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8g0KDQsNGB0YjQuNGE0YDQvtCy0YvQstCw0LXQvCDRgdC+0LTQtdGA0LbQuNC80L7QtSAoTklQLTA0KVxuICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgbmlwMDQuZGVjcnlwdChcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5LCBcbiAgICAgICAgZXZlbnQucHVia2V5ISxcbiAgICAgICAgZXZlbnQuY29udGVudFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGRlY3J5cHRlZCk7XG4gICAgICBjb25zdCBjYWxsSWQgPSBldmVudC50YWdzLmZpbmQodCA9PiB0WzBdID09PSAnY2FsbC1pZCcpPy5bMV0gfHwgJyc7XG4gICAgICBcbiAgICAgIHN3aXRjaCAoZXZlbnQua2luZCkge1xuICAgICAgICBjYXNlIDI1MDUwOiAvLyBPZmZlclxuICAgICAgICAgIHRoaXMub25PZmZlcj8uKGRhdGEuc2RwLCBldmVudC5wdWJrZXkhLCBjYWxsSWQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI1MDUxOiAvLyBBbnN3ZXJcbiAgICAgICAgICB0aGlzLm9uQW5zd2VyPy4oZGF0YS5zZHAsIGV2ZW50LnB1YmtleSEsIGNhbGxJZCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjUwNTI6IC8vIElDRSBDYW5kaWRhdGVcbiAgICAgICAgICB0aGlzLm9uSWNlQ2FuZGlkYXRlPy4oZGF0YS5jYW5kaWRhdGUsIGV2ZW50LnB1YmtleSEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI1MDUzOiAvLyBIYW5ndXBcbiAgICAgICAgICB0aGlzLm9uSGFuZ3VwPy4oZXZlbnQucHVia2V5ISwgY2FsbElkKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyNTA1NDogLy8gUmVqZWN0XG4gICAgICAgICAgdGhpcy5vblJlamVjdD8uKGV2ZW50LnB1YmtleSEsIGNhbGxJZCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcHJvY2VzcyBzaWduYWxpbmcgZXZlbnQ6JywgZXJyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNlbmRTaWduYWxpbmdFdmVudChcbiAgICBraW5kOiBudW1iZXIsXG4gICAgcmVjaXBpZW50UHVia2V5OiBzdHJpbmcsXG4gICAgZGF0YTogYW55LFxuICAgIGNhbGxJZDogc3RyaW5nXG4gICkge1xuICAgIC8vINCo0LjRhNGA0YPQtdC8INC00LDQvdC90YvQtSAoTklQLTA0KVxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGF3YWl0IG5pcDA0LmVuY3J5cHQoXG4gICAgICB0aGlzLnByaXZhdGVLZXksXG4gICAgICByZWNpcGllbnRQdWJrZXksXG4gICAgICBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICk7XG5cbiAgICBjb25zdCBldmVudCA9IGZpbmFsaXplRXZlbnQoe1xuICAgICAga2luZCxcbiAgICAgIGNyZWF0ZWRfYXQ6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApLFxuICAgICAgdGFnczogW1xuICAgICAgICBbJ3AnLCByZWNpcGllbnRQdWJrZXldLFxuICAgICAgICBbJ2NhbGwtaWQnLCBjYWxsSWRdLFxuICAgICAgICBbJ2V4cGlyYXRpb24nLCBTdHJpbmcoTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgKyAzMDApXSwgLy8gNSDQvNC40L0gVFRMXG4gICAgICBdLFxuICAgICAgY29udGVudDogZW5jcnlwdGVkLFxuICAgIH0sIHRoaXMucHJpdmF0ZUtleSk7XG5cbiAgICB0aGlzLndzLnNlbmQoSlNPTi5zdHJpbmdpZnkoWydFVkVOVCcsIGV2ZW50XSkpO1xuICB9XG5cbiAgYXN5bmMgc2VuZE9mZmVyKHJlY2lwaWVudFB1YmtleTogc3RyaW5nLCBzZHA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbkluaXQsIGNhbGxJZDogc3RyaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5zZW5kU2lnbmFsaW5nRXZlbnQoMjUwNTAsIHJlY2lwaWVudFB1YmtleSwgeyBzZHAgfSwgY2FsbElkKTtcbiAgfVxuXG4gIGFzeW5jIHNlbmRBbnN3ZXIocmVjaXBpZW50UHVia2V5OiBzdHJpbmcsIHNkcDogUlRDU2Vzc2lvbkRlc2NyaXB0aW9uSW5pdCwgY2FsbElkOiBzdHJpbmcpIHtcbiAgICBhd2FpdCB0aGlzLnNlbmRTaWduYWxpbmdFdmVudCgyNTA1MSwgcmVjaXBpZW50UHVia2V5LCB7IHNkcCB9LCBjYWxsSWQpO1xuICB9XG5cbiAgYXN5bmMgc2VuZEljZUNhbmRpZGF0ZShyZWNpcGllbnRQdWJrZXk6IHN0cmluZywgY2FuZGlkYXRlOiBSVENJY2VDYW5kaWRhdGVJbml0LCBjYWxsSWQ6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuc2VuZFNpZ25hbGluZ0V2ZW50KDI1MDUyLCByZWNpcGllbnRQdWJrZXksIHsgY2FuZGlkYXRlIH0sIGNhbGxJZCk7XG4gIH1cblxuICBhc3luYyBzZW5kSGFuZ3VwKHJlY2lwaWVudFB1YmtleTogc3RyaW5nLCBjYWxsSWQ6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuc2VuZFNpZ25hbGluZ0V2ZW50KDI1MDUzLCByZWNpcGllbnRQdWJrZXksIHt9LCBjYWxsSWQpO1xuICB9XG5cbiAgYXN5bmMgc2VuZFJlamVjdChyZWNpcGllbnRQdWJrZXk6IHN0cmluZywgY2FsbElkOiBzdHJpbmcpIHtcbiAgICBhd2FpdCB0aGlzLnNlbmRTaWduYWxpbmdFdmVudCgyNTA1NCwgcmVjaXBpZW50UHVia2V5LCB7fSwgY2FsbElkKTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uSWQpIHtcbiAgICAgIHRoaXMud3Muc2VuZChKU09OLnN0cmluZ2lmeShbJ0NMT1NFJywgdGhpcy5zdWJzY3JpcHRpb25JZF0pKTtcbiAgICB9XG4gICAgdGhpcy53cy5jbG9zZSgpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiZ2V0UHVibGljS2V5IiwibmlwMDQiLCJmaW5hbGl6ZUV2ZW50IiwiTm9zdHJTaWduYWxpbmciLCJjb25uZWN0UmVsYXkiLCJ3cyIsIldlYlNvY2tldCIsInJlbGF5VXJsIiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsInN1YnNjcmliZVRvU2lnbmFsaW5nIiwib25tZXNzYWdlIiwiZXZlbnQiLCJoYW5kbGVSZWxheU1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwib25jbG9zZSIsInNldFRpbWVvdXQiLCJzdWJzY3JpcHRpb25JZCIsIkRhdGUiLCJub3ciLCJmaWx0ZXIiLCJraW5kcyIsInB1YmxpY0tleSIsInNpbmNlIiwiTWF0aCIsImZsb29yIiwic2VuZCIsInN0cmluZ2lmeSIsIm1lc3NhZ2UiLCJwdWJrZXkiLCJkZWNyeXB0ZWQiLCJkZWNyeXB0IiwicHJpdmF0ZUtleSIsImNvbnRlbnQiLCJjYWxsSWQiLCJ0YWdzIiwiZmluZCIsInQiLCJraW5kIiwib25PZmZlciIsInNkcCIsIm9uQW5zd2VyIiwib25JY2VDYW5kaWRhdGUiLCJjYW5kaWRhdGUiLCJvbkhhbmd1cCIsIm9uUmVqZWN0IiwiZXJyIiwiZXJyb3IiLCJzZW5kU2lnbmFsaW5nRXZlbnQiLCJyZWNpcGllbnRQdWJrZXkiLCJlbmNyeXB0ZWQiLCJlbmNyeXB0IiwiY3JlYXRlZF9hdCIsIlN0cmluZyIsInNlbmRPZmZlciIsInNlbmRBbnN3ZXIiLCJzZW5kSWNlQ2FuZGlkYXRlIiwic2VuZEhhbmd1cCIsInNlbmRSZWplY3QiLCJkZXN0cm95IiwiY2xvc2UiLCJjb25zdHJ1Y3RvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/nostr-signaling.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@noble/ciphers/_arx.js":
/*!*********************************************!*\
  !*** ./node_modules/@noble/ciphers/_arx.js ***!
  \*********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _XorStreamPRG: function() { return /* binding */ _XorStreamPRG; },\n/* harmony export */   createCipher: function() { return /* binding */ createCipher; },\n/* harmony export */   createPRG: function() { return /* binding */ createPRG; },\n/* harmony export */   rotl: function() { return /* binding */ rotl; }\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/utils.js\");\n/**\n * Basic utils for ARX (add-rotate-xor) salsa and chacha ciphers.\n\nRFC8439 requires multi-step cipher stream, where\nauthKey starts with counter: 0, actual msg with counter: 1.\n\nFor this, we need a way to re-use nonce / counter:\n\n    const counter = new Uint8Array(4);\n    chacha(..., counter, ...); // counter is now 1\n    chacha(..., counter, ...); // counter is now 2\n\nThis is complicated:\n\n- 32-bit counters are enough, no need for 64-bit: max ArrayBuffer size in JS is 4GB\n- Original papers don't allow mutating counters\n- Counter overflow is undefined [^1]\n- Idea A: allow providing (nonce | counter) instead of just nonce, re-use it\n- Caveat: Cannot be re-used through all cases:\n- * chacha has (counter | nonce)\n- * xchacha has (nonce16 | counter | nonce16)\n- Idea B: separate nonce / counter and provide separate API for counter re-use\n- Caveat: there are different counter sizes depending on an algorithm.\n- salsa & chacha also differ in structures of key & sigma:\n  salsa20:      s[0] | k(4) | s[1] | nonce(2) | cnt(2) | s[2] | k(4) | s[3]\n  chacha:       s(4) | k(8) | cnt(1) | nonce(3)\n  chacha20orig: s(4) | k(8) | cnt(2) | nonce(2)\n- Idea C: helper method such as `setSalsaState(key, nonce, sigma, data)`\n- Caveat: we can't re-use counter array\n\nxchacha [^2] uses the subkey and remaining 8 byte nonce with ChaCha20 as normal\n(prefixed by 4 NUL bytes, since [RFC8439] specifies a 12-byte nonce).\n\n[^1]: https://mailarchive.ietf.org/arch/msg/cfrg/gsOnTJzcbgG6OqD8Sc0GO5aR_tU/\n[^2]: https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha#appendix-A.2\n\n * @module\n */\n\n// Replaces `TextEncoder`, which is not available in all environments\nconst encodeStr = (str) => Uint8Array.from(str.split(''), (c) => c.charCodeAt(0));\nconst sigma16 = encodeStr('expand 16-byte k');\nconst sigma32 = encodeStr('expand 32-byte k');\nconst sigma16_32 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(sigma16);\nconst sigma32_32 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(sigma32);\n/** Rotate left. */\nfunction rotl(a, b) {\n    return (a << b) | (a >>> (32 - b));\n}\n// Is byte array aligned to 4 byte offset (u32)?\nfunction isAligned32(b) {\n    return b.byteOffset % 4 === 0;\n}\n// Salsa and Chacha block length is always 512-bit\nconst BLOCK_LEN = 64;\nconst BLOCK_LEN32 = 16;\n// new Uint32Array([2**32])   // => Uint32Array(1) [ 0 ]\n// new Uint32Array([2**32-1]) // => Uint32Array(1) [ 4294967295 ]\nconst MAX_COUNTER = 2 ** 32 - 1;\nconst U32_EMPTY = Uint32Array.of();\nfunction runCipher(core, sigma, key, nonce, data, output, counter, rounds) {\n    const len = data.length;\n    const block = new Uint8Array(BLOCK_LEN);\n    const b32 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(block);\n    // Make sure that buffers aligned to 4 bytes\n    const isAligned = isAligned32(data) && isAligned32(output);\n    const d32 = isAligned ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(data) : U32_EMPTY;\n    const o32 = isAligned ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(output) : U32_EMPTY;\n    for (let pos = 0; pos < len; counter++) {\n        core(sigma, key, nonce, b32, counter, rounds);\n        if (counter >= MAX_COUNTER)\n            throw new Error('arx: counter overflow');\n        const take = Math.min(BLOCK_LEN, len - pos);\n        // aligned to 4 bytes\n        if (isAligned && take === BLOCK_LEN) {\n            const pos32 = pos / 4;\n            if (pos % 4 !== 0)\n                throw new Error('arx: invalid block position');\n            for (let j = 0, posj; j < BLOCK_LEN32; j++) {\n                posj = pos32 + j;\n                o32[posj] = d32[posj] ^ b32[j];\n            }\n            pos += BLOCK_LEN;\n            continue;\n        }\n        for (let j = 0, posj; j < take; j++) {\n            posj = pos + j;\n            output[posj] = data[posj] ^ block[j];\n        }\n        pos += take;\n    }\n}\n/** Creates ARX-like (ChaCha, Salsa) cipher stream from core function. */\nfunction createCipher(core, opts) {\n    const { allowShortKeys, extendNonceFn, counterLength, counterRight, rounds } = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.checkOpts)({ allowShortKeys: false, counterLength: 8, counterRight: false, rounds: 20 }, opts);\n    if (typeof core !== 'function')\n        throw new Error('core must be a function');\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.anumber)(counterLength);\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.anumber)(rounds);\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abool)(counterRight);\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abool)(allowShortKeys);\n    return (key, nonce, data, output, counter = 0) => {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(key, undefined, 'key');\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(nonce, undefined, 'nonce');\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(data, undefined, 'data');\n        const len = data.length;\n        if (output === undefined)\n            output = new Uint8Array(len);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(output, undefined, 'output');\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.anumber)(counter);\n        if (counter < 0 || counter >= MAX_COUNTER)\n            throw new Error('arx: counter overflow');\n        if (output.length < len)\n            throw new Error(`arx: output (${output.length}) is shorter than data (${len})`);\n        const toClean = [];\n        // Key & sigma\n        // key=16 -> sigma16, k=key|key\n        // key=32 -> sigma32, k=key\n        let l = key.length;\n        let k;\n        let sigma;\n        if (l === 32) {\n            toClean.push((k = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.copyBytes)(key)));\n            sigma = sigma32_32;\n        }\n        else if (l === 16 && allowShortKeys) {\n            k = new Uint8Array(32);\n            k.set(key);\n            k.set(key, 16);\n            sigma = sigma16_32;\n            toClean.push(k);\n        }\n        else {\n            (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(key, 32, 'arx key');\n            throw new Error('invalid key size');\n            // throw new Error(`\"arx key\" expected Uint8Array of length 32, got length=${l}`);\n        }\n        // Nonce\n        // salsa20:      8   (8-byte counter)\n        // chacha20orig: 8   (8-byte counter)\n        // chacha20:     12  (4-byte counter)\n        // xsalsa20:     24  (16 -> hsalsa,  8 -> old nonce)\n        // xchacha20:    24  (16 -> hchacha, 8 -> old nonce)\n        // Align nonce to 4 bytes\n        if (!isAligned32(nonce))\n            toClean.push((nonce = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.copyBytes)(nonce)));\n        const k32 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(k);\n        // hsalsa & hchacha: handle extended nonce\n        if (extendNonceFn) {\n            if (nonce.length !== 24)\n                throw new Error(`arx: extended nonce must be 24 bytes`);\n            extendNonceFn(sigma, k32, (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(nonce.subarray(0, 16)), k32);\n            nonce = nonce.subarray(16);\n        }\n        // Handle nonce counter\n        const nonceNcLen = 16 - counterLength;\n        if (nonceNcLen !== nonce.length)\n            throw new Error(`arx: nonce must be ${nonceNcLen} or 16 bytes`);\n        // Pad counter when nonce is 64 bit\n        if (nonceNcLen !== 12) {\n            const nc = new Uint8Array(12);\n            nc.set(nonce, counterRight ? 0 : 12 - nonce.length);\n            nonce = nc;\n            toClean.push(nonce);\n        }\n        const n32 = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.u32)(nonce);\n        runCipher(core, sigma, k32, n32, data, output, counter, rounds);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.clean)(...toClean);\n        return output;\n    };\n}\n/** Internal class which wraps chacha20 or chacha8 to create CSPRNG. */\nclass _XorStreamPRG {\n    blockLen;\n    keyLen;\n    nonceLen;\n    state;\n    buf;\n    key;\n    nonce;\n    pos;\n    ctr;\n    cipher;\n    constructor(cipher, blockLen, keyLen, nonceLen, seed) {\n        this.cipher = cipher;\n        this.blockLen = blockLen;\n        this.keyLen = keyLen;\n        this.nonceLen = nonceLen;\n        this.state = new Uint8Array(this.keyLen + this.nonceLen);\n        this.reseed(seed);\n        this.ctr = 0;\n        this.pos = this.blockLen;\n        this.buf = new Uint8Array(this.blockLen);\n        this.key = this.state.subarray(0, this.keyLen);\n        this.nonce = this.state.subarray(this.keyLen);\n    }\n    reseed(seed) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(seed);\n        if (!seed || seed.length === 0)\n            throw new Error('entropy required');\n        for (let i = 0; i < seed.length; i++)\n            this.state[i % this.state.length] ^= seed[i];\n        this.ctr = 0;\n        this.pos = this.blockLen;\n    }\n    addEntropy(seed) {\n        this.state.set(this.randomBytes(this.state.length));\n        this.reseed(seed);\n    }\n    randomBytes(len) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.anumber)(len);\n        if (len === 0)\n            return new Uint8Array(0);\n        const out = new Uint8Array(len);\n        let outPos = 0;\n        // Leftovers\n        if (this.pos < this.blockLen) {\n            const take = Math.min(len, this.blockLen - this.pos);\n            out.set(this.buf.subarray(this.pos, this.pos + take), 0);\n            this.pos += take;\n            outPos += take;\n            if (outPos === len)\n                return out; // fast path\n        }\n        // Full blocks directly to out\n        const blocks = Math.floor((len - outPos) / this.blockLen);\n        if (blocks > 0) {\n            const blockBytes = blocks * this.blockLen;\n            const b = out.subarray(outPos, outPos + blockBytes);\n            this.cipher(this.key, this.nonce, b, b, this.ctr);\n            this.ctr += blocks;\n            outPos += blockBytes;\n        }\n        // Save leftovers\n        const left = len - outPos;\n        if (left > 0) {\n            this.buf.fill(0);\n            // NOTE: cipher will handle overflow\n            this.cipher(this.key, this.nonce, this.buf, this.buf, this.ctr++);\n            out.set(this.buf.subarray(0, left), outPos);\n            this.pos = left;\n        }\n        return out;\n    }\n    clone() {\n        return new _XorStreamPRG(this.cipher, this.blockLen, this.keyLen, this.nonceLen, this.randomBytes(this.state.length));\n    }\n    clean() {\n        this.pos = 0;\n        this.ctr = 0;\n        this.buf.fill(0);\n        this.state.fill(0);\n    }\n}\nconst createPRG = (cipher, blockLen, keyLen, nonceLen) => {\n    return (seed = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.randomBytes)(32)) => new _XorStreamPRG(cipher, blockLen, keyLen, nonceLen, seed);\n};\n//# sourceMappingURL=_arx.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9Abm9ibGUvY2lwaGVycy9fYXJ4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsK0JBQStCO0FBQy9CLCtCQUErQjs7QUFFL0I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ29HO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhDQUFHO0FBQ3RCLG1CQUFtQiw4Q0FBRztBQUN0QjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOENBQUc7QUFDbkI7QUFDQTtBQUNBLDRCQUE0Qiw4Q0FBRztBQUMvQiw0QkFBNEIsOENBQUc7QUFDL0Isc0JBQXNCLFdBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGlCQUFpQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsVUFBVTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxxRUFBcUUsRUFBRSxvREFBUyxHQUFHLDBFQUEwRTtBQUN6SztBQUNBO0FBQ0EsSUFBSSxrREFBTztBQUNYLElBQUksa0RBQU87QUFDWCxJQUFJLGdEQUFLO0FBQ1QsSUFBSSxnREFBSztBQUNUO0FBQ0EsUUFBUSxpREFBTTtBQUNkLFFBQVEsaURBQU07QUFDZCxRQUFRLGlEQUFNO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpREFBTTtBQUNkLFFBQVEsa0RBQU87QUFDZjtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsY0FBYywwQkFBMEIsSUFBSTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9EQUFTO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpREFBTTtBQUNsQjtBQUNBLHlGQUF5RixFQUFFO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxvREFBUztBQUMzQyxvQkFBb0IsOENBQUc7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsOENBQUc7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxZQUFZO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDhDQUFHO0FBQ3ZCO0FBQ0EsUUFBUSxnREFBSztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlEQUFNO0FBQ2Q7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrREFBTztBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLG1CQUFtQixzREFBVztBQUM5QjtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9Abm9ibGUvY2lwaGVycy9fYXJ4LmpzPzZlNGEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBCYXNpYyB1dGlscyBmb3IgQVJYIChhZGQtcm90YXRlLXhvcikgc2Fsc2EgYW5kIGNoYWNoYSBjaXBoZXJzLlxuXG5SRkM4NDM5IHJlcXVpcmVzIG11bHRpLXN0ZXAgY2lwaGVyIHN0cmVhbSwgd2hlcmVcbmF1dGhLZXkgc3RhcnRzIHdpdGggY291bnRlcjogMCwgYWN0dWFsIG1zZyB3aXRoIGNvdW50ZXI6IDEuXG5cbkZvciB0aGlzLCB3ZSBuZWVkIGEgd2F5IHRvIHJlLXVzZSBub25jZSAvIGNvdW50ZXI6XG5cbiAgICBjb25zdCBjb3VudGVyID0gbmV3IFVpbnQ4QXJyYXkoNCk7XG4gICAgY2hhY2hhKC4uLiwgY291bnRlciwgLi4uKTsgLy8gY291bnRlciBpcyBub3cgMVxuICAgIGNoYWNoYSguLi4sIGNvdW50ZXIsIC4uLik7IC8vIGNvdW50ZXIgaXMgbm93IDJcblxuVGhpcyBpcyBjb21wbGljYXRlZDpcblxuLSAzMi1iaXQgY291bnRlcnMgYXJlIGVub3VnaCwgbm8gbmVlZCBmb3IgNjQtYml0OiBtYXggQXJyYXlCdWZmZXIgc2l6ZSBpbiBKUyBpcyA0R0Jcbi0gT3JpZ2luYWwgcGFwZXJzIGRvbid0IGFsbG93IG11dGF0aW5nIGNvdW50ZXJzXG4tIENvdW50ZXIgb3ZlcmZsb3cgaXMgdW5kZWZpbmVkIFteMV1cbi0gSWRlYSBBOiBhbGxvdyBwcm92aWRpbmcgKG5vbmNlIHwgY291bnRlcikgaW5zdGVhZCBvZiBqdXN0IG5vbmNlLCByZS11c2UgaXRcbi0gQ2F2ZWF0OiBDYW5ub3QgYmUgcmUtdXNlZCB0aHJvdWdoIGFsbCBjYXNlczpcbi0gKiBjaGFjaGEgaGFzIChjb3VudGVyIHwgbm9uY2UpXG4tICogeGNoYWNoYSBoYXMgKG5vbmNlMTYgfCBjb3VudGVyIHwgbm9uY2UxNilcbi0gSWRlYSBCOiBzZXBhcmF0ZSBub25jZSAvIGNvdW50ZXIgYW5kIHByb3ZpZGUgc2VwYXJhdGUgQVBJIGZvciBjb3VudGVyIHJlLXVzZVxuLSBDYXZlYXQ6IHRoZXJlIGFyZSBkaWZmZXJlbnQgY291bnRlciBzaXplcyBkZXBlbmRpbmcgb24gYW4gYWxnb3JpdGhtLlxuLSBzYWxzYSAmIGNoYWNoYSBhbHNvIGRpZmZlciBpbiBzdHJ1Y3R1cmVzIG9mIGtleSAmIHNpZ21hOlxuICBzYWxzYTIwOiAgICAgIHNbMF0gfCBrKDQpIHwgc1sxXSB8IG5vbmNlKDIpIHwgY250KDIpIHwgc1syXSB8IGsoNCkgfCBzWzNdXG4gIGNoYWNoYTogICAgICAgcyg0KSB8IGsoOCkgfCBjbnQoMSkgfCBub25jZSgzKVxuICBjaGFjaGEyMG9yaWc6IHMoNCkgfCBrKDgpIHwgY250KDIpIHwgbm9uY2UoMilcbi0gSWRlYSBDOiBoZWxwZXIgbWV0aG9kIHN1Y2ggYXMgYHNldFNhbHNhU3RhdGUoa2V5LCBub25jZSwgc2lnbWEsIGRhdGEpYFxuLSBDYXZlYXQ6IHdlIGNhbid0IHJlLXVzZSBjb3VudGVyIGFycmF5XG5cbnhjaGFjaGEgW14yXSB1c2VzIHRoZSBzdWJrZXkgYW5kIHJlbWFpbmluZyA4IGJ5dGUgbm9uY2Ugd2l0aCBDaGFDaGEyMCBhcyBub3JtYWxcbihwcmVmaXhlZCBieSA0IE5VTCBieXRlcywgc2luY2UgW1JGQzg0MzldIHNwZWNpZmllcyBhIDEyLWJ5dGUgbm9uY2UpLlxuXG5bXjFdOiBodHRwczovL21haWxhcmNoaXZlLmlldGYub3JnL2FyY2gvbXNnL2NmcmcvZ3NPblRKemNiZ0c2T3FEOFNjMEdPNWFSX3RVL1xuW14yXTogaHR0cHM6Ly9kYXRhdHJhY2tlci5pZXRmLm9yZy9kb2MvaHRtbC9kcmFmdC1pcnRmLWNmcmcteGNoYWNoYSNhcHBlbmRpeC1BLjJcblxuICogQG1vZHVsZVxuICovXG5pbXBvcnQgeyBhYm9vbCwgYWJ5dGVzLCBhbnVtYmVyLCBjaGVja09wdHMsIGNsZWFuLCBjb3B5Qnl0ZXMsIHJhbmRvbUJ5dGVzLCB1MzIsIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbi8vIFJlcGxhY2VzIGBUZXh0RW5jb2RlcmAsIHdoaWNoIGlzIG5vdCBhdmFpbGFibGUgaW4gYWxsIGVudmlyb25tZW50c1xuY29uc3QgZW5jb2RlU3RyID0gKHN0cikgPT4gVWludDhBcnJheS5mcm9tKHN0ci5zcGxpdCgnJyksIChjKSA9PiBjLmNoYXJDb2RlQXQoMCkpO1xuY29uc3Qgc2lnbWExNiA9IGVuY29kZVN0cignZXhwYW5kIDE2LWJ5dGUgaycpO1xuY29uc3Qgc2lnbWEzMiA9IGVuY29kZVN0cignZXhwYW5kIDMyLWJ5dGUgaycpO1xuY29uc3Qgc2lnbWExNl8zMiA9IHUzMihzaWdtYTE2KTtcbmNvbnN0IHNpZ21hMzJfMzIgPSB1MzIoc2lnbWEzMik7XG4vKiogUm90YXRlIGxlZnQuICovXG5leHBvcnQgZnVuY3Rpb24gcm90bChhLCBiKSB7XG4gICAgcmV0dXJuIChhIDw8IGIpIHwgKGEgPj4+ICgzMiAtIGIpKTtcbn1cbi8vIElzIGJ5dGUgYXJyYXkgYWxpZ25lZCB0byA0IGJ5dGUgb2Zmc2V0ICh1MzIpP1xuZnVuY3Rpb24gaXNBbGlnbmVkMzIoYikge1xuICAgIHJldHVybiBiLmJ5dGVPZmZzZXQgJSA0ID09PSAwO1xufVxuLy8gU2Fsc2EgYW5kIENoYWNoYSBibG9jayBsZW5ndGggaXMgYWx3YXlzIDUxMi1iaXRcbmNvbnN0IEJMT0NLX0xFTiA9IDY0O1xuY29uc3QgQkxPQ0tfTEVOMzIgPSAxNjtcbi8vIG5ldyBVaW50MzJBcnJheShbMioqMzJdKSAgIC8vID0+IFVpbnQzMkFycmF5KDEpIFsgMCBdXG4vLyBuZXcgVWludDMyQXJyYXkoWzIqKjMyLTFdKSAvLyA9PiBVaW50MzJBcnJheSgxKSBbIDQyOTQ5NjcyOTUgXVxuY29uc3QgTUFYX0NPVU5URVIgPSAyICoqIDMyIC0gMTtcbmNvbnN0IFUzMl9FTVBUWSA9IFVpbnQzMkFycmF5Lm9mKCk7XG5mdW5jdGlvbiBydW5DaXBoZXIoY29yZSwgc2lnbWEsIGtleSwgbm9uY2UsIGRhdGEsIG91dHB1dCwgY291bnRlciwgcm91bmRzKSB7XG4gICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgY29uc3QgYmxvY2sgPSBuZXcgVWludDhBcnJheShCTE9DS19MRU4pO1xuICAgIGNvbnN0IGIzMiA9IHUzMihibG9jayk7XG4gICAgLy8gTWFrZSBzdXJlIHRoYXQgYnVmZmVycyBhbGlnbmVkIHRvIDQgYnl0ZXNcbiAgICBjb25zdCBpc0FsaWduZWQgPSBpc0FsaWduZWQzMihkYXRhKSAmJiBpc0FsaWduZWQzMihvdXRwdXQpO1xuICAgIGNvbnN0IGQzMiA9IGlzQWxpZ25lZCA/IHUzMihkYXRhKSA6IFUzMl9FTVBUWTtcbiAgICBjb25zdCBvMzIgPSBpc0FsaWduZWQgPyB1MzIob3V0cHV0KSA6IFUzMl9FTVBUWTtcbiAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47IGNvdW50ZXIrKykge1xuICAgICAgICBjb3JlKHNpZ21hLCBrZXksIG5vbmNlLCBiMzIsIGNvdW50ZXIsIHJvdW5kcyk7XG4gICAgICAgIGlmIChjb3VudGVyID49IE1BWF9DT1VOVEVSKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdhcng6IGNvdW50ZXIgb3ZlcmZsb3cnKTtcbiAgICAgICAgY29uc3QgdGFrZSA9IE1hdGgubWluKEJMT0NLX0xFTiwgbGVuIC0gcG9zKTtcbiAgICAgICAgLy8gYWxpZ25lZCB0byA0IGJ5dGVzXG4gICAgICAgIGlmIChpc0FsaWduZWQgJiYgdGFrZSA9PT0gQkxPQ0tfTEVOKSB7XG4gICAgICAgICAgICBjb25zdCBwb3MzMiA9IHBvcyAvIDQ7XG4gICAgICAgICAgICBpZiAocG9zICUgNCAhPT0gMClcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FyeDogaW52YWxpZCBibG9jayBwb3NpdGlvbicpO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIHBvc2o7IGogPCBCTE9DS19MRU4zMjsgaisrKSB7XG4gICAgICAgICAgICAgICAgcG9zaiA9IHBvczMyICsgajtcbiAgICAgICAgICAgICAgICBvMzJbcG9zal0gPSBkMzJbcG9zal0gXiBiMzJbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3MgKz0gQkxPQ0tfTEVOO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaiA9IDAsIHBvc2o7IGogPCB0YWtlOyBqKyspIHtcbiAgICAgICAgICAgIHBvc2ogPSBwb3MgKyBqO1xuICAgICAgICAgICAgb3V0cHV0W3Bvc2pdID0gZGF0YVtwb3NqXSBeIGJsb2NrW2pdO1xuICAgICAgICB9XG4gICAgICAgIHBvcyArPSB0YWtlO1xuICAgIH1cbn1cbi8qKiBDcmVhdGVzIEFSWC1saWtlIChDaGFDaGEsIFNhbHNhKSBjaXBoZXIgc3RyZWFtIGZyb20gY29yZSBmdW5jdGlvbi4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDaXBoZXIoY29yZSwgb3B0cykge1xuICAgIGNvbnN0IHsgYWxsb3dTaG9ydEtleXMsIGV4dGVuZE5vbmNlRm4sIGNvdW50ZXJMZW5ndGgsIGNvdW50ZXJSaWdodCwgcm91bmRzIH0gPSBjaGVja09wdHMoeyBhbGxvd1Nob3J0S2V5czogZmFsc2UsIGNvdW50ZXJMZW5ndGg6IDgsIGNvdW50ZXJSaWdodDogZmFsc2UsIHJvdW5kczogMjAgfSwgb3B0cyk7XG4gICAgaWYgKHR5cGVvZiBjb3JlICE9PSAnZnVuY3Rpb24nKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvcmUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgYW51bWJlcihjb3VudGVyTGVuZ3RoKTtcbiAgICBhbnVtYmVyKHJvdW5kcyk7XG4gICAgYWJvb2woY291bnRlclJpZ2h0KTtcbiAgICBhYm9vbChhbGxvd1Nob3J0S2V5cyk7XG4gICAgcmV0dXJuIChrZXksIG5vbmNlLCBkYXRhLCBvdXRwdXQsIGNvdW50ZXIgPSAwKSA9PiB7XG4gICAgICAgIGFieXRlcyhrZXksIHVuZGVmaW5lZCwgJ2tleScpO1xuICAgICAgICBhYnl0ZXMobm9uY2UsIHVuZGVmaW5lZCwgJ25vbmNlJyk7XG4gICAgICAgIGFieXRlcyhkYXRhLCB1bmRlZmluZWQsICdkYXRhJyk7XG4gICAgICAgIGNvbnN0IGxlbiA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBpZiAob3V0cHV0ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBvdXRwdXQgPSBuZXcgVWludDhBcnJheShsZW4pO1xuICAgICAgICBhYnl0ZXMob3V0cHV0LCB1bmRlZmluZWQsICdvdXRwdXQnKTtcbiAgICAgICAgYW51bWJlcihjb3VudGVyKTtcbiAgICAgICAgaWYgKGNvdW50ZXIgPCAwIHx8IGNvdW50ZXIgPj0gTUFYX0NPVU5URVIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FyeDogY291bnRlciBvdmVyZmxvdycpO1xuICAgICAgICBpZiAob3V0cHV0Lmxlbmd0aCA8IGxlbilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgYXJ4OiBvdXRwdXQgKCR7b3V0cHV0Lmxlbmd0aH0pIGlzIHNob3J0ZXIgdGhhbiBkYXRhICgke2xlbn0pYCk7XG4gICAgICAgIGNvbnN0IHRvQ2xlYW4gPSBbXTtcbiAgICAgICAgLy8gS2V5ICYgc2lnbWFcbiAgICAgICAgLy8ga2V5PTE2IC0+IHNpZ21hMTYsIGs9a2V5fGtleVxuICAgICAgICAvLyBrZXk9MzIgLT4gc2lnbWEzMiwgaz1rZXlcbiAgICAgICAgbGV0IGwgPSBrZXkubGVuZ3RoO1xuICAgICAgICBsZXQgaztcbiAgICAgICAgbGV0IHNpZ21hO1xuICAgICAgICBpZiAobCA9PT0gMzIpIHtcbiAgICAgICAgICAgIHRvQ2xlYW4ucHVzaCgoayA9IGNvcHlCeXRlcyhrZXkpKSk7XG4gICAgICAgICAgICBzaWdtYSA9IHNpZ21hMzJfMzI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobCA9PT0gMTYgJiYgYWxsb3dTaG9ydEtleXMpIHtcbiAgICAgICAgICAgIGsgPSBuZXcgVWludDhBcnJheSgzMik7XG4gICAgICAgICAgICBrLnNldChrZXkpO1xuICAgICAgICAgICAgay5zZXQoa2V5LCAxNik7XG4gICAgICAgICAgICBzaWdtYSA9IHNpZ21hMTZfMzI7XG4gICAgICAgICAgICB0b0NsZWFuLnB1c2goayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhYnl0ZXMoa2V5LCAzMiwgJ2FyeCBrZXknKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBrZXkgc2l6ZScpO1xuICAgICAgICAgICAgLy8gdGhyb3cgbmV3IEVycm9yKGBcImFyeCBrZXlcIiBleHBlY3RlZCBVaW50OEFycmF5IG9mIGxlbmd0aCAzMiwgZ290IGxlbmd0aD0ke2x9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm9uY2VcbiAgICAgICAgLy8gc2Fsc2EyMDogICAgICA4ICAgKDgtYnl0ZSBjb3VudGVyKVxuICAgICAgICAvLyBjaGFjaGEyMG9yaWc6IDggICAoOC1ieXRlIGNvdW50ZXIpXG4gICAgICAgIC8vIGNoYWNoYTIwOiAgICAgMTIgICg0LWJ5dGUgY291bnRlcilcbiAgICAgICAgLy8geHNhbHNhMjA6ICAgICAyNCAgKDE2IC0+IGhzYWxzYSwgIDggLT4gb2xkIG5vbmNlKVxuICAgICAgICAvLyB4Y2hhY2hhMjA6ICAgIDI0ICAoMTYgLT4gaGNoYWNoYSwgOCAtPiBvbGQgbm9uY2UpXG4gICAgICAgIC8vIEFsaWduIG5vbmNlIHRvIDQgYnl0ZXNcbiAgICAgICAgaWYgKCFpc0FsaWduZWQzMihub25jZSkpXG4gICAgICAgICAgICB0b0NsZWFuLnB1c2goKG5vbmNlID0gY29weUJ5dGVzKG5vbmNlKSkpO1xuICAgICAgICBjb25zdCBrMzIgPSB1MzIoayk7XG4gICAgICAgIC8vIGhzYWxzYSAmIGhjaGFjaGE6IGhhbmRsZSBleHRlbmRlZCBub25jZVxuICAgICAgICBpZiAoZXh0ZW5kTm9uY2VGbikge1xuICAgICAgICAgICAgaWYgKG5vbmNlLmxlbmd0aCAhPT0gMjQpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBhcng6IGV4dGVuZGVkIG5vbmNlIG11c3QgYmUgMjQgYnl0ZXNgKTtcbiAgICAgICAgICAgIGV4dGVuZE5vbmNlRm4oc2lnbWEsIGszMiwgdTMyKG5vbmNlLnN1YmFycmF5KDAsIDE2KSksIGszMik7XG4gICAgICAgICAgICBub25jZSA9IG5vbmNlLnN1YmFycmF5KDE2KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBIYW5kbGUgbm9uY2UgY291bnRlclxuICAgICAgICBjb25zdCBub25jZU5jTGVuID0gMTYgLSBjb3VudGVyTGVuZ3RoO1xuICAgICAgICBpZiAobm9uY2VOY0xlbiAhPT0gbm9uY2UubGVuZ3RoKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBhcng6IG5vbmNlIG11c3QgYmUgJHtub25jZU5jTGVufSBvciAxNiBieXRlc2ApO1xuICAgICAgICAvLyBQYWQgY291bnRlciB3aGVuIG5vbmNlIGlzIDY0IGJpdFxuICAgICAgICBpZiAobm9uY2VOY0xlbiAhPT0gMTIpIHtcbiAgICAgICAgICAgIGNvbnN0IG5jID0gbmV3IFVpbnQ4QXJyYXkoMTIpO1xuICAgICAgICAgICAgbmMuc2V0KG5vbmNlLCBjb3VudGVyUmlnaHQgPyAwIDogMTIgLSBub25jZS5sZW5ndGgpO1xuICAgICAgICAgICAgbm9uY2UgPSBuYztcbiAgICAgICAgICAgIHRvQ2xlYW4ucHVzaChub25jZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbjMyID0gdTMyKG5vbmNlKTtcbiAgICAgICAgcnVuQ2lwaGVyKGNvcmUsIHNpZ21hLCBrMzIsIG4zMiwgZGF0YSwgb3V0cHV0LCBjb3VudGVyLCByb3VuZHMpO1xuICAgICAgICBjbGVhbiguLi50b0NsZWFuKTtcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xufVxuLyoqIEludGVybmFsIGNsYXNzIHdoaWNoIHdyYXBzIGNoYWNoYTIwIG9yIGNoYWNoYTggdG8gY3JlYXRlIENTUFJORy4gKi9cbmV4cG9ydCBjbGFzcyBfWG9yU3RyZWFtUFJHIHtcbiAgICBibG9ja0xlbjtcbiAgICBrZXlMZW47XG4gICAgbm9uY2VMZW47XG4gICAgc3RhdGU7XG4gICAgYnVmO1xuICAgIGtleTtcbiAgICBub25jZTtcbiAgICBwb3M7XG4gICAgY3RyO1xuICAgIGNpcGhlcjtcbiAgICBjb25zdHJ1Y3RvcihjaXBoZXIsIGJsb2NrTGVuLCBrZXlMZW4sIG5vbmNlTGVuLCBzZWVkKSB7XG4gICAgICAgIHRoaXMuY2lwaGVyID0gY2lwaGVyO1xuICAgICAgICB0aGlzLmJsb2NrTGVuID0gYmxvY2tMZW47XG4gICAgICAgIHRoaXMua2V5TGVuID0ga2V5TGVuO1xuICAgICAgICB0aGlzLm5vbmNlTGVuID0gbm9uY2VMZW47XG4gICAgICAgIHRoaXMuc3RhdGUgPSBuZXcgVWludDhBcnJheSh0aGlzLmtleUxlbiArIHRoaXMubm9uY2VMZW4pO1xuICAgICAgICB0aGlzLnJlc2VlZChzZWVkKTtcbiAgICAgICAgdGhpcy5jdHIgPSAwO1xuICAgICAgICB0aGlzLnBvcyA9IHRoaXMuYmxvY2tMZW47XG4gICAgICAgIHRoaXMuYnVmID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5ibG9ja0xlbik7XG4gICAgICAgIHRoaXMua2V5ID0gdGhpcy5zdGF0ZS5zdWJhcnJheSgwLCB0aGlzLmtleUxlbik7XG4gICAgICAgIHRoaXMubm9uY2UgPSB0aGlzLnN0YXRlLnN1YmFycmF5KHRoaXMua2V5TGVuKTtcbiAgICB9XG4gICAgcmVzZWVkKHNlZWQpIHtcbiAgICAgICAgYWJ5dGVzKHNlZWQpO1xuICAgICAgICBpZiAoIXNlZWQgfHwgc2VlZC5sZW5ndGggPT09IDApXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2VudHJvcHkgcmVxdWlyZWQnKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWVkLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgdGhpcy5zdGF0ZVtpICUgdGhpcy5zdGF0ZS5sZW5ndGhdIF49IHNlZWRbaV07XG4gICAgICAgIHRoaXMuY3RyID0gMDtcbiAgICAgICAgdGhpcy5wb3MgPSB0aGlzLmJsb2NrTGVuO1xuICAgIH1cbiAgICBhZGRFbnRyb3B5KHNlZWQpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5zZXQodGhpcy5yYW5kb21CeXRlcyh0aGlzLnN0YXRlLmxlbmd0aCkpO1xuICAgICAgICB0aGlzLnJlc2VlZChzZWVkKTtcbiAgICB9XG4gICAgcmFuZG9tQnl0ZXMobGVuKSB7XG4gICAgICAgIGFudW1iZXIobGVuKTtcbiAgICAgICAgaWYgKGxlbiA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSgwKTtcbiAgICAgICAgY29uc3Qgb3V0ID0gbmV3IFVpbnQ4QXJyYXkobGVuKTtcbiAgICAgICAgbGV0IG91dFBvcyA9IDA7XG4gICAgICAgIC8vIExlZnRvdmVyc1xuICAgICAgICBpZiAodGhpcy5wb3MgPCB0aGlzLmJsb2NrTGVuKSB7XG4gICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4obGVuLCB0aGlzLmJsb2NrTGVuIC0gdGhpcy5wb3MpO1xuICAgICAgICAgICAgb3V0LnNldCh0aGlzLmJ1Zi5zdWJhcnJheSh0aGlzLnBvcywgdGhpcy5wb3MgKyB0YWtlKSwgMCk7XG4gICAgICAgICAgICB0aGlzLnBvcyArPSB0YWtlO1xuICAgICAgICAgICAgb3V0UG9zICs9IHRha2U7XG4gICAgICAgICAgICBpZiAob3V0UG9zID09PSBsZW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDsgLy8gZmFzdCBwYXRoXG4gICAgICAgIH1cbiAgICAgICAgLy8gRnVsbCBibG9ja3MgZGlyZWN0bHkgdG8gb3V0XG4gICAgICAgIGNvbnN0IGJsb2NrcyA9IE1hdGguZmxvb3IoKGxlbiAtIG91dFBvcykgLyB0aGlzLmJsb2NrTGVuKTtcbiAgICAgICAgaWYgKGJsb2NrcyA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrQnl0ZXMgPSBibG9ja3MgKiB0aGlzLmJsb2NrTGVuO1xuICAgICAgICAgICAgY29uc3QgYiA9IG91dC5zdWJhcnJheShvdXRQb3MsIG91dFBvcyArIGJsb2NrQnl0ZXMpO1xuICAgICAgICAgICAgdGhpcy5jaXBoZXIodGhpcy5rZXksIHRoaXMubm9uY2UsIGIsIGIsIHRoaXMuY3RyKTtcbiAgICAgICAgICAgIHRoaXMuY3RyICs9IGJsb2NrcztcbiAgICAgICAgICAgIG91dFBvcyArPSBibG9ja0J5dGVzO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNhdmUgbGVmdG92ZXJzXG4gICAgICAgIGNvbnN0IGxlZnQgPSBsZW4gLSBvdXRQb3M7XG4gICAgICAgIGlmIChsZWZ0ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5idWYuZmlsbCgwKTtcbiAgICAgICAgICAgIC8vIE5PVEU6IGNpcGhlciB3aWxsIGhhbmRsZSBvdmVyZmxvd1xuICAgICAgICAgICAgdGhpcy5jaXBoZXIodGhpcy5rZXksIHRoaXMubm9uY2UsIHRoaXMuYnVmLCB0aGlzLmJ1ZiwgdGhpcy5jdHIrKyk7XG4gICAgICAgICAgICBvdXQuc2V0KHRoaXMuYnVmLnN1YmFycmF5KDAsIGxlZnQpLCBvdXRQb3MpO1xuICAgICAgICAgICAgdGhpcy5wb3MgPSBsZWZ0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfVxuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IF9Yb3JTdHJlYW1QUkcodGhpcy5jaXBoZXIsIHRoaXMuYmxvY2tMZW4sIHRoaXMua2V5TGVuLCB0aGlzLm5vbmNlTGVuLCB0aGlzLnJhbmRvbUJ5dGVzKHRoaXMuc3RhdGUubGVuZ3RoKSk7XG4gICAgfVxuICAgIGNsZWFuKCkge1xuICAgICAgICB0aGlzLnBvcyA9IDA7XG4gICAgICAgIHRoaXMuY3RyID0gMDtcbiAgICAgICAgdGhpcy5idWYuZmlsbCgwKTtcbiAgICAgICAgdGhpcy5zdGF0ZS5maWxsKDApO1xuICAgIH1cbn1cbmV4cG9ydCBjb25zdCBjcmVhdGVQUkcgPSAoY2lwaGVyLCBibG9ja0xlbiwga2V5TGVuLCBub25jZUxlbikgPT4ge1xuICAgIHJldHVybiAoc2VlZCA9IHJhbmRvbUJ5dGVzKDMyKSkgPT4gbmV3IF9Yb3JTdHJlYW1QUkcoY2lwaGVyLCBibG9ja0xlbiwga2V5TGVuLCBub25jZUxlbiwgc2VlZCk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9X2FyeC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@noble/ciphers/_arx.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@noble/ciphers/_poly1305.js":
/*!**************************************************!*\
  !*** ./node_modules/@noble/ciphers/_poly1305.js ***!
  \**************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Poly1305: function() { return /* binding */ Poly1305; },\n/* harmony export */   poly1305: function() { return /* binding */ poly1305; },\n/* harmony export */   wrapConstructorWithKey: function() { return /* binding */ wrapConstructorWithKey; }\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/utils.js\");\n/**\n * Poly1305 ([PDF](https://cr.yp.to/mac/poly1305-20050329.pdf),\n * [wiki](https://en.wikipedia.org/wiki/Poly1305))\n * is a fast and parallel secret-key message-authentication code suitable for\n * a wide variety of applications. It was standardized in\n * [RFC 8439](https://www.rfc-editor.org/rfc/rfc8439) and is now used in TLS 1.3.\n *\n * Polynomial MACs are not perfect for every situation:\n * they lack Random Key Robustness: the MAC can be forged, and can't be used in PAKE schemes.\n * See [invisible salamanders attack](https://keymaterial.net/2020/09/07/invisible-salamanders-in-aes-gcm-siv/).\n * To combat invisible salamanders, `hash(key)` can be included in ciphertext,\n * however, this would violate ciphertext indistinguishability:\n * an attacker would know which key was used - so `HKDF(key, i)`\n * could be used instead.\n *\n * Check out [original website](https://cr.yp.to/mac.html).\n * Based on Public Domain [poly1305-donna](https://github.com/floodyberry/poly1305-donna).\n * @module\n */\n// prettier-ignore\n\nfunction u8to16(a, i) {\n    return (a[i++] & 0xff) | ((a[i++] & 0xff) << 8);\n}\nfunction bytesToNumberLE(bytes) {\n    return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToNumber)((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(Uint8Array.from(bytes).reverse()));\n}\n/** Small version of `poly1305` without loop unrolling. Unused, provided for auditability. */\nfunction poly1305_small(msg, key) {\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(msg);\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(key, 32, 'key');\n    const POW_2_130_5 = BigInt(2) ** BigInt(130) - BigInt(5); // 2^130-5\n    const POW_2_128_1 = BigInt(2) ** BigInt(128) - BigInt(1); // 2^128-1\n    const CLAMP_R = BigInt('0x0ffffffc0ffffffc0ffffffc0fffffff');\n    const r = bytesToNumberLE(key.subarray(0, 16)) & CLAMP_R;\n    const s = bytesToNumberLE(key.subarray(16));\n    // Process by 16 byte chunks\n    let acc = BigInt(0);\n    for (let i = 0; i < msg.length; i += 16) {\n        const m = msg.subarray(i, i + 16);\n        const n = bytesToNumberLE(m) | (BigInt(1) << BigInt(8 * m.length));\n        acc = ((acc + n) * r) % POW_2_130_5;\n    }\n    const res = (acc + s) & POW_2_128_1;\n    return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.numberToBytesBE)(res, 16).reverse(); // LE\n}\n// Can be used to replace `computeTag` in chacha.ts. Unused, provided for auditability.\n// @ts-expect-error\nfunction poly1305_computeTag_small(authKey, lengths, ciphertext, AAD) {\n    const res = [];\n    const updatePadded2 = (msg) => {\n        res.push(msg);\n        const leftover = msg.length % 16;\n        if (leftover)\n            res.push(new Uint8Array(16).slice(leftover));\n    };\n    if (AAD)\n        updatePadded2(AAD);\n    updatePadded2(ciphertext);\n    res.push(lengths);\n    return poly1305_small((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.concatBytes)(...res), authKey);\n}\n/** Poly1305 class. Prefer poly1305() function instead. */\nclass Poly1305 {\n    blockLen = 16;\n    outputLen = 16;\n    buffer = new Uint8Array(16);\n    r = new Uint16Array(10); // Allocating 1 array with .subarray() here is slower than 3\n    h = new Uint16Array(10);\n    pad = new Uint16Array(8);\n    pos = 0;\n    finished = false;\n    // Can be speed-up using BigUint64Array, at the cost of complexity\n    constructor(key) {\n        key = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.copyBytes)((0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(key, 32, 'key'));\n        const t0 = u8to16(key, 0);\n        const t1 = u8to16(key, 2);\n        const t2 = u8to16(key, 4);\n        const t3 = u8to16(key, 6);\n        const t4 = u8to16(key, 8);\n        const t5 = u8to16(key, 10);\n        const t6 = u8to16(key, 12);\n        const t7 = u8to16(key, 14);\n        // https://github.com/floodyberry/poly1305-donna/blob/e6ad6e091d30d7f4ec2d4f978be1fcfcbce72781/poly1305-donna-16.h#L47\n        this.r[0] = t0 & 0x1fff;\n        this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n        this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n        this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n        this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n        this.r[5] = (t4 >>> 1) & 0x1ffe;\n        this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n        this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n        this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n        this.r[9] = (t7 >>> 5) & 0x007f;\n        for (let i = 0; i < 8; i++)\n            this.pad[i] = u8to16(key, 16 + 2 * i);\n    }\n    process(data, offset, isLast = false) {\n        const hibit = isLast ? 0 : 1 << 11;\n        const { h, r } = this;\n        const r0 = r[0];\n        const r1 = r[1];\n        const r2 = r[2];\n        const r3 = r[3];\n        const r4 = r[4];\n        const r5 = r[5];\n        const r6 = r[6];\n        const r7 = r[7];\n        const r8 = r[8];\n        const r9 = r[9];\n        const t0 = u8to16(data, offset + 0);\n        const t1 = u8to16(data, offset + 2);\n        const t2 = u8to16(data, offset + 4);\n        const t3 = u8to16(data, offset + 6);\n        const t4 = u8to16(data, offset + 8);\n        const t5 = u8to16(data, offset + 10);\n        const t6 = u8to16(data, offset + 12);\n        const t7 = u8to16(data, offset + 14);\n        let h0 = h[0] + (t0 & 0x1fff);\n        let h1 = h[1] + (((t0 >>> 13) | (t1 << 3)) & 0x1fff);\n        let h2 = h[2] + (((t1 >>> 10) | (t2 << 6)) & 0x1fff);\n        let h3 = h[3] + (((t2 >>> 7) | (t3 << 9)) & 0x1fff);\n        let h4 = h[4] + (((t3 >>> 4) | (t4 << 12)) & 0x1fff);\n        let h5 = h[5] + ((t4 >>> 1) & 0x1fff);\n        let h6 = h[6] + (((t4 >>> 14) | (t5 << 2)) & 0x1fff);\n        let h7 = h[7] + (((t5 >>> 11) | (t6 << 5)) & 0x1fff);\n        let h8 = h[8] + (((t6 >>> 8) | (t7 << 8)) & 0x1fff);\n        let h9 = h[9] + ((t7 >>> 5) | hibit);\n        let c = 0;\n        let d0 = c + h0 * r0 + h1 * (5 * r9) + h2 * (5 * r8) + h3 * (5 * r7) + h4 * (5 * r6);\n        c = d0 >>> 13;\n        d0 &= 0x1fff;\n        d0 += h5 * (5 * r5) + h6 * (5 * r4) + h7 * (5 * r3) + h8 * (5 * r2) + h9 * (5 * r1);\n        c += d0 >>> 13;\n        d0 &= 0x1fff;\n        let d1 = c + h0 * r1 + h1 * r0 + h2 * (5 * r9) + h3 * (5 * r8) + h4 * (5 * r7);\n        c = d1 >>> 13;\n        d1 &= 0x1fff;\n        d1 += h5 * (5 * r6) + h6 * (5 * r5) + h7 * (5 * r4) + h8 * (5 * r3) + h9 * (5 * r2);\n        c += d1 >>> 13;\n        d1 &= 0x1fff;\n        let d2 = c + h0 * r2 + h1 * r1 + h2 * r0 + h3 * (5 * r9) + h4 * (5 * r8);\n        c = d2 >>> 13;\n        d2 &= 0x1fff;\n        d2 += h5 * (5 * r7) + h6 * (5 * r6) + h7 * (5 * r5) + h8 * (5 * r4) + h9 * (5 * r3);\n        c += d2 >>> 13;\n        d2 &= 0x1fff;\n        let d3 = c + h0 * r3 + h1 * r2 + h2 * r1 + h3 * r0 + h4 * (5 * r9);\n        c = d3 >>> 13;\n        d3 &= 0x1fff;\n        d3 += h5 * (5 * r8) + h6 * (5 * r7) + h7 * (5 * r6) + h8 * (5 * r5) + h9 * (5 * r4);\n        c += d3 >>> 13;\n        d3 &= 0x1fff;\n        let d4 = c + h0 * r4 + h1 * r3 + h2 * r2 + h3 * r1 + h4 * r0;\n        c = d4 >>> 13;\n        d4 &= 0x1fff;\n        d4 += h5 * (5 * r9) + h6 * (5 * r8) + h7 * (5 * r7) + h8 * (5 * r6) + h9 * (5 * r5);\n        c += d4 >>> 13;\n        d4 &= 0x1fff;\n        let d5 = c + h0 * r5 + h1 * r4 + h2 * r3 + h3 * r2 + h4 * r1;\n        c = d5 >>> 13;\n        d5 &= 0x1fff;\n        d5 += h5 * r0 + h6 * (5 * r9) + h7 * (5 * r8) + h8 * (5 * r7) + h9 * (5 * r6);\n        c += d5 >>> 13;\n        d5 &= 0x1fff;\n        let d6 = c + h0 * r6 + h1 * r5 + h2 * r4 + h3 * r3 + h4 * r2;\n        c = d6 >>> 13;\n        d6 &= 0x1fff;\n        d6 += h5 * r1 + h6 * r0 + h7 * (5 * r9) + h8 * (5 * r8) + h9 * (5 * r7);\n        c += d6 >>> 13;\n        d6 &= 0x1fff;\n        let d7 = c + h0 * r7 + h1 * r6 + h2 * r5 + h3 * r4 + h4 * r3;\n        c = d7 >>> 13;\n        d7 &= 0x1fff;\n        d7 += h5 * r2 + h6 * r1 + h7 * r0 + h8 * (5 * r9) + h9 * (5 * r8);\n        c += d7 >>> 13;\n        d7 &= 0x1fff;\n        let d8 = c + h0 * r8 + h1 * r7 + h2 * r6 + h3 * r5 + h4 * r4;\n        c = d8 >>> 13;\n        d8 &= 0x1fff;\n        d8 += h5 * r3 + h6 * r2 + h7 * r1 + h8 * r0 + h9 * (5 * r9);\n        c += d8 >>> 13;\n        d8 &= 0x1fff;\n        let d9 = c + h0 * r9 + h1 * r8 + h2 * r7 + h3 * r6 + h4 * r5;\n        c = d9 >>> 13;\n        d9 &= 0x1fff;\n        d9 += h5 * r4 + h6 * r3 + h7 * r2 + h8 * r1 + h9 * r0;\n        c += d9 >>> 13;\n        d9 &= 0x1fff;\n        c = ((c << 2) + c) | 0;\n        c = (c + d0) | 0;\n        d0 = c & 0x1fff;\n        c = c >>> 13;\n        d1 += c;\n        h[0] = d0;\n        h[1] = d1;\n        h[2] = d2;\n        h[3] = d3;\n        h[4] = d4;\n        h[5] = d5;\n        h[6] = d6;\n        h[7] = d7;\n        h[8] = d8;\n        h[9] = d9;\n    }\n    finalize() {\n        const { h, pad } = this;\n        const g = new Uint16Array(10);\n        let c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        for (let i = 2; i < 10; i++) {\n            h[i] += c;\n            c = h[i] >>> 13;\n            h[i] &= 0x1fff;\n        }\n        h[0] += c * 5;\n        c = h[0] >>> 13;\n        h[0] &= 0x1fff;\n        h[1] += c;\n        c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        h[2] += c;\n        g[0] = h[0] + 5;\n        c = g[0] >>> 13;\n        g[0] &= 0x1fff;\n        for (let i = 1; i < 10; i++) {\n            g[i] = h[i] + c;\n            c = g[i] >>> 13;\n            g[i] &= 0x1fff;\n        }\n        g[9] -= 1 << 13;\n        let mask = (c ^ 1) - 1;\n        for (let i = 0; i < 10; i++)\n            g[i] &= mask;\n        mask = ~mask;\n        for (let i = 0; i < 10; i++)\n            h[i] = (h[i] & mask) | g[i];\n        h[0] = (h[0] | (h[1] << 13)) & 0xffff;\n        h[1] = ((h[1] >>> 3) | (h[2] << 10)) & 0xffff;\n        h[2] = ((h[2] >>> 6) | (h[3] << 7)) & 0xffff;\n        h[3] = ((h[3] >>> 9) | (h[4] << 4)) & 0xffff;\n        h[4] = ((h[4] >>> 12) | (h[5] << 1) | (h[6] << 14)) & 0xffff;\n        h[5] = ((h[6] >>> 2) | (h[7] << 11)) & 0xffff;\n        h[6] = ((h[7] >>> 5) | (h[8] << 8)) & 0xffff;\n        h[7] = ((h[8] >>> 8) | (h[9] << 5)) & 0xffff;\n        let f = h[0] + pad[0];\n        h[0] = f & 0xffff;\n        for (let i = 1; i < 8; i++) {\n            f = (((h[i] + pad[i]) | 0) + (f >>> 16)) | 0;\n            h[i] = f & 0xffff;\n        }\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.clean)(g);\n    }\n    update(data) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.aexists)(this);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(data);\n        data = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.copyBytes)(data);\n        const { buffer, blockLen } = this;\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input\n            if (take === blockLen) {\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(data, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(buffer, 0, false);\n                this.pos = 0;\n            }\n        }\n        return this;\n    }\n    destroy() {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.clean)(this.h, this.r, this.buffer, this.pad);\n    }\n    digestInto(out) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.aexists)(this);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.aoutput)(out, this);\n        this.finished = true;\n        const { buffer, h } = this;\n        let { pos } = this;\n        if (pos) {\n            buffer[pos++] = 1;\n            for (; pos < 16; pos++)\n                buffer[pos] = 0;\n            this.process(buffer, 0, true);\n        }\n        this.finalize();\n        let opos = 0;\n        for (let i = 0; i < 8; i++) {\n            out[opos++] = h[i] >>> 0;\n            out[opos++] = h[i] >>> 8;\n        }\n        return out;\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n}\nfunction wrapConstructorWithKey(hashCons) {\n    const hashC = (msg, key) => hashCons(key).update(msg).digest();\n    const tmp = hashCons(new Uint8Array(32)); // tmp array, used just once below\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (key) => hashCons(key);\n    return hashC;\n}\n/** Poly1305 MAC from RFC 8439. */\nconst poly1305 = /** @__PURE__ */ (() => wrapConstructorWithKey((key) => new Poly1305(key)))();\n//# sourceMappingURL=_poly1305.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9Abm9ibGUvY2lwaGVycy9fcG9seTEzMDUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDK0g7QUFDL0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNEQUFXLENBQUMscURBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0EsSUFBSSxpREFBTTtBQUNWLElBQUksaURBQU07QUFDViw4REFBOEQ7QUFDOUQsOERBQThEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0JBQWdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBEQUFlLHFCQUFxQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQVc7QUFDckM7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb0RBQVMsQ0FBQyxpREFBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixPQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE9BQU87QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsa0RBQU87QUFDZixRQUFRLGlEQUFNO0FBQ2QsZUFBZSxvREFBUztBQUN4QixnQkFBZ0IsbUJBQW1CO0FBQ25DO0FBQ0EsMEJBQTBCLFVBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHVCQUF1QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxnREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLGtEQUFPO0FBQ2YsUUFBUSxrREFBTztBQUNmO0FBQ0EsZ0JBQWdCLFlBQVk7QUFDNUIsY0FBYyxNQUFNO0FBQ3BCO0FBQ0E7QUFDQSxtQkFBbUIsVUFBVTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9CQUFvQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0Bub2JsZS9jaXBoZXJzL19wb2x5MTMwNS5qcz82N2Y1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUG9seTEzMDUgKFtQREZdKGh0dHBzOi8vY3IueXAudG8vbWFjL3BvbHkxMzA1LTIwMDUwMzI5LnBkZiksXG4gKiBbd2lraV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUG9seTEzMDUpKVxuICogaXMgYSBmYXN0IGFuZCBwYXJhbGxlbCBzZWNyZXQta2V5IG1lc3NhZ2UtYXV0aGVudGljYXRpb24gY29kZSBzdWl0YWJsZSBmb3JcbiAqIGEgd2lkZSB2YXJpZXR5IG9mIGFwcGxpY2F0aW9ucy4gSXQgd2FzIHN0YW5kYXJkaXplZCBpblxuICogW1JGQyA4NDM5XShodHRwczovL3d3dy5yZmMtZWRpdG9yLm9yZy9yZmMvcmZjODQzOSkgYW5kIGlzIG5vdyB1c2VkIGluIFRMUyAxLjMuXG4gKlxuICogUG9seW5vbWlhbCBNQUNzIGFyZSBub3QgcGVyZmVjdCBmb3IgZXZlcnkgc2l0dWF0aW9uOlxuICogdGhleSBsYWNrIFJhbmRvbSBLZXkgUm9idXN0bmVzczogdGhlIE1BQyBjYW4gYmUgZm9yZ2VkLCBhbmQgY2FuJ3QgYmUgdXNlZCBpbiBQQUtFIHNjaGVtZXMuXG4gKiBTZWUgW2ludmlzaWJsZSBzYWxhbWFuZGVycyBhdHRhY2tdKGh0dHBzOi8va2V5bWF0ZXJpYWwubmV0LzIwMjAvMDkvMDcvaW52aXNpYmxlLXNhbGFtYW5kZXJzLWluLWFlcy1nY20tc2l2LykuXG4gKiBUbyBjb21iYXQgaW52aXNpYmxlIHNhbGFtYW5kZXJzLCBgaGFzaChrZXkpYCBjYW4gYmUgaW5jbHVkZWQgaW4gY2lwaGVydGV4dCxcbiAqIGhvd2V2ZXIsIHRoaXMgd291bGQgdmlvbGF0ZSBjaXBoZXJ0ZXh0IGluZGlzdGluZ3Vpc2hhYmlsaXR5OlxuICogYW4gYXR0YWNrZXIgd291bGQga25vdyB3aGljaCBrZXkgd2FzIHVzZWQgLSBzbyBgSEtERihrZXksIGkpYFxuICogY291bGQgYmUgdXNlZCBpbnN0ZWFkLlxuICpcbiAqIENoZWNrIG91dCBbb3JpZ2luYWwgd2Vic2l0ZV0oaHR0cHM6Ly9jci55cC50by9tYWMuaHRtbCkuXG4gKiBCYXNlZCBvbiBQdWJsaWMgRG9tYWluIFtwb2x5MTMwNS1kb25uYV0oaHR0cHM6Ly9naXRodWIuY29tL2Zsb29keWJlcnJ5L3BvbHkxMzA1LWRvbm5hKS5cbiAqIEBtb2R1bGVcbiAqL1xuLy8gcHJldHRpZXItaWdub3JlXG5pbXBvcnQgeyBhYnl0ZXMsIGFleGlzdHMsIGFvdXRwdXQsIGJ5dGVzVG9IZXgsIGNsZWFuLCBjb25jYXRCeXRlcywgY29weUJ5dGVzLCBoZXhUb051bWJlciwgbnVtYmVyVG9CeXRlc0JFIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmZ1bmN0aW9uIHU4dG8xNihhLCBpKSB7XG4gICAgcmV0dXJuIChhW2krK10gJiAweGZmKSB8ICgoYVtpKytdICYgMHhmZikgPDwgOCk7XG59XG5mdW5jdGlvbiBieXRlc1RvTnVtYmVyTEUoYnl0ZXMpIHtcbiAgICByZXR1cm4gaGV4VG9OdW1iZXIoYnl0ZXNUb0hleChVaW50OEFycmF5LmZyb20oYnl0ZXMpLnJldmVyc2UoKSkpO1xufVxuLyoqIFNtYWxsIHZlcnNpb24gb2YgYHBvbHkxMzA1YCB3aXRob3V0IGxvb3AgdW5yb2xsaW5nLiBVbnVzZWQsIHByb3ZpZGVkIGZvciBhdWRpdGFiaWxpdHkuICovXG5mdW5jdGlvbiBwb2x5MTMwNV9zbWFsbChtc2csIGtleSkge1xuICAgIGFieXRlcyhtc2cpO1xuICAgIGFieXRlcyhrZXksIDMyLCAna2V5Jyk7XG4gICAgY29uc3QgUE9XXzJfMTMwXzUgPSBCaWdJbnQoMikgKiogQmlnSW50KDEzMCkgLSBCaWdJbnQoNSk7IC8vIDJeMTMwLTVcbiAgICBjb25zdCBQT1dfMl8xMjhfMSA9IEJpZ0ludCgyKSAqKiBCaWdJbnQoMTI4KSAtIEJpZ0ludCgxKTsgLy8gMl4xMjgtMVxuICAgIGNvbnN0IENMQU1QX1IgPSBCaWdJbnQoJzB4MGZmZmZmZmMwZmZmZmZmYzBmZmZmZmZjMGZmZmZmZmYnKTtcbiAgICBjb25zdCByID0gYnl0ZXNUb051bWJlckxFKGtleS5zdWJhcnJheSgwLCAxNikpICYgQ0xBTVBfUjtcbiAgICBjb25zdCBzID0gYnl0ZXNUb051bWJlckxFKGtleS5zdWJhcnJheSgxNikpO1xuICAgIC8vIFByb2Nlc3MgYnkgMTYgYnl0ZSBjaHVua3NcbiAgICBsZXQgYWNjID0gQmlnSW50KDApO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXNnLmxlbmd0aDsgaSArPSAxNikge1xuICAgICAgICBjb25zdCBtID0gbXNnLnN1YmFycmF5KGksIGkgKyAxNik7XG4gICAgICAgIGNvbnN0IG4gPSBieXRlc1RvTnVtYmVyTEUobSkgfCAoQmlnSW50KDEpIDw8IEJpZ0ludCg4ICogbS5sZW5ndGgpKTtcbiAgICAgICAgYWNjID0gKChhY2MgKyBuKSAqIHIpICUgUE9XXzJfMTMwXzU7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IChhY2MgKyBzKSAmIFBPV18yXzEyOF8xO1xuICAgIHJldHVybiBudW1iZXJUb0J5dGVzQkUocmVzLCAxNikucmV2ZXJzZSgpOyAvLyBMRVxufVxuLy8gQ2FuIGJlIHVzZWQgdG8gcmVwbGFjZSBgY29tcHV0ZVRhZ2AgaW4gY2hhY2hhLnRzLiBVbnVzZWQsIHByb3ZpZGVkIGZvciBhdWRpdGFiaWxpdHkuXG4vLyBAdHMtZXhwZWN0LWVycm9yXG5mdW5jdGlvbiBwb2x5MTMwNV9jb21wdXRlVGFnX3NtYWxsKGF1dGhLZXksIGxlbmd0aHMsIGNpcGhlcnRleHQsIEFBRCkge1xuICAgIGNvbnN0IHJlcyA9IFtdO1xuICAgIGNvbnN0IHVwZGF0ZVBhZGRlZDIgPSAobXNnKSA9PiB7XG4gICAgICAgIHJlcy5wdXNoKG1zZyk7XG4gICAgICAgIGNvbnN0IGxlZnRvdmVyID0gbXNnLmxlbmd0aCAlIDE2O1xuICAgICAgICBpZiAobGVmdG92ZXIpXG4gICAgICAgICAgICByZXMucHVzaChuZXcgVWludDhBcnJheSgxNikuc2xpY2UobGVmdG92ZXIpKTtcbiAgICB9O1xuICAgIGlmIChBQUQpXG4gICAgICAgIHVwZGF0ZVBhZGRlZDIoQUFEKTtcbiAgICB1cGRhdGVQYWRkZWQyKGNpcGhlcnRleHQpO1xuICAgIHJlcy5wdXNoKGxlbmd0aHMpO1xuICAgIHJldHVybiBwb2x5MTMwNV9zbWFsbChjb25jYXRCeXRlcyguLi5yZXMpLCBhdXRoS2V5KTtcbn1cbi8qKiBQb2x5MTMwNSBjbGFzcy4gUHJlZmVyIHBvbHkxMzA1KCkgZnVuY3Rpb24gaW5zdGVhZC4gKi9cbmV4cG9ydCBjbGFzcyBQb2x5MTMwNSB7XG4gICAgYmxvY2tMZW4gPSAxNjtcbiAgICBvdXRwdXRMZW4gPSAxNjtcbiAgICBidWZmZXIgPSBuZXcgVWludDhBcnJheSgxNik7XG4gICAgciA9IG5ldyBVaW50MTZBcnJheSgxMCk7IC8vIEFsbG9jYXRpbmcgMSBhcnJheSB3aXRoIC5zdWJhcnJheSgpIGhlcmUgaXMgc2xvd2VyIHRoYW4gM1xuICAgIGggPSBuZXcgVWludDE2QXJyYXkoMTApO1xuICAgIHBhZCA9IG5ldyBVaW50MTZBcnJheSg4KTtcbiAgICBwb3MgPSAwO1xuICAgIGZpbmlzaGVkID0gZmFsc2U7XG4gICAgLy8gQ2FuIGJlIHNwZWVkLXVwIHVzaW5nIEJpZ1VpbnQ2NEFycmF5LCBhdCB0aGUgY29zdCBvZiBjb21wbGV4aXR5XG4gICAgY29uc3RydWN0b3Ioa2V5KSB7XG4gICAgICAgIGtleSA9IGNvcHlCeXRlcyhhYnl0ZXMoa2V5LCAzMiwgJ2tleScpKTtcbiAgICAgICAgY29uc3QgdDAgPSB1OHRvMTYoa2V5LCAwKTtcbiAgICAgICAgY29uc3QgdDEgPSB1OHRvMTYoa2V5LCAyKTtcbiAgICAgICAgY29uc3QgdDIgPSB1OHRvMTYoa2V5LCA0KTtcbiAgICAgICAgY29uc3QgdDMgPSB1OHRvMTYoa2V5LCA2KTtcbiAgICAgICAgY29uc3QgdDQgPSB1OHRvMTYoa2V5LCA4KTtcbiAgICAgICAgY29uc3QgdDUgPSB1OHRvMTYoa2V5LCAxMCk7XG4gICAgICAgIGNvbnN0IHQ2ID0gdTh0bzE2KGtleSwgMTIpO1xuICAgICAgICBjb25zdCB0NyA9IHU4dG8xNihrZXksIDE0KTtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2Zsb29keWJlcnJ5L3BvbHkxMzA1LWRvbm5hL2Jsb2IvZTZhZDZlMDkxZDMwZDdmNGVjMmQ0Zjk3OGJlMWZjZmNiY2U3Mjc4MS9wb2x5MTMwNS1kb25uYS0xNi5oI0w0N1xuICAgICAgICB0aGlzLnJbMF0gPSB0MCAmIDB4MWZmZjtcbiAgICAgICAgdGhpcy5yWzFdID0gKCh0MCA+Pj4gMTMpIHwgKHQxIDw8IDMpKSAmIDB4MWZmZjtcbiAgICAgICAgdGhpcy5yWzJdID0gKCh0MSA+Pj4gMTApIHwgKHQyIDw8IDYpKSAmIDB4MWYwMztcbiAgICAgICAgdGhpcy5yWzNdID0gKCh0MiA+Pj4gNykgfCAodDMgPDwgOSkpICYgMHgxZmZmO1xuICAgICAgICB0aGlzLnJbNF0gPSAoKHQzID4+PiA0KSB8ICh0NCA8PCAxMikpICYgMHgwMGZmO1xuICAgICAgICB0aGlzLnJbNV0gPSAodDQgPj4+IDEpICYgMHgxZmZlO1xuICAgICAgICB0aGlzLnJbNl0gPSAoKHQ0ID4+PiAxNCkgfCAodDUgPDwgMikpICYgMHgxZmZmO1xuICAgICAgICB0aGlzLnJbN10gPSAoKHQ1ID4+PiAxMSkgfCAodDYgPDwgNSkpICYgMHgxZjgxO1xuICAgICAgICB0aGlzLnJbOF0gPSAoKHQ2ID4+PiA4KSB8ICh0NyA8PCA4KSkgJiAweDFmZmY7XG4gICAgICAgIHRoaXMucls5XSA9ICh0NyA+Pj4gNSkgJiAweDAwN2Y7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKVxuICAgICAgICAgICAgdGhpcy5wYWRbaV0gPSB1OHRvMTYoa2V5LCAxNiArIDIgKiBpKTtcbiAgICB9XG4gICAgcHJvY2VzcyhkYXRhLCBvZmZzZXQsIGlzTGFzdCA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IGhpYml0ID0gaXNMYXN0ID8gMCA6IDEgPDwgMTE7XG4gICAgICAgIGNvbnN0IHsgaCwgciB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgcjAgPSByWzBdO1xuICAgICAgICBjb25zdCByMSA9IHJbMV07XG4gICAgICAgIGNvbnN0IHIyID0gclsyXTtcbiAgICAgICAgY29uc3QgcjMgPSByWzNdO1xuICAgICAgICBjb25zdCByNCA9IHJbNF07XG4gICAgICAgIGNvbnN0IHI1ID0gcls1XTtcbiAgICAgICAgY29uc3QgcjYgPSByWzZdO1xuICAgICAgICBjb25zdCByNyA9IHJbN107XG4gICAgICAgIGNvbnN0IHI4ID0gcls4XTtcbiAgICAgICAgY29uc3QgcjkgPSByWzldO1xuICAgICAgICBjb25zdCB0MCA9IHU4dG8xNihkYXRhLCBvZmZzZXQgKyAwKTtcbiAgICAgICAgY29uc3QgdDEgPSB1OHRvMTYoZGF0YSwgb2Zmc2V0ICsgMik7XG4gICAgICAgIGNvbnN0IHQyID0gdTh0bzE2KGRhdGEsIG9mZnNldCArIDQpO1xuICAgICAgICBjb25zdCB0MyA9IHU4dG8xNihkYXRhLCBvZmZzZXQgKyA2KTtcbiAgICAgICAgY29uc3QgdDQgPSB1OHRvMTYoZGF0YSwgb2Zmc2V0ICsgOCk7XG4gICAgICAgIGNvbnN0IHQ1ID0gdTh0bzE2KGRhdGEsIG9mZnNldCArIDEwKTtcbiAgICAgICAgY29uc3QgdDYgPSB1OHRvMTYoZGF0YSwgb2Zmc2V0ICsgMTIpO1xuICAgICAgICBjb25zdCB0NyA9IHU4dG8xNihkYXRhLCBvZmZzZXQgKyAxNCk7XG4gICAgICAgIGxldCBoMCA9IGhbMF0gKyAodDAgJiAweDFmZmYpO1xuICAgICAgICBsZXQgaDEgPSBoWzFdICsgKCgodDAgPj4+IDEzKSB8ICh0MSA8PCAzKSkgJiAweDFmZmYpO1xuICAgICAgICBsZXQgaDIgPSBoWzJdICsgKCgodDEgPj4+IDEwKSB8ICh0MiA8PCA2KSkgJiAweDFmZmYpO1xuICAgICAgICBsZXQgaDMgPSBoWzNdICsgKCgodDIgPj4+IDcpIHwgKHQzIDw8IDkpKSAmIDB4MWZmZik7XG4gICAgICAgIGxldCBoNCA9IGhbNF0gKyAoKCh0MyA+Pj4gNCkgfCAodDQgPDwgMTIpKSAmIDB4MWZmZik7XG4gICAgICAgIGxldCBoNSA9IGhbNV0gKyAoKHQ0ID4+PiAxKSAmIDB4MWZmZik7XG4gICAgICAgIGxldCBoNiA9IGhbNl0gKyAoKCh0NCA+Pj4gMTQpIHwgKHQ1IDw8IDIpKSAmIDB4MWZmZik7XG4gICAgICAgIGxldCBoNyA9IGhbN10gKyAoKCh0NSA+Pj4gMTEpIHwgKHQ2IDw8IDUpKSAmIDB4MWZmZik7XG4gICAgICAgIGxldCBoOCA9IGhbOF0gKyAoKCh0NiA+Pj4gOCkgfCAodDcgPDwgOCkpICYgMHgxZmZmKTtcbiAgICAgICAgbGV0IGg5ID0gaFs5XSArICgodDcgPj4+IDUpIHwgaGliaXQpO1xuICAgICAgICBsZXQgYyA9IDA7XG4gICAgICAgIGxldCBkMCA9IGMgKyBoMCAqIHIwICsgaDEgKiAoNSAqIHI5KSArIGgyICogKDUgKiByOCkgKyBoMyAqICg1ICogcjcpICsgaDQgKiAoNSAqIHI2KTtcbiAgICAgICAgYyA9IGQwID4+PiAxMztcbiAgICAgICAgZDAgJj0gMHgxZmZmO1xuICAgICAgICBkMCArPSBoNSAqICg1ICogcjUpICsgaDYgKiAoNSAqIHI0KSArIGg3ICogKDUgKiByMykgKyBoOCAqICg1ICogcjIpICsgaDkgKiAoNSAqIHIxKTtcbiAgICAgICAgYyArPSBkMCA+Pj4gMTM7XG4gICAgICAgIGQwICY9IDB4MWZmZjtcbiAgICAgICAgbGV0IGQxID0gYyArIGgwICogcjEgKyBoMSAqIHIwICsgaDIgKiAoNSAqIHI5KSArIGgzICogKDUgKiByOCkgKyBoNCAqICg1ICogcjcpO1xuICAgICAgICBjID0gZDEgPj4+IDEzO1xuICAgICAgICBkMSAmPSAweDFmZmY7XG4gICAgICAgIGQxICs9IGg1ICogKDUgKiByNikgKyBoNiAqICg1ICogcjUpICsgaDcgKiAoNSAqIHI0KSArIGg4ICogKDUgKiByMykgKyBoOSAqICg1ICogcjIpO1xuICAgICAgICBjICs9IGQxID4+PiAxMztcbiAgICAgICAgZDEgJj0gMHgxZmZmO1xuICAgICAgICBsZXQgZDIgPSBjICsgaDAgKiByMiArIGgxICogcjEgKyBoMiAqIHIwICsgaDMgKiAoNSAqIHI5KSArIGg0ICogKDUgKiByOCk7XG4gICAgICAgIGMgPSBkMiA+Pj4gMTM7XG4gICAgICAgIGQyICY9IDB4MWZmZjtcbiAgICAgICAgZDIgKz0gaDUgKiAoNSAqIHI3KSArIGg2ICogKDUgKiByNikgKyBoNyAqICg1ICogcjUpICsgaDggKiAoNSAqIHI0KSArIGg5ICogKDUgKiByMyk7XG4gICAgICAgIGMgKz0gZDIgPj4+IDEzO1xuICAgICAgICBkMiAmPSAweDFmZmY7XG4gICAgICAgIGxldCBkMyA9IGMgKyBoMCAqIHIzICsgaDEgKiByMiArIGgyICogcjEgKyBoMyAqIHIwICsgaDQgKiAoNSAqIHI5KTtcbiAgICAgICAgYyA9IGQzID4+PiAxMztcbiAgICAgICAgZDMgJj0gMHgxZmZmO1xuICAgICAgICBkMyArPSBoNSAqICg1ICogcjgpICsgaDYgKiAoNSAqIHI3KSArIGg3ICogKDUgKiByNikgKyBoOCAqICg1ICogcjUpICsgaDkgKiAoNSAqIHI0KTtcbiAgICAgICAgYyArPSBkMyA+Pj4gMTM7XG4gICAgICAgIGQzICY9IDB4MWZmZjtcbiAgICAgICAgbGV0IGQ0ID0gYyArIGgwICogcjQgKyBoMSAqIHIzICsgaDIgKiByMiArIGgzICogcjEgKyBoNCAqIHIwO1xuICAgICAgICBjID0gZDQgPj4+IDEzO1xuICAgICAgICBkNCAmPSAweDFmZmY7XG4gICAgICAgIGQ0ICs9IGg1ICogKDUgKiByOSkgKyBoNiAqICg1ICogcjgpICsgaDcgKiAoNSAqIHI3KSArIGg4ICogKDUgKiByNikgKyBoOSAqICg1ICogcjUpO1xuICAgICAgICBjICs9IGQ0ID4+PiAxMztcbiAgICAgICAgZDQgJj0gMHgxZmZmO1xuICAgICAgICBsZXQgZDUgPSBjICsgaDAgKiByNSArIGgxICogcjQgKyBoMiAqIHIzICsgaDMgKiByMiArIGg0ICogcjE7XG4gICAgICAgIGMgPSBkNSA+Pj4gMTM7XG4gICAgICAgIGQ1ICY9IDB4MWZmZjtcbiAgICAgICAgZDUgKz0gaDUgKiByMCArIGg2ICogKDUgKiByOSkgKyBoNyAqICg1ICogcjgpICsgaDggKiAoNSAqIHI3KSArIGg5ICogKDUgKiByNik7XG4gICAgICAgIGMgKz0gZDUgPj4+IDEzO1xuICAgICAgICBkNSAmPSAweDFmZmY7XG4gICAgICAgIGxldCBkNiA9IGMgKyBoMCAqIHI2ICsgaDEgKiByNSArIGgyICogcjQgKyBoMyAqIHIzICsgaDQgKiByMjtcbiAgICAgICAgYyA9IGQ2ID4+PiAxMztcbiAgICAgICAgZDYgJj0gMHgxZmZmO1xuICAgICAgICBkNiArPSBoNSAqIHIxICsgaDYgKiByMCArIGg3ICogKDUgKiByOSkgKyBoOCAqICg1ICogcjgpICsgaDkgKiAoNSAqIHI3KTtcbiAgICAgICAgYyArPSBkNiA+Pj4gMTM7XG4gICAgICAgIGQ2ICY9IDB4MWZmZjtcbiAgICAgICAgbGV0IGQ3ID0gYyArIGgwICogcjcgKyBoMSAqIHI2ICsgaDIgKiByNSArIGgzICogcjQgKyBoNCAqIHIzO1xuICAgICAgICBjID0gZDcgPj4+IDEzO1xuICAgICAgICBkNyAmPSAweDFmZmY7XG4gICAgICAgIGQ3ICs9IGg1ICogcjIgKyBoNiAqIHIxICsgaDcgKiByMCArIGg4ICogKDUgKiByOSkgKyBoOSAqICg1ICogcjgpO1xuICAgICAgICBjICs9IGQ3ID4+PiAxMztcbiAgICAgICAgZDcgJj0gMHgxZmZmO1xuICAgICAgICBsZXQgZDggPSBjICsgaDAgKiByOCArIGgxICogcjcgKyBoMiAqIHI2ICsgaDMgKiByNSArIGg0ICogcjQ7XG4gICAgICAgIGMgPSBkOCA+Pj4gMTM7XG4gICAgICAgIGQ4ICY9IDB4MWZmZjtcbiAgICAgICAgZDggKz0gaDUgKiByMyArIGg2ICogcjIgKyBoNyAqIHIxICsgaDggKiByMCArIGg5ICogKDUgKiByOSk7XG4gICAgICAgIGMgKz0gZDggPj4+IDEzO1xuICAgICAgICBkOCAmPSAweDFmZmY7XG4gICAgICAgIGxldCBkOSA9IGMgKyBoMCAqIHI5ICsgaDEgKiByOCArIGgyICogcjcgKyBoMyAqIHI2ICsgaDQgKiByNTtcbiAgICAgICAgYyA9IGQ5ID4+PiAxMztcbiAgICAgICAgZDkgJj0gMHgxZmZmO1xuICAgICAgICBkOSArPSBoNSAqIHI0ICsgaDYgKiByMyArIGg3ICogcjIgKyBoOCAqIHIxICsgaDkgKiByMDtcbiAgICAgICAgYyArPSBkOSA+Pj4gMTM7XG4gICAgICAgIGQ5ICY9IDB4MWZmZjtcbiAgICAgICAgYyA9ICgoYyA8PCAyKSArIGMpIHwgMDtcbiAgICAgICAgYyA9IChjICsgZDApIHwgMDtcbiAgICAgICAgZDAgPSBjICYgMHgxZmZmO1xuICAgICAgICBjID0gYyA+Pj4gMTM7XG4gICAgICAgIGQxICs9IGM7XG4gICAgICAgIGhbMF0gPSBkMDtcbiAgICAgICAgaFsxXSA9IGQxO1xuICAgICAgICBoWzJdID0gZDI7XG4gICAgICAgIGhbM10gPSBkMztcbiAgICAgICAgaFs0XSA9IGQ0O1xuICAgICAgICBoWzVdID0gZDU7XG4gICAgICAgIGhbNl0gPSBkNjtcbiAgICAgICAgaFs3XSA9IGQ3O1xuICAgICAgICBoWzhdID0gZDg7XG4gICAgICAgIGhbOV0gPSBkOTtcbiAgICB9XG4gICAgZmluYWxpemUoKSB7XG4gICAgICAgIGNvbnN0IHsgaCwgcGFkIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBnID0gbmV3IFVpbnQxNkFycmF5KDEwKTtcbiAgICAgICAgbGV0IGMgPSBoWzFdID4+PiAxMztcbiAgICAgICAgaFsxXSAmPSAweDFmZmY7XG4gICAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgMTA7IGkrKykge1xuICAgICAgICAgICAgaFtpXSArPSBjO1xuICAgICAgICAgICAgYyA9IGhbaV0gPj4+IDEzO1xuICAgICAgICAgICAgaFtpXSAmPSAweDFmZmY7XG4gICAgICAgIH1cbiAgICAgICAgaFswXSArPSBjICogNTtcbiAgICAgICAgYyA9IGhbMF0gPj4+IDEzO1xuICAgICAgICBoWzBdICY9IDB4MWZmZjtcbiAgICAgICAgaFsxXSArPSBjO1xuICAgICAgICBjID0gaFsxXSA+Pj4gMTM7XG4gICAgICAgIGhbMV0gJj0gMHgxZmZmO1xuICAgICAgICBoWzJdICs9IGM7XG4gICAgICAgIGdbMF0gPSBoWzBdICsgNTtcbiAgICAgICAgYyA9IGdbMF0gPj4+IDEzO1xuICAgICAgICBnWzBdICY9IDB4MWZmZjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgICAgICBnW2ldID0gaFtpXSArIGM7XG4gICAgICAgICAgICBjID0gZ1tpXSA+Pj4gMTM7XG4gICAgICAgICAgICBnW2ldICY9IDB4MWZmZjtcbiAgICAgICAgfVxuICAgICAgICBnWzldIC09IDEgPDwgMTM7XG4gICAgICAgIGxldCBtYXNrID0gKGMgXiAxKSAtIDE7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKylcbiAgICAgICAgICAgIGdbaV0gJj0gbWFzaztcbiAgICAgICAgbWFzayA9IH5tYXNrO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspXG4gICAgICAgICAgICBoW2ldID0gKGhbaV0gJiBtYXNrKSB8IGdbaV07XG4gICAgICAgIGhbMF0gPSAoaFswXSB8IChoWzFdIDw8IDEzKSkgJiAweGZmZmY7XG4gICAgICAgIGhbMV0gPSAoKGhbMV0gPj4+IDMpIHwgKGhbMl0gPDwgMTApKSAmIDB4ZmZmZjtcbiAgICAgICAgaFsyXSA9ICgoaFsyXSA+Pj4gNikgfCAoaFszXSA8PCA3KSkgJiAweGZmZmY7XG4gICAgICAgIGhbM10gPSAoKGhbM10gPj4+IDkpIHwgKGhbNF0gPDwgNCkpICYgMHhmZmZmO1xuICAgICAgICBoWzRdID0gKChoWzRdID4+PiAxMikgfCAoaFs1XSA8PCAxKSB8IChoWzZdIDw8IDE0KSkgJiAweGZmZmY7XG4gICAgICAgIGhbNV0gPSAoKGhbNl0gPj4+IDIpIHwgKGhbN10gPDwgMTEpKSAmIDB4ZmZmZjtcbiAgICAgICAgaFs2XSA9ICgoaFs3XSA+Pj4gNSkgfCAoaFs4XSA8PCA4KSkgJiAweGZmZmY7XG4gICAgICAgIGhbN10gPSAoKGhbOF0gPj4+IDgpIHwgKGhbOV0gPDwgNSkpICYgMHhmZmZmO1xuICAgICAgICBsZXQgZiA9IGhbMF0gKyBwYWRbMF07XG4gICAgICAgIGhbMF0gPSBmICYgMHhmZmZmO1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgZiA9ICgoKGhbaV0gKyBwYWRbaV0pIHwgMCkgKyAoZiA+Pj4gMTYpKSB8IDA7XG4gICAgICAgICAgICBoW2ldID0gZiAmIDB4ZmZmZjtcbiAgICAgICAgfVxuICAgICAgICBjbGVhbihnKTtcbiAgICB9XG4gICAgdXBkYXRlKGRhdGEpIHtcbiAgICAgICAgYWV4aXN0cyh0aGlzKTtcbiAgICAgICAgYWJ5dGVzKGRhdGEpO1xuICAgICAgICBkYXRhID0gY29weUJ5dGVzKGRhdGEpO1xuICAgICAgICBjb25zdCB7IGJ1ZmZlciwgYmxvY2tMZW4gfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGxlbiA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47KSB7XG4gICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvcywgbGVuIC0gcG9zKTtcbiAgICAgICAgICAgIC8vIEZhc3QgcGF0aDogd2UgaGF2ZSBhdCBsZWFzdCBvbmUgYmxvY2sgaW4gaW5wdXRcbiAgICAgICAgICAgIGlmICh0YWtlID09PSBibG9ja0xlbikge1xuICAgICAgICAgICAgICAgIGZvciAoOyBibG9ja0xlbiA8PSBsZW4gLSBwb3M7IHBvcyArPSBibG9ja0xlbilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzKGRhdGEsIHBvcyk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBidWZmZXIuc2V0KGRhdGEuc3ViYXJyYXkocG9zLCBwb3MgKyB0YWtlKSwgdGhpcy5wb3MpO1xuICAgICAgICAgICAgdGhpcy5wb3MgKz0gdGFrZTtcbiAgICAgICAgICAgIHBvcyArPSB0YWtlO1xuICAgICAgICAgICAgaWYgKHRoaXMucG9zID09PSBibG9ja0xlbikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2VzcyhidWZmZXIsIDAsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcyA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIGNsZWFuKHRoaXMuaCwgdGhpcy5yLCB0aGlzLmJ1ZmZlciwgdGhpcy5wYWQpO1xuICAgIH1cbiAgICBkaWdlc3RJbnRvKG91dCkge1xuICAgICAgICBhZXhpc3RzKHRoaXMpO1xuICAgICAgICBhb3V0cHV0KG91dCwgdGhpcyk7XG4gICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlO1xuICAgICAgICBjb25zdCB7IGJ1ZmZlciwgaCB9ID0gdGhpcztcbiAgICAgICAgbGV0IHsgcG9zIH0gPSB0aGlzO1xuICAgICAgICBpZiAocG9zKSB7XG4gICAgICAgICAgICBidWZmZXJbcG9zKytdID0gMTtcbiAgICAgICAgICAgIGZvciAoOyBwb3MgPCAxNjsgcG9zKyspXG4gICAgICAgICAgICAgICAgYnVmZmVyW3Bvc10gPSAwO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzKGJ1ZmZlciwgMCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maW5hbGl6ZSgpO1xuICAgICAgICBsZXQgb3BvcyA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbb3BvcysrXSA9IGhbaV0gPj4+IDA7XG4gICAgICAgICAgICBvdXRbb3BvcysrXSA9IGhbaV0gPj4+IDg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9XG4gICAgZGlnZXN0KCkge1xuICAgICAgICBjb25zdCB7IGJ1ZmZlciwgb3V0cHV0TGVuIH0gPSB0aGlzO1xuICAgICAgICB0aGlzLmRpZ2VzdEludG8oYnVmZmVyKTtcbiAgICAgICAgY29uc3QgcmVzID0gYnVmZmVyLnNsaWNlKDAsIG91dHB1dExlbik7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiB3cmFwQ29uc3RydWN0b3JXaXRoS2V5KGhhc2hDb25zKSB7XG4gICAgY29uc3QgaGFzaEMgPSAobXNnLCBrZXkpID0+IGhhc2hDb25zKGtleSkudXBkYXRlKG1zZykuZGlnZXN0KCk7XG4gICAgY29uc3QgdG1wID0gaGFzaENvbnMobmV3IFVpbnQ4QXJyYXkoMzIpKTsgLy8gdG1wIGFycmF5LCB1c2VkIGp1c3Qgb25jZSBiZWxvd1xuICAgIGhhc2hDLm91dHB1dExlbiA9IHRtcC5vdXRwdXRMZW47XG4gICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47XG4gICAgaGFzaEMuY3JlYXRlID0gKGtleSkgPT4gaGFzaENvbnMoa2V5KTtcbiAgICByZXR1cm4gaGFzaEM7XG59XG4vKiogUG9seTEzMDUgTUFDIGZyb20gUkZDIDg0MzkuICovXG5leHBvcnQgY29uc3QgcG9seTEzMDUgPSAvKiogQF9fUFVSRV9fICovICgoKSA9PiB3cmFwQ29uc3RydWN0b3JXaXRoS2V5KChrZXkpID0+IG5ldyBQb2x5MTMwNShrZXkpKSkoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPV9wb2x5MTMwNS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@noble/ciphers/_poly1305.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@noble/ciphers/chacha.js":
/*!***********************************************!*\
  !*** ./node_modules/@noble/ciphers/chacha.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _poly1305_aead: function() { return /* binding */ _poly1305_aead; },\n/* harmony export */   chacha12: function() { return /* binding */ chacha12; },\n/* harmony export */   chacha20: function() { return /* binding */ chacha20; },\n/* harmony export */   chacha20orig: function() { return /* binding */ chacha20orig; },\n/* harmony export */   chacha20poly1305: function() { return /* binding */ chacha20poly1305; },\n/* harmony export */   chacha8: function() { return /* binding */ chacha8; },\n/* harmony export */   hchacha: function() { return /* binding */ hchacha; },\n/* harmony export */   rngChacha20: function() { return /* binding */ rngChacha20; },\n/* harmony export */   rngChacha8: function() { return /* binding */ rngChacha8; },\n/* harmony export */   xchacha20: function() { return /* binding */ xchacha20; },\n/* harmony export */   xchacha20poly1305: function() { return /* binding */ xchacha20poly1305; }\n/* harmony export */ });\n/* harmony import */ var _arx_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_arx.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/_arx.js\");\n/* harmony import */ var _poly1305_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_poly1305.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/_poly1305.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/utils.js\");\n/**\n * ChaCha stream cipher, released\n * in 2008. Developed after Salsa20, ChaCha aims to increase diffusion per round.\n * It was standardized in [RFC 8439](https://www.rfc-editor.org/rfc/rfc8439) and\n * is now used in TLS 1.3.\n *\n * [XChaCha20](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha)\n * extended-nonce variant is also provided. Similar to XSalsa, it's safe to use with\n * randomly-generated nonces.\n *\n * Check out [PDF](http://cr.yp.to/chacha/chacha-20080128.pdf) and\n * [wiki](https://en.wikipedia.org/wiki/Salsa20) and\n * [website](https://cr.yp.to/chacha.html).\n *\n * @module\n */\n\n\n\n/**\n * ChaCha core function. It is implemented twice:\n * 1. Simple loop (chachaCore_small, hchacha_small)\n * 2. Unrolled loop (chachaCore, hchacha) - 4x faster, but larger & harder to read\n * The specific implementation is selected in `createCipher` below.\n */\n/** quarter-round */\n// prettier-ignore\nfunction chachaQR(x, a, b, c, d) {\n    x[a] = (x[a] + x[b]) | 0;\n    x[d] = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x[d] ^ x[a], 16);\n    x[c] = (x[c] + x[d]) | 0;\n    x[b] = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x[b] ^ x[c], 12);\n    x[a] = (x[a] + x[b]) | 0;\n    x[d] = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x[d] ^ x[a], 8);\n    x[c] = (x[c] + x[d]) | 0;\n    x[b] = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x[b] ^ x[c], 7);\n}\n/** single round */\nfunction chachaRound(x, rounds = 20) {\n    for (let r = 0; r < rounds; r += 2) {\n        chachaQR(x, 0, 4, 8, 12);\n        chachaQR(x, 1, 5, 9, 13);\n        chachaQR(x, 2, 6, 10, 14);\n        chachaQR(x, 3, 7, 11, 15);\n        chachaQR(x, 0, 5, 10, 15);\n        chachaQR(x, 1, 6, 11, 12);\n        chachaQR(x, 2, 7, 8, 13);\n        chachaQR(x, 3, 4, 9, 14);\n    }\n}\nconst ctmp = /* @__PURE__ */ new Uint32Array(16);\n/** Small version of chacha without loop unrolling. Unused, provided for auditability. */\n// prettier-ignore\nfunction chacha(s, k, i, out, isHChacha = true, rounds = 20) {\n    // Create initial array using common pattern\n    const y = Uint32Array.from([\n        s[0], s[1], s[2], s[3], // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n        k[0], k[1], k[2], k[3], // Key      Key     Key     Key\n        k[4], k[5], k[6], k[7], // Key      Key     Key     Key\n        i[0], i[1], i[2], i[3], // Counter  Counter Nonce   Nonce\n    ]);\n    const x = ctmp;\n    x.set(y);\n    chachaRound(x, rounds);\n    // hchacha extracts 8 specific bytes, chacha adds orig to result\n    if (isHChacha) {\n        const xindexes = [0, 1, 2, 3, 12, 13, 14, 15];\n        for (let i = 0; i < 8; i++)\n            out[i] = x[xindexes[i]];\n    }\n    else {\n        for (let i = 0; i < 16; i++)\n            out[i] = (y[i] + x[i]) | 0;\n    }\n}\n/** Identical to `chachaCore`. Unused. */\n// @ts-ignore\nconst chachaCore_small = (s, k, n, out, cnt, rounds) => chacha(s, k, Uint32Array.from([n[0], n[1], cnt, 0]), out, false, rounds);\n/** Identical to `hchacha`. Unused. */\n// @ts-ignore\nconst hchacha_small = chacha;\n/** Identical to `chachaCore_small`. Unused. */\n// prettier-ignore\nfunction chachaCore(s, k, n, out, cnt, rounds = 20) {\n    let y00 = s[0], y01 = s[1], y02 = s[2], y03 = s[3], // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n    y04 = k[0], y05 = k[1], y06 = k[2], y07 = k[3], // Key      Key     Key     Key\n    y08 = k[4], y09 = k[5], y10 = k[6], y11 = k[7], // Key      Key     Key     Key\n    y12 = cnt, y13 = n[0], y14 = n[1], y15 = n[2]; // Counter  Counter\tNonce   Nonce\n    // Save state to temporary variables\n    let x00 = y00, x01 = y01, x02 = y02, x03 = y03, x04 = y04, x05 = y05, x06 = y06, x07 = y07, x08 = y08, x09 = y09, x10 = y10, x11 = y11, x12 = y12, x13 = y13, x14 = y14, x15 = y15;\n    for (let r = 0; r < rounds; r += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x09, 7);\n    }\n    // Write output\n    let oi = 0;\n    out[oi++] = (y00 + x00) | 0;\n    out[oi++] = (y01 + x01) | 0;\n    out[oi++] = (y02 + x02) | 0;\n    out[oi++] = (y03 + x03) | 0;\n    out[oi++] = (y04 + x04) | 0;\n    out[oi++] = (y05 + x05) | 0;\n    out[oi++] = (y06 + x06) | 0;\n    out[oi++] = (y07 + x07) | 0;\n    out[oi++] = (y08 + x08) | 0;\n    out[oi++] = (y09 + x09) | 0;\n    out[oi++] = (y10 + x10) | 0;\n    out[oi++] = (y11 + x11) | 0;\n    out[oi++] = (y12 + x12) | 0;\n    out[oi++] = (y13 + x13) | 0;\n    out[oi++] = (y14 + x14) | 0;\n    out[oi++] = (y15 + x15) | 0;\n}\n/**\n * hchacha hashes key and nonce into key' and nonce' for xchacha20.\n * Identical to `hchacha_small`.\n * Need to find a way to merge it with `chachaCore` without 25% performance hit.\n */\n// prettier-ignore\nfunction hchacha(s, k, i, out) {\n    let x00 = s[0], x01 = s[1], x02 = s[2], x03 = s[3], x04 = k[0], x05 = k[1], x06 = k[2], x07 = k[3], x08 = k[4], x09 = k[5], x10 = k[6], x11 = k[7], x12 = i[0], x13 = i[1], x14 = i[2], x15 = i[3];\n    for (let r = 0; r < 20; r += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.rotl)(x04 ^ x09, 7);\n    }\n    let oi = 0;\n    out[oi++] = x00;\n    out[oi++] = x01;\n    out[oi++] = x02;\n    out[oi++] = x03;\n    out[oi++] = x12;\n    out[oi++] = x13;\n    out[oi++] = x14;\n    out[oi++] = x15;\n}\n/** Original, non-RFC chacha20 from DJB. 8-byte nonce, 8-byte counter. */\nconst chacha20orig = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createCipher)(chachaCore, {\n    counterRight: false,\n    counterLength: 8,\n    allowShortKeys: true,\n});\n/**\n * ChaCha stream cipher. Conforms to RFC 8439 (IETF, TLS). 12-byte nonce, 4-byte counter.\n * With smaller nonce, it's not safe to make it random (CSPRNG), due to collision chance.\n */\nconst chacha20 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createCipher)(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    allowShortKeys: false,\n});\n/**\n * XChaCha eXtended-nonce ChaCha. With 24-byte nonce, it's safe to make it random (CSPRNG).\n * See [IRTF draft](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha).\n */\nconst xchacha20 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createCipher)(chachaCore, {\n    counterRight: false,\n    counterLength: 8,\n    extendNonceFn: hchacha,\n    allowShortKeys: false,\n});\n/** Reduced 8-round chacha, described in original paper. */\nconst chacha8 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createCipher)(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    rounds: 8,\n});\n/** Reduced 12-round chacha, described in original paper. */\nconst chacha12 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createCipher)(chachaCore, {\n    counterRight: false,\n    counterLength: 4,\n    rounds: 12,\n});\nconst ZEROS16 = /* @__PURE__ */ new Uint8Array(16);\n// Pad to digest size with zeros\nconst updatePadded = (h, msg) => {\n    h.update(msg);\n    const leftover = msg.length % 16;\n    if (leftover)\n        h.update(ZEROS16.subarray(leftover));\n};\nconst ZEROS32 = /* @__PURE__ */ new Uint8Array(32);\nfunction computeTag(fn, key, nonce, ciphertext, AAD) {\n    if (AAD !== undefined)\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.abytes)(AAD, undefined, 'AAD');\n    const authKey = fn(key, nonce, ZEROS32);\n    const lengths = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.u64Lengths)(ciphertext.length, AAD ? AAD.length : 0, true);\n    // Methods below can be replaced with\n    // return poly1305_computeTag_small(authKey, lengths, ciphertext, AAD)\n    const h = _poly1305_js__WEBPACK_IMPORTED_MODULE_2__.poly1305.create(authKey);\n    if (AAD)\n        updatePadded(h, AAD);\n    updatePadded(h, ciphertext);\n    h.update(lengths);\n    const res = h.digest();\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.clean)(authKey, lengths);\n    return res;\n}\n/**\n * AEAD algorithm from RFC 8439.\n * Salsa20 and chacha (RFC 8439) use poly1305 differently.\n * We could have composed them, but it's hard because of authKey:\n * In salsa20, authKey changes position in salsa stream.\n * In chacha, authKey can't be computed inside computeTag, it modifies the counter.\n */\nconst _poly1305_aead = (xorStream) => (key, nonce, AAD) => {\n    const tagLength = 16;\n    return {\n        encrypt(plaintext, output) {\n            const plength = plaintext.length;\n            output = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getOutput)(plength + tagLength, output, false);\n            output.set(plaintext);\n            const oPlain = output.subarray(0, -tagLength);\n            // Actual encryption\n            xorStream(key, nonce, oPlain, oPlain, 1);\n            const tag = computeTag(xorStream, key, nonce, oPlain, AAD);\n            output.set(tag, plength); // append tag\n            (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.clean)(tag);\n            return output;\n        },\n        decrypt(ciphertext, output) {\n            output = (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.getOutput)(ciphertext.length - tagLength, output, false);\n            const data = ciphertext.subarray(0, -tagLength);\n            const passedTag = ciphertext.subarray(-tagLength);\n            const tag = computeTag(xorStream, key, nonce, data, AAD);\n            if (!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.equalBytes)(passedTag, tag))\n                throw new Error('invalid tag');\n            output.set(ciphertext.subarray(0, -tagLength));\n            // Actual decryption\n            xorStream(key, nonce, output, output, 1); // start stream with i=1\n            (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.clean)(tag);\n            return output;\n        },\n    };\n};\n/**\n * ChaCha20-Poly1305 from RFC 8439.\n *\n * Unsafe to use random nonces under the same key, due to collision chance.\n * Prefer XChaCha instead.\n */\nconst chacha20poly1305 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapCipher)({ blockSize: 64, nonceLength: 12, tagLength: 16 }, _poly1305_aead(chacha20));\n/**\n * XChaCha20-Poly1305 extended-nonce chacha.\n *\n * Can be safely used with random nonces (CSPRNG).\n * See [IRTF draft](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha).\n */\nconst xchacha20poly1305 = /* @__PURE__ */ (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapCipher)({ blockSize: 64, nonceLength: 24, tagLength: 16 }, _poly1305_aead(xchacha20));\n/**\n * Chacha20 CSPRNG (cryptographically secure pseudorandom number generator).\n * It's best to limit usage to non-production, non-critical cases: for example, test-only.\n * Compatible with libtomcrypt. It does not have a specification, so unclear how secure it is.\n */\nconst rngChacha20 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createPRG)(chacha20orig, 64, 32, 8);\n/**\n * Chacha20/8 CSPRNG (cryptographically secure pseudorandom number generator).\n * It's best to limit usage to non-production, non-critical cases: for example, test-only.\n * Faster than `rngChacha20`.\n */\nconst rngChacha8 = /* @__PURE__ */ (0,_arx_js__WEBPACK_IMPORTED_MODULE_0__.createPRG)(chacha8, 64, 32, 12);\n//# sourceMappingURL=chacha.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9Abm9ibGUvY2lwaGVycy9jaGFjaGEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUMwRDtBQUNoQjtBQUNpRDtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsNkNBQUk7QUFDZjtBQUNBLFdBQVcsNkNBQUk7QUFDZjtBQUNBLFdBQVcsNkNBQUk7QUFDZjtBQUNBLFdBQVcsNkNBQUk7QUFDZjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsWUFBWTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBLG9CQUFvQixZQUFZO0FBQ2hDO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0EsY0FBYyw2Q0FBSTtBQUNsQjtBQUNBLGNBQWMsNkNBQUk7QUFDbEI7QUFDQSxjQUFjLDZDQUFJO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHFDQUFxQyxxREFBWTtBQUN4RDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDTyxpQ0FBaUMscURBQVk7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ08sa0NBQWtDLHFEQUFZO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ08sZ0NBQWdDLHFEQUFZO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNPLGlDQUFpQyxxREFBWTtBQUNwRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaURBQU07QUFDZDtBQUNBLG9CQUFvQixxREFBVTtBQUM5QjtBQUNBO0FBQ0EsY0FBYyxrREFBUTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxnREFBSztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsb0RBQVM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QyxZQUFZLGdEQUFLO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0EscUJBQXFCLG9EQUFTO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixxREFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQsWUFBWSxnREFBSztBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08seUNBQXlDLHFEQUFVLEdBQUcsK0NBQStDO0FBQzVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLDBDQUEwQyxxREFBVSxHQUFHLCtDQUErQztBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sb0NBQW9DLGtEQUFTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxtQ0FBbUMsa0RBQVM7QUFDbkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcz8wZDdhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ2hhQ2hhIHN0cmVhbSBjaXBoZXIsIHJlbGVhc2VkXG4gKiBpbiAyMDA4LiBEZXZlbG9wZWQgYWZ0ZXIgU2Fsc2EyMCwgQ2hhQ2hhIGFpbXMgdG8gaW5jcmVhc2UgZGlmZnVzaW9uIHBlciByb3VuZC5cbiAqIEl0IHdhcyBzdGFuZGFyZGl6ZWQgaW4gW1JGQyA4NDM5XShodHRwczovL3d3dy5yZmMtZWRpdG9yLm9yZy9yZmMvcmZjODQzOSkgYW5kXG4gKiBpcyBub3cgdXNlZCBpbiBUTFMgMS4zLlxuICpcbiAqIFtYQ2hhQ2hhMjBdKGh0dHBzOi8vZGF0YXRyYWNrZXIuaWV0Zi5vcmcvZG9jL2h0bWwvZHJhZnQtaXJ0Zi1jZnJnLXhjaGFjaGEpXG4gKiBleHRlbmRlZC1ub25jZSB2YXJpYW50IGlzIGFsc28gcHJvdmlkZWQuIFNpbWlsYXIgdG8gWFNhbHNhLCBpdCdzIHNhZmUgdG8gdXNlIHdpdGhcbiAqIHJhbmRvbWx5LWdlbmVyYXRlZCBub25jZXMuXG4gKlxuICogQ2hlY2sgb3V0IFtQREZdKGh0dHA6Ly9jci55cC50by9jaGFjaGEvY2hhY2hhLTIwMDgwMTI4LnBkZikgYW5kXG4gKiBbd2lraV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2Fsc2EyMCkgYW5kXG4gKiBbd2Vic2l0ZV0oaHR0cHM6Ly9jci55cC50by9jaGFjaGEuaHRtbCkuXG4gKlxuICogQG1vZHVsZVxuICovXG5pbXBvcnQgeyBjcmVhdGVDaXBoZXIsIGNyZWF0ZVBSRywgcm90bCB9IGZyb20gXCIuL19hcnguanNcIjtcbmltcG9ydCB7IHBvbHkxMzA1IH0gZnJvbSBcIi4vX3BvbHkxMzA1LmpzXCI7XG5pbXBvcnQgeyBhYnl0ZXMsIGNsZWFuLCBlcXVhbEJ5dGVzLCBnZXRPdXRwdXQsIHU2NExlbmd0aHMsIHdyYXBDaXBoZXIsIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbi8qKlxuICogQ2hhQ2hhIGNvcmUgZnVuY3Rpb24uIEl0IGlzIGltcGxlbWVudGVkIHR3aWNlOlxuICogMS4gU2ltcGxlIGxvb3AgKGNoYWNoYUNvcmVfc21hbGwsIGhjaGFjaGFfc21hbGwpXG4gKiAyLiBVbnJvbGxlZCBsb29wIChjaGFjaGFDb3JlLCBoY2hhY2hhKSAtIDR4IGZhc3RlciwgYnV0IGxhcmdlciAmIGhhcmRlciB0byByZWFkXG4gKiBUaGUgc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gaXMgc2VsZWN0ZWQgaW4gYGNyZWF0ZUNpcGhlcmAgYmVsb3cuXG4gKi9cbi8qKiBxdWFydGVyLXJvdW5kICovXG4vLyBwcmV0dGllci1pZ25vcmVcbmZ1bmN0aW9uIGNoYWNoYVFSKHgsIGEsIGIsIGMsIGQpIHtcbiAgICB4W2FdID0gKHhbYV0gKyB4W2JdKSB8IDA7XG4gICAgeFtkXSA9IHJvdGwoeFtkXSBeIHhbYV0sIDE2KTtcbiAgICB4W2NdID0gKHhbY10gKyB4W2RdKSB8IDA7XG4gICAgeFtiXSA9IHJvdGwoeFtiXSBeIHhbY10sIDEyKTtcbiAgICB4W2FdID0gKHhbYV0gKyB4W2JdKSB8IDA7XG4gICAgeFtkXSA9IHJvdGwoeFtkXSBeIHhbYV0sIDgpO1xuICAgIHhbY10gPSAoeFtjXSArIHhbZF0pIHwgMDtcbiAgICB4W2JdID0gcm90bCh4W2JdIF4geFtjXSwgNyk7XG59XG4vKiogc2luZ2xlIHJvdW5kICovXG5mdW5jdGlvbiBjaGFjaGFSb3VuZCh4LCByb3VuZHMgPSAyMCkge1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgcm91bmRzOyByICs9IDIpIHtcbiAgICAgICAgY2hhY2hhUVIoeCwgMCwgNCwgOCwgMTIpO1xuICAgICAgICBjaGFjaGFRUih4LCAxLCA1LCA5LCAxMyk7XG4gICAgICAgIGNoYWNoYVFSKHgsIDIsIDYsIDEwLCAxNCk7XG4gICAgICAgIGNoYWNoYVFSKHgsIDMsIDcsIDExLCAxNSk7XG4gICAgICAgIGNoYWNoYVFSKHgsIDAsIDUsIDEwLCAxNSk7XG4gICAgICAgIGNoYWNoYVFSKHgsIDEsIDYsIDExLCAxMik7XG4gICAgICAgIGNoYWNoYVFSKHgsIDIsIDcsIDgsIDEzKTtcbiAgICAgICAgY2hhY2hhUVIoeCwgMywgNCwgOSwgMTQpO1xuICAgIH1cbn1cbmNvbnN0IGN0bXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KDE2KTtcbi8qKiBTbWFsbCB2ZXJzaW9uIG9mIGNoYWNoYSB3aXRob3V0IGxvb3AgdW5yb2xsaW5nLiBVbnVzZWQsIHByb3ZpZGVkIGZvciBhdWRpdGFiaWxpdHkuICovXG4vLyBwcmV0dGllci1pZ25vcmVcbmZ1bmN0aW9uIGNoYWNoYShzLCBrLCBpLCBvdXQsIGlzSENoYWNoYSA9IHRydWUsIHJvdW5kcyA9IDIwKSB7XG4gICAgLy8gQ3JlYXRlIGluaXRpYWwgYXJyYXkgdXNpbmcgY29tbW9uIHBhdHRlcm5cbiAgICBjb25zdCB5ID0gVWludDMyQXJyYXkuZnJvbShbXG4gICAgICAgIHNbMF0sIHNbMV0sIHNbMl0sIHNbM10sIC8vIFwiZXhwYVwiICAgXCJuZCAzXCIgIFwiMi1ieVwiICBcInRlIGtcIlxuICAgICAgICBrWzBdLCBrWzFdLCBrWzJdLCBrWzNdLCAvLyBLZXkgICAgICBLZXkgICAgIEtleSAgICAgS2V5XG4gICAgICAgIGtbNF0sIGtbNV0sIGtbNl0sIGtbN10sIC8vIEtleSAgICAgIEtleSAgICAgS2V5ICAgICBLZXlcbiAgICAgICAgaVswXSwgaVsxXSwgaVsyXSwgaVszXSwgLy8gQ291bnRlciAgQ291bnRlciBOb25jZSAgIE5vbmNlXG4gICAgXSk7XG4gICAgY29uc3QgeCA9IGN0bXA7XG4gICAgeC5zZXQoeSk7XG4gICAgY2hhY2hhUm91bmQoeCwgcm91bmRzKTtcbiAgICAvLyBoY2hhY2hhIGV4dHJhY3RzIDggc3BlY2lmaWMgYnl0ZXMsIGNoYWNoYSBhZGRzIG9yaWcgdG8gcmVzdWx0XG4gICAgaWYgKGlzSENoYWNoYSkge1xuICAgICAgICBjb25zdCB4aW5kZXhlcyA9IFswLCAxLCAyLCAzLCAxMiwgMTMsIDE0LCAxNV07XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKVxuICAgICAgICAgICAgb3V0W2ldID0geFt4aW5kZXhlc1tpXV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspXG4gICAgICAgICAgICBvdXRbaV0gPSAoeVtpXSArIHhbaV0pIHwgMDtcbiAgICB9XG59XG4vKiogSWRlbnRpY2FsIHRvIGBjaGFjaGFDb3JlYC4gVW51c2VkLiAqL1xuLy8gQHRzLWlnbm9yZVxuY29uc3QgY2hhY2hhQ29yZV9zbWFsbCA9IChzLCBrLCBuLCBvdXQsIGNudCwgcm91bmRzKSA9PiBjaGFjaGEocywgaywgVWludDMyQXJyYXkuZnJvbShbblswXSwgblsxXSwgY250LCAwXSksIG91dCwgZmFsc2UsIHJvdW5kcyk7XG4vKiogSWRlbnRpY2FsIHRvIGBoY2hhY2hhYC4gVW51c2VkLiAqL1xuLy8gQHRzLWlnbm9yZVxuY29uc3QgaGNoYWNoYV9zbWFsbCA9IGNoYWNoYTtcbi8qKiBJZGVudGljYWwgdG8gYGNoYWNoYUNvcmVfc21hbGxgLiBVbnVzZWQuICovXG4vLyBwcmV0dGllci1pZ25vcmVcbmZ1bmN0aW9uIGNoYWNoYUNvcmUocywgaywgbiwgb3V0LCBjbnQsIHJvdW5kcyA9IDIwKSB7XG4gICAgbGV0IHkwMCA9IHNbMF0sIHkwMSA9IHNbMV0sIHkwMiA9IHNbMl0sIHkwMyA9IHNbM10sIC8vIFwiZXhwYVwiICAgXCJuZCAzXCIgIFwiMi1ieVwiICBcInRlIGtcIlxuICAgIHkwNCA9IGtbMF0sIHkwNSA9IGtbMV0sIHkwNiA9IGtbMl0sIHkwNyA9IGtbM10sIC8vIEtleSAgICAgIEtleSAgICAgS2V5ICAgICBLZXlcbiAgICB5MDggPSBrWzRdLCB5MDkgPSBrWzVdLCB5MTAgPSBrWzZdLCB5MTEgPSBrWzddLCAvLyBLZXkgICAgICBLZXkgICAgIEtleSAgICAgS2V5XG4gICAgeTEyID0gY250LCB5MTMgPSBuWzBdLCB5MTQgPSBuWzFdLCB5MTUgPSBuWzJdOyAvLyBDb3VudGVyICBDb3VudGVyXHROb25jZSAgIE5vbmNlXG4gICAgLy8gU2F2ZSBzdGF0ZSB0byB0ZW1wb3JhcnkgdmFyaWFibGVzXG4gICAgbGV0IHgwMCA9IHkwMCwgeDAxID0geTAxLCB4MDIgPSB5MDIsIHgwMyA9IHkwMywgeDA0ID0geTA0LCB4MDUgPSB5MDUsIHgwNiA9IHkwNiwgeDA3ID0geTA3LCB4MDggPSB5MDgsIHgwOSA9IHkwOSwgeDEwID0geTEwLCB4MTEgPSB5MTEsIHgxMiA9IHkxMiwgeDEzID0geTEzLCB4MTQgPSB5MTQsIHgxNSA9IHkxNTtcbiAgICBmb3IgKGxldCByID0gMDsgciA8IHJvdW5kczsgciArPSAyKSB7XG4gICAgICAgIHgwMCA9ICh4MDAgKyB4MDQpIHwgMDtcbiAgICAgICAgeDEyID0gcm90bCh4MTIgXiB4MDAsIDE2KTtcbiAgICAgICAgeDA4ID0gKHgwOCArIHgxMikgfCAwO1xuICAgICAgICB4MDQgPSByb3RsKHgwNCBeIHgwOCwgMTIpO1xuICAgICAgICB4MDAgPSAoeDAwICsgeDA0KSB8IDA7XG4gICAgICAgIHgxMiA9IHJvdGwoeDEyIF4geDAwLCA4KTtcbiAgICAgICAgeDA4ID0gKHgwOCArIHgxMikgfCAwO1xuICAgICAgICB4MDQgPSByb3RsKHgwNCBeIHgwOCwgNyk7XG4gICAgICAgIHgwMSA9ICh4MDEgKyB4MDUpIHwgMDtcbiAgICAgICAgeDEzID0gcm90bCh4MTMgXiB4MDEsIDE2KTtcbiAgICAgICAgeDA5ID0gKHgwOSArIHgxMykgfCAwO1xuICAgICAgICB4MDUgPSByb3RsKHgwNSBeIHgwOSwgMTIpO1xuICAgICAgICB4MDEgPSAoeDAxICsgeDA1KSB8IDA7XG4gICAgICAgIHgxMyA9IHJvdGwoeDEzIF4geDAxLCA4KTtcbiAgICAgICAgeDA5ID0gKHgwOSArIHgxMykgfCAwO1xuICAgICAgICB4MDUgPSByb3RsKHgwNSBeIHgwOSwgNyk7XG4gICAgICAgIHgwMiA9ICh4MDIgKyB4MDYpIHwgMDtcbiAgICAgICAgeDE0ID0gcm90bCh4MTQgXiB4MDIsIDE2KTtcbiAgICAgICAgeDEwID0gKHgxMCArIHgxNCkgfCAwO1xuICAgICAgICB4MDYgPSByb3RsKHgwNiBeIHgxMCwgMTIpO1xuICAgICAgICB4MDIgPSAoeDAyICsgeDA2KSB8IDA7XG4gICAgICAgIHgxNCA9IHJvdGwoeDE0IF4geDAyLCA4KTtcbiAgICAgICAgeDEwID0gKHgxMCArIHgxNCkgfCAwO1xuICAgICAgICB4MDYgPSByb3RsKHgwNiBeIHgxMCwgNyk7XG4gICAgICAgIHgwMyA9ICh4MDMgKyB4MDcpIHwgMDtcbiAgICAgICAgeDE1ID0gcm90bCh4MTUgXiB4MDMsIDE2KTtcbiAgICAgICAgeDExID0gKHgxMSArIHgxNSkgfCAwO1xuICAgICAgICB4MDcgPSByb3RsKHgwNyBeIHgxMSwgMTIpO1xuICAgICAgICB4MDMgPSAoeDAzICsgeDA3KSB8IDA7XG4gICAgICAgIHgxNSA9IHJvdGwoeDE1IF4geDAzLCA4KTtcbiAgICAgICAgeDExID0gKHgxMSArIHgxNSkgfCAwO1xuICAgICAgICB4MDcgPSByb3RsKHgwNyBeIHgxMSwgNyk7XG4gICAgICAgIHgwMCA9ICh4MDAgKyB4MDUpIHwgMDtcbiAgICAgICAgeDE1ID0gcm90bCh4MTUgXiB4MDAsIDE2KTtcbiAgICAgICAgeDEwID0gKHgxMCArIHgxNSkgfCAwO1xuICAgICAgICB4MDUgPSByb3RsKHgwNSBeIHgxMCwgMTIpO1xuICAgICAgICB4MDAgPSAoeDAwICsgeDA1KSB8IDA7XG4gICAgICAgIHgxNSA9IHJvdGwoeDE1IF4geDAwLCA4KTtcbiAgICAgICAgeDEwID0gKHgxMCArIHgxNSkgfCAwO1xuICAgICAgICB4MDUgPSByb3RsKHgwNSBeIHgxMCwgNyk7XG4gICAgICAgIHgwMSA9ICh4MDEgKyB4MDYpIHwgMDtcbiAgICAgICAgeDEyID0gcm90bCh4MTIgXiB4MDEsIDE2KTtcbiAgICAgICAgeDExID0gKHgxMSArIHgxMikgfCAwO1xuICAgICAgICB4MDYgPSByb3RsKHgwNiBeIHgxMSwgMTIpO1xuICAgICAgICB4MDEgPSAoeDAxICsgeDA2KSB8IDA7XG4gICAgICAgIHgxMiA9IHJvdGwoeDEyIF4geDAxLCA4KTtcbiAgICAgICAgeDExID0gKHgxMSArIHgxMikgfCAwO1xuICAgICAgICB4MDYgPSByb3RsKHgwNiBeIHgxMSwgNyk7XG4gICAgICAgIHgwMiA9ICh4MDIgKyB4MDcpIHwgMDtcbiAgICAgICAgeDEzID0gcm90bCh4MTMgXiB4MDIsIDE2KTtcbiAgICAgICAgeDA4ID0gKHgwOCArIHgxMykgfCAwO1xuICAgICAgICB4MDcgPSByb3RsKHgwNyBeIHgwOCwgMTIpO1xuICAgICAgICB4MDIgPSAoeDAyICsgeDA3KSB8IDA7XG4gICAgICAgIHgxMyA9IHJvdGwoeDEzIF4geDAyLCA4KTtcbiAgICAgICAgeDA4ID0gKHgwOCArIHgxMykgfCAwO1xuICAgICAgICB4MDcgPSByb3RsKHgwNyBeIHgwOCwgNyk7XG4gICAgICAgIHgwMyA9ICh4MDMgKyB4MDQpIHwgMDtcbiAgICAgICAgeDE0ID0gcm90bCh4MTQgXiB4MDMsIDE2KTtcbiAgICAgICAgeDA5ID0gKHgwOSArIHgxNCkgfCAwO1xuICAgICAgICB4MDQgPSByb3RsKHgwNCBeIHgwOSwgMTIpO1xuICAgICAgICB4MDMgPSAoeDAzICsgeDA0KSB8IDA7XG4gICAgICAgIHgxNCA9IHJvdGwoeDE0IF4geDAzLCA4KTtcbiAgICAgICAgeDA5ID0gKHgwOSArIHgxNCkgfCAwO1xuICAgICAgICB4MDQgPSByb3RsKHgwNCBeIHgwOSwgNyk7XG4gICAgfVxuICAgIC8vIFdyaXRlIG91dHB1dFxuICAgIGxldCBvaSA9IDA7XG4gICAgb3V0W29pKytdID0gKHkwMCArIHgwMCkgfCAwO1xuICAgIG91dFtvaSsrXSA9ICh5MDEgKyB4MDEpIHwgMDtcbiAgICBvdXRbb2krK10gPSAoeTAyICsgeDAyKSB8IDA7XG4gICAgb3V0W29pKytdID0gKHkwMyArIHgwMykgfCAwO1xuICAgIG91dFtvaSsrXSA9ICh5MDQgKyB4MDQpIHwgMDtcbiAgICBvdXRbb2krK10gPSAoeTA1ICsgeDA1KSB8IDA7XG4gICAgb3V0W29pKytdID0gKHkwNiArIHgwNikgfCAwO1xuICAgIG91dFtvaSsrXSA9ICh5MDcgKyB4MDcpIHwgMDtcbiAgICBvdXRbb2krK10gPSAoeTA4ICsgeDA4KSB8IDA7XG4gICAgb3V0W29pKytdID0gKHkwOSArIHgwOSkgfCAwO1xuICAgIG91dFtvaSsrXSA9ICh5MTAgKyB4MTApIHwgMDtcbiAgICBvdXRbb2krK10gPSAoeTExICsgeDExKSB8IDA7XG4gICAgb3V0W29pKytdID0gKHkxMiArIHgxMikgfCAwO1xuICAgIG91dFtvaSsrXSA9ICh5MTMgKyB4MTMpIHwgMDtcbiAgICBvdXRbb2krK10gPSAoeTE0ICsgeDE0KSB8IDA7XG4gICAgb3V0W29pKytdID0gKHkxNSArIHgxNSkgfCAwO1xufVxuLyoqXG4gKiBoY2hhY2hhIGhhc2hlcyBrZXkgYW5kIG5vbmNlIGludG8ga2V5JyBhbmQgbm9uY2UnIGZvciB4Y2hhY2hhMjAuXG4gKiBJZGVudGljYWwgdG8gYGhjaGFjaGFfc21hbGxgLlxuICogTmVlZCB0byBmaW5kIGEgd2F5IHRvIG1lcmdlIGl0IHdpdGggYGNoYWNoYUNvcmVgIHdpdGhvdXQgMjUlIHBlcmZvcm1hbmNlIGhpdC5cbiAqL1xuLy8gcHJldHRpZXItaWdub3JlXG5leHBvcnQgZnVuY3Rpb24gaGNoYWNoYShzLCBrLCBpLCBvdXQpIHtcbiAgICBsZXQgeDAwID0gc1swXSwgeDAxID0gc1sxXSwgeDAyID0gc1syXSwgeDAzID0gc1szXSwgeDA0ID0ga1swXSwgeDA1ID0ga1sxXSwgeDA2ID0ga1syXSwgeDA3ID0ga1szXSwgeDA4ID0ga1s0XSwgeDA5ID0ga1s1XSwgeDEwID0ga1s2XSwgeDExID0ga1s3XSwgeDEyID0gaVswXSwgeDEzID0gaVsxXSwgeDE0ID0gaVsyXSwgeDE1ID0gaVszXTtcbiAgICBmb3IgKGxldCByID0gMDsgciA8IDIwOyByICs9IDIpIHtcbiAgICAgICAgeDAwID0gKHgwMCArIHgwNCkgfCAwO1xuICAgICAgICB4MTIgPSByb3RsKHgxMiBeIHgwMCwgMTYpO1xuICAgICAgICB4MDggPSAoeDA4ICsgeDEyKSB8IDA7XG4gICAgICAgIHgwNCA9IHJvdGwoeDA0IF4geDA4LCAxMik7XG4gICAgICAgIHgwMCA9ICh4MDAgKyB4MDQpIHwgMDtcbiAgICAgICAgeDEyID0gcm90bCh4MTIgXiB4MDAsIDgpO1xuICAgICAgICB4MDggPSAoeDA4ICsgeDEyKSB8IDA7XG4gICAgICAgIHgwNCA9IHJvdGwoeDA0IF4geDA4LCA3KTtcbiAgICAgICAgeDAxID0gKHgwMSArIHgwNSkgfCAwO1xuICAgICAgICB4MTMgPSByb3RsKHgxMyBeIHgwMSwgMTYpO1xuICAgICAgICB4MDkgPSAoeDA5ICsgeDEzKSB8IDA7XG4gICAgICAgIHgwNSA9IHJvdGwoeDA1IF4geDA5LCAxMik7XG4gICAgICAgIHgwMSA9ICh4MDEgKyB4MDUpIHwgMDtcbiAgICAgICAgeDEzID0gcm90bCh4MTMgXiB4MDEsIDgpO1xuICAgICAgICB4MDkgPSAoeDA5ICsgeDEzKSB8IDA7XG4gICAgICAgIHgwNSA9IHJvdGwoeDA1IF4geDA5LCA3KTtcbiAgICAgICAgeDAyID0gKHgwMiArIHgwNikgfCAwO1xuICAgICAgICB4MTQgPSByb3RsKHgxNCBeIHgwMiwgMTYpO1xuICAgICAgICB4MTAgPSAoeDEwICsgeDE0KSB8IDA7XG4gICAgICAgIHgwNiA9IHJvdGwoeDA2IF4geDEwLCAxMik7XG4gICAgICAgIHgwMiA9ICh4MDIgKyB4MDYpIHwgMDtcbiAgICAgICAgeDE0ID0gcm90bCh4MTQgXiB4MDIsIDgpO1xuICAgICAgICB4MTAgPSAoeDEwICsgeDE0KSB8IDA7XG4gICAgICAgIHgwNiA9IHJvdGwoeDA2IF4geDEwLCA3KTtcbiAgICAgICAgeDAzID0gKHgwMyArIHgwNykgfCAwO1xuICAgICAgICB4MTUgPSByb3RsKHgxNSBeIHgwMywgMTYpO1xuICAgICAgICB4MTEgPSAoeDExICsgeDE1KSB8IDA7XG4gICAgICAgIHgwNyA9IHJvdGwoeDA3IF4geDExLCAxMik7XG4gICAgICAgIHgwMyA9ICh4MDMgKyB4MDcpIHwgMDtcbiAgICAgICAgeDE1ID0gcm90bCh4MTUgXiB4MDMsIDgpO1xuICAgICAgICB4MTEgPSAoeDExICsgeDE1KSB8IDA7XG4gICAgICAgIHgwNyA9IHJvdGwoeDA3IF4geDExLCA3KTtcbiAgICAgICAgeDAwID0gKHgwMCArIHgwNSkgfCAwO1xuICAgICAgICB4MTUgPSByb3RsKHgxNSBeIHgwMCwgMTYpO1xuICAgICAgICB4MTAgPSAoeDEwICsgeDE1KSB8IDA7XG4gICAgICAgIHgwNSA9IHJvdGwoeDA1IF4geDEwLCAxMik7XG4gICAgICAgIHgwMCA9ICh4MDAgKyB4MDUpIHwgMDtcbiAgICAgICAgeDE1ID0gcm90bCh4MTUgXiB4MDAsIDgpO1xuICAgICAgICB4MTAgPSAoeDEwICsgeDE1KSB8IDA7XG4gICAgICAgIHgwNSA9IHJvdGwoeDA1IF4geDEwLCA3KTtcbiAgICAgICAgeDAxID0gKHgwMSArIHgwNikgfCAwO1xuICAgICAgICB4MTIgPSByb3RsKHgxMiBeIHgwMSwgMTYpO1xuICAgICAgICB4MTEgPSAoeDExICsgeDEyKSB8IDA7XG4gICAgICAgIHgwNiA9IHJvdGwoeDA2IF4geDExLCAxMik7XG4gICAgICAgIHgwMSA9ICh4MDEgKyB4MDYpIHwgMDtcbiAgICAgICAgeDEyID0gcm90bCh4MTIgXiB4MDEsIDgpO1xuICAgICAgICB4MTEgPSAoeDExICsgeDEyKSB8IDA7XG4gICAgICAgIHgwNiA9IHJvdGwoeDA2IF4geDExLCA3KTtcbiAgICAgICAgeDAyID0gKHgwMiArIHgwNykgfCAwO1xuICAgICAgICB4MTMgPSByb3RsKHgxMyBeIHgwMiwgMTYpO1xuICAgICAgICB4MDggPSAoeDA4ICsgeDEzKSB8IDA7XG4gICAgICAgIHgwNyA9IHJvdGwoeDA3IF4geDA4LCAxMik7XG4gICAgICAgIHgwMiA9ICh4MDIgKyB4MDcpIHwgMDtcbiAgICAgICAgeDEzID0gcm90bCh4MTMgXiB4MDIsIDgpO1xuICAgICAgICB4MDggPSAoeDA4ICsgeDEzKSB8IDA7XG4gICAgICAgIHgwNyA9IHJvdGwoeDA3IF4geDA4LCA3KTtcbiAgICAgICAgeDAzID0gKHgwMyArIHgwNCkgfCAwO1xuICAgICAgICB4MTQgPSByb3RsKHgxNCBeIHgwMywgMTYpO1xuICAgICAgICB4MDkgPSAoeDA5ICsgeDE0KSB8IDA7XG4gICAgICAgIHgwNCA9IHJvdGwoeDA0IF4geDA5LCAxMik7XG4gICAgICAgIHgwMyA9ICh4MDMgKyB4MDQpIHwgMDtcbiAgICAgICAgeDE0ID0gcm90bCh4MTQgXiB4MDMsIDgpO1xuICAgICAgICB4MDkgPSAoeDA5ICsgeDE0KSB8IDA7XG4gICAgICAgIHgwNCA9IHJvdGwoeDA0IF4geDA5LCA3KTtcbiAgICB9XG4gICAgbGV0IG9pID0gMDtcbiAgICBvdXRbb2krK10gPSB4MDA7XG4gICAgb3V0W29pKytdID0geDAxO1xuICAgIG91dFtvaSsrXSA9IHgwMjtcbiAgICBvdXRbb2krK10gPSB4MDM7XG4gICAgb3V0W29pKytdID0geDEyO1xuICAgIG91dFtvaSsrXSA9IHgxMztcbiAgICBvdXRbb2krK10gPSB4MTQ7XG4gICAgb3V0W29pKytdID0geDE1O1xufVxuLyoqIE9yaWdpbmFsLCBub24tUkZDIGNoYWNoYTIwIGZyb20gREpCLiA4LWJ5dGUgbm9uY2UsIDgtYnl0ZSBjb3VudGVyLiAqL1xuZXhwb3J0IGNvbnN0IGNoYWNoYTIwb3JpZyA9IC8qIEBfX1BVUkVfXyAqLyBjcmVhdGVDaXBoZXIoY2hhY2hhQ29yZSwge1xuICAgIGNvdW50ZXJSaWdodDogZmFsc2UsXG4gICAgY291bnRlckxlbmd0aDogOCxcbiAgICBhbGxvd1Nob3J0S2V5czogdHJ1ZSxcbn0pO1xuLyoqXG4gKiBDaGFDaGEgc3RyZWFtIGNpcGhlci4gQ29uZm9ybXMgdG8gUkZDIDg0MzkgKElFVEYsIFRMUykuIDEyLWJ5dGUgbm9uY2UsIDQtYnl0ZSBjb3VudGVyLlxuICogV2l0aCBzbWFsbGVyIG5vbmNlLCBpdCdzIG5vdCBzYWZlIHRvIG1ha2UgaXQgcmFuZG9tIChDU1BSTkcpLCBkdWUgdG8gY29sbGlzaW9uIGNoYW5jZS5cbiAqL1xuZXhwb3J0IGNvbnN0IGNoYWNoYTIwID0gLyogQF9fUFVSRV9fICovIGNyZWF0ZUNpcGhlcihjaGFjaGFDb3JlLCB7XG4gICAgY291bnRlclJpZ2h0OiBmYWxzZSxcbiAgICBjb3VudGVyTGVuZ3RoOiA0LFxuICAgIGFsbG93U2hvcnRLZXlzOiBmYWxzZSxcbn0pO1xuLyoqXG4gKiBYQ2hhQ2hhIGVYdGVuZGVkLW5vbmNlIENoYUNoYS4gV2l0aCAyNC1ieXRlIG5vbmNlLCBpdCdzIHNhZmUgdG8gbWFrZSBpdCByYW5kb20gKENTUFJORykuXG4gKiBTZWUgW0lSVEYgZHJhZnRdKGh0dHBzOi8vZGF0YXRyYWNrZXIuaWV0Zi5vcmcvZG9jL2h0bWwvZHJhZnQtaXJ0Zi1jZnJnLXhjaGFjaGEpLlxuICovXG5leHBvcnQgY29uc3QgeGNoYWNoYTIwID0gLyogQF9fUFVSRV9fICovIGNyZWF0ZUNpcGhlcihjaGFjaGFDb3JlLCB7XG4gICAgY291bnRlclJpZ2h0OiBmYWxzZSxcbiAgICBjb3VudGVyTGVuZ3RoOiA4LFxuICAgIGV4dGVuZE5vbmNlRm46IGhjaGFjaGEsXG4gICAgYWxsb3dTaG9ydEtleXM6IGZhbHNlLFxufSk7XG4vKiogUmVkdWNlZCA4LXJvdW5kIGNoYWNoYSwgZGVzY3JpYmVkIGluIG9yaWdpbmFsIHBhcGVyLiAqL1xuZXhwb3J0IGNvbnN0IGNoYWNoYTggPSAvKiBAX19QVVJFX18gKi8gY3JlYXRlQ2lwaGVyKGNoYWNoYUNvcmUsIHtcbiAgICBjb3VudGVyUmlnaHQ6IGZhbHNlLFxuICAgIGNvdW50ZXJMZW5ndGg6IDQsXG4gICAgcm91bmRzOiA4LFxufSk7XG4vKiogUmVkdWNlZCAxMi1yb3VuZCBjaGFjaGEsIGRlc2NyaWJlZCBpbiBvcmlnaW5hbCBwYXBlci4gKi9cbmV4cG9ydCBjb25zdCBjaGFjaGExMiA9IC8qIEBfX1BVUkVfXyAqLyBjcmVhdGVDaXBoZXIoY2hhY2hhQ29yZSwge1xuICAgIGNvdW50ZXJSaWdodDogZmFsc2UsXG4gICAgY291bnRlckxlbmd0aDogNCxcbiAgICByb3VuZHM6IDEyLFxufSk7XG5jb25zdCBaRVJPUzE2ID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50OEFycmF5KDE2KTtcbi8vIFBhZCB0byBkaWdlc3Qgc2l6ZSB3aXRoIHplcm9zXG5jb25zdCB1cGRhdGVQYWRkZWQgPSAoaCwgbXNnKSA9PiB7XG4gICAgaC51cGRhdGUobXNnKTtcbiAgICBjb25zdCBsZWZ0b3ZlciA9IG1zZy5sZW5ndGggJSAxNjtcbiAgICBpZiAobGVmdG92ZXIpXG4gICAgICAgIGgudXBkYXRlKFpFUk9TMTYuc3ViYXJyYXkobGVmdG92ZXIpKTtcbn07XG5jb25zdCBaRVJPUzMyID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50OEFycmF5KDMyKTtcbmZ1bmN0aW9uIGNvbXB1dGVUYWcoZm4sIGtleSwgbm9uY2UsIGNpcGhlcnRleHQsIEFBRCkge1xuICAgIGlmIChBQUQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgYWJ5dGVzKEFBRCwgdW5kZWZpbmVkLCAnQUFEJyk7XG4gICAgY29uc3QgYXV0aEtleSA9IGZuKGtleSwgbm9uY2UsIFpFUk9TMzIpO1xuICAgIGNvbnN0IGxlbmd0aHMgPSB1NjRMZW5ndGhzKGNpcGhlcnRleHQubGVuZ3RoLCBBQUQgPyBBQUQubGVuZ3RoIDogMCwgdHJ1ZSk7XG4gICAgLy8gTWV0aG9kcyBiZWxvdyBjYW4gYmUgcmVwbGFjZWQgd2l0aFxuICAgIC8vIHJldHVybiBwb2x5MTMwNV9jb21wdXRlVGFnX3NtYWxsKGF1dGhLZXksIGxlbmd0aHMsIGNpcGhlcnRleHQsIEFBRClcbiAgICBjb25zdCBoID0gcG9seTEzMDUuY3JlYXRlKGF1dGhLZXkpO1xuICAgIGlmIChBQUQpXG4gICAgICAgIHVwZGF0ZVBhZGRlZChoLCBBQUQpO1xuICAgIHVwZGF0ZVBhZGRlZChoLCBjaXBoZXJ0ZXh0KTtcbiAgICBoLnVwZGF0ZShsZW5ndGhzKTtcbiAgICBjb25zdCByZXMgPSBoLmRpZ2VzdCgpO1xuICAgIGNsZWFuKGF1dGhLZXksIGxlbmd0aHMpO1xuICAgIHJldHVybiByZXM7XG59XG4vKipcbiAqIEFFQUQgYWxnb3JpdGhtIGZyb20gUkZDIDg0MzkuXG4gKiBTYWxzYTIwIGFuZCBjaGFjaGEgKFJGQyA4NDM5KSB1c2UgcG9seTEzMDUgZGlmZmVyZW50bHkuXG4gKiBXZSBjb3VsZCBoYXZlIGNvbXBvc2VkIHRoZW0sIGJ1dCBpdCdzIGhhcmQgYmVjYXVzZSBvZiBhdXRoS2V5OlxuICogSW4gc2Fsc2EyMCwgYXV0aEtleSBjaGFuZ2VzIHBvc2l0aW9uIGluIHNhbHNhIHN0cmVhbS5cbiAqIEluIGNoYWNoYSwgYXV0aEtleSBjYW4ndCBiZSBjb21wdXRlZCBpbnNpZGUgY29tcHV0ZVRhZywgaXQgbW9kaWZpZXMgdGhlIGNvdW50ZXIuXG4gKi9cbmV4cG9ydCBjb25zdCBfcG9seTEzMDVfYWVhZCA9ICh4b3JTdHJlYW0pID0+IChrZXksIG5vbmNlLCBBQUQpID0+IHtcbiAgICBjb25zdCB0YWdMZW5ndGggPSAxNjtcbiAgICByZXR1cm4ge1xuICAgICAgICBlbmNyeXB0KHBsYWludGV4dCwgb3V0cHV0KSB7XG4gICAgICAgICAgICBjb25zdCBwbGVuZ3RoID0gcGxhaW50ZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgIG91dHB1dCA9IGdldE91dHB1dChwbGVuZ3RoICsgdGFnTGVuZ3RoLCBvdXRwdXQsIGZhbHNlKTtcbiAgICAgICAgICAgIG91dHB1dC5zZXQocGxhaW50ZXh0KTtcbiAgICAgICAgICAgIGNvbnN0IG9QbGFpbiA9IG91dHB1dC5zdWJhcnJheSgwLCAtdGFnTGVuZ3RoKTtcbiAgICAgICAgICAgIC8vIEFjdHVhbCBlbmNyeXB0aW9uXG4gICAgICAgICAgICB4b3JTdHJlYW0oa2V5LCBub25jZSwgb1BsYWluLCBvUGxhaW4sIDEpO1xuICAgICAgICAgICAgY29uc3QgdGFnID0gY29tcHV0ZVRhZyh4b3JTdHJlYW0sIGtleSwgbm9uY2UsIG9QbGFpbiwgQUFEKTtcbiAgICAgICAgICAgIG91dHB1dC5zZXQodGFnLCBwbGVuZ3RoKTsgLy8gYXBwZW5kIHRhZ1xuICAgICAgICAgICAgY2xlYW4odGFnKTtcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH0sXG4gICAgICAgIGRlY3J5cHQoY2lwaGVydGV4dCwgb3V0cHV0KSB7XG4gICAgICAgICAgICBvdXRwdXQgPSBnZXRPdXRwdXQoY2lwaGVydGV4dC5sZW5ndGggLSB0YWdMZW5ndGgsIG91dHB1dCwgZmFsc2UpO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNpcGhlcnRleHQuc3ViYXJyYXkoMCwgLXRhZ0xlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBwYXNzZWRUYWcgPSBjaXBoZXJ0ZXh0LnN1YmFycmF5KC10YWdMZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgdGFnID0gY29tcHV0ZVRhZyh4b3JTdHJlYW0sIGtleSwgbm9uY2UsIGRhdGEsIEFBRCk7XG4gICAgICAgICAgICBpZiAoIWVxdWFsQnl0ZXMocGFzc2VkVGFnLCB0YWcpKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCB0YWcnKTtcbiAgICAgICAgICAgIG91dHB1dC5zZXQoY2lwaGVydGV4dC5zdWJhcnJheSgwLCAtdGFnTGVuZ3RoKSk7XG4gICAgICAgICAgICAvLyBBY3R1YWwgZGVjcnlwdGlvblxuICAgICAgICAgICAgeG9yU3RyZWFtKGtleSwgbm9uY2UsIG91dHB1dCwgb3V0cHV0LCAxKTsgLy8gc3RhcnQgc3RyZWFtIHdpdGggaT0xXG4gICAgICAgICAgICBjbGVhbih0YWcpO1xuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhQ2hhMjAtUG9seTEzMDUgZnJvbSBSRkMgODQzOS5cbiAqXG4gKiBVbnNhZmUgdG8gdXNlIHJhbmRvbSBub25jZXMgdW5kZXIgdGhlIHNhbWUga2V5LCBkdWUgdG8gY29sbGlzaW9uIGNoYW5jZS5cbiAqIFByZWZlciBYQ2hhQ2hhIGluc3RlYWQuXG4gKi9cbmV4cG9ydCBjb25zdCBjaGFjaGEyMHBvbHkxMzA1ID0gLyogQF9fUFVSRV9fICovIHdyYXBDaXBoZXIoeyBibG9ja1NpemU6IDY0LCBub25jZUxlbmd0aDogMTIsIHRhZ0xlbmd0aDogMTYgfSwgX3BvbHkxMzA1X2FlYWQoY2hhY2hhMjApKTtcbi8qKlxuICogWENoYUNoYTIwLVBvbHkxMzA1IGV4dGVuZGVkLW5vbmNlIGNoYWNoYS5cbiAqXG4gKiBDYW4gYmUgc2FmZWx5IHVzZWQgd2l0aCByYW5kb20gbm9uY2VzIChDU1BSTkcpLlxuICogU2VlIFtJUlRGIGRyYWZ0XShodHRwczovL2RhdGF0cmFja2VyLmlldGYub3JnL2RvYy9odG1sL2RyYWZ0LWlydGYtY2ZyZy14Y2hhY2hhKS5cbiAqL1xuZXhwb3J0IGNvbnN0IHhjaGFjaGEyMHBvbHkxMzA1ID0gLyogQF9fUFVSRV9fICovIHdyYXBDaXBoZXIoeyBibG9ja1NpemU6IDY0LCBub25jZUxlbmd0aDogMjQsIHRhZ0xlbmd0aDogMTYgfSwgX3BvbHkxMzA1X2FlYWQoeGNoYWNoYTIwKSk7XG4vKipcbiAqIENoYWNoYTIwIENTUFJORyAoY3J5cHRvZ3JhcGhpY2FsbHkgc2VjdXJlIHBzZXVkb3JhbmRvbSBudW1iZXIgZ2VuZXJhdG9yKS5cbiAqIEl0J3MgYmVzdCB0byBsaW1pdCB1c2FnZSB0byBub24tcHJvZHVjdGlvbiwgbm9uLWNyaXRpY2FsIGNhc2VzOiBmb3IgZXhhbXBsZSwgdGVzdC1vbmx5LlxuICogQ29tcGF0aWJsZSB3aXRoIGxpYnRvbWNyeXB0LiBJdCBkb2VzIG5vdCBoYXZlIGEgc3BlY2lmaWNhdGlvbiwgc28gdW5jbGVhciBob3cgc2VjdXJlIGl0IGlzLlxuICovXG5leHBvcnQgY29uc3Qgcm5nQ2hhY2hhMjAgPSAvKiBAX19QVVJFX18gKi8gY3JlYXRlUFJHKGNoYWNoYTIwb3JpZywgNjQsIDMyLCA4KTtcbi8qKlxuICogQ2hhY2hhMjAvOCBDU1BSTkcgKGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZSBwc2V1ZG9yYW5kb20gbnVtYmVyIGdlbmVyYXRvcikuXG4gKiBJdCdzIGJlc3QgdG8gbGltaXQgdXNhZ2UgdG8gbm9uLXByb2R1Y3Rpb24sIG5vbi1jcml0aWNhbCBjYXNlczogZm9yIGV4YW1wbGUsIHRlc3Qtb25seS5cbiAqIEZhc3RlciB0aGFuIGBybmdDaGFjaGEyMGAuXG4gKi9cbmV4cG9ydCBjb25zdCBybmdDaGFjaGE4ID0gLyogQF9fUFVSRV9fICovIGNyZWF0ZVBSRyhjaGFjaGE4LCA2NCwgMzIsIDEyKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNoYWNoYS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@noble/ciphers/chacha.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/nostr-tools/lib/esm/index.js":
/*!***************************************************!*\
  !*** ./node_modules/nostr-tools/lib/esm/index.js ***!
  \***************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Relay: function() { return /* binding */ Relay; },\n/* harmony export */   SimplePool: function() { return /* binding */ SimplePool; },\n/* harmony export */   finalizeEvent: function() { return /* binding */ finalizeEvent; },\n/* harmony export */   fj: function() { return /* binding */ fakejson_exports; },\n/* harmony export */   generateSecretKey: function() { return /* binding */ generateSecretKey; },\n/* harmony export */   getEventHash: function() { return /* binding */ getEventHash; },\n/* harmony export */   getFilterLimit: function() { return /* binding */ getFilterLimit; },\n/* harmony export */   getPublicKey: function() { return /* binding */ getPublicKey; },\n/* harmony export */   kinds: function() { return /* binding */ kinds_exports; },\n/* harmony export */   matchFilter: function() { return /* binding */ matchFilter; },\n/* harmony export */   matchFilters: function() { return /* binding */ matchFilters; },\n/* harmony export */   mergeFilters: function() { return /* binding */ mergeFilters; },\n/* harmony export */   nip04: function() { return /* binding */ nip04_exports; },\n/* harmony export */   nip05: function() { return /* binding */ nip05_exports; },\n/* harmony export */   nip10: function() { return /* binding */ nip10_exports; },\n/* harmony export */   nip11: function() { return /* binding */ nip11_exports; },\n/* harmony export */   nip13: function() { return /* binding */ nip13_exports; },\n/* harmony export */   nip17: function() { return /* binding */ nip17_exports; },\n/* harmony export */   nip18: function() { return /* binding */ nip18_exports; },\n/* harmony export */   nip19: function() { return /* binding */ nip19_exports; },\n/* harmony export */   nip21: function() { return /* binding */ nip21_exports; },\n/* harmony export */   nip25: function() { return /* binding */ nip25_exports; },\n/* harmony export */   nip27: function() { return /* binding */ nip27_exports; },\n/* harmony export */   nip28: function() { return /* binding */ nip28_exports; },\n/* harmony export */   nip30: function() { return /* binding */ nip30_exports; },\n/* harmony export */   nip39: function() { return /* binding */ nip39_exports; },\n/* harmony export */   nip42: function() { return /* binding */ nip42_exports; },\n/* harmony export */   nip44: function() { return /* binding */ nip44_exports; },\n/* harmony export */   nip47: function() { return /* binding */ nip47_exports; },\n/* harmony export */   nip54: function() { return /* binding */ nip54_exports; },\n/* harmony export */   nip57: function() { return /* binding */ nip57_exports; },\n/* harmony export */   nip59: function() { return /* binding */ nip59_exports; },\n/* harmony export */   nip77: function() { return /* binding */ nip77_exports; },\n/* harmony export */   nip98: function() { return /* binding */ nip98_exports; },\n/* harmony export */   parseReferences: function() { return /* binding */ parseReferences; },\n/* harmony export */   serializeEvent: function() { return /* binding */ serializeEvent; },\n/* harmony export */   sortEvents: function() { return /* binding */ sortEvents; },\n/* harmony export */   utils: function() { return /* binding */ utils_exports; },\n/* harmony export */   validateEvent: function() { return /* binding */ validateEvent; },\n/* harmony export */   verifiedSymbol: function() { return /* binding */ verifiedSymbol; },\n/* harmony export */   verifyEvent: function() { return /* binding */ verifyEvent; }\n/* harmony export */ });\n/* harmony import */ var _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @noble/curves/secp256k1.js */ \"(app-pages-browser)/./node_modules/@noble/curves/secp256k1.js\");\n/* harmony import */ var _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @noble/hashes/utils.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/utils.js\");\n/* harmony import */ var _noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @noble/hashes/sha2.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/sha2.js\");\n/* harmony import */ var _scure_base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @scure/base */ \"(app-pages-browser)/./node_modules/@scure/base/index.js\");\n/* harmony import */ var _noble_ciphers_aes_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @noble/ciphers/aes.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/aes.js\");\n/* harmony import */ var _noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @noble/ciphers/chacha.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/ciphers/utils.js */ \"(app-pages-browser)/./node_modules/@noble/ciphers/utils.js\");\n/* harmony import */ var _noble_hashes_hkdf_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/hkdf.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hkdf.js\");\n/* harmony import */ var _noble_hashes_hmac_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/hashes/hmac.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hmac.js\");\nvar __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// pure.ts\n\n\n\n// core.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar isRecord = (obj) => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event))\n    return false;\n  if (typeof event.kind !== \"number\")\n    return false;\n  if (typeof event.content !== \"string\")\n    return false;\n  if (typeof event.created_at !== \"number\")\n    return false;\n  if (typeof event.pubkey !== \"string\")\n    return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/))\n    return false;\n  if (!Array.isArray(event.tags))\n    return false;\n  for (let i2 = 0; i2 < event.tags.length; i2++) {\n    let tag = event.tags[i2];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] !== \"string\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction sortEvents(events) {\n  return events.sort((a, b) => {\n    if (a.created_at !== b.created_at) {\n      return b.created_at - a.created_at;\n    }\n    return a.id.localeCompare(b.id);\n  });\n}\n\n// pure.ts\n\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  binarySearch: () => binarySearch,\n  bytesToHex: () => _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex,\n  hexToBytes: () => _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  mergeReverseSortedLists: () => mergeReverseSortedLists,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\n\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  try {\n    if (url.indexOf(\"://\") === -1)\n      url = \"wss://\" + url;\n    let p = new URL(url);\n    if (p.protocol === \"http:\")\n      p.protocol = \"ws:\";\n    else if (p.protocol === \"https:\")\n      p.protocol = \"wss:\";\n    p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n    if (p.pathname.endsWith(\"/\"))\n      p.pathname = p.pathname.slice(0, -1);\n    if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\")\n      p.port = \"\";\n    p.searchParams.sort();\n    p.hash = \"\";\n    return p.toString();\n  } catch (e) {\n    throw new Error(`Invalid URL: ${url}`);\n  }\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return b.created_at - event.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  const [idx, found] = binarySearch(sortedArray, (b) => {\n    if (event.id === b.id)\n      return 0;\n    if (event.created_at === b.created_at)\n      return -1;\n    return event.created_at - b.created_at;\n  });\n  if (!found) {\n    sortedArray.splice(idx, 0, event);\n  }\n  return sortedArray;\n}\nfunction binarySearch(arr, compare) {\n  let start = 0;\n  let end = arr.length - 1;\n  while (start <= end) {\n    const mid = Math.floor((start + end) / 2);\n    const cmp = compare(arr[mid]);\n    if (cmp === 0) {\n      return [mid, true];\n    }\n    if (cmp < 0) {\n      end = mid - 1;\n    } else {\n      start = mid + 1;\n    }\n  }\n  return [start, false];\n}\nfunction mergeReverseSortedLists(list1, list2) {\n  const result = new Array(list1.length + list2.length);\n  result.length = 0;\n  let i1 = 0;\n  let i2 = 0;\n  let sameTimestampIds = [];\n  while (i1 < list1.length && i2 < list2.length) {\n    let next;\n    if (list1[i1]?.created_at > list2[i2]?.created_at) {\n      next = list1[i1];\n      i1++;\n    } else {\n      next = list2[i2];\n      i2++;\n    }\n    if (result.length > 0 && result[result.length - 1].created_at === next.created_at) {\n      if (sameTimestampIds.includes(next.id))\n        continue;\n    } else {\n      sameTimestampIds.length = 0;\n    }\n    result.push(next);\n    sameTimestampIds.push(next.id);\n  }\n  while (i1 < list1.length) {\n    const next = list1[i1];\n    i1++;\n    if (result.length > 0 && result[result.length - 1].created_at === next.created_at) {\n      if (sameTimestampIds.includes(next.id))\n        continue;\n    } else {\n      sameTimestampIds.length = 0;\n    }\n    result.push(next);\n    sameTimestampIds.push(next.id);\n  }\n  while (i2 < list2.length) {\n    const next = list2[i2];\n    i2++;\n    if (result.length > 0 && result[result.length - 1].created_at === next.created_at) {\n      if (sameTimestampIds.includes(next.id))\n        continue;\n    } else {\n      sameTimestampIds.length = 0;\n    }\n    result.push(next);\n    sameTimestampIds.push(next.id);\n  }\n  return result;\n}\n\n// pure.ts\nvar JS = class {\n  generateSecretKey() {\n    return _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.schnorr.utils.randomSecretKey();\n  }\n  getPublicKey(secretKey) {\n    return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(_noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.schnorr.getPublicKey(secretKey));\n  }\n  finalizeEvent(t, secretKey) {\n    const event = t;\n    event.pubkey = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(_noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.schnorr.getPublicKey(secretKey));\n    event.id = getEventHash(event);\n    event.sig = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(_noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.schnorr.sign((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(getEventHash(event)), secretKey));\n    event[verifiedSymbol] = true;\n    return event;\n  }\n  verifyEvent(event) {\n    if (typeof event[verifiedSymbol] === \"boolean\")\n      return event[verifiedSymbol];\n    const hash = getEventHash(event);\n    if (hash !== event.id) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n    try {\n      const valid = _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.schnorr.verify((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(event.sig), (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(hash), (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(event.pubkey));\n      event[verifiedSymbol] = valid;\n      return valid;\n    } catch (err) {\n      event[verifiedSymbol] = false;\n      return false;\n    }\n  }\n};\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt))\n    throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = (0,_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256)(utf8Encoder.encode(serializeEvent(event)));\n  return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(eventHash);\n}\nvar i = new JS();\nvar generateSecretKey = i.generateSecretKey;\nvar getPublicKey = i.getPublicKey;\nvar finalizeEvent = i.finalizeEvent;\nvar verifyEvent = i.verifyEvent;\n\n// kinds.ts\nvar kinds_exports = {};\n__export(kinds_exports, {\n  Application: () => Application,\n  BadgeAward: () => BadgeAward,\n  BadgeDefinition: () => BadgeDefinition,\n  BlockedRelaysList: () => BlockedRelaysList,\n  BlossomServerList: () => BlossomServerList,\n  BookmarkList: () => BookmarkList,\n  Bookmarksets: () => Bookmarksets,\n  Calendar: () => Calendar,\n  CalendarEventRSVP: () => CalendarEventRSVP,\n  ChannelCreation: () => ChannelCreation,\n  ChannelHideMessage: () => ChannelHideMessage,\n  ChannelMessage: () => ChannelMessage,\n  ChannelMetadata: () => ChannelMetadata,\n  ChannelMuteUser: () => ChannelMuteUser,\n  ChatMessage: () => ChatMessage,\n  ClassifiedListing: () => ClassifiedListing,\n  ClientAuth: () => ClientAuth,\n  Comment: () => Comment,\n  CommunitiesList: () => CommunitiesList,\n  CommunityDefinition: () => CommunityDefinition,\n  CommunityPostApproval: () => CommunityPostApproval,\n  Contacts: () => Contacts,\n  CreateOrUpdateProduct: () => CreateOrUpdateProduct,\n  CreateOrUpdateStall: () => CreateOrUpdateStall,\n  Curationsets: () => Curationsets,\n  Date: () => Date2,\n  DirectMessageRelaysList: () => DirectMessageRelaysList,\n  DraftClassifiedListing: () => DraftClassifiedListing,\n  DraftLong: () => DraftLong,\n  Emojisets: () => Emojisets,\n  EncryptedDirectMessage: () => EncryptedDirectMessage,\n  EventDeletion: () => EventDeletion,\n  FavoriteRelays: () => FavoriteRelays,\n  FileMessage: () => FileMessage,\n  FileMetadata: () => FileMetadata,\n  FileServerPreference: () => FileServerPreference,\n  Followsets: () => Followsets,\n  ForumThread: () => ForumThread,\n  GenericRepost: () => GenericRepost,\n  Genericlists: () => Genericlists,\n  GiftWrap: () => GiftWrap,\n  GroupMetadata: () => GroupMetadata,\n  HTTPAuth: () => HTTPAuth,\n  Handlerinformation: () => Handlerinformation,\n  Handlerrecommendation: () => Handlerrecommendation,\n  Highlights: () => Highlights,\n  InterestsList: () => InterestsList,\n  Interestsets: () => Interestsets,\n  JobFeedback: () => JobFeedback,\n  JobRequest: () => JobRequest,\n  JobResult: () => JobResult,\n  Label: () => Label,\n  LightningPubRPC: () => LightningPubRPC,\n  LiveChatMessage: () => LiveChatMessage,\n  LiveEvent: () => LiveEvent,\n  LongFormArticle: () => LongFormArticle,\n  Metadata: () => Metadata,\n  Mutelist: () => Mutelist,\n  NWCWalletInfo: () => NWCWalletInfo,\n  NWCWalletRequest: () => NWCWalletRequest,\n  NWCWalletResponse: () => NWCWalletResponse,\n  NormalVideo: () => NormalVideo,\n  NostrConnect: () => NostrConnect,\n  OpenTimestamps: () => OpenTimestamps,\n  Photo: () => Photo,\n  Pinlist: () => Pinlist,\n  Poll: () => Poll,\n  PollResponse: () => PollResponse,\n  PrivateDirectMessage: () => PrivateDirectMessage,\n  ProblemTracker: () => ProblemTracker,\n  ProfileBadges: () => ProfileBadges,\n  PublicChatsList: () => PublicChatsList,\n  Reaction: () => Reaction,\n  RecommendRelay: () => RecommendRelay,\n  RelayList: () => RelayList,\n  RelayReview: () => RelayReview,\n  Relaysets: () => Relaysets,\n  Report: () => Report,\n  Reporting: () => Reporting,\n  Repost: () => Repost,\n  Seal: () => Seal,\n  SearchRelaysList: () => SearchRelaysList,\n  ShortTextNote: () => ShortTextNote,\n  ShortVideo: () => ShortVideo,\n  Time: () => Time,\n  UserEmojiList: () => UserEmojiList,\n  UserStatuses: () => UserStatuses,\n  Voice: () => Voice,\n  VoiceComment: () => VoiceComment,\n  Zap: () => Zap,\n  ZapGoal: () => ZapGoal,\n  ZapRequest: () => ZapRequest,\n  classifyKind: () => classifyKind,\n  isAddressableKind: () => isAddressableKind,\n  isEphemeralKind: () => isEphemeralKind,\n  isKind: () => isKind,\n  isRegularKind: () => isRegularKind,\n  isReplaceableKind: () => isReplaceableKind\n});\nfunction isRegularKind(kind) {\n  return kind < 1e4 && kind !== 0 && kind !== 3;\n}\nfunction isReplaceableKind(kind) {\n  return kind === 0 || kind === 3 || 1e4 <= kind && kind < 2e4;\n}\nfunction isEphemeralKind(kind) {\n  return 2e4 <= kind && kind < 3e4;\n}\nfunction isAddressableKind(kind) {\n  return 3e4 <= kind && kind < 4e4;\n}\nfunction classifyKind(kind) {\n  if (isRegularKind(kind))\n    return \"regular\";\n  if (isReplaceableKind(kind))\n    return \"replaceable\";\n  if (isEphemeralKind(kind))\n    return \"ephemeral\";\n  if (isAddressableKind(kind))\n    return \"parameterized\";\n  return \"unknown\";\n}\nfunction isKind(event, kind) {\n  const kindAsArray = kind instanceof Array ? kind : [kind];\n  return validateEvent(event) && kindAsArray.includes(event.kind) || false;\n}\nvar Metadata = 0;\nvar ShortTextNote = 1;\nvar RecommendRelay = 2;\nvar Contacts = 3;\nvar EncryptedDirectMessage = 4;\nvar EventDeletion = 5;\nvar Repost = 6;\nvar Reaction = 7;\nvar BadgeAward = 8;\nvar ChatMessage = 9;\nvar ForumThread = 11;\nvar Seal = 13;\nvar PrivateDirectMessage = 14;\nvar FileMessage = 15;\nvar GenericRepost = 16;\nvar Photo = 20;\nvar NormalVideo = 21;\nvar ShortVideo = 22;\nvar ChannelCreation = 40;\nvar ChannelMetadata = 41;\nvar ChannelMessage = 42;\nvar ChannelHideMessage = 43;\nvar ChannelMuteUser = 44;\nvar OpenTimestamps = 1040;\nvar GiftWrap = 1059;\nvar Poll = 1068;\nvar FileMetadata = 1063;\nvar Comment = 1111;\nvar LiveChatMessage = 1311;\nvar Voice = 1222;\nvar VoiceComment = 1244;\nvar ProblemTracker = 1971;\nvar Report = 1984;\nvar Reporting = 1984;\nvar Label = 1985;\nvar CommunityPostApproval = 4550;\nvar JobRequest = 5999;\nvar JobResult = 6999;\nvar JobFeedback = 7e3;\nvar ZapGoal = 9041;\nvar ZapRequest = 9734;\nvar Zap = 9735;\nvar Highlights = 9802;\nvar PollResponse = 1018;\nvar Mutelist = 1e4;\nvar Pinlist = 10001;\nvar RelayList = 10002;\nvar BookmarkList = 10003;\nvar CommunitiesList = 10004;\nvar PublicChatsList = 10005;\nvar BlockedRelaysList = 10006;\nvar SearchRelaysList = 10007;\nvar FavoriteRelays = 10012;\nvar InterestsList = 10015;\nvar UserEmojiList = 10030;\nvar DirectMessageRelaysList = 10050;\nvar FileServerPreference = 10096;\nvar BlossomServerList = 10063;\nvar NWCWalletInfo = 13194;\nvar LightningPubRPC = 21e3;\nvar ClientAuth = 22242;\nvar NWCWalletRequest = 23194;\nvar NWCWalletResponse = 23195;\nvar NostrConnect = 24133;\nvar HTTPAuth = 27235;\nvar Followsets = 3e4;\nvar Genericlists = 30001;\nvar Relaysets = 30002;\nvar Bookmarksets = 30003;\nvar Curationsets = 30004;\nvar ProfileBadges = 30008;\nvar BadgeDefinition = 30009;\nvar Interestsets = 30015;\nvar CreateOrUpdateStall = 30017;\nvar CreateOrUpdateProduct = 30018;\nvar LongFormArticle = 30023;\nvar DraftLong = 30024;\nvar Emojisets = 30030;\nvar Application = 30078;\nvar LiveEvent = 30311;\nvar UserStatuses = 30315;\nvar ClassifiedListing = 30402;\nvar DraftClassifiedListing = 30403;\nvar Date2 = 31922;\nvar Time = 31923;\nvar Calendar = 31924;\nvar CalendarEventRSVP = 31925;\nvar RelayReview = 31987;\nvar Handlerrecommendation = 31989;\nvar Handlerinformation = 31990;\nvar CommunityDefinition = 34550;\nvar GroupMetadata = 39e3;\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    return false;\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1) {\n    return false;\n  }\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    return false;\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[`#${tagName}`];\n      if (values && !event.tags.find(([t, v]) => t === f.slice(1) && values.indexOf(v) !== -1))\n        return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since)\n    return false;\n  if (filter.until && event.created_at > filter.until)\n    return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    if (matchFilter(filters[i2], event)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction mergeFilters(...filters) {\n  let result = {};\n  for (let i2 = 0; i2 < filters.length; i2++) {\n    let filter = filters[i2];\n    Object.entries(filter).forEach(([property, values]) => {\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value))\n            result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit))\n      result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until))\n      result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since))\n      result.since = filter.since;\n  }\n  return result;\n}\nfunction getFilterLimit(filter) {\n  if (filter.ids && !filter.ids.length)\n    return 0;\n  if (filter.kinds && !filter.kinds.length)\n    return 0;\n  if (filter.authors && !filter.authors.length)\n    return 0;\n  for (const [key, value] of Object.entries(filter)) {\n    if (key[0] === \"#\" && Array.isArray(value) && !value.length)\n      return 0;\n  }\n  return Math.min(\n    Math.max(0, filter.limit ?? Infinity),\n    filter.ids?.length ?? Infinity,\n    filter.authors?.length && filter.kinds?.every((kind) => isReplaceableKind(kind)) ? filter.authors.length * filter.kinds.length : Infinity,\n    filter.authors?.length && filter.kinds?.every((kind) => isAddressableKind(kind)) && filter[\"#d\"]?.length ? filter.authors.length * filter.kinds.length * filter[\"#d\"].length : Infinity\n  );\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(`\"${field}\":`) + len;\n  let s = json.slice(idx).indexOf(`\"`) + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(`\"${field}\":`) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(`\"EVENT\"`);\n  if (idx === -1)\n    return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(`\"`);\n  if (pstart === -1)\n    return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(`\"`);\n  if (pend === -1)\n    return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  makeAuthEvent: () => makeAuthEvent\n});\nfunction makeAuthEvent(relayURL, challenge) {\n  return {\n    kind: ClientAuth,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [\n      [\"relay\", relayURL],\n      [\"challenge\", challenge]\n    ],\n    content: \"\"\n  };\n}\n\n// abstract-relay.ts\nvar SendingOnClosedConnection = class extends Error {\n  constructor(message, relay) {\n    super(`Tried to send message '${message} on a closed connection to ${relay}.`);\n    this.name = \"SendingOnClosedConnection\";\n  }\n};\nvar AbstractRelay = class {\n  url;\n  _connected = false;\n  onclose = null;\n  onnotice = (msg) => console.debug(`NOTICE from ${this.url}: ${msg}`);\n  onauth;\n  baseEoseTimeout = 4400;\n  publishTimeout = 4400;\n  pingFrequency = 29e3;\n  pingTimeout = 2e4;\n  resubscribeBackoff = [1e4, 1e4, 1e4, 2e4, 2e4, 3e4, 6e4];\n  openSubs = /* @__PURE__ */ new Map();\n  enablePing;\n  enableReconnect;\n  idleSince = Date.now();\n  ongoingOperations = 0;\n  reconnectTimeoutHandle;\n  pingIntervalHandle;\n  reconnectAttempts = 0;\n  skipReconnection = false;\n  connectionPromise;\n  openCountRequests = /* @__PURE__ */ new Map();\n  openEventPublishes = /* @__PURE__ */ new Map();\n  ws;\n  challenge;\n  authPromise;\n  serial = 0;\n  verifyEvent;\n  _WebSocket;\n  constructor(url, opts) {\n    this.url = normalizeURL(url);\n    this.verifyEvent = opts.verifyEvent;\n    this._WebSocket = opts.websocketImplementation || WebSocket;\n    this.enablePing = opts.enablePing;\n    this.enableReconnect = opts.enableReconnect || false;\n  }\n  static async connect(url, opts) {\n    const relay = new AbstractRelay(url, opts);\n    await relay.connect(opts);\n    return relay;\n  }\n  closeAllSubscriptions(reason) {\n    for (let [_, sub] of this.openSubs) {\n      sub.close(reason);\n    }\n    this.openSubs.clear();\n    for (let [_, ep] of this.openEventPublishes) {\n      ep.reject(new Error(reason));\n    }\n    this.openEventPublishes.clear();\n    for (let [_, cr] of this.openCountRequests) {\n      cr.reject(new Error(reason));\n    }\n    this.openCountRequests.clear();\n  }\n  get connected() {\n    return this._connected;\n  }\n  async reconnect() {\n    const backoff = this.resubscribeBackoff[Math.min(this.reconnectAttempts, this.resubscribeBackoff.length - 1)];\n    this.reconnectAttempts++;\n    this.reconnectTimeoutHandle = setTimeout(async () => {\n      try {\n        await this.connect();\n      } catch (err) {\n      }\n    }, backoff);\n  }\n  handleHardClose(reason) {\n    if (this.pingIntervalHandle) {\n      clearInterval(this.pingIntervalHandle);\n      this.pingIntervalHandle = void 0;\n    }\n    this._connected = false;\n    this.connectionPromise = void 0;\n    this.idleSince = void 0;\n    if (this.enableReconnect && !this.skipReconnection) {\n      this.reconnect();\n    } else {\n      this.onclose?.();\n      this.closeAllSubscriptions(reason);\n    }\n  }\n  async connect(opts) {\n    let connectionTimeoutHandle;\n    if (this.connectionPromise)\n      return this.connectionPromise;\n    this.challenge = void 0;\n    this.authPromise = void 0;\n    this.skipReconnection = false;\n    this.connectionPromise = new Promise((resolve, reject) => {\n      if (opts?.timeout) {\n        connectionTimeoutHandle = setTimeout(() => {\n          reject(\"connection timed out\");\n          this.connectionPromise = void 0;\n          this.skipReconnection = true;\n          this.onclose?.();\n          this.handleHardClose(\"relay connection timed out\");\n        }, opts.timeout);\n      }\n      if (opts?.abort) {\n        opts.abort.onabort = reject;\n      }\n      try {\n        this.ws = new this._WebSocket(this.url);\n      } catch (err) {\n        clearTimeout(connectionTimeoutHandle);\n        reject(err);\n        return;\n      }\n      this.ws.onopen = () => {\n        if (this.reconnectTimeoutHandle) {\n          clearTimeout(this.reconnectTimeoutHandle);\n          this.reconnectTimeoutHandle = void 0;\n        }\n        clearTimeout(connectionTimeoutHandle);\n        this._connected = true;\n        const isReconnection = this.reconnectAttempts > 0;\n        this.reconnectAttempts = 0;\n        for (const sub of this.openSubs.values()) {\n          sub.eosed = false;\n          if (isReconnection) {\n            for (let f = 0; f < sub.filters.length; f++) {\n              if (sub.lastEmitted) {\n                sub.filters[f].since = sub.lastEmitted + 1;\n              }\n            }\n          }\n          sub.fire();\n        }\n        if (this.enablePing) {\n          this.pingIntervalHandle = setInterval(() => this.pingpong(), this.pingFrequency);\n        }\n        resolve();\n      };\n      this.ws.onerror = () => {\n        clearTimeout(connectionTimeoutHandle);\n        reject(\"connection failed\");\n        this.connectionPromise = void 0;\n        this.skipReconnection = true;\n        this.onclose?.();\n        this.handleHardClose(\"relay connection failed\");\n      };\n      this.ws.onclose = (ev) => {\n        clearTimeout(connectionTimeoutHandle);\n        reject(ev.message || \"websocket closed\");\n        this.handleHardClose(\"relay connection closed\");\n      };\n      this.ws.onmessage = this._onmessage.bind(this);\n    });\n    return this.connectionPromise;\n  }\n  waitForPingPong() {\n    return new Promise((resolve) => {\n      ;\n      this.ws.once(\"pong\", () => resolve(true));\n      this.ws.ping();\n    });\n  }\n  waitForDummyReq() {\n    return new Promise((resolve, reject) => {\n      if (!this.connectionPromise)\n        return reject(new Error(`no connection to ${this.url}, can't ping`));\n      try {\n        const sub = this.subscribe(\n          [{ ids: [\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"], limit: 0 }],\n          {\n            label: \"<forced-ping>\",\n            oneose: () => {\n              resolve(true);\n              sub.close();\n            },\n            onclose() {\n              resolve(true);\n            },\n            eoseTimeout: this.pingTimeout + 1e3\n          }\n        );\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n  async pingpong() {\n    if (this.ws?.readyState === 1) {\n      const result = await Promise.any([\n        this.ws && this.ws.ping && this.ws.once ? this.waitForPingPong() : this.waitForDummyReq(),\n        new Promise((res) => setTimeout(() => res(false), this.pingTimeout))\n      ]);\n      if (!result) {\n        if (this.ws?.readyState === this._WebSocket.OPEN) {\n          this.ws?.close();\n        }\n      }\n    }\n  }\n  async send(message) {\n    if (!this.connectionPromise)\n      throw new SendingOnClosedConnection(message, this.url);\n    this.connectionPromise.then(() => {\n      this.ws?.send(message);\n    });\n  }\n  async auth(signAuthEvent) {\n    const challenge = this.challenge;\n    if (!challenge)\n      throw new Error(\"can't perform auth, no challenge was received\");\n    if (this.authPromise)\n      return this.authPromise;\n    this.authPromise = new Promise(async (resolve, reject) => {\n      try {\n        let evt = await signAuthEvent(makeAuthEvent(this.url, challenge));\n        let timeout = setTimeout(() => {\n          let ep = this.openEventPublishes.get(evt.id);\n          if (ep) {\n            ep.reject(new Error(\"auth timed out\"));\n            this.openEventPublishes.delete(evt.id);\n          }\n        }, this.publishTimeout);\n        this.openEventPublishes.set(evt.id, { resolve, reject, timeout });\n        this.send('[\"AUTH\",' + JSON.stringify(evt) + \"]\");\n      } catch (err) {\n        console.warn(\"subscribe auth function failed:\", err);\n      }\n    });\n    return this.authPromise;\n  }\n  async publish(event) {\n    this.idleSince = void 0;\n    this.ongoingOperations++;\n    const ret = new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        const ep = this.openEventPublishes.get(event.id);\n        if (ep) {\n          ep.reject(new Error(\"publish timed out\"));\n          this.openEventPublishes.delete(event.id);\n        }\n      }, this.publishTimeout);\n      this.openEventPublishes.set(event.id, { resolve, reject, timeout });\n    });\n    this.send('[\"EVENT\",' + JSON.stringify(event) + \"]\");\n    this.ongoingOperations--;\n    if (this.ongoingOperations === 0)\n      this.idleSince = Date.now();\n    return ret;\n  }\n  async count(filters, params) {\n    this.serial++;\n    const id = params?.id || \"count:\" + this.serial;\n    const ret = new Promise((resolve, reject) => {\n      this.openCountRequests.set(id, { resolve, reject });\n    });\n    this.send('[\"COUNT\",\"' + id + '\",' + JSON.stringify(filters).substring(1));\n    return ret;\n  }\n  subscribe(filters, params) {\n    if (params.label !== \"<forced-ping>\") {\n      this.idleSince = void 0;\n      this.ongoingOperations++;\n    }\n    const sub = this.prepareSubscription(filters, params);\n    sub.fire();\n    if (params.abort) {\n      params.abort.onabort = () => sub.close(String(params.abort.reason || \"<aborted>\"));\n    }\n    return sub;\n  }\n  prepareSubscription(filters, params) {\n    this.serial++;\n    const id = params.id || (params.label ? params.label + \":\" : \"sub:\") + this.serial;\n    const sub = new Subscription(this, id, filters, params);\n    this.openSubs.set(id, sub);\n    return sub;\n  }\n  close() {\n    this.skipReconnection = true;\n    if (this.reconnectTimeoutHandle) {\n      clearTimeout(this.reconnectTimeoutHandle);\n      this.reconnectTimeoutHandle = void 0;\n    }\n    if (this.pingIntervalHandle) {\n      clearInterval(this.pingIntervalHandle);\n      this.pingIntervalHandle = void 0;\n    }\n    this.closeAllSubscriptions(\"relay connection closed by us\");\n    this._connected = false;\n    this.idleSince = void 0;\n    this.onclose?.();\n    if (this.ws?.readyState === this._WebSocket.OPEN) {\n      this.ws?.close();\n    }\n  }\n  _onmessage(ev) {\n    const json = ev.data;\n    if (!json) {\n      return;\n    }\n    const subid = getSubscriptionId(json);\n    if (subid) {\n      const so = this.openSubs.get(subid);\n      if (!so) {\n        return;\n      }\n      const id = getHex64(json, \"id\");\n      const alreadyHave = so.alreadyHaveEvent?.(id);\n      so.receivedEvent?.(this, id);\n      if (alreadyHave) {\n        return;\n      }\n    }\n    try {\n      let data = JSON.parse(json);\n      switch (data[0]) {\n        case \"EVENT\": {\n          const so = this.openSubs.get(data[1]);\n          const event = data[2];\n          if (this.verifyEvent(event) && matchFilters(so.filters, event)) {\n            so.onevent(event);\n          }\n          if (!so.lastEmitted || so.lastEmitted < event.created_at)\n            so.lastEmitted = event.created_at;\n          return;\n        }\n        case \"COUNT\": {\n          const id = data[1];\n          const payload = data[2];\n          const cr = this.openCountRequests.get(id);\n          if (cr) {\n            cr.resolve(payload.count);\n            this.openCountRequests.delete(id);\n          }\n          return;\n        }\n        case \"EOSE\": {\n          const so = this.openSubs.get(data[1]);\n          if (!so)\n            return;\n          so.receivedEose();\n          return;\n        }\n        case \"OK\": {\n          const id = data[1];\n          const ok = data[2];\n          const reason = data[3];\n          const ep = this.openEventPublishes.get(id);\n          if (ep) {\n            clearTimeout(ep.timeout);\n            if (ok)\n              ep.resolve(reason);\n            else\n              ep.reject(new Error(reason));\n            this.openEventPublishes.delete(id);\n          }\n          return;\n        }\n        case \"CLOSED\": {\n          const id = data[1];\n          const so = this.openSubs.get(id);\n          if (!so)\n            return;\n          so.closed = true;\n          so.close(data[2]);\n          return;\n        }\n        case \"NOTICE\": {\n          this.onnotice(data[1]);\n          return;\n        }\n        case \"AUTH\": {\n          this.challenge = data[1];\n          if (this.onauth) {\n            this.auth(this.onauth);\n          }\n          return;\n        }\n        default: {\n          const so = this.openSubs.get(data[1]);\n          so?.oncustom?.(data);\n          return;\n        }\n      }\n    } catch (err) {\n      const [_, __, event] = JSON.parse(json);\n      window.printer.maybe(event.pubkey, \":: caught err\", event, this.url, err);\n      return;\n    }\n  }\n};\nvar Subscription = class {\n  relay;\n  id;\n  lastEmitted;\n  closed = false;\n  eosed = false;\n  filters;\n  alreadyHaveEvent;\n  receivedEvent;\n  onevent;\n  oneose;\n  onclose;\n  oncustom;\n  eoseTimeout;\n  eoseTimeoutHandle;\n  constructor(relay, id, filters, params) {\n    if (filters.length === 0)\n      throw new Error(\"subscription can't be created with zero filters\");\n    this.relay = relay;\n    this.filters = filters;\n    this.id = id;\n    this.alreadyHaveEvent = params.alreadyHaveEvent;\n    this.receivedEvent = params.receivedEvent;\n    this.eoseTimeout = params.eoseTimeout || relay.baseEoseTimeout;\n    this.oneose = params.oneose;\n    this.onclose = params.onclose;\n    this.onevent = params.onevent || ((event) => {\n      console.warn(\n        `onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,\n        event\n      );\n    });\n  }\n  fire() {\n    this.relay.send('[\"REQ\",\"' + this.id + '\",' + JSON.stringify(this.filters).substring(1));\n    this.eoseTimeoutHandle = setTimeout(this.receivedEose.bind(this), this.eoseTimeout);\n  }\n  receivedEose() {\n    if (this.eosed)\n      return;\n    clearTimeout(this.eoseTimeoutHandle);\n    this.eosed = true;\n    this.oneose?.();\n  }\n  close(reason = \"closed by caller\") {\n    if (!this.closed && this.relay.connected) {\n      try {\n        this.relay.send('[\"CLOSE\",' + JSON.stringify(this.id) + \"]\");\n      } catch (err) {\n        if (err instanceof SendingOnClosedConnection) {\n        } else {\n          throw err;\n        }\n      }\n      this.closed = true;\n    }\n    this.relay.openSubs.delete(this.id);\n    this.relay.ongoingOperations--;\n    if (this.relay.ongoingOperations === 0)\n      this.relay.idleSince = Date.now();\n    this.onclose?.(reason);\n  }\n};\n\n// relay.ts\nvar _WebSocket;\ntry {\n  _WebSocket = WebSocket;\n} catch {\n}\nvar Relay = class extends AbstractRelay {\n  constructor(url, options) {\n    super(url, { verifyEvent, websocketImplementation: _WebSocket, ...options });\n  }\n  static async connect(url, options) {\n    const relay = new Relay(url, options);\n    await relay.connect();\n    return relay;\n  }\n};\n\n// helpers.ts\nvar alwaysTrue = (t) => {\n  t[verifiedSymbol] = true;\n  return true;\n};\n\n// abstract-pool.ts\nvar AbstractSimplePool = class {\n  relays = /* @__PURE__ */ new Map();\n  seenOn = /* @__PURE__ */ new Map();\n  trackRelays = false;\n  verifyEvent;\n  enablePing;\n  enableReconnect;\n  automaticallyAuth;\n  trustedRelayURLs = /* @__PURE__ */ new Set();\n  onRelayConnectionFailure;\n  onRelayConnectionSuccess;\n  allowConnectingToRelay;\n  maxWaitForConnection;\n  _WebSocket;\n  constructor(opts) {\n    this.verifyEvent = opts.verifyEvent;\n    this._WebSocket = opts.websocketImplementation;\n    this.enablePing = opts.enablePing;\n    this.enableReconnect = opts.enableReconnect || false;\n    this.automaticallyAuth = opts.automaticallyAuth;\n    this.onRelayConnectionFailure = opts.onRelayConnectionFailure;\n    this.onRelayConnectionSuccess = opts.onRelayConnectionSuccess;\n    this.allowConnectingToRelay = opts.allowConnectingToRelay;\n    this.maxWaitForConnection = opts.maxWaitForConnection || 3e3;\n  }\n  async ensureRelay(url, params) {\n    url = normalizeURL(url);\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new AbstractRelay(url, {\n        verifyEvent: this.trustedRelayURLs.has(url) ? alwaysTrue : this.verifyEvent,\n        websocketImplementation: this._WebSocket,\n        enablePing: this.enablePing,\n        enableReconnect: this.enableReconnect\n      });\n      relay.onclose = () => {\n        this.relays.delete(url);\n      };\n      this.relays.set(url, relay);\n    }\n    if (this.automaticallyAuth) {\n      const authSignerFn = this.automaticallyAuth(url);\n      if (authSignerFn) {\n        relay.onauth = authSignerFn;\n      }\n    }\n    try {\n      await relay.connect({\n        timeout: params?.connectionTimeout,\n        abort: params?.abort\n      });\n    } catch (err) {\n      this.relays.delete(url);\n      throw err;\n    }\n    return relay;\n  }\n  close(relays) {\n    relays.map(normalizeURL).forEach((url) => {\n      this.relays.get(url)?.close();\n      this.relays.delete(url);\n    });\n  }\n  subscribe(relays, filter, params) {\n    const request = [];\n    const uniqUrls = [];\n    for (let i2 = 0; i2 < relays.length; i2++) {\n      const url = normalizeURL(relays[i2]);\n      if (!request.find((r) => r.url === url)) {\n        if (uniqUrls.indexOf(url) === -1) {\n          uniqUrls.push(url);\n          request.push({ url, filter });\n        }\n      }\n    }\n    return this.subscribeMap(request, params);\n  }\n  subscribeMany(relays, filter, params) {\n    return this.subscribe(relays, filter, params);\n  }\n  subscribeMap(requests, params) {\n    const grouped = /* @__PURE__ */ new Map();\n    for (const req of requests) {\n      const { url, filter } = req;\n      if (!grouped.has(url))\n        grouped.set(url, []);\n      grouped.get(url).push(filter);\n    }\n    const groupedRequests = Array.from(grouped.entries()).map(([url, filters]) => ({ url, filters }));\n    if (this.trackRelays) {\n      params.receivedEvent = (relay, id) => {\n        let set = this.seenOn.get(id);\n        if (!set) {\n          set = /* @__PURE__ */ new Set();\n          this.seenOn.set(id, set);\n        }\n        set.add(relay);\n      };\n    }\n    const _knownIds = /* @__PURE__ */ new Set();\n    const subs = [];\n    const eosesReceived = [];\n    let handleEose = (i2) => {\n      if (eosesReceived[i2])\n        return;\n      eosesReceived[i2] = true;\n      if (eosesReceived.filter((a) => a).length === groupedRequests.length) {\n        params.oneose?.();\n        handleEose = () => {\n        };\n      }\n    };\n    const closesReceived = [];\n    let handleClose = (i2, reason) => {\n      if (closesReceived[i2])\n        return;\n      handleEose(i2);\n      closesReceived[i2] = reason;\n      if (closesReceived.filter((a) => a).length === groupedRequests.length) {\n        params.onclose?.(closesReceived);\n        handleClose = () => {\n        };\n      }\n    };\n    const localAlreadyHaveEventHandler = (id) => {\n      if (params.alreadyHaveEvent?.(id)) {\n        return true;\n      }\n      const have = _knownIds.has(id);\n      _knownIds.add(id);\n      return have;\n    };\n    const allOpened = Promise.all(\n      groupedRequests.map(async ({ url, filters }, i2) => {\n        if (this.allowConnectingToRelay?.(url, [\"read\", filters]) === false) {\n          handleClose(i2, \"connection skipped by allowConnectingToRelay\");\n          return;\n        }\n        let relay;\n        try {\n          relay = await this.ensureRelay(url, {\n            connectionTimeout: this.maxWaitForConnection < (params.maxWait || 0) ? Math.max(params.maxWait * 0.8, params.maxWait - 1e3) : this.maxWaitForConnection,\n            abort: params.abort\n          });\n        } catch (err) {\n          this.onRelayConnectionFailure?.(url);\n          handleClose(i2, err?.message || String(err));\n          return;\n        }\n        this.onRelayConnectionSuccess?.(url);\n        let subscription = relay.subscribe(filters, {\n          ...params,\n          oneose: () => handleEose(i2),\n          onclose: (reason) => {\n            if (reason.startsWith(\"auth-required: \") && params.onauth) {\n              relay.auth(params.onauth).then(() => {\n                relay.subscribe(filters, {\n                  ...params,\n                  oneose: () => handleEose(i2),\n                  onclose: (reason2) => {\n                    handleClose(i2, reason2);\n                  },\n                  alreadyHaveEvent: localAlreadyHaveEventHandler,\n                  eoseTimeout: params.maxWait,\n                  abort: params.abort\n                });\n              }).catch((err) => {\n                handleClose(i2, `auth was required and attempted, but failed with: ${err}`);\n              });\n            } else {\n              handleClose(i2, reason);\n            }\n          },\n          alreadyHaveEvent: localAlreadyHaveEventHandler,\n          eoseTimeout: params.maxWait,\n          abort: params.abort\n        });\n        subs.push(subscription);\n      })\n    );\n    return {\n      async close(reason) {\n        await allOpened;\n        subs.forEach((sub) => {\n          sub.close(reason);\n        });\n      }\n    };\n  }\n  subscribeEose(relays, filter, params) {\n    let subcloser;\n    subcloser = this.subscribe(relays, filter, {\n      ...params,\n      oneose() {\n        const reason = \"closed automatically on eose\";\n        if (subcloser)\n          subcloser.close(reason);\n        else\n          params.onclose?.(relays.map((_) => reason));\n      }\n    });\n    return subcloser;\n  }\n  subscribeManyEose(relays, filter, params) {\n    return this.subscribeEose(relays, filter, params);\n  }\n  async querySync(relays, filter, params) {\n    return new Promise(async (resolve) => {\n      const events = [];\n      this.subscribeEose(relays, filter, {\n        ...params,\n        onevent(event) {\n          events.push(event);\n        },\n        onclose(_) {\n          resolve(events);\n        }\n      });\n    });\n  }\n  async get(relays, filter, params) {\n    filter.limit = 1;\n    const events = await this.querySync(relays, filter, params);\n    events.sort((a, b) => b.created_at - a.created_at);\n    return events[0] || null;\n  }\n  publish(relays, event, params) {\n    return relays.map(normalizeURL).map(async (url, i2, arr) => {\n      if (arr.indexOf(url) !== i2) {\n        return Promise.reject(\"duplicate url\");\n      }\n      if (this.allowConnectingToRelay?.(url, [\"write\", event]) === false) {\n        return Promise.reject(\"connection skipped by allowConnectingToRelay\");\n      }\n      let r;\n      try {\n        r = await this.ensureRelay(url, {\n          connectionTimeout: this.maxWaitForConnection < (params?.maxWait || 0) ? Math.max(params.maxWait * 0.8, params.maxWait - 1e3) : this.maxWaitForConnection,\n          abort: params?.abort\n        });\n      } catch (err) {\n        this.onRelayConnectionFailure?.(url);\n        return String(\"connection failure: \" + String(err));\n      }\n      return r.publish(event).catch(async (err) => {\n        if (err instanceof Error && err.message.startsWith(\"auth-required: \") && params?.onauth) {\n          await r.auth(params.onauth);\n          return r.publish(event);\n        }\n        throw err;\n      }).then((reason) => {\n        if (this.trackRelays) {\n          let set = this.seenOn.get(event.id);\n          if (!set) {\n            set = /* @__PURE__ */ new Set();\n            this.seenOn.set(event.id, set);\n          }\n          set.add(r);\n        }\n        return reason;\n      });\n    });\n  }\n  listConnectionStatus() {\n    const map = /* @__PURE__ */ new Map();\n    this.relays.forEach((relay, url) => map.set(url, relay.connected));\n    return map;\n  }\n  destroy() {\n    this.relays.forEach((conn) => conn.close());\n    this.relays = /* @__PURE__ */ new Map();\n  }\n  pruneIdleRelays(idleThresholdMs = 1e4) {\n    const prunedUrls = [];\n    for (const [url, relay] of this.relays) {\n      if (relay.idleSince && Date.now() - relay.idleSince >= idleThresholdMs) {\n        this.relays.delete(url);\n        prunedUrls.push(url);\n        relay.close();\n      }\n    }\n    return prunedUrls;\n  }\n};\n\n// pool.ts\nvar _WebSocket2;\ntry {\n  _WebSocket2 = WebSocket;\n} catch {\n}\nvar SimplePool = class extends AbstractSimplePool {\n  constructor(options) {\n    super({ verifyEvent, websocketImplementation: _WebSocket2, maxWaitForConnection: 3e3, ...options });\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  Bech32MaxSize: () => Bech32MaxSize,\n  NostrTypeGuard: () => NostrTypeGuard,\n  decode: () => decode,\n  decodeNostrURI: () => decodeNostrURI,\n  encodeBytes: () => encodeBytes,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nsecEncode: () => nsecEncode\n});\n\n\nvar NostrTypeGuard = {\n  isNProfile: (value) => /^nprofile1[a-z\\d]+$/.test(value || \"\"),\n  isNEvent: (value) => /^nevent1[a-z\\d]+$/.test(value || \"\"),\n  isNAddr: (value) => /^naddr1[a-z\\d]+$/.test(value || \"\"),\n  isNSec: (value) => /^nsec1[a-z\\d]{58}$/.test(value || \"\"),\n  isNPub: (value) => /^npub1[a-z\\d]{58}$/.test(value || \"\"),\n  isNote: (value) => /^note1[a-z\\d]+$/.test(value || \"\"),\n  isNcryptsec: (value) => /^ncryptsec1[a-z\\d]+$/.test(value || \"\")\n};\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decodeNostrURI(nip19code) {\n  try {\n    if (nip19code.startsWith(\"nostr:\"))\n      nip19code = nip19code.substring(6);\n    return decode(nip19code);\n  } catch (_err) {\n    return { type: \"invalid\", data: null };\n  }\n}\nfunction decode(code) {\n  let { prefix, words } = _scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.decode(code, Bech32MaxSize);\n  let data = new Uint8Array(_scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nprofile\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      return {\n        type: \"nprofile\",\n        data: {\n          pubkey: (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nevent\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nevent\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      if (tlv[2] && tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (tlv[3] && tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"nevent\",\n        data: {\n          id: (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : [],\n          author: tlv[2]?.[0] ? (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[2][0]) : void 0,\n          kind: tlv[3]?.[0] ? parseInt((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[3][0]), 16) : void 0\n        }\n      };\n    }\n    case \"naddr\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for naddr\");\n      if (!tlv[2]?.[0])\n        throw new Error(\"missing TLV 2 for naddr\");\n      if (tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (!tlv[3]?.[0])\n        throw new Error(\"missing TLV 3 for naddr\");\n      if (tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"naddr\",\n        data: {\n          identifier: utf8Decoder.decode(tlv[0][0]),\n          pubkey: (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[2][0]),\n          kind: parseInt((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(tlv[3][0]), 16),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nsec\":\n      return { type: prefix, data };\n    case \"npub\":\n    case \"note\":\n      return { type: prefix, data: (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(data) };\n    default:\n      throw new Error(`unknown prefix ${prefix}`);\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l)\n      throw new Error(`not enough data to read on TLV ${t}`);\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(key) {\n  return encodeBytes(\"nsec\", key);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(hex));\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(hex));\n}\nfunction encodeBech32(prefix, data) {\n  let words = _scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.toWords(data);\n  return _scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, bytes) {\n  return encodeBech32(prefix, bytes);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(profile.pubkey)],\n    1: (profile.relays || []).map((url) => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind !== void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(event.id)],\n    1: (event.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: event.author ? [(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: [(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).reverse().forEach(([t, vs]) => {\n    vs.forEach((v) => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.concatBytes)(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let { type, data } = decode(ref[1]);\n        switch (type) {\n          case \"npub\": {\n            references.push({\n              text: ref[0],\n              profile: { pubkey: data, relays: [] }\n            });\n            break;\n          }\n          case \"nprofile\": {\n            references.push({\n              text: ref[0],\n              profile: data\n            });\n            break;\n          }\n          case \"note\": {\n            references.push({\n              text: ref[0],\n              event: { id: data, relays: [] }\n            });\n            break;\n          }\n          case \"nevent\": {\n            references.push({\n              text: ref[0],\n              event: data\n            });\n            break;\n          }\n          case \"naddr\": {\n            references.push({\n              text: ref[0],\n              address: data\n            });\n            break;\n          }\n        }\n      } catch (err) {\n      }\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag)\n        continue;\n      switch (tag[0]) {\n        case \"p\": {\n          references.push({\n            text: ref[0],\n            profile: { pubkey: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"e\": {\n          references.push({\n            text: ref[0],\n            event: { id: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"a\": {\n          try {\n            let [kind, pubkey, identifier] = tag[1].split(\":\");\n            references.push({\n              text: ref[0],\n              address: {\n                identifier,\n                pubkey,\n                kind: parseInt(kind, 10),\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n          } catch (err) {\n          }\n          break;\n        }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\n\n\n\n\nfunction encrypt(secretKey, pubkey, text) {\n  const privkey = secretKey instanceof Uint8Array ? secretKey : (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(secretKey);\n  const key = _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.secp256k1.getSharedSecret(privkey, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(\"02\" + pubkey));\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.randomBytes)(16));\n  let plaintext = utf8Encoder.encode(text);\n  let ciphertext = (0,_noble_ciphers_aes_js__WEBPACK_IMPORTED_MODULE_4__.cbc)(normalizedKey, iv).encrypt(plaintext);\n  let ctb64 = _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.encode(new Uint8Array(iv.buffer));\n  return `${ctb64}?iv=${ivb64}`;\n}\nfunction decrypt(secretKey, pubkey, data) {\n  const privkey = secretKey instanceof Uint8Array ? secretKey : (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(secretKey);\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.secp256k1.getSharedSecret(privkey, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(\"02\" + pubkey));\n  let normalizedKey = getNormalizedX(key);\n  let iv = _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.decode(ivb64);\n  let ciphertext = _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.decode(ctb64);\n  let plaintext = (0,_noble_ciphers_aes_js__WEBPACK_IMPORTED_MODULE_4__.cbc)(normalizedKey, iv).decrypt(ciphertext);\n  return utf8Decoder.decode(plaintext);\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  isNip05: () => isNip05,\n  isValid: () => isValid,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w_-]+(\\.[\\w_-]+)+)$/;\nvar isNip05 = (value) => NIP05_REGEX.test(value || \"\");\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch (_) {\n  null;\n}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain, query = \"\") {\n  try {\n    const url = `https://${domain}/.well-known/nostr.json?name=${query}`;\n    const res = await _fetch(url, { redirect: \"manual\" });\n    if (res.status !== 200) {\n      throw Error(\"Wrong response code\");\n    }\n    const json = await res.json();\n    return json.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match)\n    return null;\n  const [, name = \"_\", domain] = match;\n  try {\n    const url = `https://${domain}/.well-known/nostr.json?name=${name}`;\n    const res = await _fetch(url, { redirect: \"manual\" });\n    if (res.status !== 200) {\n      throw Error(\"Wrong response code\");\n    }\n    const json = await res.json();\n    const pubkey = json.names[name];\n    return pubkey ? { pubkey, relays: json.relays?.[pubkey] } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nasync function isValid(pubkey, nip05) {\n  const res = await queryProfile(nip05);\n  return res ? res.pubkey === pubkey : false;\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: [],\n    quotes: []\n  };\n  let maybeParent;\n  let maybeRoot;\n  for (let i2 = event.tags.length - 1; i2 >= 0; i2--) {\n    const tag = event.tags[i2];\n    if (tag[0] === \"e\" && tag[1]) {\n      const [_, eTagEventId, eTagRelayUrl, eTagMarker, eTagAuthor] = tag;\n      const eventPointer = {\n        id: eTagEventId,\n        relays: eTagRelayUrl ? [eTagRelayUrl] : [],\n        author: eTagAuthor\n      };\n      if (eTagMarker === \"root\") {\n        result.root = eventPointer;\n        continue;\n      }\n      if (eTagMarker === \"reply\") {\n        result.reply = eventPointer;\n        continue;\n      }\n      if (eTagMarker === \"mention\") {\n        result.mentions.push(eventPointer);\n        continue;\n      }\n      if (!maybeParent) {\n        maybeParent = eventPointer;\n      } else {\n        maybeRoot = eventPointer;\n      }\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (tag[0] === \"q\" && tag[1]) {\n      const [_, eTagEventId, eTagRelayUrl] = tag;\n      result.quotes.push({\n        id: eTagEventId,\n        relays: eTagRelayUrl ? [eTagRelayUrl] : []\n      });\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n      continue;\n    }\n  }\n  if (!result.root) {\n    result.root = maybeRoot || maybeParent || result.reply;\n  }\n  if (!result.reply) {\n    result.reply = maybeParent || result.root;\n  }\n  ;\n  [result.reply, result.root].forEach((ref) => {\n    if (!ref)\n      return;\n    let idx = result.mentions.indexOf(ref);\n    if (idx !== -1) {\n      result.mentions.splice(idx, 1);\n    }\n    if (ref.author) {\n      let author = result.profiles.find((p) => p.pubkey === ref.author);\n      if (author && author.relays) {\n        if (!ref.relays) {\n          ref.relays = [];\n        }\n        author.relays.forEach((url) => {\n          if (ref.relays?.indexOf(url) === -1)\n            ref.relays.push(url);\n        });\n        author.relays = ref.relays;\n      }\n    }\n  });\n  result.mentions.forEach((ref) => {\n    if (ref.author) {\n      let author = result.profiles.find((p) => p.pubkey === ref.author);\n      if (author && author.relays) {\n        if (!ref.relays) {\n          ref.relays = [];\n        }\n        author.relays.forEach((url) => {\n          if (ref.relays.indexOf(url) === -1)\n            ref.relays.push(url);\n        });\n        author.relays = ref.relays;\n      }\n    }\n  });\n  return result;\n}\n\n// nip11.ts\nvar nip11_exports = {};\n__export(nip11_exports, {\n  fetchRelayInformation: () => fetchRelayInformation,\n  useFetchImplementation: () => useFetchImplementation2\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {\n}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function fetchRelayInformation(url) {\n  return await (await fetch(url.replace(\"ws://\", \"http://\").replace(\"wss://\", \"https://\"), {\n    headers: { Accept: \"application/nostr+json\" }\n  })).json();\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  getPow: () => getPow,\n  minePow: () => minePow\n});\n\n\nfunction getPow(hex) {\n  let count = 0;\n  for (let i2 = 0; i2 < 64; i2 += 8) {\n    const nibble = parseInt(hex.substring(i2, i2 + 8), 16);\n    if (nibble === 0) {\n      count += 32;\n    } else {\n      count += Math.clz32(nibble);\n      break;\n    }\n  }\n  return count;\n}\nfunction getPowFromBytes(hash) {\n  let count = 0;\n  for (let i2 = 0; i2 < hash.length; i2++) {\n    const byte = hash[i2];\n    if (byte === 0) {\n      count += 8;\n    } else {\n      count += Math.clz32(byte) - 24;\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now2 = Math.floor(new Date().getTime() / 1e3);\n    if (now2 !== event.created_at) {\n      count = 0;\n      event.created_at = now2;\n    }\n    tag[1] = (++count).toString();\n    const hash = (0,_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256)(\n      utf8Encoder.encode(JSON.stringify([0, event.pubkey, event.created_at, event.kind, event.tags, event.content]))\n    );\n    if (getPowFromBytes(hash) >= difficulty) {\n      event.id = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(hash);\n      break;\n    }\n  }\n  return event;\n}\n\n// nip17.ts\nvar nip17_exports = {};\n__export(nip17_exports, {\n  unwrapEvent: () => unwrapEvent2,\n  unwrapManyEvents: () => unwrapManyEvents2,\n  wrapEvent: () => wrapEvent2,\n  wrapManyEvents: () => wrapManyEvents2\n});\n\n// nip59.ts\nvar nip59_exports = {};\n__export(nip59_exports, {\n  createRumor: () => createRumor,\n  createSeal: () => createSeal,\n  createWrap: () => createWrap,\n  unwrapEvent: () => unwrapEvent,\n  unwrapManyEvents: () => unwrapManyEvents,\n  wrapEvent: () => wrapEvent,\n  wrapManyEvents: () => wrapManyEvents\n});\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  decrypt: () => decrypt2,\n  encrypt: () => encrypt2,\n  getConversationKey: () => getConversationKey,\n  v2: () => v2\n});\n\n\n\n\n\n\n\n\nvar minPlaintextSize = 1;\nvar maxPlaintextSize = 65535;\nfunction getConversationKey(privkeyA, pubkeyB) {\n  const sharedX = _noble_curves_secp256k1_js__WEBPACK_IMPORTED_MODULE_1__.secp256k1.getSharedSecret(privkeyA, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(\"02\" + pubkeyB)).subarray(1, 33);\n  return (0,_noble_hashes_hkdf_js__WEBPACK_IMPORTED_MODULE_5__.extract)(_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256, sharedX, utf8Encoder.encode(\"nip44-v2\"));\n}\nfunction getMessageKeys(conversationKey, nonce) {\n  const keys = (0,_noble_hashes_hkdf_js__WEBPACK_IMPORTED_MODULE_5__.expand)(_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256, conversationKey, nonce, 76);\n  return {\n    chacha_key: keys.subarray(0, 32),\n    chacha_nonce: keys.subarray(32, 44),\n    hmac_key: keys.subarray(44, 76)\n  };\n}\nfunction calcPaddedLen(len) {\n  if (!Number.isSafeInteger(len) || len < 1)\n    throw new Error(\"expected positive integer\");\n  if (len <= 32)\n    return 32;\n  const nextPower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n  const chunk = nextPower <= 256 ? 32 : nextPower / 8;\n  return chunk * (Math.floor((len - 1) / chunk) + 1);\n}\nfunction writeU16BE(num) {\n  if (!Number.isSafeInteger(num) || num < minPlaintextSize || num > maxPlaintextSize)\n    throw new Error(\"invalid plaintext size: must be between 1 and 65535 bytes\");\n  const arr = new Uint8Array(2);\n  new DataView(arr.buffer).setUint16(0, num, false);\n  return arr;\n}\nfunction pad(plaintext) {\n  const unpadded = utf8Encoder.encode(plaintext);\n  const unpaddedLen = unpadded.length;\n  const prefix = writeU16BE(unpaddedLen);\n  const suffix = new Uint8Array(calcPaddedLen(unpaddedLen) - unpaddedLen);\n  return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.concatBytes)(prefix, unpadded, suffix);\n}\nfunction unpad(padded) {\n  const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n  const unpadded = padded.subarray(2, 2 + unpaddedLen);\n  if (unpaddedLen < minPlaintextSize || unpaddedLen > maxPlaintextSize || unpadded.length !== unpaddedLen || padded.length !== 2 + calcPaddedLen(unpaddedLen))\n    throw new Error(\"invalid padding\");\n  return utf8Decoder.decode(unpadded);\n}\nfunction hmacAad(key, message, aad) {\n  if (aad.length !== 32)\n    throw new Error(\"AAD associated data must be 32 bytes\");\n  const combined = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.concatBytes)(aad, message);\n  return (0,_noble_hashes_hmac_js__WEBPACK_IMPORTED_MODULE_6__.hmac)(_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256, key, combined);\n}\nfunction decodePayload(payload) {\n  if (typeof payload !== \"string\")\n    throw new Error(\"payload must be a valid string\");\n  const plen = payload.length;\n  if (plen < 132 || plen > 87472)\n    throw new Error(\"invalid payload length: \" + plen);\n  if (payload[0] === \"#\")\n    throw new Error(\"unknown encryption version\");\n  let data;\n  try {\n    data = _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.decode(payload);\n  } catch (error) {\n    throw new Error(\"invalid base64: \" + error.message);\n  }\n  const dlen = data.length;\n  if (dlen < 99 || dlen > 65603)\n    throw new Error(\"invalid data length: \" + dlen);\n  const vers = data[0];\n  if (vers !== 2)\n    throw new Error(\"unknown encryption version \" + vers);\n  return {\n    nonce: data.subarray(1, 33),\n    ciphertext: data.subarray(33, -32),\n    mac: data.subarray(-32)\n  };\n}\nfunction encrypt2(plaintext, conversationKey, nonce = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.randomBytes)(32)) {\n  const { chacha_key, chacha_nonce, hmac_key } = getMessageKeys(conversationKey, nonce);\n  const padded = pad(plaintext);\n  const ciphertext = (0,_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_7__.chacha20)(chacha_key, chacha_nonce, padded);\n  const mac = hmacAad(hmac_key, ciphertext, nonce);\n  return _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.encode((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.concatBytes)(new Uint8Array([2]), nonce, ciphertext, mac));\n}\nfunction decrypt2(payload, conversationKey) {\n  const { nonce, ciphertext, mac } = decodePayload(payload);\n  const { chacha_key, chacha_nonce, hmac_key } = getMessageKeys(conversationKey, nonce);\n  const calculatedMac = hmacAad(hmac_key, ciphertext, nonce);\n  if (!(0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_8__.equalBytes)(calculatedMac, mac))\n    throw new Error(\"invalid MAC\");\n  const padded = (0,_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_7__.chacha20)(chacha_key, chacha_nonce, ciphertext);\n  return unpad(padded);\n}\nvar v2 = {\n  utils: {\n    getConversationKey,\n    calcPaddedLen\n  },\n  encrypt: encrypt2,\n  decrypt: decrypt2\n};\n\n// nip59.ts\nvar TWO_DAYS = 2 * 24 * 60 * 60;\nvar now = () => Math.round(Date.now() / 1e3);\nvar randomNow = () => Math.round(now() - Math.random() * TWO_DAYS);\nvar nip44ConversationKey = (privateKey, publicKey) => getConversationKey(privateKey, publicKey);\nvar nip44Encrypt = (data, privateKey, publicKey) => encrypt2(JSON.stringify(data), nip44ConversationKey(privateKey, publicKey));\nvar nip44Decrypt = (data, privateKey) => JSON.parse(decrypt2(data.content, nip44ConversationKey(privateKey, data.pubkey)));\nfunction createRumor(event, privateKey) {\n  const rumor = {\n    created_at: now(),\n    content: \"\",\n    tags: [],\n    ...event,\n    pubkey: getPublicKey(privateKey)\n  };\n  rumor.id = getEventHash(rumor);\n  return rumor;\n}\nfunction createSeal(rumor, privateKey, recipientPublicKey) {\n  return finalizeEvent(\n    {\n      kind: Seal,\n      content: nip44Encrypt(rumor, privateKey, recipientPublicKey),\n      created_at: randomNow(),\n      tags: []\n    },\n    privateKey\n  );\n}\nfunction createWrap(seal, recipientPublicKey) {\n  const randomKey = generateSecretKey();\n  return finalizeEvent(\n    {\n      kind: GiftWrap,\n      content: nip44Encrypt(seal, randomKey, recipientPublicKey),\n      created_at: randomNow(),\n      tags: [[\"p\", recipientPublicKey]]\n    },\n    randomKey\n  );\n}\nfunction wrapEvent(event, senderPrivateKey, recipientPublicKey) {\n  const rumor = createRumor(event, senderPrivateKey);\n  const seal = createSeal(rumor, senderPrivateKey, recipientPublicKey);\n  return createWrap(seal, recipientPublicKey);\n}\nfunction wrapManyEvents(event, senderPrivateKey, recipientsPublicKeys) {\n  if (!recipientsPublicKeys || recipientsPublicKeys.length === 0) {\n    throw new Error(\"At least one recipient is required.\");\n  }\n  const senderPublicKey = getPublicKey(senderPrivateKey);\n  const wrappeds = [wrapEvent(event, senderPrivateKey, senderPublicKey)];\n  recipientsPublicKeys.forEach((recipientPublicKey) => {\n    wrappeds.push(wrapEvent(event, senderPrivateKey, recipientPublicKey));\n  });\n  return wrappeds;\n}\nfunction unwrapEvent(wrap, recipientPrivateKey) {\n  const unwrappedSeal = nip44Decrypt(wrap, recipientPrivateKey);\n  return nip44Decrypt(unwrappedSeal, recipientPrivateKey);\n}\nfunction unwrapManyEvents(wrappedEvents, recipientPrivateKey) {\n  let unwrappedEvents = [];\n  wrappedEvents.forEach((e) => {\n    unwrappedEvents.push(unwrapEvent(e, recipientPrivateKey));\n  });\n  unwrappedEvents.sort((a, b) => a.created_at - b.created_at);\n  return unwrappedEvents;\n}\n\n// nip17.ts\nfunction createEvent(recipients, message, conversationTitle, replyTo) {\n  const baseEvent = {\n    created_at: Math.ceil(Date.now() / 1e3),\n    kind: PrivateDirectMessage,\n    tags: [],\n    content: message\n  };\n  const recipientsArray = Array.isArray(recipients) ? recipients : [recipients];\n  recipientsArray.forEach(({ publicKey, relayUrl }) => {\n    baseEvent.tags.push(relayUrl ? [\"p\", publicKey, relayUrl] : [\"p\", publicKey]);\n  });\n  if (replyTo) {\n    baseEvent.tags.push([\"e\", replyTo.eventId, replyTo.relayUrl || \"\", \"reply\"]);\n  }\n  if (conversationTitle) {\n    baseEvent.tags.push([\"subject\", conversationTitle]);\n  }\n  return baseEvent;\n}\nfunction wrapEvent2(senderPrivateKey, recipient, message, conversationTitle, replyTo) {\n  const event = createEvent(recipient, message, conversationTitle, replyTo);\n  return wrapEvent(event, senderPrivateKey, recipient.publicKey);\n}\nfunction wrapManyEvents2(senderPrivateKey, recipients, message, conversationTitle, replyTo) {\n  if (!recipients || recipients.length === 0) {\n    throw new Error(\"At least one recipient is required.\");\n  }\n  const senderPublicKey = getPublicKey(senderPrivateKey);\n  return [{ publicKey: senderPublicKey }, ...recipients].map(\n    (recipient) => wrapEvent2(senderPrivateKey, recipient, message, conversationTitle, replyTo)\n  );\n}\nvar unwrapEvent2 = unwrapEvent;\nvar unwrapManyEvents2 = unwrapManyEvents;\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  let kind;\n  const tags = [...t.tags ?? [], [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]];\n  if (reposted.kind === ShortTextNote) {\n    kind = Repost;\n  } else {\n    kind = GenericRepost;\n    tags.push([\"k\", String(reposted.kind)]);\n  }\n  return finalizeEvent(\n    {\n      kind,\n      tags,\n      content: t.content === \"\" || reposted.tags?.find((tag) => tag[0] === \"-\") ? \"\" : JSON.stringify(reposted),\n      created_at: t.created_at\n    },\n    privateKey\n  );\n}\nfunction getRepostedEventPointer(event) {\n  if (![Repost, GenericRepost].includes(event.kind)) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag?.[2]].filter((x) => typeof x === \"string\"),\n    author: lastPTag?.[1]\n  };\n}\nfunction getRepostedEvent(event, { skipVerification } = {}) {\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifyEvent(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(`nostr:(${BECH32_REGEX.source})`);\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));\n  if (!match)\n    throw new Error(`Invalid Nostr URI: ${uri}`);\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  const inheritedTags = reacted.tags.filter((tag) => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finalizeEvent(\n    {\n      ...t,\n      kind: Reaction,\n      tags: [...t.tags ?? [], ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n      content: t.content ?? \"+\"\n    },\n    privateKey\n  );\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== Reaction) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i2 = event.tags.length - 1; i2 >= 0 && (lastETag === void 0 || lastPTag === void 0); i2--) {\n    const tag = event.tags[i2];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter((x) => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  parse: () => parse3\n});\nvar noCharacter = /\\W/m;\nvar noURLCharacter = /[^\\w\\/] |[^\\w\\/]$|$|,| /m;\nvar MAX_HASHTAG_LENGTH = 42;\nfunction* parse3(content) {\n  let emojis = [];\n  if (typeof content !== \"string\") {\n    for (let i2 = 0; i2 < content.tags.length; i2++) {\n      const tag = content.tags[i2];\n      if (tag[0] === \"emoji\" && tag.length >= 3) {\n        emojis.push({ type: \"emoji\", shortcode: tag[1], url: tag[2] });\n      }\n    }\n    content = content.content;\n  }\n  const max = content.length;\n  let prevIndex = 0;\n  let index = 0;\n  mainloop:\n    while (index < max) {\n      const u = content.indexOf(\":\", index);\n      const h = content.indexOf(\"#\", index);\n      if (u === -1 && h === -1) {\n        break mainloop;\n      }\n      if (u === -1 || h >= 0 && h < u) {\n        if (h === 0 || content[h - 1].match(noCharacter)) {\n          const m = content.slice(h + 1, h + MAX_HASHTAG_LENGTH).match(noCharacter);\n          const end = m ? h + 1 + m.index : max;\n          yield { type: \"text\", text: content.slice(prevIndex, h) };\n          yield { type: \"hashtag\", value: content.slice(h + 1, end) };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        }\n        index = h + 1;\n        continue mainloop;\n      }\n      if (content.slice(u - 5, u) === \"nostr\") {\n        const m = content.slice(u + 60).match(noCharacter);\n        const end = m ? u + 60 + m.index : max;\n        try {\n          let pointer;\n          let { data, type } = decode(content.slice(u + 1, end));\n          switch (type) {\n            case \"npub\":\n              pointer = { pubkey: data };\n              break;\n            case \"note\":\n              pointer = { id: data };\n              break;\n            case \"nsec\":\n              index = end + 1;\n              continue;\n            default:\n              pointer = data;\n          }\n          if (prevIndex !== u - 5) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - 5) };\n          }\n          yield { type: \"reference\", pointer };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = u + 1;\n          continue mainloop;\n        }\n      } else if (content.slice(u - 5, u) === \"https\" || content.slice(u - 4, u) === \"http\") {\n        const m = content.slice(u + 4).match(noURLCharacter);\n        const end = m ? u + 4 + m.index : max;\n        const prefixLen = content[u - 1] === \"s\" ? 5 : 4;\n        try {\n          let url = new URL(content.slice(u - prefixLen, end));\n          if (url.hostname.indexOf(\".\") === -1) {\n            throw new Error(\"invalid url\");\n          }\n          if (prevIndex !== u - prefixLen) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - prefixLen) };\n          }\n          if (/\\.(png|jpe?g|gif|webp|heic|svg)$/i.test(url.pathname)) {\n            yield { type: \"image\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          if (/\\.(mp4|avi|webm|mkv|mov)$/i.test(url.pathname)) {\n            yield { type: \"video\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          if (/\\.(mp3|aac|ogg|opus|wav|flac)$/i.test(url.pathname)) {\n            yield { type: \"audio\", url: url.toString() };\n            index = end;\n            prevIndex = index;\n            continue mainloop;\n          }\n          yield { type: \"url\", url: url.toString() };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = end + 1;\n          continue mainloop;\n        }\n      } else if (content.slice(u - 3, u) === \"wss\" || content.slice(u - 2, u) === \"ws\") {\n        const m = content.slice(u + 4).match(noURLCharacter);\n        const end = m ? u + 4 + m.index : max;\n        const prefixLen = content[u - 1] === \"s\" ? 3 : 2;\n        try {\n          let url = new URL(content.slice(u - prefixLen, end));\n          if (url.hostname.indexOf(\".\") === -1) {\n            throw new Error(\"invalid ws url\");\n          }\n          if (prevIndex !== u - prefixLen) {\n            yield { type: \"text\", text: content.slice(prevIndex, u - prefixLen) };\n          }\n          yield { type: \"relay\", url: url.toString() };\n          index = end;\n          prevIndex = index;\n          continue mainloop;\n        } catch (_err) {\n          index = end + 1;\n          continue mainloop;\n        }\n      } else {\n        for (let e = 0; e < emojis.length; e++) {\n          const emoji = emojis[e];\n          if (content[u + emoji.shortcode.length + 1] === \":\" && content.slice(u + 1, u + emoji.shortcode.length + 1) === emoji.shortcode) {\n            if (prevIndex !== u) {\n              yield { type: \"text\", text: content.slice(prevIndex, u) };\n            }\n            yield emoji;\n            index = u + emoji.shortcode.length + 2;\n            prevIndex = index;\n            continue mainloop;\n          }\n        }\n        index = u + 1;\n        continue mainloop;\n      }\n    }\n  if (prevIndex !== max) {\n    yield { type: \"text\", text: content.slice(prevIndex) };\n  }\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelCreation,\n      tags: [...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMetadata,\n      tags: [[\"e\", t.channel_create_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMessageEvent = (t, privateKey) => {\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMessage,\n      tags: [...tags, ...t.tags ?? []],\n      content: t.content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelHideMessage,\n      tags: [[\"e\", t.channel_message_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finalizeEvent(\n    {\n      kind: ChannelMuteUser,\n      tags: [[\"p\", t.pubkey_to_mute], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\n\n// nip30.ts\nvar nip30_exports = {};\n__export(nip30_exports, {\n  EMOJI_SHORTCODE_REGEX: () => EMOJI_SHORTCODE_REGEX,\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar EMOJI_SHORTCODE_REGEX = /:(\\w+):/;\nvar regex = () => new RegExp(`\\\\B${EMOJI_SHORTCODE_REGEX.source}\\\\B`, \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [shortcode, name] = match;\n      yield {\n        shortcode,\n        name,\n        start: match.index,\n        end: match.index + shortcode.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (shortcode, name) => {\n    return replacer({\n      shortcode,\n      name\n    });\n  });\n}\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation3,\n  validateGithub: () => validateGithub\n});\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {\n}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch3(`https://gist.github.com/${username}/${proof}/raw`)).text();\n    return res === `Verifying that I control the following Nostr public key: ${pubkey}`;\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const { host, pathname, searchParams } = new URL(connectionString);\n  const pubkey = pathname || host;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return { pubkey, relay, secret };\n}\nasync function makeNwcRequestEvent(pubkey, secretKey, invoice) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = encrypt(secretKey, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: NWCWalletRequest,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finalizeEvent(eventTemplate, secretKey);\n}\n\n// nip54.ts\nvar nip54_exports = {};\n__export(nip54_exports, {\n  normalizeIdentifier: () => normalizeIdentifier\n});\nfunction normalizeIdentifier(name) {\n  name = name.trim().toLowerCase();\n  name = name.normalize(\"NFKC\");\n  return Array.from(name).map((char) => {\n    if (/\\p{Letter}/u.test(char) || /\\p{Number}/u.test(char)) {\n      return char;\n    }\n    return \"-\";\n  }).join(\"\");\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getSatoshisAmountFromBolt11: () => getSatoshisAmountFromBolt11,\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation4,\n  validateZapRequest: () => validateZapRequest\n});\n\nvar _fetch4;\ntry {\n  _fetch4 = fetch;\n} catch {\n}\nfunction useFetchImplementation4(fetchImplementation) {\n  _fetch4 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let { lud06, lud16 } = JSON.parse(metadata.content);\n    if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = new URL(`/.well-known/lnurlp/${name}`, `https://${domain}`).toString();\n    } else if (lud06) {\n      let { words } = _scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.decode(lud06, 1e3);\n      let data = _scure_base__WEBPACK_IMPORTED_MODULE_3__.bech32.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else {\n      return null;\n    }\n    let res = await _fetch4(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n  }\n  return null;\n}\nfunction makeZapRequest(params) {\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: params.comment || \"\",\n    tags: [\n      [\"p\", \"pubkey\" in params ? params.pubkey : params.event.pubkey],\n      [\"amount\", params.amount.toString()],\n      [\"relays\", ...params.relays]\n    ]\n  };\n  if (\"event\" in params) {\n    zr.tags.push([\"e\", params.event.id]);\n    if (isReplaceableKind(params.event.kind)) {\n      const a = [\"a\", `${params.event.kind}:${params.event.pubkey}:`];\n      zr.tags.push(a);\n    } else if (isAddressableKind(params.event.kind)) {\n      let d = params.event.tags.find(([t, v]) => t === \"d\" && v);\n      if (!d)\n        throw new Error(\"d tag not found or is empty\");\n      const a = [\"a\", `${params.event.kind}:${params.event.pubkey}:${d[1]}`];\n      zr.tags.push(a);\n    }\n    zr.tags.push([\"k\", params.event.kind.toString()]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest))\n    return \"Zap request is not a valid Nostr event.\";\n  if (!verifyEvent(zapRequest))\n    return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(([t, v]) => t === \"p\" && v);\n  if (!p)\n    return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(([t, v]) => t === \"e\" && v);\n  if (e && !e[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(([t, v]) => t === \"relays\" && v);\n  if (!relays)\n    return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt({\n  zapRequest,\n  preimage,\n  bolt11,\n  paidAt\n}) {\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(([t]) => t === \"e\" || t === \"p\" || t === \"a\");\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"P\", zr.pubkey], [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\nfunction getSatoshisAmountFromBolt11(bolt11) {\n  if (bolt11.length < 50) {\n    return 0;\n  }\n  bolt11 = bolt11.substring(0, 50);\n  const idx = bolt11.lastIndexOf(\"1\");\n  if (idx === -1) {\n    return 0;\n  }\n  const hrp = bolt11.substring(0, idx);\n  if (!hrp.startsWith(\"lnbc\")) {\n    return 0;\n  }\n  const amount = hrp.substring(4);\n  if (amount.length < 1) {\n    return 0;\n  }\n  const char = amount[amount.length - 1];\n  const digit = char.charCodeAt(0) - \"0\".charCodeAt(0);\n  const isDigit = digit >= 0 && digit <= 9;\n  let cutPoint = amount.length - 1;\n  if (isDigit) {\n    cutPoint++;\n  }\n  if (cutPoint < 1) {\n    return 0;\n  }\n  const num = parseInt(amount.substring(0, cutPoint));\n  switch (char) {\n    case \"m\":\n      return num * 1e5;\n    case \"u\":\n      return num * 100;\n    case \"n\":\n      return num / 10;\n    case \"p\":\n      return num / 1e4;\n    default:\n      return num * 1e8;\n  }\n}\n\n// nip77.ts\nvar nip77_exports = {};\n__export(nip77_exports, {\n  Negentropy: () => Negentropy,\n  NegentropyStorageVector: () => NegentropyStorageVector,\n  NegentropySync: () => NegentropySync\n});\n\n\nvar PROTOCOL_VERSION = 97;\nvar ID_SIZE = 32;\nvar FINGERPRINT_SIZE = 16;\nvar Mode = {\n  Skip: 0,\n  Fingerprint: 1,\n  IdList: 2\n};\nvar WrappedBuffer = class {\n  _raw;\n  length;\n  constructor(buffer) {\n    if (typeof buffer === \"number\") {\n      this._raw = new Uint8Array(buffer);\n      this.length = 0;\n    } else if (buffer instanceof Uint8Array) {\n      this._raw = new Uint8Array(buffer);\n      this.length = buffer.length;\n    } else {\n      this._raw = new Uint8Array(512);\n      this.length = 0;\n    }\n  }\n  unwrap() {\n    return this._raw.subarray(0, this.length);\n  }\n  get capacity() {\n    return this._raw.byteLength;\n  }\n  extend(buf) {\n    if (buf instanceof WrappedBuffer)\n      buf = buf.unwrap();\n    if (typeof buf.length !== \"number\")\n      throw Error(\"bad length\");\n    const targetSize = buf.length + this.length;\n    if (this.capacity < targetSize) {\n      const oldRaw = this._raw;\n      const newCapacity = Math.max(this.capacity * 2, targetSize);\n      this._raw = new Uint8Array(newCapacity);\n      this._raw.set(oldRaw);\n    }\n    this._raw.set(buf, this.length);\n    this.length += buf.length;\n  }\n  shift() {\n    const first = this._raw[0];\n    this._raw = this._raw.subarray(1);\n    this.length--;\n    return first;\n  }\n  shiftN(n = 1) {\n    const firstSubarray = this._raw.subarray(0, n);\n    this._raw = this._raw.subarray(n);\n    this.length -= n;\n    return firstSubarray;\n  }\n};\nfunction decodeVarInt(buf) {\n  let res = 0;\n  while (1) {\n    if (buf.length === 0)\n      throw Error(\"parse ends prematurely\");\n    let byte = buf.shift();\n    res = res << 7 | byte & 127;\n    if ((byte & 128) === 0)\n      break;\n  }\n  return res;\n}\nfunction encodeVarInt(n) {\n  if (n === 0)\n    return new WrappedBuffer(new Uint8Array([0]));\n  let o = [];\n  while (n !== 0) {\n    o.push(n & 127);\n    n >>>= 7;\n  }\n  o.reverse();\n  for (let i2 = 0; i2 < o.length - 1; i2++)\n    o[i2] |= 128;\n  return new WrappedBuffer(new Uint8Array(o));\n}\nfunction getByte(buf) {\n  return getBytes(buf, 1)[0];\n}\nfunction getBytes(buf, n) {\n  if (buf.length < n)\n    throw Error(\"parse ends prematurely\");\n  return buf.shiftN(n);\n}\nvar Accumulator = class {\n  buf;\n  constructor() {\n    this.setToZero();\n  }\n  setToZero() {\n    this.buf = new Uint8Array(ID_SIZE);\n  }\n  add(otherBuf) {\n    let currCarry = 0, nextCarry = 0;\n    let p = new DataView(this.buf.buffer);\n    let po = new DataView(otherBuf.buffer);\n    for (let i2 = 0; i2 < 8; i2++) {\n      let offset = i2 * 4;\n      let orig = p.getUint32(offset, true);\n      let otherV = po.getUint32(offset, true);\n      let next = orig;\n      next += currCarry;\n      next += otherV;\n      if (next > 4294967295)\n        nextCarry = 1;\n      p.setUint32(offset, next & 4294967295, true);\n      currCarry = nextCarry;\n      nextCarry = 0;\n    }\n  }\n  negate() {\n    let p = new DataView(this.buf.buffer);\n    for (let i2 = 0; i2 < 8; i2++) {\n      let offset = i2 * 4;\n      p.setUint32(offset, ~p.getUint32(offset, true));\n    }\n    let one = new Uint8Array(ID_SIZE);\n    one[0] = 1;\n    this.add(one);\n  }\n  getFingerprint(n) {\n    let input = new WrappedBuffer();\n    input.extend(this.buf);\n    input.extend(encodeVarInt(n));\n    let hash = (0,_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256)(input.unwrap());\n    return hash.subarray(0, FINGERPRINT_SIZE);\n  }\n};\nvar NegentropyStorageVector = class {\n  items;\n  sealed;\n  constructor() {\n    this.items = [];\n    this.sealed = false;\n  }\n  insert(timestamp, id) {\n    if (this.sealed)\n      throw Error(\"already sealed\");\n    const idb = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(id);\n    if (idb.byteLength !== ID_SIZE)\n      throw Error(\"bad id size for added item\");\n    this.items.push({ timestamp, id: idb });\n  }\n  seal() {\n    if (this.sealed)\n      throw Error(\"already sealed\");\n    this.sealed = true;\n    this.items.sort(itemCompare);\n    for (let i2 = 1; i2 < this.items.length; i2++) {\n      if (itemCompare(this.items[i2 - 1], this.items[i2]) === 0)\n        throw Error(\"duplicate item inserted\");\n    }\n  }\n  unseal() {\n    this.sealed = false;\n  }\n  size() {\n    this._checkSealed();\n    return this.items.length;\n  }\n  getItem(i2) {\n    this._checkSealed();\n    if (i2 >= this.items.length)\n      throw Error(\"out of range\");\n    return this.items[i2];\n  }\n  iterate(begin, end, cb) {\n    this._checkSealed();\n    this._checkBounds(begin, end);\n    for (let i2 = begin; i2 < end; ++i2) {\n      if (!cb(this.items[i2], i2))\n        break;\n    }\n  }\n  findLowerBound(begin, end, bound) {\n    this._checkSealed();\n    this._checkBounds(begin, end);\n    return this._binarySearch(this.items, begin, end, (a) => itemCompare(a, bound) < 0);\n  }\n  fingerprint(begin, end) {\n    let out = new Accumulator();\n    out.setToZero();\n    this.iterate(begin, end, (item) => {\n      out.add(item.id);\n      return true;\n    });\n    return out.getFingerprint(end - begin);\n  }\n  _checkSealed() {\n    if (!this.sealed)\n      throw Error(\"not sealed\");\n  }\n  _checkBounds(begin, end) {\n    if (begin > end || end > this.items.length)\n      throw Error(\"bad range\");\n  }\n  _binarySearch(arr, first, last, cmp) {\n    let count = last - first;\n    while (count > 0) {\n      let it = first;\n      let step = Math.floor(count / 2);\n      it += step;\n      if (cmp(arr[it])) {\n        first = ++it;\n        count -= step + 1;\n      } else {\n        count = step;\n      }\n    }\n    return first;\n  }\n};\nvar Negentropy = class {\n  storage;\n  frameSizeLimit;\n  lastTimestampIn;\n  lastTimestampOut;\n  constructor(storage, frameSizeLimit = 6e4) {\n    if (frameSizeLimit < 4096)\n      throw Error(\"frameSizeLimit too small\");\n    this.storage = storage;\n    this.frameSizeLimit = frameSizeLimit;\n    this.lastTimestampIn = 0;\n    this.lastTimestampOut = 0;\n  }\n  _bound(timestamp, id) {\n    return { timestamp, id: id || new Uint8Array(0) };\n  }\n  initiate() {\n    let output = new WrappedBuffer();\n    output.extend(new Uint8Array([PROTOCOL_VERSION]));\n    this.splitRange(0, this.storage.size(), this._bound(Number.MAX_VALUE), output);\n    return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(output.unwrap());\n  }\n  reconcile(queryMsg, onhave, onneed) {\n    const query = new WrappedBuffer((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.hexToBytes)(queryMsg));\n    this.lastTimestampIn = this.lastTimestampOut = 0;\n    let fullOutput = new WrappedBuffer();\n    fullOutput.extend(new Uint8Array([PROTOCOL_VERSION]));\n    let protocolVersion = getByte(query);\n    if (protocolVersion < 96 || protocolVersion > 111)\n      throw Error(\"invalid negentropy protocol version byte\");\n    if (protocolVersion !== PROTOCOL_VERSION) {\n      throw Error(\"unsupported negentropy protocol version requested: \" + (protocolVersion - 96));\n    }\n    let storageSize = this.storage.size();\n    let prevBound = this._bound(0);\n    let prevIndex = 0;\n    let skip = false;\n    while (query.length !== 0) {\n      let o = new WrappedBuffer();\n      let doSkip = () => {\n        if (skip) {\n          skip = false;\n          o.extend(this.encodeBound(prevBound));\n          o.extend(encodeVarInt(Mode.Skip));\n        }\n      };\n      let currBound = this.decodeBound(query);\n      let mode = decodeVarInt(query);\n      let lower = prevIndex;\n      let upper = this.storage.findLowerBound(prevIndex, storageSize, currBound);\n      if (mode === Mode.Skip) {\n        skip = true;\n      } else if (mode === Mode.Fingerprint) {\n        let theirFingerprint = getBytes(query, FINGERPRINT_SIZE);\n        let ourFingerprint = this.storage.fingerprint(lower, upper);\n        if (compareUint8Array(theirFingerprint, ourFingerprint) !== 0) {\n          doSkip();\n          this.splitRange(lower, upper, currBound, o);\n        } else {\n          skip = true;\n        }\n      } else if (mode === Mode.IdList) {\n        let numIds = decodeVarInt(query);\n        let theirElems = {};\n        for (let i2 = 0; i2 < numIds; i2++) {\n          let e = getBytes(query, ID_SIZE);\n          theirElems[(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(e)] = e;\n        }\n        skip = true;\n        this.storage.iterate(lower, upper, (item) => {\n          let k = item.id;\n          const id = (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(k);\n          if (!theirElems[id]) {\n            onhave?.(id);\n          } else {\n            delete theirElems[(0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(k)];\n          }\n          return true;\n        });\n        if (onneed) {\n          for (let v of Object.values(theirElems)) {\n            onneed((0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(v));\n          }\n        }\n      } else {\n        throw Error(\"unexpected mode\");\n      }\n      if (this.exceededFrameSizeLimit(fullOutput.length + o.length)) {\n        let remainingFingerprint = this.storage.fingerprint(upper, storageSize);\n        fullOutput.extend(this.encodeBound(this._bound(Number.MAX_VALUE)));\n        fullOutput.extend(encodeVarInt(Mode.Fingerprint));\n        fullOutput.extend(remainingFingerprint);\n        break;\n      } else {\n        fullOutput.extend(o);\n      }\n      prevIndex = upper;\n      prevBound = currBound;\n    }\n    return fullOutput.length === 1 ? null : (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(fullOutput.unwrap());\n  }\n  splitRange(lower, upper, upperBound, o) {\n    let numElems = upper - lower;\n    let buckets = 16;\n    if (numElems < buckets * 2) {\n      o.extend(this.encodeBound(upperBound));\n      o.extend(encodeVarInt(Mode.IdList));\n      o.extend(encodeVarInt(numElems));\n      this.storage.iterate(lower, upper, (item) => {\n        o.extend(item.id);\n        return true;\n      });\n    } else {\n      let itemsPerBucket = Math.floor(numElems / buckets);\n      let bucketsWithExtra = numElems % buckets;\n      let curr = lower;\n      for (let i2 = 0; i2 < buckets; i2++) {\n        let bucketSize = itemsPerBucket + (i2 < bucketsWithExtra ? 1 : 0);\n        let ourFingerprint = this.storage.fingerprint(curr, curr + bucketSize);\n        curr += bucketSize;\n        let nextBound;\n        if (curr === upper) {\n          nextBound = upperBound;\n        } else {\n          let prevItem;\n          let currItem;\n          this.storage.iterate(curr - 1, curr + 1, (item, index) => {\n            if (index === curr - 1)\n              prevItem = item;\n            else\n              currItem = item;\n            return true;\n          });\n          nextBound = this.getMinimalBound(prevItem, currItem);\n        }\n        o.extend(this.encodeBound(nextBound));\n        o.extend(encodeVarInt(Mode.Fingerprint));\n        o.extend(ourFingerprint);\n      }\n    }\n  }\n  exceededFrameSizeLimit(n) {\n    return n > this.frameSizeLimit - 200;\n  }\n  decodeTimestampIn(encoded) {\n    let timestamp = decodeVarInt(encoded);\n    timestamp = timestamp === 0 ? Number.MAX_VALUE : timestamp - 1;\n    if (this.lastTimestampIn === Number.MAX_VALUE || timestamp === Number.MAX_VALUE) {\n      this.lastTimestampIn = Number.MAX_VALUE;\n      return Number.MAX_VALUE;\n    }\n    timestamp += this.lastTimestampIn;\n    this.lastTimestampIn = timestamp;\n    return timestamp;\n  }\n  decodeBound(encoded) {\n    let timestamp = this.decodeTimestampIn(encoded);\n    let len = decodeVarInt(encoded);\n    if (len > ID_SIZE)\n      throw Error(\"bound key too long\");\n    let id = getBytes(encoded, len);\n    return { timestamp, id };\n  }\n  encodeTimestampOut(timestamp) {\n    if (timestamp === Number.MAX_VALUE) {\n      this.lastTimestampOut = Number.MAX_VALUE;\n      return encodeVarInt(0);\n    }\n    let temp = timestamp;\n    timestamp -= this.lastTimestampOut;\n    this.lastTimestampOut = temp;\n    return encodeVarInt(timestamp + 1);\n  }\n  encodeBound(key) {\n    let output = new WrappedBuffer();\n    output.extend(this.encodeTimestampOut(key.timestamp));\n    output.extend(encodeVarInt(key.id.length));\n    output.extend(key.id);\n    return output;\n  }\n  getMinimalBound(prev, curr) {\n    if (curr.timestamp !== prev.timestamp) {\n      return this._bound(curr.timestamp);\n    } else {\n      let sharedPrefixBytes = 0;\n      let currKey = curr.id;\n      let prevKey = prev.id;\n      for (let i2 = 0; i2 < ID_SIZE; i2++) {\n        if (currKey[i2] !== prevKey[i2])\n          break;\n        sharedPrefixBytes++;\n      }\n      return this._bound(curr.timestamp, curr.id.subarray(0, sharedPrefixBytes + 1));\n    }\n  }\n};\nfunction compareUint8Array(a, b) {\n  for (let i2 = 0; i2 < a.byteLength; i2++) {\n    if (a[i2] < b[i2])\n      return -1;\n    if (a[i2] > b[i2])\n      return 1;\n  }\n  if (a.byteLength > b.byteLength)\n    return 1;\n  if (a.byteLength < b.byteLength)\n    return -1;\n  return 0;\n}\nfunction itemCompare(a, b) {\n  if (a.timestamp === b.timestamp) {\n    return compareUint8Array(a.id, b.id);\n  }\n  return a.timestamp - b.timestamp;\n}\nvar NegentropySync = class {\n  relay;\n  storage;\n  neg;\n  filter;\n  subscription;\n  onhave;\n  onneed;\n  constructor(relay, storage, filter, params = {}) {\n    this.relay = relay;\n    this.storage = storage;\n    this.neg = new Negentropy(storage);\n    this.onhave = params.onhave;\n    this.onneed = params.onneed;\n    this.filter = filter;\n    this.subscription = this.relay.prepareSubscription([{}], { label: params.label || \"negentropy\" });\n    this.subscription.oncustom = (data) => {\n      switch (data[0]) {\n        case \"NEG-MSG\": {\n          if (data.length < 3) {\n            console.warn(`got invalid NEG-MSG from ${this.relay.url}: ${data}`);\n          }\n          try {\n            const response = this.neg.reconcile(data[2], this.onhave, this.onneed);\n            if (response) {\n              this.relay.send(`[\"NEG-MSG\", \"${this.subscription.id}\", \"${response}\"]`);\n            } else {\n              this.close();\n              params.onclose?.();\n            }\n          } catch (error) {\n            console.error(\"negentropy reconcile error:\", error);\n            params?.onclose?.(`reconcile error: ${error}`);\n          }\n          break;\n        }\n        case \"NEG-CLOSE\": {\n          const reason = data[2];\n          console.warn(\"negentropy error:\", reason);\n          params.onclose?.(reason);\n          break;\n        }\n        case \"NEG-ERR\": {\n          params.onclose?.();\n        }\n      }\n    };\n  }\n  async start() {\n    const initMsg = this.neg.initiate();\n    this.relay.send(`[\"NEG-OPEN\",\"${this.subscription.id}\",${JSON.stringify(this.filter)},\"${initMsg}\"]`);\n  }\n  close() {\n    this.relay.send(`[\"NEG-CLOSE\",\"${this.subscription.id}\"]`);\n    this.subscription.close();\n  }\n};\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  hashPayload: () => hashPayload,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateEventKind: () => validateEventKind,\n  validateEventMethodTag: () => validateEventMethodTag,\n  validateEventPayloadTag: () => validateEventPayloadTag,\n  validateEventTimestamp: () => validateEventTimestamp,\n  validateEventUrlTag: () => validateEventUrlTag,\n  validateToken: () => validateToken\n});\n\n\n\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign, includeAuthorizationScheme = false, payload) {\n  const event = {\n    kind: HTTPAuth,\n    tags: [\n      [\"u\", loginUrl],\n      [\"method\", httpMethod]\n    ],\n    created_at: Math.round(new Date().getTime() / 1e3),\n    content: \"\"\n  };\n  if (payload) {\n    event.tags.push([\"payload\", hashPayload(payload)]);\n  }\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + _scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch((error) => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch((error) => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(_scure_base__WEBPACK_IMPORTED_MODULE_3__.base64.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nfunction validateEventTimestamp(event) {\n  if (!event.created_at) {\n    return false;\n  }\n  return Math.round(new Date().getTime() / 1e3) - event.created_at < 60;\n}\nfunction validateEventKind(event) {\n  return event.kind === HTTPAuth;\n}\nfunction validateEventUrlTag(event, url) {\n  const urlTag = event.tags.find((t) => t[0] === \"u\");\n  if (!urlTag) {\n    return false;\n  }\n  return urlTag.length > 0 && urlTag[1] === url;\n}\nfunction validateEventMethodTag(event, method) {\n  const methodTag = event.tags.find((t) => t[0] === \"method\");\n  if (!methodTag) {\n    return false;\n  }\n  return methodTag.length > 0 && methodTag[1].toLowerCase() === method.toLowerCase();\n}\nfunction hashPayload(payload) {\n  const hash = (0,_noble_hashes_sha2_js__WEBPACK_IMPORTED_MODULE_2__.sha256)(utf8Encoder.encode(JSON.stringify(payload)));\n  return (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_0__.bytesToHex)(hash);\n}\nfunction validateEventPayloadTag(event, payload) {\n  const payloadTag = event.tags.find((t) => t[0] === \"payload\");\n  if (!payloadTag) {\n    return false;\n  }\n  const payloadHash = hashPayload(payload);\n  return payloadTag.length > 0 && payloadTag[1] === payloadHash;\n}\nasync function validateEvent2(event, url, method, body) {\n  if (!verifyEvent(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (!validateEventKind(event)) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!validateEventTimestamp(event)) {\n    throw new Error(\"Invalid nostr event, created_at timestamp invalid\");\n  }\n  if (!validateEventUrlTag(event, url)) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  if (!validateEventMethodTag(event, method)) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  if (Boolean(body) && typeof body === \"object\" && Object.keys(body).length > 0) {\n    if (!validateEventPayloadTag(event, body)) {\n      throw new Error(\"Invalid nostr event, payload tag does not match request body hash\");\n    }\n  }\n  return true;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9ub3N0ci10b29scy9saWIvZXNtL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGtDQUFrQztBQUNoRTs7QUFFQTtBQUNxRDtBQUN5Qzs7QUFFOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxHQUFHO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix3QkFBd0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGdCQUFnQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDK0M7O0FBRS9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDhEQUFVO0FBQzlCLG9CQUFvQiw4REFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQytEO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLG9DQUFvQyxJQUFJO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLCtEQUFPO0FBQ2xCO0FBQ0E7QUFDQSxXQUFXLGtFQUFXLENBQUMsK0RBQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtFQUFXLENBQUMsK0RBQU87QUFDdEM7QUFDQSxnQkFBZ0Isa0VBQVcsQ0FBQywrREFBTyxNQUFNLGtFQUFXO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBTyxRQUFRLGtFQUFXLGFBQWEsa0VBQVcsUUFBUSxrRUFBVztBQUN6RjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkRBQU07QUFDeEIsU0FBUyxrRUFBVztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsUUFBUTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHFCQUFxQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHFCQUFxQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixtQkFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSw2QkFBNkIsTUFBTTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLE1BQU07QUFDbkM7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsU0FBUyw0QkFBNEIsTUFBTTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxTQUFTLElBQUksSUFBSTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdCQUF3QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELFNBQVM7QUFDN0Q7QUFDQTtBQUNBLGFBQWEscUZBQXFGO0FBQ2xHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCw4Q0FBOEMsMEJBQTBCO0FBQ3hFO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLDhDQUE4QywwQkFBMEI7QUFDeEUsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGlCQUFpQjtBQUN4RCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELFFBQVEsYUFBYSxlQUFlO0FBQ2hHO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw4REFBOEQ7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEyQ0UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL25vc3RyLXRvb2xzL2xpYi9lc20vaW5kZXguanM/ZGI5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7XG4gIGZvciAodmFyIG5hbWUgaW4gYWxsKVxuICAgIF9fZGVmUHJvcCh0YXJnZXQsIG5hbWUsIHsgZ2V0OiBhbGxbbmFtZV0sIGVudW1lcmFibGU6IHRydWUgfSk7XG59O1xuXG4vLyBwdXJlLnRzXG5pbXBvcnQgeyBzY2hub3JyIH0gZnJvbSBcIkBub2JsZS9jdXJ2ZXMvc2VjcDI1NmsxLmpzXCI7XG5pbXBvcnQgeyBieXRlc1RvSGV4IGFzIGJ5dGVzVG9IZXgyLCBoZXhUb0J5dGVzIGFzIGhleFRvQnl0ZXMyIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvdXRpbHMuanNcIjtcblxuLy8gY29yZS50c1xudmFyIHZlcmlmaWVkU3ltYm9sID0gU3ltYm9sKFwidmVyaWZpZWRcIik7XG52YXIgaXNSZWNvcmQgPSAob2JqKSA9PiBvYmogaW5zdGFuY2VvZiBPYmplY3Q7XG5mdW5jdGlvbiB2YWxpZGF0ZUV2ZW50KGV2ZW50KSB7XG4gIGlmICghaXNSZWNvcmQoZXZlbnQpKVxuICAgIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBldmVudC5raW5kICE9PSBcIm51bWJlclwiKVxuICAgIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBldmVudC5jb250ZW50ICE9PSBcInN0cmluZ1wiKVxuICAgIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBldmVudC5jcmVhdGVkX2F0ICE9PSBcIm51bWJlclwiKVxuICAgIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBldmVudC5wdWJrZXkgIT09IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuIGZhbHNlO1xuICBpZiAoIWV2ZW50LnB1YmtleS5tYXRjaCgvXlthLWYwLTldezY0fSQvKSlcbiAgICByZXR1cm4gZmFsc2U7XG4gIGlmICghQXJyYXkuaXNBcnJheShldmVudC50YWdzKSlcbiAgICByZXR1cm4gZmFsc2U7XG4gIGZvciAobGV0IGkyID0gMDsgaTIgPCBldmVudC50YWdzLmxlbmd0aDsgaTIrKykge1xuICAgIGxldCB0YWcgPSBldmVudC50YWdzW2kyXTtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFnKSlcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRhZy5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKHR5cGVvZiB0YWdbal0gIT09IFwic3RyaW5nXCIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBzb3J0RXZlbnRzKGV2ZW50cykge1xuICByZXR1cm4gZXZlbnRzLnNvcnQoKGEsIGIpID0+IHtcbiAgICBpZiAoYS5jcmVhdGVkX2F0ICE9PSBiLmNyZWF0ZWRfYXQpIHtcbiAgICAgIHJldHVybiBiLmNyZWF0ZWRfYXQgLSBhLmNyZWF0ZWRfYXQ7XG4gICAgfVxuICAgIHJldHVybiBhLmlkLmxvY2FsZUNvbXBhcmUoYi5pZCk7XG4gIH0pO1xufVxuXG4vLyBwdXJlLnRzXG5pbXBvcnQgeyBzaGEyNTYgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy9zaGEyLmpzXCI7XG5cbi8vIHV0aWxzLnRzXG52YXIgdXRpbHNfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQodXRpbHNfZXhwb3J0cywge1xuICBiaW5hcnlTZWFyY2g6ICgpID0+IGJpbmFyeVNlYXJjaCxcbiAgYnl0ZXNUb0hleDogKCkgPT4gYnl0ZXNUb0hleCxcbiAgaGV4VG9CeXRlczogKCkgPT4gaGV4VG9CeXRlcyxcbiAgaW5zZXJ0RXZlbnRJbnRvQXNjZW5kaW5nTGlzdDogKCkgPT4gaW5zZXJ0RXZlbnRJbnRvQXNjZW5kaW5nTGlzdCxcbiAgaW5zZXJ0RXZlbnRJbnRvRGVzY2VuZGluZ0xpc3Q6ICgpID0+IGluc2VydEV2ZW50SW50b0Rlc2NlbmRpbmdMaXN0LFxuICBtZXJnZVJldmVyc2VTb3J0ZWRMaXN0czogKCkgPT4gbWVyZ2VSZXZlcnNlU29ydGVkTGlzdHMsXG4gIG5vcm1hbGl6ZVVSTDogKCkgPT4gbm9ybWFsaXplVVJMLFxuICB1dGY4RGVjb2RlcjogKCkgPT4gdXRmOERlY29kZXIsXG4gIHV0ZjhFbmNvZGVyOiAoKSA9PiB1dGY4RW5jb2RlclxufSk7XG5pbXBvcnQgeyBieXRlc1RvSGV4LCBoZXhUb0J5dGVzIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvdXRpbHMuanNcIjtcbnZhciB1dGY4RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcihcInV0Zi04XCIpO1xudmFyIHV0ZjhFbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5mdW5jdGlvbiBub3JtYWxpemVVUkwodXJsKSB7XG4gIHRyeSB7XG4gICAgaWYgKHVybC5pbmRleE9mKFwiOi8vXCIpID09PSAtMSlcbiAgICAgIHVybCA9IFwid3NzOi8vXCIgKyB1cmw7XG4gICAgbGV0IHAgPSBuZXcgVVJMKHVybCk7XG4gICAgaWYgKHAucHJvdG9jb2wgPT09IFwiaHR0cDpcIilcbiAgICAgIHAucHJvdG9jb2wgPSBcIndzOlwiO1xuICAgIGVsc2UgaWYgKHAucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIpXG4gICAgICBwLnByb3RvY29sID0gXCJ3c3M6XCI7XG4gICAgcC5wYXRobmFtZSA9IHAucGF0aG5hbWUucmVwbGFjZSgvXFwvKy9nLCBcIi9cIik7XG4gICAgaWYgKHAucGF0aG5hbWUuZW5kc1dpdGgoXCIvXCIpKVxuICAgICAgcC5wYXRobmFtZSA9IHAucGF0aG5hbWUuc2xpY2UoMCwgLTEpO1xuICAgIGlmIChwLnBvcnQgPT09IFwiODBcIiAmJiBwLnByb3RvY29sID09PSBcIndzOlwiIHx8IHAucG9ydCA9PT0gXCI0NDNcIiAmJiBwLnByb3RvY29sID09PSBcIndzczpcIilcbiAgICAgIHAucG9ydCA9IFwiXCI7XG4gICAgcC5zZWFyY2hQYXJhbXMuc29ydCgpO1xuICAgIHAuaGFzaCA9IFwiXCI7XG4gICAgcmV0dXJuIHAudG9TdHJpbmcoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBVUkw6ICR7dXJsfWApO1xuICB9XG59XG5mdW5jdGlvbiBpbnNlcnRFdmVudEludG9EZXNjZW5kaW5nTGlzdChzb3J0ZWRBcnJheSwgZXZlbnQpIHtcbiAgY29uc3QgW2lkeCwgZm91bmRdID0gYmluYXJ5U2VhcmNoKHNvcnRlZEFycmF5LCAoYikgPT4ge1xuICAgIGlmIChldmVudC5pZCA9PT0gYi5pZClcbiAgICAgIHJldHVybiAwO1xuICAgIGlmIChldmVudC5jcmVhdGVkX2F0ID09PSBiLmNyZWF0ZWRfYXQpXG4gICAgICByZXR1cm4gLTE7XG4gICAgcmV0dXJuIGIuY3JlYXRlZF9hdCAtIGV2ZW50LmNyZWF0ZWRfYXQ7XG4gIH0pO1xuICBpZiAoIWZvdW5kKSB7XG4gICAgc29ydGVkQXJyYXkuc3BsaWNlKGlkeCwgMCwgZXZlbnQpO1xuICB9XG4gIHJldHVybiBzb3J0ZWRBcnJheTtcbn1cbmZ1bmN0aW9uIGluc2VydEV2ZW50SW50b0FzY2VuZGluZ0xpc3Qoc29ydGVkQXJyYXksIGV2ZW50KSB7XG4gIGNvbnN0IFtpZHgsIGZvdW5kXSA9IGJpbmFyeVNlYXJjaChzb3J0ZWRBcnJheSwgKGIpID0+IHtcbiAgICBpZiAoZXZlbnQuaWQgPT09IGIuaWQpXG4gICAgICByZXR1cm4gMDtcbiAgICBpZiAoZXZlbnQuY3JlYXRlZF9hdCA9PT0gYi5jcmVhdGVkX2F0KVxuICAgICAgcmV0dXJuIC0xO1xuICAgIHJldHVybiBldmVudC5jcmVhdGVkX2F0IC0gYi5jcmVhdGVkX2F0O1xuICB9KTtcbiAgaWYgKCFmb3VuZCkge1xuICAgIHNvcnRlZEFycmF5LnNwbGljZShpZHgsIDAsIGV2ZW50KTtcbiAgfVxuICByZXR1cm4gc29ydGVkQXJyYXk7XG59XG5mdW5jdGlvbiBiaW5hcnlTZWFyY2goYXJyLCBjb21wYXJlKSB7XG4gIGxldCBzdGFydCA9IDA7XG4gIGxldCBlbmQgPSBhcnIubGVuZ3RoIC0gMTtcbiAgd2hpbGUgKHN0YXJ0IDw9IGVuZCkge1xuICAgIGNvbnN0IG1pZCA9IE1hdGguZmxvb3IoKHN0YXJ0ICsgZW5kKSAvIDIpO1xuICAgIGNvbnN0IGNtcCA9IGNvbXBhcmUoYXJyW21pZF0pO1xuICAgIGlmIChjbXAgPT09IDApIHtcbiAgICAgIHJldHVybiBbbWlkLCB0cnVlXTtcbiAgICB9XG4gICAgaWYgKGNtcCA8IDApIHtcbiAgICAgIGVuZCA9IG1pZCAtIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXJ0ID0gbWlkICsgMTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFtzdGFydCwgZmFsc2VdO1xufVxuZnVuY3Rpb24gbWVyZ2VSZXZlcnNlU29ydGVkTGlzdHMobGlzdDEsIGxpc3QyKSB7XG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBBcnJheShsaXN0MS5sZW5ndGggKyBsaXN0Mi5sZW5ndGgpO1xuICByZXN1bHQubGVuZ3RoID0gMDtcbiAgbGV0IGkxID0gMDtcbiAgbGV0IGkyID0gMDtcbiAgbGV0IHNhbWVUaW1lc3RhbXBJZHMgPSBbXTtcbiAgd2hpbGUgKGkxIDwgbGlzdDEubGVuZ3RoICYmIGkyIDwgbGlzdDIubGVuZ3RoKSB7XG4gICAgbGV0IG5leHQ7XG4gICAgaWYgKGxpc3QxW2kxXT8uY3JlYXRlZF9hdCA+IGxpc3QyW2kyXT8uY3JlYXRlZF9hdCkge1xuICAgICAgbmV4dCA9IGxpc3QxW2kxXTtcbiAgICAgIGkxKys7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5leHQgPSBsaXN0MltpMl07XG4gICAgICBpMisrO1xuICAgIH1cbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDAgJiYgcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXS5jcmVhdGVkX2F0ID09PSBuZXh0LmNyZWF0ZWRfYXQpIHtcbiAgICAgIGlmIChzYW1lVGltZXN0YW1wSWRzLmluY2x1ZGVzKG5leHQuaWQpKVxuICAgICAgICBjb250aW51ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2FtZVRpbWVzdGFtcElkcy5sZW5ndGggPSAwO1xuICAgIH1cbiAgICByZXN1bHQucHVzaChuZXh0KTtcbiAgICBzYW1lVGltZXN0YW1wSWRzLnB1c2gobmV4dC5pZCk7XG4gIH1cbiAgd2hpbGUgKGkxIDwgbGlzdDEubGVuZ3RoKSB7XG4gICAgY29uc3QgbmV4dCA9IGxpc3QxW2kxXTtcbiAgICBpMSsrO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCAmJiByZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdLmNyZWF0ZWRfYXQgPT09IG5leHQuY3JlYXRlZF9hdCkge1xuICAgICAgaWYgKHNhbWVUaW1lc3RhbXBJZHMuaW5jbHVkZXMobmV4dC5pZCkpXG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzYW1lVGltZXN0YW1wSWRzLmxlbmd0aCA9IDA7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKG5leHQpO1xuICAgIHNhbWVUaW1lc3RhbXBJZHMucHVzaChuZXh0LmlkKTtcbiAgfVxuICB3aGlsZSAoaTIgPCBsaXN0Mi5sZW5ndGgpIHtcbiAgICBjb25zdCBuZXh0ID0gbGlzdDJbaTJdO1xuICAgIGkyKys7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwICYmIHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0uY3JlYXRlZF9hdCA9PT0gbmV4dC5jcmVhdGVkX2F0KSB7XG4gICAgICBpZiAoc2FtZVRpbWVzdGFtcElkcy5pbmNsdWRlcyhuZXh0LmlkKSlcbiAgICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNhbWVUaW1lc3RhbXBJZHMubGVuZ3RoID0gMDtcbiAgICB9XG4gICAgcmVzdWx0LnB1c2gobmV4dCk7XG4gICAgc2FtZVRpbWVzdGFtcElkcy5wdXNoKG5leHQuaWQpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIHB1cmUudHNcbnZhciBKUyA9IGNsYXNzIHtcbiAgZ2VuZXJhdGVTZWNyZXRLZXkoKSB7XG4gICAgcmV0dXJuIHNjaG5vcnIudXRpbHMucmFuZG9tU2VjcmV0S2V5KCk7XG4gIH1cbiAgZ2V0UHVibGljS2V5KHNlY3JldEtleSkge1xuICAgIHJldHVybiBieXRlc1RvSGV4MihzY2hub3JyLmdldFB1YmxpY0tleShzZWNyZXRLZXkpKTtcbiAgfVxuICBmaW5hbGl6ZUV2ZW50KHQsIHNlY3JldEtleSkge1xuICAgIGNvbnN0IGV2ZW50ID0gdDtcbiAgICBldmVudC5wdWJrZXkgPSBieXRlc1RvSGV4MihzY2hub3JyLmdldFB1YmxpY0tleShzZWNyZXRLZXkpKTtcbiAgICBldmVudC5pZCA9IGdldEV2ZW50SGFzaChldmVudCk7XG4gICAgZXZlbnQuc2lnID0gYnl0ZXNUb0hleDIoc2Nobm9yci5zaWduKGhleFRvQnl0ZXMyKGdldEV2ZW50SGFzaChldmVudCkpLCBzZWNyZXRLZXkpKTtcbiAgICBldmVudFt2ZXJpZmllZFN5bWJvbF0gPSB0cnVlO1xuICAgIHJldHVybiBldmVudDtcbiAgfVxuICB2ZXJpZnlFdmVudChldmVudCkge1xuICAgIGlmICh0eXBlb2YgZXZlbnRbdmVyaWZpZWRTeW1ib2xdID09PSBcImJvb2xlYW5cIilcbiAgICAgIHJldHVybiBldmVudFt2ZXJpZmllZFN5bWJvbF07XG4gICAgY29uc3QgaGFzaCA9IGdldEV2ZW50SGFzaChldmVudCk7XG4gICAgaWYgKGhhc2ggIT09IGV2ZW50LmlkKSB7XG4gICAgICBldmVudFt2ZXJpZmllZFN5bWJvbF0gPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHZhbGlkID0gc2Nobm9yci52ZXJpZnkoaGV4VG9CeXRlczIoZXZlbnQuc2lnKSwgaGV4VG9CeXRlczIoaGFzaCksIGhleFRvQnl0ZXMyKGV2ZW50LnB1YmtleSkpO1xuICAgICAgZXZlbnRbdmVyaWZpZWRTeW1ib2xdID0gdmFsaWQ7XG4gICAgICByZXR1cm4gdmFsaWQ7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBldmVudFt2ZXJpZmllZFN5bWJvbF0gPSBmYWxzZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn07XG5mdW5jdGlvbiBzZXJpYWxpemVFdmVudChldnQpIHtcbiAgaWYgKCF2YWxpZGF0ZUV2ZW50KGV2dCkpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiY2FuJ3Qgc2VyaWFsaXplIGV2ZW50IHdpdGggd3Jvbmcgb3IgbWlzc2luZyBwcm9wZXJ0aWVzXCIpO1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoWzAsIGV2dC5wdWJrZXksIGV2dC5jcmVhdGVkX2F0LCBldnQua2luZCwgZXZ0LnRhZ3MsIGV2dC5jb250ZW50XSk7XG59XG5mdW5jdGlvbiBnZXRFdmVudEhhc2goZXZlbnQpIHtcbiAgbGV0IGV2ZW50SGFzaCA9IHNoYTI1Nih1dGY4RW5jb2Rlci5lbmNvZGUoc2VyaWFsaXplRXZlbnQoZXZlbnQpKSk7XG4gIHJldHVybiBieXRlc1RvSGV4MihldmVudEhhc2gpO1xufVxudmFyIGkgPSBuZXcgSlMoKTtcbnZhciBnZW5lcmF0ZVNlY3JldEtleSA9IGkuZ2VuZXJhdGVTZWNyZXRLZXk7XG52YXIgZ2V0UHVibGljS2V5ID0gaS5nZXRQdWJsaWNLZXk7XG52YXIgZmluYWxpemVFdmVudCA9IGkuZmluYWxpemVFdmVudDtcbnZhciB2ZXJpZnlFdmVudCA9IGkudmVyaWZ5RXZlbnQ7XG5cbi8vIGtpbmRzLnRzXG52YXIga2luZHNfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQoa2luZHNfZXhwb3J0cywge1xuICBBcHBsaWNhdGlvbjogKCkgPT4gQXBwbGljYXRpb24sXG4gIEJhZGdlQXdhcmQ6ICgpID0+IEJhZGdlQXdhcmQsXG4gIEJhZGdlRGVmaW5pdGlvbjogKCkgPT4gQmFkZ2VEZWZpbml0aW9uLFxuICBCbG9ja2VkUmVsYXlzTGlzdDogKCkgPT4gQmxvY2tlZFJlbGF5c0xpc3QsXG4gIEJsb3Nzb21TZXJ2ZXJMaXN0OiAoKSA9PiBCbG9zc29tU2VydmVyTGlzdCxcbiAgQm9va21hcmtMaXN0OiAoKSA9PiBCb29rbWFya0xpc3QsXG4gIEJvb2ttYXJrc2V0czogKCkgPT4gQm9va21hcmtzZXRzLFxuICBDYWxlbmRhcjogKCkgPT4gQ2FsZW5kYXIsXG4gIENhbGVuZGFyRXZlbnRSU1ZQOiAoKSA9PiBDYWxlbmRhckV2ZW50UlNWUCxcbiAgQ2hhbm5lbENyZWF0aW9uOiAoKSA9PiBDaGFubmVsQ3JlYXRpb24sXG4gIENoYW5uZWxIaWRlTWVzc2FnZTogKCkgPT4gQ2hhbm5lbEhpZGVNZXNzYWdlLFxuICBDaGFubmVsTWVzc2FnZTogKCkgPT4gQ2hhbm5lbE1lc3NhZ2UsXG4gIENoYW5uZWxNZXRhZGF0YTogKCkgPT4gQ2hhbm5lbE1ldGFkYXRhLFxuICBDaGFubmVsTXV0ZVVzZXI6ICgpID0+IENoYW5uZWxNdXRlVXNlcixcbiAgQ2hhdE1lc3NhZ2U6ICgpID0+IENoYXRNZXNzYWdlLFxuICBDbGFzc2lmaWVkTGlzdGluZzogKCkgPT4gQ2xhc3NpZmllZExpc3RpbmcsXG4gIENsaWVudEF1dGg6ICgpID0+IENsaWVudEF1dGgsXG4gIENvbW1lbnQ6ICgpID0+IENvbW1lbnQsXG4gIENvbW11bml0aWVzTGlzdDogKCkgPT4gQ29tbXVuaXRpZXNMaXN0LFxuICBDb21tdW5pdHlEZWZpbml0aW9uOiAoKSA9PiBDb21tdW5pdHlEZWZpbml0aW9uLFxuICBDb21tdW5pdHlQb3N0QXBwcm92YWw6ICgpID0+IENvbW11bml0eVBvc3RBcHByb3ZhbCxcbiAgQ29udGFjdHM6ICgpID0+IENvbnRhY3RzLFxuICBDcmVhdGVPclVwZGF0ZVByb2R1Y3Q6ICgpID0+IENyZWF0ZU9yVXBkYXRlUHJvZHVjdCxcbiAgQ3JlYXRlT3JVcGRhdGVTdGFsbDogKCkgPT4gQ3JlYXRlT3JVcGRhdGVTdGFsbCxcbiAgQ3VyYXRpb25zZXRzOiAoKSA9PiBDdXJhdGlvbnNldHMsXG4gIERhdGU6ICgpID0+IERhdGUyLFxuICBEaXJlY3RNZXNzYWdlUmVsYXlzTGlzdDogKCkgPT4gRGlyZWN0TWVzc2FnZVJlbGF5c0xpc3QsXG4gIERyYWZ0Q2xhc3NpZmllZExpc3Rpbmc6ICgpID0+IERyYWZ0Q2xhc3NpZmllZExpc3RpbmcsXG4gIERyYWZ0TG9uZzogKCkgPT4gRHJhZnRMb25nLFxuICBFbW9qaXNldHM6ICgpID0+IEVtb2ppc2V0cyxcbiAgRW5jcnlwdGVkRGlyZWN0TWVzc2FnZTogKCkgPT4gRW5jcnlwdGVkRGlyZWN0TWVzc2FnZSxcbiAgRXZlbnREZWxldGlvbjogKCkgPT4gRXZlbnREZWxldGlvbixcbiAgRmF2b3JpdGVSZWxheXM6ICgpID0+IEZhdm9yaXRlUmVsYXlzLFxuICBGaWxlTWVzc2FnZTogKCkgPT4gRmlsZU1lc3NhZ2UsXG4gIEZpbGVNZXRhZGF0YTogKCkgPT4gRmlsZU1ldGFkYXRhLFxuICBGaWxlU2VydmVyUHJlZmVyZW5jZTogKCkgPT4gRmlsZVNlcnZlclByZWZlcmVuY2UsXG4gIEZvbGxvd3NldHM6ICgpID0+IEZvbGxvd3NldHMsXG4gIEZvcnVtVGhyZWFkOiAoKSA9PiBGb3J1bVRocmVhZCxcbiAgR2VuZXJpY1JlcG9zdDogKCkgPT4gR2VuZXJpY1JlcG9zdCxcbiAgR2VuZXJpY2xpc3RzOiAoKSA9PiBHZW5lcmljbGlzdHMsXG4gIEdpZnRXcmFwOiAoKSA9PiBHaWZ0V3JhcCxcbiAgR3JvdXBNZXRhZGF0YTogKCkgPT4gR3JvdXBNZXRhZGF0YSxcbiAgSFRUUEF1dGg6ICgpID0+IEhUVFBBdXRoLFxuICBIYW5kbGVyaW5mb3JtYXRpb246ICgpID0+IEhhbmRsZXJpbmZvcm1hdGlvbixcbiAgSGFuZGxlcnJlY29tbWVuZGF0aW9uOiAoKSA9PiBIYW5kbGVycmVjb21tZW5kYXRpb24sXG4gIEhpZ2hsaWdodHM6ICgpID0+IEhpZ2hsaWdodHMsXG4gIEludGVyZXN0c0xpc3Q6ICgpID0+IEludGVyZXN0c0xpc3QsXG4gIEludGVyZXN0c2V0czogKCkgPT4gSW50ZXJlc3RzZXRzLFxuICBKb2JGZWVkYmFjazogKCkgPT4gSm9iRmVlZGJhY2ssXG4gIEpvYlJlcXVlc3Q6ICgpID0+IEpvYlJlcXVlc3QsXG4gIEpvYlJlc3VsdDogKCkgPT4gSm9iUmVzdWx0LFxuICBMYWJlbDogKCkgPT4gTGFiZWwsXG4gIExpZ2h0bmluZ1B1YlJQQzogKCkgPT4gTGlnaHRuaW5nUHViUlBDLFxuICBMaXZlQ2hhdE1lc3NhZ2U6ICgpID0+IExpdmVDaGF0TWVzc2FnZSxcbiAgTGl2ZUV2ZW50OiAoKSA9PiBMaXZlRXZlbnQsXG4gIExvbmdGb3JtQXJ0aWNsZTogKCkgPT4gTG9uZ0Zvcm1BcnRpY2xlLFxuICBNZXRhZGF0YTogKCkgPT4gTWV0YWRhdGEsXG4gIE11dGVsaXN0OiAoKSA9PiBNdXRlbGlzdCxcbiAgTldDV2FsbGV0SW5mbzogKCkgPT4gTldDV2FsbGV0SW5mbyxcbiAgTldDV2FsbGV0UmVxdWVzdDogKCkgPT4gTldDV2FsbGV0UmVxdWVzdCxcbiAgTldDV2FsbGV0UmVzcG9uc2U6ICgpID0+IE5XQ1dhbGxldFJlc3BvbnNlLFxuICBOb3JtYWxWaWRlbzogKCkgPT4gTm9ybWFsVmlkZW8sXG4gIE5vc3RyQ29ubmVjdDogKCkgPT4gTm9zdHJDb25uZWN0LFxuICBPcGVuVGltZXN0YW1wczogKCkgPT4gT3BlblRpbWVzdGFtcHMsXG4gIFBob3RvOiAoKSA9PiBQaG90byxcbiAgUGlubGlzdDogKCkgPT4gUGlubGlzdCxcbiAgUG9sbDogKCkgPT4gUG9sbCxcbiAgUG9sbFJlc3BvbnNlOiAoKSA9PiBQb2xsUmVzcG9uc2UsXG4gIFByaXZhdGVEaXJlY3RNZXNzYWdlOiAoKSA9PiBQcml2YXRlRGlyZWN0TWVzc2FnZSxcbiAgUHJvYmxlbVRyYWNrZXI6ICgpID0+IFByb2JsZW1UcmFja2VyLFxuICBQcm9maWxlQmFkZ2VzOiAoKSA9PiBQcm9maWxlQmFkZ2VzLFxuICBQdWJsaWNDaGF0c0xpc3Q6ICgpID0+IFB1YmxpY0NoYXRzTGlzdCxcbiAgUmVhY3Rpb246ICgpID0+IFJlYWN0aW9uLFxuICBSZWNvbW1lbmRSZWxheTogKCkgPT4gUmVjb21tZW5kUmVsYXksXG4gIFJlbGF5TGlzdDogKCkgPT4gUmVsYXlMaXN0LFxuICBSZWxheVJldmlldzogKCkgPT4gUmVsYXlSZXZpZXcsXG4gIFJlbGF5c2V0czogKCkgPT4gUmVsYXlzZXRzLFxuICBSZXBvcnQ6ICgpID0+IFJlcG9ydCxcbiAgUmVwb3J0aW5nOiAoKSA9PiBSZXBvcnRpbmcsXG4gIFJlcG9zdDogKCkgPT4gUmVwb3N0LFxuICBTZWFsOiAoKSA9PiBTZWFsLFxuICBTZWFyY2hSZWxheXNMaXN0OiAoKSA9PiBTZWFyY2hSZWxheXNMaXN0LFxuICBTaG9ydFRleHROb3RlOiAoKSA9PiBTaG9ydFRleHROb3RlLFxuICBTaG9ydFZpZGVvOiAoKSA9PiBTaG9ydFZpZGVvLFxuICBUaW1lOiAoKSA9PiBUaW1lLFxuICBVc2VyRW1vamlMaXN0OiAoKSA9PiBVc2VyRW1vamlMaXN0LFxuICBVc2VyU3RhdHVzZXM6ICgpID0+IFVzZXJTdGF0dXNlcyxcbiAgVm9pY2U6ICgpID0+IFZvaWNlLFxuICBWb2ljZUNvbW1lbnQ6ICgpID0+IFZvaWNlQ29tbWVudCxcbiAgWmFwOiAoKSA9PiBaYXAsXG4gIFphcEdvYWw6ICgpID0+IFphcEdvYWwsXG4gIFphcFJlcXVlc3Q6ICgpID0+IFphcFJlcXVlc3QsXG4gIGNsYXNzaWZ5S2luZDogKCkgPT4gY2xhc3NpZnlLaW5kLFxuICBpc0FkZHJlc3NhYmxlS2luZDogKCkgPT4gaXNBZGRyZXNzYWJsZUtpbmQsXG4gIGlzRXBoZW1lcmFsS2luZDogKCkgPT4gaXNFcGhlbWVyYWxLaW5kLFxuICBpc0tpbmQ6ICgpID0+IGlzS2luZCxcbiAgaXNSZWd1bGFyS2luZDogKCkgPT4gaXNSZWd1bGFyS2luZCxcbiAgaXNSZXBsYWNlYWJsZUtpbmQ6ICgpID0+IGlzUmVwbGFjZWFibGVLaW5kXG59KTtcbmZ1bmN0aW9uIGlzUmVndWxhcktpbmQoa2luZCkge1xuICByZXR1cm4ga2luZCA8IDFlNCAmJiBraW5kICE9PSAwICYmIGtpbmQgIT09IDM7XG59XG5mdW5jdGlvbiBpc1JlcGxhY2VhYmxlS2luZChraW5kKSB7XG4gIHJldHVybiBraW5kID09PSAwIHx8IGtpbmQgPT09IDMgfHwgMWU0IDw9IGtpbmQgJiYga2luZCA8IDJlNDtcbn1cbmZ1bmN0aW9uIGlzRXBoZW1lcmFsS2luZChraW5kKSB7XG4gIHJldHVybiAyZTQgPD0ga2luZCAmJiBraW5kIDwgM2U0O1xufVxuZnVuY3Rpb24gaXNBZGRyZXNzYWJsZUtpbmQoa2luZCkge1xuICByZXR1cm4gM2U0IDw9IGtpbmQgJiYga2luZCA8IDRlNDtcbn1cbmZ1bmN0aW9uIGNsYXNzaWZ5S2luZChraW5kKSB7XG4gIGlmIChpc1JlZ3VsYXJLaW5kKGtpbmQpKVxuICAgIHJldHVybiBcInJlZ3VsYXJcIjtcbiAgaWYgKGlzUmVwbGFjZWFibGVLaW5kKGtpbmQpKVxuICAgIHJldHVybiBcInJlcGxhY2VhYmxlXCI7XG4gIGlmIChpc0VwaGVtZXJhbEtpbmQoa2luZCkpXG4gICAgcmV0dXJuIFwiZXBoZW1lcmFsXCI7XG4gIGlmIChpc0FkZHJlc3NhYmxlS2luZChraW5kKSlcbiAgICByZXR1cm4gXCJwYXJhbWV0ZXJpemVkXCI7XG4gIHJldHVybiBcInVua25vd25cIjtcbn1cbmZ1bmN0aW9uIGlzS2luZChldmVudCwga2luZCkge1xuICBjb25zdCBraW5kQXNBcnJheSA9IGtpbmQgaW5zdGFuY2VvZiBBcnJheSA/IGtpbmQgOiBba2luZF07XG4gIHJldHVybiB2YWxpZGF0ZUV2ZW50KGV2ZW50KSAmJiBraW5kQXNBcnJheS5pbmNsdWRlcyhldmVudC5raW5kKSB8fCBmYWxzZTtcbn1cbnZhciBNZXRhZGF0YSA9IDA7XG52YXIgU2hvcnRUZXh0Tm90ZSA9IDE7XG52YXIgUmVjb21tZW5kUmVsYXkgPSAyO1xudmFyIENvbnRhY3RzID0gMztcbnZhciBFbmNyeXB0ZWREaXJlY3RNZXNzYWdlID0gNDtcbnZhciBFdmVudERlbGV0aW9uID0gNTtcbnZhciBSZXBvc3QgPSA2O1xudmFyIFJlYWN0aW9uID0gNztcbnZhciBCYWRnZUF3YXJkID0gODtcbnZhciBDaGF0TWVzc2FnZSA9IDk7XG52YXIgRm9ydW1UaHJlYWQgPSAxMTtcbnZhciBTZWFsID0gMTM7XG52YXIgUHJpdmF0ZURpcmVjdE1lc3NhZ2UgPSAxNDtcbnZhciBGaWxlTWVzc2FnZSA9IDE1O1xudmFyIEdlbmVyaWNSZXBvc3QgPSAxNjtcbnZhciBQaG90byA9IDIwO1xudmFyIE5vcm1hbFZpZGVvID0gMjE7XG52YXIgU2hvcnRWaWRlbyA9IDIyO1xudmFyIENoYW5uZWxDcmVhdGlvbiA9IDQwO1xudmFyIENoYW5uZWxNZXRhZGF0YSA9IDQxO1xudmFyIENoYW5uZWxNZXNzYWdlID0gNDI7XG52YXIgQ2hhbm5lbEhpZGVNZXNzYWdlID0gNDM7XG52YXIgQ2hhbm5lbE11dGVVc2VyID0gNDQ7XG52YXIgT3BlblRpbWVzdGFtcHMgPSAxMDQwO1xudmFyIEdpZnRXcmFwID0gMTA1OTtcbnZhciBQb2xsID0gMTA2ODtcbnZhciBGaWxlTWV0YWRhdGEgPSAxMDYzO1xudmFyIENvbW1lbnQgPSAxMTExO1xudmFyIExpdmVDaGF0TWVzc2FnZSA9IDEzMTE7XG52YXIgVm9pY2UgPSAxMjIyO1xudmFyIFZvaWNlQ29tbWVudCA9IDEyNDQ7XG52YXIgUHJvYmxlbVRyYWNrZXIgPSAxOTcxO1xudmFyIFJlcG9ydCA9IDE5ODQ7XG52YXIgUmVwb3J0aW5nID0gMTk4NDtcbnZhciBMYWJlbCA9IDE5ODU7XG52YXIgQ29tbXVuaXR5UG9zdEFwcHJvdmFsID0gNDU1MDtcbnZhciBKb2JSZXF1ZXN0ID0gNTk5OTtcbnZhciBKb2JSZXN1bHQgPSA2OTk5O1xudmFyIEpvYkZlZWRiYWNrID0gN2UzO1xudmFyIFphcEdvYWwgPSA5MDQxO1xudmFyIFphcFJlcXVlc3QgPSA5NzM0O1xudmFyIFphcCA9IDk3MzU7XG52YXIgSGlnaGxpZ2h0cyA9IDk4MDI7XG52YXIgUG9sbFJlc3BvbnNlID0gMTAxODtcbnZhciBNdXRlbGlzdCA9IDFlNDtcbnZhciBQaW5saXN0ID0gMTAwMDE7XG52YXIgUmVsYXlMaXN0ID0gMTAwMDI7XG52YXIgQm9va21hcmtMaXN0ID0gMTAwMDM7XG52YXIgQ29tbXVuaXRpZXNMaXN0ID0gMTAwMDQ7XG52YXIgUHVibGljQ2hhdHNMaXN0ID0gMTAwMDU7XG52YXIgQmxvY2tlZFJlbGF5c0xpc3QgPSAxMDAwNjtcbnZhciBTZWFyY2hSZWxheXNMaXN0ID0gMTAwMDc7XG52YXIgRmF2b3JpdGVSZWxheXMgPSAxMDAxMjtcbnZhciBJbnRlcmVzdHNMaXN0ID0gMTAwMTU7XG52YXIgVXNlckVtb2ppTGlzdCA9IDEwMDMwO1xudmFyIERpcmVjdE1lc3NhZ2VSZWxheXNMaXN0ID0gMTAwNTA7XG52YXIgRmlsZVNlcnZlclByZWZlcmVuY2UgPSAxMDA5NjtcbnZhciBCbG9zc29tU2VydmVyTGlzdCA9IDEwMDYzO1xudmFyIE5XQ1dhbGxldEluZm8gPSAxMzE5NDtcbnZhciBMaWdodG5pbmdQdWJSUEMgPSAyMWUzO1xudmFyIENsaWVudEF1dGggPSAyMjI0MjtcbnZhciBOV0NXYWxsZXRSZXF1ZXN0ID0gMjMxOTQ7XG52YXIgTldDV2FsbGV0UmVzcG9uc2UgPSAyMzE5NTtcbnZhciBOb3N0ckNvbm5lY3QgPSAyNDEzMztcbnZhciBIVFRQQXV0aCA9IDI3MjM1O1xudmFyIEZvbGxvd3NldHMgPSAzZTQ7XG52YXIgR2VuZXJpY2xpc3RzID0gMzAwMDE7XG52YXIgUmVsYXlzZXRzID0gMzAwMDI7XG52YXIgQm9va21hcmtzZXRzID0gMzAwMDM7XG52YXIgQ3VyYXRpb25zZXRzID0gMzAwMDQ7XG52YXIgUHJvZmlsZUJhZGdlcyA9IDMwMDA4O1xudmFyIEJhZGdlRGVmaW5pdGlvbiA9IDMwMDA5O1xudmFyIEludGVyZXN0c2V0cyA9IDMwMDE1O1xudmFyIENyZWF0ZU9yVXBkYXRlU3RhbGwgPSAzMDAxNztcbnZhciBDcmVhdGVPclVwZGF0ZVByb2R1Y3QgPSAzMDAxODtcbnZhciBMb25nRm9ybUFydGljbGUgPSAzMDAyMztcbnZhciBEcmFmdExvbmcgPSAzMDAyNDtcbnZhciBFbW9qaXNldHMgPSAzMDAzMDtcbnZhciBBcHBsaWNhdGlvbiA9IDMwMDc4O1xudmFyIExpdmVFdmVudCA9IDMwMzExO1xudmFyIFVzZXJTdGF0dXNlcyA9IDMwMzE1O1xudmFyIENsYXNzaWZpZWRMaXN0aW5nID0gMzA0MDI7XG52YXIgRHJhZnRDbGFzc2lmaWVkTGlzdGluZyA9IDMwNDAzO1xudmFyIERhdGUyID0gMzE5MjI7XG52YXIgVGltZSA9IDMxOTIzO1xudmFyIENhbGVuZGFyID0gMzE5MjQ7XG52YXIgQ2FsZW5kYXJFdmVudFJTVlAgPSAzMTkyNTtcbnZhciBSZWxheVJldmlldyA9IDMxOTg3O1xudmFyIEhhbmRsZXJyZWNvbW1lbmRhdGlvbiA9IDMxOTg5O1xudmFyIEhhbmRsZXJpbmZvcm1hdGlvbiA9IDMxOTkwO1xudmFyIENvbW11bml0eURlZmluaXRpb24gPSAzNDU1MDtcbnZhciBHcm91cE1ldGFkYXRhID0gMzllMztcblxuLy8gZmlsdGVyLnRzXG5mdW5jdGlvbiBtYXRjaEZpbHRlcihmaWx0ZXIsIGV2ZW50KSB7XG4gIGlmIChmaWx0ZXIuaWRzICYmIGZpbHRlci5pZHMuaW5kZXhPZihldmVudC5pZCkgPT09IC0xKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChmaWx0ZXIua2luZHMgJiYgZmlsdGVyLmtpbmRzLmluZGV4T2YoZXZlbnQua2luZCkgPT09IC0xKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChmaWx0ZXIuYXV0aG9ycyAmJiBmaWx0ZXIuYXV0aG9ycy5pbmRleE9mKGV2ZW50LnB1YmtleSkgPT09IC0xKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGZvciAobGV0IGYgaW4gZmlsdGVyKSB7XG4gICAgaWYgKGZbMF0gPT09IFwiI1wiKSB7XG4gICAgICBsZXQgdGFnTmFtZSA9IGYuc2xpY2UoMSk7XG4gICAgICBsZXQgdmFsdWVzID0gZmlsdGVyW2AjJHt0YWdOYW1lfWBdO1xuICAgICAgaWYgKHZhbHVlcyAmJiAhZXZlbnQudGFncy5maW5kKChbdCwgdl0pID0+IHQgPT09IGYuc2xpY2UoMSkgJiYgdmFsdWVzLmluZGV4T2YodikgIT09IC0xKSlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAoZmlsdGVyLnNpbmNlICYmIGV2ZW50LmNyZWF0ZWRfYXQgPCBmaWx0ZXIuc2luY2UpXG4gICAgcmV0dXJuIGZhbHNlO1xuICBpZiAoZmlsdGVyLnVudGlsICYmIGV2ZW50LmNyZWF0ZWRfYXQgPiBmaWx0ZXIudW50aWwpXG4gICAgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIG1hdGNoRmlsdGVycyhmaWx0ZXJzLCBldmVudCkge1xuICBmb3IgKGxldCBpMiA9IDA7IGkyIDwgZmlsdGVycy5sZW5ndGg7IGkyKyspIHtcbiAgICBpZiAobWF0Y2hGaWx0ZXIoZmlsdGVyc1tpMl0sIGV2ZW50KSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIG1lcmdlRmlsdGVycyguLi5maWx0ZXJzKSB7XG4gIGxldCByZXN1bHQgPSB7fTtcbiAgZm9yIChsZXQgaTIgPSAwOyBpMiA8IGZpbHRlcnMubGVuZ3RoOyBpMisrKSB7XG4gICAgbGV0IGZpbHRlciA9IGZpbHRlcnNbaTJdO1xuICAgIE9iamVjdC5lbnRyaWVzKGZpbHRlcikuZm9yRWFjaCgoW3Byb3BlcnR5LCB2YWx1ZXNdKSA9PiB7XG4gICAgICBpZiAocHJvcGVydHkgPT09IFwia2luZHNcIiB8fCBwcm9wZXJ0eSA9PT0gXCJpZHNcIiB8fCBwcm9wZXJ0eSA9PT0gXCJhdXRob3JzXCIgfHwgcHJvcGVydHlbMF0gPT09IFwiI1wiKSB7XG4gICAgICAgIHJlc3VsdFtwcm9wZXJ0eV0gPSByZXN1bHRbcHJvcGVydHldIHx8IFtdO1xuICAgICAgICBmb3IgKGxldCB2ID0gMDsgdiA8IHZhbHVlcy5sZW5ndGg7IHYrKykge1xuICAgICAgICAgIGxldCB2YWx1ZSA9IHZhbHVlc1t2XTtcbiAgICAgICAgICBpZiAoIXJlc3VsdFtwcm9wZXJ0eV0uaW5jbHVkZXModmFsdWUpKVxuICAgICAgICAgICAgcmVzdWx0W3Byb3BlcnR5XS5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChmaWx0ZXIubGltaXQgJiYgKCFyZXN1bHQubGltaXQgfHwgZmlsdGVyLmxpbWl0ID4gcmVzdWx0LmxpbWl0KSlcbiAgICAgIHJlc3VsdC5saW1pdCA9IGZpbHRlci5saW1pdDtcbiAgICBpZiAoZmlsdGVyLnVudGlsICYmICghcmVzdWx0LnVudGlsIHx8IGZpbHRlci51bnRpbCA+IHJlc3VsdC51bnRpbCkpXG4gICAgICByZXN1bHQudW50aWwgPSBmaWx0ZXIudW50aWw7XG4gICAgaWYgKGZpbHRlci5zaW5jZSAmJiAoIXJlc3VsdC5zaW5jZSB8fCBmaWx0ZXIuc2luY2UgPCByZXN1bHQuc2luY2UpKVxuICAgICAgcmVzdWx0LnNpbmNlID0gZmlsdGVyLnNpbmNlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRGaWx0ZXJMaW1pdChmaWx0ZXIpIHtcbiAgaWYgKGZpbHRlci5pZHMgJiYgIWZpbHRlci5pZHMubGVuZ3RoKVxuICAgIHJldHVybiAwO1xuICBpZiAoZmlsdGVyLmtpbmRzICYmICFmaWx0ZXIua2luZHMubGVuZ3RoKVxuICAgIHJldHVybiAwO1xuICBpZiAoZmlsdGVyLmF1dGhvcnMgJiYgIWZpbHRlci5hdXRob3JzLmxlbmd0aClcbiAgICByZXR1cm4gMDtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZmlsdGVyKSkge1xuICAgIGlmIChrZXlbMF0gPT09IFwiI1wiICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmICF2YWx1ZS5sZW5ndGgpXG4gICAgICByZXR1cm4gMDtcbiAgfVxuICByZXR1cm4gTWF0aC5taW4oXG4gICAgTWF0aC5tYXgoMCwgZmlsdGVyLmxpbWl0ID8/IEluZmluaXR5KSxcbiAgICBmaWx0ZXIuaWRzPy5sZW5ndGggPz8gSW5maW5pdHksXG4gICAgZmlsdGVyLmF1dGhvcnM/Lmxlbmd0aCAmJiBmaWx0ZXIua2luZHM/LmV2ZXJ5KChraW5kKSA9PiBpc1JlcGxhY2VhYmxlS2luZChraW5kKSkgPyBmaWx0ZXIuYXV0aG9ycy5sZW5ndGggKiBmaWx0ZXIua2luZHMubGVuZ3RoIDogSW5maW5pdHksXG4gICAgZmlsdGVyLmF1dGhvcnM/Lmxlbmd0aCAmJiBmaWx0ZXIua2luZHM/LmV2ZXJ5KChraW5kKSA9PiBpc0FkZHJlc3NhYmxlS2luZChraW5kKSkgJiYgZmlsdGVyW1wiI2RcIl0/Lmxlbmd0aCA/IGZpbHRlci5hdXRob3JzLmxlbmd0aCAqIGZpbHRlci5raW5kcy5sZW5ndGggKiBmaWx0ZXJbXCIjZFwiXS5sZW5ndGggOiBJbmZpbml0eVxuICApO1xufVxuXG4vLyBmYWtlanNvbi50c1xudmFyIGZha2Vqc29uX2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KGZha2Vqc29uX2V4cG9ydHMsIHtcbiAgZ2V0SGV4NjQ6ICgpID0+IGdldEhleDY0LFxuICBnZXRJbnQ6ICgpID0+IGdldEludCxcbiAgZ2V0U3Vic2NyaXB0aW9uSWQ6ICgpID0+IGdldFN1YnNjcmlwdGlvbklkLFxuICBtYXRjaEV2ZW50SWQ6ICgpID0+IG1hdGNoRXZlbnRJZCxcbiAgbWF0Y2hFdmVudEtpbmQ6ICgpID0+IG1hdGNoRXZlbnRLaW5kLFxuICBtYXRjaEV2ZW50UHVia2V5OiAoKSA9PiBtYXRjaEV2ZW50UHVia2V5XG59KTtcbmZ1bmN0aW9uIGdldEhleDY0KGpzb24sIGZpZWxkKSB7XG4gIGxldCBsZW4gPSBmaWVsZC5sZW5ndGggKyAzO1xuICBsZXQgaWR4ID0ganNvbi5pbmRleE9mKGBcIiR7ZmllbGR9XCI6YCkgKyBsZW47XG4gIGxldCBzID0ganNvbi5zbGljZShpZHgpLmluZGV4T2YoYFwiYCkgKyBpZHggKyAxO1xuICByZXR1cm4ganNvbi5zbGljZShzLCBzICsgNjQpO1xufVxuZnVuY3Rpb24gZ2V0SW50KGpzb24sIGZpZWxkKSB7XG4gIGxldCBsZW4gPSBmaWVsZC5sZW5ndGg7XG4gIGxldCBpZHggPSBqc29uLmluZGV4T2YoYFwiJHtmaWVsZH1cIjpgKSArIGxlbiArIDM7XG4gIGxldCBzbGljZWQgPSBqc29uLnNsaWNlKGlkeCk7XG4gIGxldCBlbmQgPSBNYXRoLm1pbihzbGljZWQuaW5kZXhPZihcIixcIiksIHNsaWNlZC5pbmRleE9mKFwifVwiKSk7XG4gIHJldHVybiBwYXJzZUludChzbGljZWQuc2xpY2UoMCwgZW5kKSwgMTApO1xufVxuZnVuY3Rpb24gZ2V0U3Vic2NyaXB0aW9uSWQoanNvbikge1xuICBsZXQgaWR4ID0ganNvbi5zbGljZSgwLCAyMikuaW5kZXhPZihgXCJFVkVOVFwiYCk7XG4gIGlmIChpZHggPT09IC0xKVxuICAgIHJldHVybiBudWxsO1xuICBsZXQgcHN0YXJ0ID0ganNvbi5zbGljZShpZHggKyA3ICsgMSkuaW5kZXhPZihgXCJgKTtcbiAgaWYgKHBzdGFydCA9PT0gLTEpXG4gICAgcmV0dXJuIG51bGw7XG4gIGxldCBzdGFydCA9IGlkeCArIDcgKyAxICsgcHN0YXJ0O1xuICBsZXQgcGVuZCA9IGpzb24uc2xpY2Uoc3RhcnQgKyAxLCA4MCkuaW5kZXhPZihgXCJgKTtcbiAgaWYgKHBlbmQgPT09IC0xKVxuICAgIHJldHVybiBudWxsO1xuICBsZXQgZW5kID0gc3RhcnQgKyAxICsgcGVuZDtcbiAgcmV0dXJuIGpzb24uc2xpY2Uoc3RhcnQgKyAxLCBlbmQpO1xufVxuZnVuY3Rpb24gbWF0Y2hFdmVudElkKGpzb24sIGlkKSB7XG4gIHJldHVybiBpZCA9PT0gZ2V0SGV4NjQoanNvbiwgXCJpZFwiKTtcbn1cbmZ1bmN0aW9uIG1hdGNoRXZlbnRQdWJrZXkoanNvbiwgcHVia2V5KSB7XG4gIHJldHVybiBwdWJrZXkgPT09IGdldEhleDY0KGpzb24sIFwicHVia2V5XCIpO1xufVxuZnVuY3Rpb24gbWF0Y2hFdmVudEtpbmQoanNvbiwga2luZCkge1xuICByZXR1cm4ga2luZCA9PT0gZ2V0SW50KGpzb24sIFwia2luZFwiKTtcbn1cblxuLy8gbmlwNDIudHNcbnZhciBuaXA0Ml9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXA0Ml9leHBvcnRzLCB7XG4gIG1ha2VBdXRoRXZlbnQ6ICgpID0+IG1ha2VBdXRoRXZlbnRcbn0pO1xuZnVuY3Rpb24gbWFrZUF1dGhFdmVudChyZWxheVVSTCwgY2hhbGxlbmdlKSB7XG4gIHJldHVybiB7XG4gICAga2luZDogQ2xpZW50QXV0aCxcbiAgICBjcmVhdGVkX2F0OiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxZTMpLFxuICAgIHRhZ3M6IFtcbiAgICAgIFtcInJlbGF5XCIsIHJlbGF5VVJMXSxcbiAgICAgIFtcImNoYWxsZW5nZVwiLCBjaGFsbGVuZ2VdXG4gICAgXSxcbiAgICBjb250ZW50OiBcIlwiXG4gIH07XG59XG5cbi8vIGFic3RyYWN0LXJlbGF5LnRzXG52YXIgU2VuZGluZ09uQ2xvc2VkQ29ubmVjdGlvbiA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCByZWxheSkge1xuICAgIHN1cGVyKGBUcmllZCB0byBzZW5kIG1lc3NhZ2UgJyR7bWVzc2FnZX0gb24gYSBjbG9zZWQgY29ubmVjdGlvbiB0byAke3JlbGF5fS5gKTtcbiAgICB0aGlzLm5hbWUgPSBcIlNlbmRpbmdPbkNsb3NlZENvbm5lY3Rpb25cIjtcbiAgfVxufTtcbnZhciBBYnN0cmFjdFJlbGF5ID0gY2xhc3Mge1xuICB1cmw7XG4gIF9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgb25jbG9zZSA9IG51bGw7XG4gIG9ubm90aWNlID0gKG1zZykgPT4gY29uc29sZS5kZWJ1ZyhgTk9USUNFIGZyb20gJHt0aGlzLnVybH06ICR7bXNnfWApO1xuICBvbmF1dGg7XG4gIGJhc2VFb3NlVGltZW91dCA9IDQ0MDA7XG4gIHB1Ymxpc2hUaW1lb3V0ID0gNDQwMDtcbiAgcGluZ0ZyZXF1ZW5jeSA9IDI5ZTM7XG4gIHBpbmdUaW1lb3V0ID0gMmU0O1xuICByZXN1YnNjcmliZUJhY2tvZmYgPSBbMWU0LCAxZTQsIDFlNCwgMmU0LCAyZTQsIDNlNCwgNmU0XTtcbiAgb3BlblN1YnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBlbmFibGVQaW5nO1xuICBlbmFibGVSZWNvbm5lY3Q7XG4gIGlkbGVTaW5jZSA9IERhdGUubm93KCk7XG4gIG9uZ29pbmdPcGVyYXRpb25zID0gMDtcbiAgcmVjb25uZWN0VGltZW91dEhhbmRsZTtcbiAgcGluZ0ludGVydmFsSGFuZGxlO1xuICByZWNvbm5lY3RBdHRlbXB0cyA9IDA7XG4gIHNraXBSZWNvbm5lY3Rpb24gPSBmYWxzZTtcbiAgY29ubmVjdGlvblByb21pc2U7XG4gIG9wZW5Db3VudFJlcXVlc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgb3BlbkV2ZW50UHVibGlzaGVzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgd3M7XG4gIGNoYWxsZW5nZTtcbiAgYXV0aFByb21pc2U7XG4gIHNlcmlhbCA9IDA7XG4gIHZlcmlmeUV2ZW50O1xuICBfV2ViU29ja2V0O1xuICBjb25zdHJ1Y3Rvcih1cmwsIG9wdHMpIHtcbiAgICB0aGlzLnVybCA9IG5vcm1hbGl6ZVVSTCh1cmwpO1xuICAgIHRoaXMudmVyaWZ5RXZlbnQgPSBvcHRzLnZlcmlmeUV2ZW50O1xuICAgIHRoaXMuX1dlYlNvY2tldCA9IG9wdHMud2Vic29ja2V0SW1wbGVtZW50YXRpb24gfHwgV2ViU29ja2V0O1xuICAgIHRoaXMuZW5hYmxlUGluZyA9IG9wdHMuZW5hYmxlUGluZztcbiAgICB0aGlzLmVuYWJsZVJlY29ubmVjdCA9IG9wdHMuZW5hYmxlUmVjb25uZWN0IHx8IGZhbHNlO1xuICB9XG4gIHN0YXRpYyBhc3luYyBjb25uZWN0KHVybCwgb3B0cykge1xuICAgIGNvbnN0IHJlbGF5ID0gbmV3IEFic3RyYWN0UmVsYXkodXJsLCBvcHRzKTtcbiAgICBhd2FpdCByZWxheS5jb25uZWN0KG9wdHMpO1xuICAgIHJldHVybiByZWxheTtcbiAgfVxuICBjbG9zZUFsbFN1YnNjcmlwdGlvbnMocmVhc29uKSB7XG4gICAgZm9yIChsZXQgW18sIHN1Yl0gb2YgdGhpcy5vcGVuU3Vicykge1xuICAgICAgc3ViLmNsb3NlKHJlYXNvbik7XG4gICAgfVxuICAgIHRoaXMub3BlblN1YnMuY2xlYXIoKTtcbiAgICBmb3IgKGxldCBbXywgZXBdIG9mIHRoaXMub3BlbkV2ZW50UHVibGlzaGVzKSB7XG4gICAgICBlcC5yZWplY3QobmV3IEVycm9yKHJlYXNvbikpO1xuICAgIH1cbiAgICB0aGlzLm9wZW5FdmVudFB1Ymxpc2hlcy5jbGVhcigpO1xuICAgIGZvciAobGV0IFtfLCBjcl0gb2YgdGhpcy5vcGVuQ291bnRSZXF1ZXN0cykge1xuICAgICAgY3IucmVqZWN0KG5ldyBFcnJvcihyZWFzb24pKTtcbiAgICB9XG4gICAgdGhpcy5vcGVuQ291bnRSZXF1ZXN0cy5jbGVhcigpO1xuICB9XG4gIGdldCBjb25uZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Nvbm5lY3RlZDtcbiAgfVxuICBhc3luYyByZWNvbm5lY3QoKSB7XG4gICAgY29uc3QgYmFja29mZiA9IHRoaXMucmVzdWJzY3JpYmVCYWNrb2ZmW01hdGgubWluKHRoaXMucmVjb25uZWN0QXR0ZW1wdHMsIHRoaXMucmVzdWJzY3JpYmVCYWNrb2ZmLmxlbmd0aCAtIDEpXTtcbiAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzKys7XG4gICAgdGhpcy5yZWNvbm5lY3RUaW1lb3V0SGFuZGxlID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmNvbm5lY3QoKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgfVxuICAgIH0sIGJhY2tvZmYpO1xuICB9XG4gIGhhbmRsZUhhcmRDbG9zZShyZWFzb24pIHtcbiAgICBpZiAodGhpcy5waW5nSW50ZXJ2YWxIYW5kbGUpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5waW5nSW50ZXJ2YWxIYW5kbGUpO1xuICAgICAgdGhpcy5waW5nSW50ZXJ2YWxIYW5kbGUgPSB2b2lkIDA7XG4gICAgfVxuICAgIHRoaXMuX2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMuY29ubmVjdGlvblByb21pc2UgPSB2b2lkIDA7XG4gICAgdGhpcy5pZGxlU2luY2UgPSB2b2lkIDA7XG4gICAgaWYgKHRoaXMuZW5hYmxlUmVjb25uZWN0ICYmICF0aGlzLnNraXBSZWNvbm5lY3Rpb24pIHtcbiAgICAgIHRoaXMucmVjb25uZWN0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub25jbG9zZT8uKCk7XG4gICAgICB0aGlzLmNsb3NlQWxsU3Vic2NyaXB0aW9ucyhyZWFzb24pO1xuICAgIH1cbiAgfVxuICBhc3luYyBjb25uZWN0KG9wdHMpIHtcbiAgICBsZXQgY29ubmVjdGlvblRpbWVvdXRIYW5kbGU7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvblByb21pc2UpXG4gICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uUHJvbWlzZTtcbiAgICB0aGlzLmNoYWxsZW5nZSA9IHZvaWQgMDtcbiAgICB0aGlzLmF1dGhQcm9taXNlID0gdm9pZCAwO1xuICAgIHRoaXMuc2tpcFJlY29ubmVjdGlvbiA9IGZhbHNlO1xuICAgIHRoaXMuY29ubmVjdGlvblByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAob3B0cz8udGltZW91dCkge1xuICAgICAgICBjb25uZWN0aW9uVGltZW91dEhhbmRsZSA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHJlamVjdChcImNvbm5lY3Rpb24gdGltZWQgb3V0XCIpO1xuICAgICAgICAgIHRoaXMuY29ubmVjdGlvblByb21pc2UgPSB2b2lkIDA7XG4gICAgICAgICAgdGhpcy5za2lwUmVjb25uZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLm9uY2xvc2U/LigpO1xuICAgICAgICAgIHRoaXMuaGFuZGxlSGFyZENsb3NlKFwicmVsYXkgY29ubmVjdGlvbiB0aW1lZCBvdXRcIik7XG4gICAgICAgIH0sIG9wdHMudGltZW91dCk7XG4gICAgICB9XG4gICAgICBpZiAob3B0cz8uYWJvcnQpIHtcbiAgICAgICAgb3B0cy5hYm9ydC5vbmFib3J0ID0gcmVqZWN0O1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy53cyA9IG5ldyB0aGlzLl9XZWJTb2NrZXQodGhpcy51cmwpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChjb25uZWN0aW9uVGltZW91dEhhbmRsZSk7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLndzLm9ub3BlbiA9ICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25uZWN0VGltZW91dEhhbmRsZSkge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnJlY29ubmVjdFRpbWVvdXRIYW5kbGUpO1xuICAgICAgICAgIHRoaXMucmVjb25uZWN0VGltZW91dEhhbmRsZSA9IHZvaWQgMDtcbiAgICAgICAgfVxuICAgICAgICBjbGVhclRpbWVvdXQoY29ubmVjdGlvblRpbWVvdXRIYW5kbGUpO1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICBjb25zdCBpc1JlY29ubmVjdGlvbiA9IHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgPiAwO1xuICAgICAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBzdWIgb2YgdGhpcy5vcGVuU3Vicy52YWx1ZXMoKSkge1xuICAgICAgICAgIHN1Yi5lb3NlZCA9IGZhbHNlO1xuICAgICAgICAgIGlmIChpc1JlY29ubmVjdGlvbikge1xuICAgICAgICAgICAgZm9yIChsZXQgZiA9IDA7IGYgPCBzdWIuZmlsdGVycy5sZW5ndGg7IGYrKykge1xuICAgICAgICAgICAgICBpZiAoc3ViLmxhc3RFbWl0dGVkKSB7XG4gICAgICAgICAgICAgICAgc3ViLmZpbHRlcnNbZl0uc2luY2UgPSBzdWIubGFzdEVtaXR0ZWQgKyAxO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHN1Yi5maXJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlUGluZykge1xuICAgICAgICAgIHRoaXMucGluZ0ludGVydmFsSGFuZGxlID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5waW5ncG9uZygpLCB0aGlzLnBpbmdGcmVxdWVuY3kpO1xuICAgICAgICB9XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG4gICAgICB0aGlzLndzLm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgIGNsZWFyVGltZW91dChjb25uZWN0aW9uVGltZW91dEhhbmRsZSk7XG4gICAgICAgIHJlamVjdChcImNvbm5lY3Rpb24gZmFpbGVkXCIpO1xuICAgICAgICB0aGlzLmNvbm5lY3Rpb25Qcm9taXNlID0gdm9pZCAwO1xuICAgICAgICB0aGlzLnNraXBSZWNvbm5lY3Rpb24gPSB0cnVlO1xuICAgICAgICB0aGlzLm9uY2xvc2U/LigpO1xuICAgICAgICB0aGlzLmhhbmRsZUhhcmRDbG9zZShcInJlbGF5IGNvbm5lY3Rpb24gZmFpbGVkXCIpO1xuICAgICAgfTtcbiAgICAgIHRoaXMud3Mub25jbG9zZSA9IChldikgPT4ge1xuICAgICAgICBjbGVhclRpbWVvdXQoY29ubmVjdGlvblRpbWVvdXRIYW5kbGUpO1xuICAgICAgICByZWplY3QoZXYubWVzc2FnZSB8fCBcIndlYnNvY2tldCBjbG9zZWRcIik7XG4gICAgICAgIHRoaXMuaGFuZGxlSGFyZENsb3NlKFwicmVsYXkgY29ubmVjdGlvbiBjbG9zZWRcIik7XG4gICAgICB9O1xuICAgICAgdGhpcy53cy5vbm1lc3NhZ2UgPSB0aGlzLl9vbm1lc3NhZ2UuYmluZCh0aGlzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uUHJvbWlzZTtcbiAgfVxuICB3YWl0Rm9yUGluZ1BvbmcoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICA7XG4gICAgICB0aGlzLndzLm9uY2UoXCJwb25nXCIsICgpID0+IHJlc29sdmUodHJ1ZSkpO1xuICAgICAgdGhpcy53cy5waW5nKCk7XG4gICAgfSk7XG4gIH1cbiAgd2FpdEZvckR1bW15UmVxKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAoIXRoaXMuY29ubmVjdGlvblByb21pc2UpXG4gICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKGBubyBjb25uZWN0aW9uIHRvICR7dGhpcy51cmx9LCBjYW4ndCBwaW5nYCkpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc3ViID0gdGhpcy5zdWJzY3JpYmUoXG4gICAgICAgICAgW3sgaWRzOiBbXCJhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhXCJdLCBsaW1pdDogMCB9XSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogXCI8Zm9yY2VkLXBpbmc+XCIsXG4gICAgICAgICAgICBvbmVvc2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgc3ViLmNsb3NlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25jbG9zZSgpIHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlb3NlVGltZW91dDogdGhpcy5waW5nVGltZW91dCArIDFlM1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhc3luYyBwaW5ncG9uZygpIHtcbiAgICBpZiAodGhpcy53cz8ucmVhZHlTdGF0ZSA9PT0gMSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5hbnkoW1xuICAgICAgICB0aGlzLndzICYmIHRoaXMud3MucGluZyAmJiB0aGlzLndzLm9uY2UgPyB0aGlzLndhaXRGb3JQaW5nUG9uZygpIDogdGhpcy53YWl0Rm9yRHVtbXlSZXEoKSxcbiAgICAgICAgbmV3IFByb21pc2UoKHJlcykgPT4gc2V0VGltZW91dCgoKSA9PiByZXMoZmFsc2UpLCB0aGlzLnBpbmdUaW1lb3V0KSlcbiAgICAgIF0pO1xuICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgaWYgKHRoaXMud3M/LnJlYWR5U3RhdGUgPT09IHRoaXMuX1dlYlNvY2tldC5PUEVOKSB7XG4gICAgICAgICAgdGhpcy53cz8uY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBhc3luYyBzZW5kKG1lc3NhZ2UpIHtcbiAgICBpZiAoIXRoaXMuY29ubmVjdGlvblByb21pc2UpXG4gICAgICB0aHJvdyBuZXcgU2VuZGluZ09uQ2xvc2VkQ29ubmVjdGlvbihtZXNzYWdlLCB0aGlzLnVybCk7XG4gICAgdGhpcy5jb25uZWN0aW9uUHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMud3M/LnNlbmQobWVzc2FnZSk7XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgYXV0aChzaWduQXV0aEV2ZW50KSB7XG4gICAgY29uc3QgY2hhbGxlbmdlID0gdGhpcy5jaGFsbGVuZ2U7XG4gICAgaWYgKCFjaGFsbGVuZ2UpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW4ndCBwZXJmb3JtIGF1dGgsIG5vIGNoYWxsZW5nZSB3YXMgcmVjZWl2ZWRcIik7XG4gICAgaWYgKHRoaXMuYXV0aFByb21pc2UpXG4gICAgICByZXR1cm4gdGhpcy5hdXRoUHJvbWlzZTtcbiAgICB0aGlzLmF1dGhQcm9taXNlID0gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IGV2dCA9IGF3YWl0IHNpZ25BdXRoRXZlbnQobWFrZUF1dGhFdmVudCh0aGlzLnVybCwgY2hhbGxlbmdlKSk7XG4gICAgICAgIGxldCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgbGV0IGVwID0gdGhpcy5vcGVuRXZlbnRQdWJsaXNoZXMuZ2V0KGV2dC5pZCk7XG4gICAgICAgICAgaWYgKGVwKSB7XG4gICAgICAgICAgICBlcC5yZWplY3QobmV3IEVycm9yKFwiYXV0aCB0aW1lZCBvdXRcIikpO1xuICAgICAgICAgICAgdGhpcy5vcGVuRXZlbnRQdWJsaXNoZXMuZGVsZXRlKGV2dC5pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzLnB1Ymxpc2hUaW1lb3V0KTtcbiAgICAgICAgdGhpcy5vcGVuRXZlbnRQdWJsaXNoZXMuc2V0KGV2dC5pZCwgeyByZXNvbHZlLCByZWplY3QsIHRpbWVvdXQgfSk7XG4gICAgICAgIHRoaXMuc2VuZCgnW1wiQVVUSFwiLCcgKyBKU09OLnN0cmluZ2lmeShldnQpICsgXCJdXCIpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcInN1YnNjcmliZSBhdXRoIGZ1bmN0aW9uIGZhaWxlZDpcIiwgZXJyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5hdXRoUHJvbWlzZTtcbiAgfVxuICBhc3luYyBwdWJsaXNoKGV2ZW50KSB7XG4gICAgdGhpcy5pZGxlU2luY2UgPSB2b2lkIDA7XG4gICAgdGhpcy5vbmdvaW5nT3BlcmF0aW9ucysrO1xuICAgIGNvbnN0IHJldCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgZXAgPSB0aGlzLm9wZW5FdmVudFB1Ymxpc2hlcy5nZXQoZXZlbnQuaWQpO1xuICAgICAgICBpZiAoZXApIHtcbiAgICAgICAgICBlcC5yZWplY3QobmV3IEVycm9yKFwicHVibGlzaCB0aW1lZCBvdXRcIikpO1xuICAgICAgICAgIHRoaXMub3BlbkV2ZW50UHVibGlzaGVzLmRlbGV0ZShldmVudC5pZCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMucHVibGlzaFRpbWVvdXQpO1xuICAgICAgdGhpcy5vcGVuRXZlbnRQdWJsaXNoZXMuc2V0KGV2ZW50LmlkLCB7IHJlc29sdmUsIHJlamVjdCwgdGltZW91dCB9KTtcbiAgICB9KTtcbiAgICB0aGlzLnNlbmQoJ1tcIkVWRU5UXCIsJyArIEpTT04uc3RyaW5naWZ5KGV2ZW50KSArIFwiXVwiKTtcbiAgICB0aGlzLm9uZ29pbmdPcGVyYXRpb25zLS07XG4gICAgaWYgKHRoaXMub25nb2luZ09wZXJhdGlvbnMgPT09IDApXG4gICAgICB0aGlzLmlkbGVTaW5jZSA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuIHJldDtcbiAgfVxuICBhc3luYyBjb3VudChmaWx0ZXJzLCBwYXJhbXMpIHtcbiAgICB0aGlzLnNlcmlhbCsrO1xuICAgIGNvbnN0IGlkID0gcGFyYW1zPy5pZCB8fCBcImNvdW50OlwiICsgdGhpcy5zZXJpYWw7XG4gICAgY29uc3QgcmV0ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy5vcGVuQ291bnRSZXF1ZXN0cy5zZXQoaWQsIHsgcmVzb2x2ZSwgcmVqZWN0IH0pO1xuICAgIH0pO1xuICAgIHRoaXMuc2VuZCgnW1wiQ09VTlRcIixcIicgKyBpZCArICdcIiwnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVycykuc3Vic3RyaW5nKDEpKTtcbiAgICByZXR1cm4gcmV0O1xuICB9XG4gIHN1YnNjcmliZShmaWx0ZXJzLCBwYXJhbXMpIHtcbiAgICBpZiAocGFyYW1zLmxhYmVsICE9PSBcIjxmb3JjZWQtcGluZz5cIikge1xuICAgICAgdGhpcy5pZGxlU2luY2UgPSB2b2lkIDA7XG4gICAgICB0aGlzLm9uZ29pbmdPcGVyYXRpb25zKys7XG4gICAgfVxuICAgIGNvbnN0IHN1YiA9IHRoaXMucHJlcGFyZVN1YnNjcmlwdGlvbihmaWx0ZXJzLCBwYXJhbXMpO1xuICAgIHN1Yi5maXJlKCk7XG4gICAgaWYgKHBhcmFtcy5hYm9ydCkge1xuICAgICAgcGFyYW1zLmFib3J0Lm9uYWJvcnQgPSAoKSA9PiBzdWIuY2xvc2UoU3RyaW5nKHBhcmFtcy5hYm9ydC5yZWFzb24gfHwgXCI8YWJvcnRlZD5cIikpO1xuICAgIH1cbiAgICByZXR1cm4gc3ViO1xuICB9XG4gIHByZXBhcmVTdWJzY3JpcHRpb24oZmlsdGVycywgcGFyYW1zKSB7XG4gICAgdGhpcy5zZXJpYWwrKztcbiAgICBjb25zdCBpZCA9IHBhcmFtcy5pZCB8fCAocGFyYW1zLmxhYmVsID8gcGFyYW1zLmxhYmVsICsgXCI6XCIgOiBcInN1YjpcIikgKyB0aGlzLnNlcmlhbDtcbiAgICBjb25zdCBzdWIgPSBuZXcgU3Vic2NyaXB0aW9uKHRoaXMsIGlkLCBmaWx0ZXJzLCBwYXJhbXMpO1xuICAgIHRoaXMub3BlblN1YnMuc2V0KGlkLCBzdWIpO1xuICAgIHJldHVybiBzdWI7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5za2lwUmVjb25uZWN0aW9uID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5yZWNvbm5lY3RUaW1lb3V0SGFuZGxlKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lb3V0SGFuZGxlKTtcbiAgICAgIHRoaXMucmVjb25uZWN0VGltZW91dEhhbmRsZSA9IHZvaWQgMDtcbiAgICB9XG4gICAgaWYgKHRoaXMucGluZ0ludGVydmFsSGFuZGxlKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMucGluZ0ludGVydmFsSGFuZGxlKTtcbiAgICAgIHRoaXMucGluZ0ludGVydmFsSGFuZGxlID0gdm9pZCAwO1xuICAgIH1cbiAgICB0aGlzLmNsb3NlQWxsU3Vic2NyaXB0aW9ucyhcInJlbGF5IGNvbm5lY3Rpb24gY2xvc2VkIGJ5IHVzXCIpO1xuICAgIHRoaXMuX2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMuaWRsZVNpbmNlID0gdm9pZCAwO1xuICAgIHRoaXMub25jbG9zZT8uKCk7XG4gICAgaWYgKHRoaXMud3M/LnJlYWR5U3RhdGUgPT09IHRoaXMuX1dlYlNvY2tldC5PUEVOKSB7XG4gICAgICB0aGlzLndzPy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuICBfb25tZXNzYWdlKGV2KSB7XG4gICAgY29uc3QganNvbiA9IGV2LmRhdGE7XG4gICAgaWYgKCFqc29uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHN1YmlkID0gZ2V0U3Vic2NyaXB0aW9uSWQoanNvbik7XG4gICAgaWYgKHN1YmlkKSB7XG4gICAgICBjb25zdCBzbyA9IHRoaXMub3BlblN1YnMuZ2V0KHN1YmlkKTtcbiAgICAgIGlmICghc28pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgaWQgPSBnZXRIZXg2NChqc29uLCBcImlkXCIpO1xuICAgICAgY29uc3QgYWxyZWFkeUhhdmUgPSBzby5hbHJlYWR5SGF2ZUV2ZW50Py4oaWQpO1xuICAgICAgc28ucmVjZWl2ZWRFdmVudD8uKHRoaXMsIGlkKTtcbiAgICAgIGlmIChhbHJlYWR5SGF2ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICBzd2l0Y2ggKGRhdGFbMF0pIHtcbiAgICAgICAgY2FzZSBcIkVWRU5UXCI6IHtcbiAgICAgICAgICBjb25zdCBzbyA9IHRoaXMub3BlblN1YnMuZ2V0KGRhdGFbMV0pO1xuICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZGF0YVsyXTtcbiAgICAgICAgICBpZiAodGhpcy52ZXJpZnlFdmVudChldmVudCkgJiYgbWF0Y2hGaWx0ZXJzKHNvLmZpbHRlcnMsIGV2ZW50KSkge1xuICAgICAgICAgICAgc28ub25ldmVudChldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghc28ubGFzdEVtaXR0ZWQgfHwgc28ubGFzdEVtaXR0ZWQgPCBldmVudC5jcmVhdGVkX2F0KVxuICAgICAgICAgICAgc28ubGFzdEVtaXR0ZWQgPSBldmVudC5jcmVhdGVkX2F0O1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiQ09VTlRcIjoge1xuICAgICAgICAgIGNvbnN0IGlkID0gZGF0YVsxXTtcbiAgICAgICAgICBjb25zdCBwYXlsb2FkID0gZGF0YVsyXTtcbiAgICAgICAgICBjb25zdCBjciA9IHRoaXMub3BlbkNvdW50UmVxdWVzdHMuZ2V0KGlkKTtcbiAgICAgICAgICBpZiAoY3IpIHtcbiAgICAgICAgICAgIGNyLnJlc29sdmUocGF5bG9hZC5jb3VudCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5Db3VudFJlcXVlc3RzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiRU9TRVwiOiB7XG4gICAgICAgICAgY29uc3Qgc28gPSB0aGlzLm9wZW5TdWJzLmdldChkYXRhWzFdKTtcbiAgICAgICAgICBpZiAoIXNvKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIHNvLnJlY2VpdmVkRW9zZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiT0tcIjoge1xuICAgICAgICAgIGNvbnN0IGlkID0gZGF0YVsxXTtcbiAgICAgICAgICBjb25zdCBvayA9IGRhdGFbMl07XG4gICAgICAgICAgY29uc3QgcmVhc29uID0gZGF0YVszXTtcbiAgICAgICAgICBjb25zdCBlcCA9IHRoaXMub3BlbkV2ZW50UHVibGlzaGVzLmdldChpZCk7XG4gICAgICAgICAgaWYgKGVwKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoZXAudGltZW91dCk7XG4gICAgICAgICAgICBpZiAob2spXG4gICAgICAgICAgICAgIGVwLnJlc29sdmUocmVhc29uKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgZXAucmVqZWN0KG5ldyBFcnJvcihyZWFzb24pKTtcbiAgICAgICAgICAgIHRoaXMub3BlbkV2ZW50UHVibGlzaGVzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiQ0xPU0VEXCI6IHtcbiAgICAgICAgICBjb25zdCBpZCA9IGRhdGFbMV07XG4gICAgICAgICAgY29uc3Qgc28gPSB0aGlzLm9wZW5TdWJzLmdldChpZCk7XG4gICAgICAgICAgaWYgKCFzbylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICBzby5jbG9zZWQgPSB0cnVlO1xuICAgICAgICAgIHNvLmNsb3NlKGRhdGFbMl0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiTk9USUNFXCI6IHtcbiAgICAgICAgICB0aGlzLm9ubm90aWNlKGRhdGFbMV0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiQVVUSFwiOiB7XG4gICAgICAgICAgdGhpcy5jaGFsbGVuZ2UgPSBkYXRhWzFdO1xuICAgICAgICAgIGlmICh0aGlzLm9uYXV0aCkge1xuICAgICAgICAgICAgdGhpcy5hdXRoKHRoaXMub25hdXRoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICBjb25zdCBzbyA9IHRoaXMub3BlblN1YnMuZ2V0KGRhdGFbMV0pO1xuICAgICAgICAgIHNvPy5vbmN1c3RvbT8uKGRhdGEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc3QgW18sIF9fLCBldmVudF0gPSBKU09OLnBhcnNlKGpzb24pO1xuICAgICAgd2luZG93LnByaW50ZXIubWF5YmUoZXZlbnQucHVia2V5LCBcIjo6IGNhdWdodCBlcnJcIiwgZXZlbnQsIHRoaXMudXJsLCBlcnIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxufTtcbnZhciBTdWJzY3JpcHRpb24gPSBjbGFzcyB7XG4gIHJlbGF5O1xuICBpZDtcbiAgbGFzdEVtaXR0ZWQ7XG4gIGNsb3NlZCA9IGZhbHNlO1xuICBlb3NlZCA9IGZhbHNlO1xuICBmaWx0ZXJzO1xuICBhbHJlYWR5SGF2ZUV2ZW50O1xuICByZWNlaXZlZEV2ZW50O1xuICBvbmV2ZW50O1xuICBvbmVvc2U7XG4gIG9uY2xvc2U7XG4gIG9uY3VzdG9tO1xuICBlb3NlVGltZW91dDtcbiAgZW9zZVRpbWVvdXRIYW5kbGU7XG4gIGNvbnN0cnVjdG9yKHJlbGF5LCBpZCwgZmlsdGVycywgcGFyYW1zKSB7XG4gICAgaWYgKGZpbHRlcnMubGVuZ3RoID09PSAwKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwic3Vic2NyaXB0aW9uIGNhbid0IGJlIGNyZWF0ZWQgd2l0aCB6ZXJvIGZpbHRlcnNcIik7XG4gICAgdGhpcy5yZWxheSA9IHJlbGF5O1xuICAgIHRoaXMuZmlsdGVycyA9IGZpbHRlcnM7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMuYWxyZWFkeUhhdmVFdmVudCA9IHBhcmFtcy5hbHJlYWR5SGF2ZUV2ZW50O1xuICAgIHRoaXMucmVjZWl2ZWRFdmVudCA9IHBhcmFtcy5yZWNlaXZlZEV2ZW50O1xuICAgIHRoaXMuZW9zZVRpbWVvdXQgPSBwYXJhbXMuZW9zZVRpbWVvdXQgfHwgcmVsYXkuYmFzZUVvc2VUaW1lb3V0O1xuICAgIHRoaXMub25lb3NlID0gcGFyYW1zLm9uZW9zZTtcbiAgICB0aGlzLm9uY2xvc2UgPSBwYXJhbXMub25jbG9zZTtcbiAgICB0aGlzLm9uZXZlbnQgPSBwYXJhbXMub25ldmVudCB8fCAoKGV2ZW50KSA9PiB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBvbmV2ZW50KCkgY2FsbGJhY2sgbm90IGRlZmluZWQgZm9yIHN1YnNjcmlwdGlvbiAnJHt0aGlzLmlkfScgaW4gcmVsYXkgJHt0aGlzLnJlbGF5LnVybH0uIGV2ZW50IHJlY2VpdmVkOmAsXG4gICAgICAgIGV2ZW50XG4gICAgICApO1xuICAgIH0pO1xuICB9XG4gIGZpcmUoKSB7XG4gICAgdGhpcy5yZWxheS5zZW5kKCdbXCJSRVFcIixcIicgKyB0aGlzLmlkICsgJ1wiLCcgKyBKU09OLnN0cmluZ2lmeSh0aGlzLmZpbHRlcnMpLnN1YnN0cmluZygxKSk7XG4gICAgdGhpcy5lb3NlVGltZW91dEhhbmRsZSA9IHNldFRpbWVvdXQodGhpcy5yZWNlaXZlZEVvc2UuYmluZCh0aGlzKSwgdGhpcy5lb3NlVGltZW91dCk7XG4gIH1cbiAgcmVjZWl2ZWRFb3NlKCkge1xuICAgIGlmICh0aGlzLmVvc2VkKVxuICAgICAgcmV0dXJuO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmVvc2VUaW1lb3V0SGFuZGxlKTtcbiAgICB0aGlzLmVvc2VkID0gdHJ1ZTtcbiAgICB0aGlzLm9uZW9zZT8uKCk7XG4gIH1cbiAgY2xvc2UocmVhc29uID0gXCJjbG9zZWQgYnkgY2FsbGVyXCIpIHtcbiAgICBpZiAoIXRoaXMuY2xvc2VkICYmIHRoaXMucmVsYXkuY29ubmVjdGVkKSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLnJlbGF5LnNlbmQoJ1tcIkNMT1NFXCIsJyArIEpTT04uc3RyaW5naWZ5KHRoaXMuaWQpICsgXCJdXCIpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBTZW5kaW5nT25DbG9zZWRDb25uZWN0aW9uKSB7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLmNsb3NlZCA9IHRydWU7XG4gICAgfVxuICAgIHRoaXMucmVsYXkub3BlblN1YnMuZGVsZXRlKHRoaXMuaWQpO1xuICAgIHRoaXMucmVsYXkub25nb2luZ09wZXJhdGlvbnMtLTtcbiAgICBpZiAodGhpcy5yZWxheS5vbmdvaW5nT3BlcmF0aW9ucyA9PT0gMClcbiAgICAgIHRoaXMucmVsYXkuaWRsZVNpbmNlID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLm9uY2xvc2U/LihyZWFzb24pO1xuICB9XG59O1xuXG4vLyByZWxheS50c1xudmFyIF9XZWJTb2NrZXQ7XG50cnkge1xuICBfV2ViU29ja2V0ID0gV2ViU29ja2V0O1xufSBjYXRjaCB7XG59XG52YXIgUmVsYXkgPSBjbGFzcyBleHRlbmRzIEFic3RyYWN0UmVsYXkge1xuICBjb25zdHJ1Y3Rvcih1cmwsIG9wdGlvbnMpIHtcbiAgICBzdXBlcih1cmwsIHsgdmVyaWZ5RXZlbnQsIHdlYnNvY2tldEltcGxlbWVudGF0aW9uOiBfV2ViU29ja2V0LCAuLi5vcHRpb25zIH0pO1xuICB9XG4gIHN0YXRpYyBhc3luYyBjb25uZWN0KHVybCwgb3B0aW9ucykge1xuICAgIGNvbnN0IHJlbGF5ID0gbmV3IFJlbGF5KHVybCwgb3B0aW9ucyk7XG4gICAgYXdhaXQgcmVsYXkuY29ubmVjdCgpO1xuICAgIHJldHVybiByZWxheTtcbiAgfVxufTtcblxuLy8gaGVscGVycy50c1xudmFyIGFsd2F5c1RydWUgPSAodCkgPT4ge1xuICB0W3ZlcmlmaWVkU3ltYm9sXSA9IHRydWU7XG4gIHJldHVybiB0cnVlO1xufTtcblxuLy8gYWJzdHJhY3QtcG9vbC50c1xudmFyIEFic3RyYWN0U2ltcGxlUG9vbCA9IGNsYXNzIHtcbiAgcmVsYXlzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgc2Vlbk9uID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgdHJhY2tSZWxheXMgPSBmYWxzZTtcbiAgdmVyaWZ5RXZlbnQ7XG4gIGVuYWJsZVBpbmc7XG4gIGVuYWJsZVJlY29ubmVjdDtcbiAgYXV0b21hdGljYWxseUF1dGg7XG4gIHRydXN0ZWRSZWxheVVSTHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBvblJlbGF5Q29ubmVjdGlvbkZhaWx1cmU7XG4gIG9uUmVsYXlDb25uZWN0aW9uU3VjY2VzcztcbiAgYWxsb3dDb25uZWN0aW5nVG9SZWxheTtcbiAgbWF4V2FpdEZvckNvbm5lY3Rpb247XG4gIF9XZWJTb2NrZXQ7XG4gIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICB0aGlzLnZlcmlmeUV2ZW50ID0gb3B0cy52ZXJpZnlFdmVudDtcbiAgICB0aGlzLl9XZWJTb2NrZXQgPSBvcHRzLndlYnNvY2tldEltcGxlbWVudGF0aW9uO1xuICAgIHRoaXMuZW5hYmxlUGluZyA9IG9wdHMuZW5hYmxlUGluZztcbiAgICB0aGlzLmVuYWJsZVJlY29ubmVjdCA9IG9wdHMuZW5hYmxlUmVjb25uZWN0IHx8IGZhbHNlO1xuICAgIHRoaXMuYXV0b21hdGljYWxseUF1dGggPSBvcHRzLmF1dG9tYXRpY2FsbHlBdXRoO1xuICAgIHRoaXMub25SZWxheUNvbm5lY3Rpb25GYWlsdXJlID0gb3B0cy5vblJlbGF5Q29ubmVjdGlvbkZhaWx1cmU7XG4gICAgdGhpcy5vblJlbGF5Q29ubmVjdGlvblN1Y2Nlc3MgPSBvcHRzLm9uUmVsYXlDb25uZWN0aW9uU3VjY2VzcztcbiAgICB0aGlzLmFsbG93Q29ubmVjdGluZ1RvUmVsYXkgPSBvcHRzLmFsbG93Q29ubmVjdGluZ1RvUmVsYXk7XG4gICAgdGhpcy5tYXhXYWl0Rm9yQ29ubmVjdGlvbiA9IG9wdHMubWF4V2FpdEZvckNvbm5lY3Rpb24gfHwgM2UzO1xuICB9XG4gIGFzeW5jIGVuc3VyZVJlbGF5KHVybCwgcGFyYW1zKSB7XG4gICAgdXJsID0gbm9ybWFsaXplVVJMKHVybCk7XG4gICAgbGV0IHJlbGF5ID0gdGhpcy5yZWxheXMuZ2V0KHVybCk7XG4gICAgaWYgKCFyZWxheSkge1xuICAgICAgcmVsYXkgPSBuZXcgQWJzdHJhY3RSZWxheSh1cmwsIHtcbiAgICAgICAgdmVyaWZ5RXZlbnQ6IHRoaXMudHJ1c3RlZFJlbGF5VVJMcy5oYXModXJsKSA/IGFsd2F5c1RydWUgOiB0aGlzLnZlcmlmeUV2ZW50LFxuICAgICAgICB3ZWJzb2NrZXRJbXBsZW1lbnRhdGlvbjogdGhpcy5fV2ViU29ja2V0LFxuICAgICAgICBlbmFibGVQaW5nOiB0aGlzLmVuYWJsZVBpbmcsXG4gICAgICAgIGVuYWJsZVJlY29ubmVjdDogdGhpcy5lbmFibGVSZWNvbm5lY3RcbiAgICAgIH0pO1xuICAgICAgcmVsYXkub25jbG9zZSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5yZWxheXMuZGVsZXRlKHVybCk7XG4gICAgICB9O1xuICAgICAgdGhpcy5yZWxheXMuc2V0KHVybCwgcmVsYXkpO1xuICAgIH1cbiAgICBpZiAodGhpcy5hdXRvbWF0aWNhbGx5QXV0aCkge1xuICAgICAgY29uc3QgYXV0aFNpZ25lckZuID0gdGhpcy5hdXRvbWF0aWNhbGx5QXV0aCh1cmwpO1xuICAgICAgaWYgKGF1dGhTaWduZXJGbikge1xuICAgICAgICByZWxheS5vbmF1dGggPSBhdXRoU2lnbmVyRm47XG4gICAgICB9XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCByZWxheS5jb25uZWN0KHtcbiAgICAgICAgdGltZW91dDogcGFyYW1zPy5jb25uZWN0aW9uVGltZW91dCxcbiAgICAgICAgYWJvcnQ6IHBhcmFtcz8uYWJvcnRcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhpcy5yZWxheXMuZGVsZXRlKHVybCk7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIHJldHVybiByZWxheTtcbiAgfVxuICBjbG9zZShyZWxheXMpIHtcbiAgICByZWxheXMubWFwKG5vcm1hbGl6ZVVSTCkuZm9yRWFjaCgodXJsKSA9PiB7XG4gICAgICB0aGlzLnJlbGF5cy5nZXQodXJsKT8uY2xvc2UoKTtcbiAgICAgIHRoaXMucmVsYXlzLmRlbGV0ZSh1cmwpO1xuICAgIH0pO1xuICB9XG4gIHN1YnNjcmliZShyZWxheXMsIGZpbHRlciwgcGFyYW1zKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IFtdO1xuICAgIGNvbnN0IHVuaXFVcmxzID0gW107XG4gICAgZm9yIChsZXQgaTIgPSAwOyBpMiA8IHJlbGF5cy5sZW5ndGg7IGkyKyspIHtcbiAgICAgIGNvbnN0IHVybCA9IG5vcm1hbGl6ZVVSTChyZWxheXNbaTJdKTtcbiAgICAgIGlmICghcmVxdWVzdC5maW5kKChyKSA9PiByLnVybCA9PT0gdXJsKSkge1xuICAgICAgICBpZiAodW5pcVVybHMuaW5kZXhPZih1cmwpID09PSAtMSkge1xuICAgICAgICAgIHVuaXFVcmxzLnB1c2godXJsKTtcbiAgICAgICAgICByZXF1ZXN0LnB1c2goeyB1cmwsIGZpbHRlciB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmVNYXAocmVxdWVzdCwgcGFyYW1zKTtcbiAgfVxuICBzdWJzY3JpYmVNYW55KHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmUocmVsYXlzLCBmaWx0ZXIsIHBhcmFtcyk7XG4gIH1cbiAgc3Vic2NyaWJlTWFwKHJlcXVlc3RzLCBwYXJhbXMpIHtcbiAgICBjb25zdCBncm91cGVkID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICBmb3IgKGNvbnN0IHJlcSBvZiByZXF1ZXN0cykge1xuICAgICAgY29uc3QgeyB1cmwsIGZpbHRlciB9ID0gcmVxO1xuICAgICAgaWYgKCFncm91cGVkLmhhcyh1cmwpKVxuICAgICAgICBncm91cGVkLnNldCh1cmwsIFtdKTtcbiAgICAgIGdyb3VwZWQuZ2V0KHVybCkucHVzaChmaWx0ZXIpO1xuICAgIH1cbiAgICBjb25zdCBncm91cGVkUmVxdWVzdHMgPSBBcnJheS5mcm9tKGdyb3VwZWQuZW50cmllcygpKS5tYXAoKFt1cmwsIGZpbHRlcnNdKSA9PiAoeyB1cmwsIGZpbHRlcnMgfSkpO1xuICAgIGlmICh0aGlzLnRyYWNrUmVsYXlzKSB7XG4gICAgICBwYXJhbXMucmVjZWl2ZWRFdmVudCA9IChyZWxheSwgaWQpID0+IHtcbiAgICAgICAgbGV0IHNldCA9IHRoaXMuc2Vlbk9uLmdldChpZCk7XG4gICAgICAgIGlmICghc2V0KSB7XG4gICAgICAgICAgc2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICAgICAgICB0aGlzLnNlZW5Pbi5zZXQoaWQsIHNldCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0LmFkZChyZWxheSk7XG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBfa25vd25JZHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgIGNvbnN0IHN1YnMgPSBbXTtcbiAgICBjb25zdCBlb3Nlc1JlY2VpdmVkID0gW107XG4gICAgbGV0IGhhbmRsZUVvc2UgPSAoaTIpID0+IHtcbiAgICAgIGlmIChlb3Nlc1JlY2VpdmVkW2kyXSlcbiAgICAgICAgcmV0dXJuO1xuICAgICAgZW9zZXNSZWNlaXZlZFtpMl0gPSB0cnVlO1xuICAgICAgaWYgKGVvc2VzUmVjZWl2ZWQuZmlsdGVyKChhKSA9PiBhKS5sZW5ndGggPT09IGdyb3VwZWRSZXF1ZXN0cy5sZW5ndGgpIHtcbiAgICAgICAgcGFyYW1zLm9uZW9zZT8uKCk7XG4gICAgICAgIGhhbmRsZUVvc2UgPSAoKSA9PiB7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBjbG9zZXNSZWNlaXZlZCA9IFtdO1xuICAgIGxldCBoYW5kbGVDbG9zZSA9IChpMiwgcmVhc29uKSA9PiB7XG4gICAgICBpZiAoY2xvc2VzUmVjZWl2ZWRbaTJdKVxuICAgICAgICByZXR1cm47XG4gICAgICBoYW5kbGVFb3NlKGkyKTtcbiAgICAgIGNsb3Nlc1JlY2VpdmVkW2kyXSA9IHJlYXNvbjtcbiAgICAgIGlmIChjbG9zZXNSZWNlaXZlZC5maWx0ZXIoKGEpID0+IGEpLmxlbmd0aCA9PT0gZ3JvdXBlZFJlcXVlc3RzLmxlbmd0aCkge1xuICAgICAgICBwYXJhbXMub25jbG9zZT8uKGNsb3Nlc1JlY2VpdmVkKTtcbiAgICAgICAgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBsb2NhbEFscmVhZHlIYXZlRXZlbnRIYW5kbGVyID0gKGlkKSA9PiB7XG4gICAgICBpZiAocGFyYW1zLmFscmVhZHlIYXZlRXZlbnQ/LihpZCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBjb25zdCBoYXZlID0gX2tub3duSWRzLmhhcyhpZCk7XG4gICAgICBfa25vd25JZHMuYWRkKGlkKTtcbiAgICAgIHJldHVybiBoYXZlO1xuICAgIH07XG4gICAgY29uc3QgYWxsT3BlbmVkID0gUHJvbWlzZS5hbGwoXG4gICAgICBncm91cGVkUmVxdWVzdHMubWFwKGFzeW5jICh7IHVybCwgZmlsdGVycyB9LCBpMikgPT4ge1xuICAgICAgICBpZiAodGhpcy5hbGxvd0Nvbm5lY3RpbmdUb1JlbGF5Py4odXJsLCBbXCJyZWFkXCIsIGZpbHRlcnNdKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBoYW5kbGVDbG9zZShpMiwgXCJjb25uZWN0aW9uIHNraXBwZWQgYnkgYWxsb3dDb25uZWN0aW5nVG9SZWxheVwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlbGF5O1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJlbGF5ID0gYXdhaXQgdGhpcy5lbnN1cmVSZWxheSh1cmwsIHtcbiAgICAgICAgICAgIGNvbm5lY3Rpb25UaW1lb3V0OiB0aGlzLm1heFdhaXRGb3JDb25uZWN0aW9uIDwgKHBhcmFtcy5tYXhXYWl0IHx8IDApID8gTWF0aC5tYXgocGFyYW1zLm1heFdhaXQgKiAwLjgsIHBhcmFtcy5tYXhXYWl0IC0gMWUzKSA6IHRoaXMubWF4V2FpdEZvckNvbm5lY3Rpb24sXG4gICAgICAgICAgICBhYm9ydDogcGFyYW1zLmFib3J0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIHRoaXMub25SZWxheUNvbm5lY3Rpb25GYWlsdXJlPy4odXJsKTtcbiAgICAgICAgICBoYW5kbGVDbG9zZShpMiwgZXJyPy5tZXNzYWdlIHx8IFN0cmluZyhlcnIpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vblJlbGF5Q29ubmVjdGlvblN1Y2Nlc3M/Lih1cmwpO1xuICAgICAgICBsZXQgc3Vic2NyaXB0aW9uID0gcmVsYXkuc3Vic2NyaWJlKGZpbHRlcnMsIHtcbiAgICAgICAgICAuLi5wYXJhbXMsXG4gICAgICAgICAgb25lb3NlOiAoKSA9PiBoYW5kbGVFb3NlKGkyKSxcbiAgICAgICAgICBvbmNsb3NlOiAocmVhc29uKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVhc29uLnN0YXJ0c1dpdGgoXCJhdXRoLXJlcXVpcmVkOiBcIikgJiYgcGFyYW1zLm9uYXV0aCkge1xuICAgICAgICAgICAgICByZWxheS5hdXRoKHBhcmFtcy5vbmF1dGgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlbGF5LnN1YnNjcmliZShmaWx0ZXJzLCB7XG4gICAgICAgICAgICAgICAgICAuLi5wYXJhbXMsXG4gICAgICAgICAgICAgICAgICBvbmVvc2U6ICgpID0+IGhhbmRsZUVvc2UoaTIpLFxuICAgICAgICAgICAgICAgICAgb25jbG9zZTogKHJlYXNvbjIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlQ2xvc2UoaTIsIHJlYXNvbjIpO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGFscmVhZHlIYXZlRXZlbnQ6IGxvY2FsQWxyZWFkeUhhdmVFdmVudEhhbmRsZXIsXG4gICAgICAgICAgICAgICAgICBlb3NlVGltZW91dDogcGFyYW1zLm1heFdhaXQsXG4gICAgICAgICAgICAgICAgICBhYm9ydDogcGFyYW1zLmFib3J0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBoYW5kbGVDbG9zZShpMiwgYGF1dGggd2FzIHJlcXVpcmVkIGFuZCBhdHRlbXB0ZWQsIGJ1dCBmYWlsZWQgd2l0aDogJHtlcnJ9YCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaGFuZGxlQ2xvc2UoaTIsIHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhbHJlYWR5SGF2ZUV2ZW50OiBsb2NhbEFscmVhZHlIYXZlRXZlbnRIYW5kbGVyLFxuICAgICAgICAgIGVvc2VUaW1lb3V0OiBwYXJhbXMubWF4V2FpdCxcbiAgICAgICAgICBhYm9ydDogcGFyYW1zLmFib3J0XG4gICAgICAgIH0pO1xuICAgICAgICBzdWJzLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgICByZXR1cm4ge1xuICAgICAgYXN5bmMgY2xvc2UocmVhc29uKSB7XG4gICAgICAgIGF3YWl0IGFsbE9wZW5lZDtcbiAgICAgICAgc3Vicy5mb3JFYWNoKChzdWIpID0+IHtcbiAgICAgICAgICBzdWIuY2xvc2UocmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBzdWJzY3JpYmVFb3NlKHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpIHtcbiAgICBsZXQgc3ViY2xvc2VyO1xuICAgIHN1YmNsb3NlciA9IHRoaXMuc3Vic2NyaWJlKHJlbGF5cywgZmlsdGVyLCB7XG4gICAgICAuLi5wYXJhbXMsXG4gICAgICBvbmVvc2UoKSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbiA9IFwiY2xvc2VkIGF1dG9tYXRpY2FsbHkgb24gZW9zZVwiO1xuICAgICAgICBpZiAoc3ViY2xvc2VyKVxuICAgICAgICAgIHN1YmNsb3Nlci5jbG9zZShyZWFzb24pO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgcGFyYW1zLm9uY2xvc2U/LihyZWxheXMubWFwKChfKSA9PiByZWFzb24pKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3ViY2xvc2VyO1xuICB9XG4gIHN1YnNjcmliZU1hbnlFb3NlKHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmVFb3NlKHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpO1xuICB9XG4gIGFzeW5jIHF1ZXJ5U3luYyhyZWxheXMsIGZpbHRlciwgcGFyYW1zKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCBldmVudHMgPSBbXTtcbiAgICAgIHRoaXMuc3Vic2NyaWJlRW9zZShyZWxheXMsIGZpbHRlciwge1xuICAgICAgICAuLi5wYXJhbXMsXG4gICAgICAgIG9uZXZlbnQoZXZlbnQpIHtcbiAgICAgICAgICBldmVudHMucHVzaChldmVudCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uY2xvc2UoXykge1xuICAgICAgICAgIHJlc29sdmUoZXZlbnRzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgZ2V0KHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpIHtcbiAgICBmaWx0ZXIubGltaXQgPSAxO1xuICAgIGNvbnN0IGV2ZW50cyA9IGF3YWl0IHRoaXMucXVlcnlTeW5jKHJlbGF5cywgZmlsdGVyLCBwYXJhbXMpO1xuICAgIGV2ZW50cy5zb3J0KChhLCBiKSA9PiBiLmNyZWF0ZWRfYXQgLSBhLmNyZWF0ZWRfYXQpO1xuICAgIHJldHVybiBldmVudHNbMF0gfHwgbnVsbDtcbiAgfVxuICBwdWJsaXNoKHJlbGF5cywgZXZlbnQsIHBhcmFtcykge1xuICAgIHJldHVybiByZWxheXMubWFwKG5vcm1hbGl6ZVVSTCkubWFwKGFzeW5jICh1cmwsIGkyLCBhcnIpID0+IHtcbiAgICAgIGlmIChhcnIuaW5kZXhPZih1cmwpICE9PSBpMikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJkdXBsaWNhdGUgdXJsXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuYWxsb3dDb25uZWN0aW5nVG9SZWxheT8uKHVybCwgW1wid3JpdGVcIiwgZXZlbnRdKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiY29ubmVjdGlvbiBza2lwcGVkIGJ5IGFsbG93Q29ubmVjdGluZ1RvUmVsYXlcIik7XG4gICAgICB9XG4gICAgICBsZXQgcjtcbiAgICAgIHRyeSB7XG4gICAgICAgIHIgPSBhd2FpdCB0aGlzLmVuc3VyZVJlbGF5KHVybCwge1xuICAgICAgICAgIGNvbm5lY3Rpb25UaW1lb3V0OiB0aGlzLm1heFdhaXRGb3JDb25uZWN0aW9uIDwgKHBhcmFtcz8ubWF4V2FpdCB8fCAwKSA/IE1hdGgubWF4KHBhcmFtcy5tYXhXYWl0ICogMC44LCBwYXJhbXMubWF4V2FpdCAtIDFlMykgOiB0aGlzLm1heFdhaXRGb3JDb25uZWN0aW9uLFxuICAgICAgICAgIGFib3J0OiBwYXJhbXM/LmFib3J0XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRoaXMub25SZWxheUNvbm5lY3Rpb25GYWlsdXJlPy4odXJsKTtcbiAgICAgICAgcmV0dXJuIFN0cmluZyhcImNvbm5lY3Rpb24gZmFpbHVyZTogXCIgKyBTdHJpbmcoZXJyKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gci5wdWJsaXNoKGV2ZW50KS5jYXRjaChhc3luYyAoZXJyKSA9PiB7XG4gICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnIubWVzc2FnZS5zdGFydHNXaXRoKFwiYXV0aC1yZXF1aXJlZDogXCIpICYmIHBhcmFtcz8ub25hdXRoKSB7XG4gICAgICAgICAgYXdhaXQgci5hdXRoKHBhcmFtcy5vbmF1dGgpO1xuICAgICAgICAgIHJldHVybiByLnB1Ymxpc2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0pLnRoZW4oKHJlYXNvbikgPT4ge1xuICAgICAgICBpZiAodGhpcy50cmFja1JlbGF5cykge1xuICAgICAgICAgIGxldCBzZXQgPSB0aGlzLnNlZW5Pbi5nZXQoZXZlbnQuaWQpO1xuICAgICAgICAgIGlmICghc2V0KSB7XG4gICAgICAgICAgICBzZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgICAgICAgICAgdGhpcy5zZWVuT24uc2V0KGV2ZW50LmlkLCBzZXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZXQuYWRkKHIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWFzb247XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBsaXN0Q29ubmVjdGlvblN0YXR1cygpIHtcbiAgICBjb25zdCBtYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMucmVsYXlzLmZvckVhY2goKHJlbGF5LCB1cmwpID0+IG1hcC5zZXQodXJsLCByZWxheS5jb25uZWN0ZWQpKTtcbiAgICByZXR1cm4gbWFwO1xuICB9XG4gIGRlc3Ryb3koKSB7XG4gICAgdGhpcy5yZWxheXMuZm9yRWFjaCgoY29ubikgPT4gY29ubi5jbG9zZSgpKTtcbiAgICB0aGlzLnJlbGF5cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIH1cbiAgcHJ1bmVJZGxlUmVsYXlzKGlkbGVUaHJlc2hvbGRNcyA9IDFlNCkge1xuICAgIGNvbnN0IHBydW5lZFVybHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IFt1cmwsIHJlbGF5XSBvZiB0aGlzLnJlbGF5cykge1xuICAgICAgaWYgKHJlbGF5LmlkbGVTaW5jZSAmJiBEYXRlLm5vdygpIC0gcmVsYXkuaWRsZVNpbmNlID49IGlkbGVUaHJlc2hvbGRNcykge1xuICAgICAgICB0aGlzLnJlbGF5cy5kZWxldGUodXJsKTtcbiAgICAgICAgcHJ1bmVkVXJscy5wdXNoKHVybCk7XG4gICAgICAgIHJlbGF5LmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcnVuZWRVcmxzO1xuICB9XG59O1xuXG4vLyBwb29sLnRzXG52YXIgX1dlYlNvY2tldDI7XG50cnkge1xuICBfV2ViU29ja2V0MiA9IFdlYlNvY2tldDtcbn0gY2F0Y2gge1xufVxudmFyIFNpbXBsZVBvb2wgPSBjbGFzcyBleHRlbmRzIEFic3RyYWN0U2ltcGxlUG9vbCB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcih7IHZlcmlmeUV2ZW50LCB3ZWJzb2NrZXRJbXBsZW1lbnRhdGlvbjogX1dlYlNvY2tldDIsIG1heFdhaXRGb3JDb25uZWN0aW9uOiAzZTMsIC4uLm9wdGlvbnMgfSk7XG4gIH1cbn07XG5cbi8vIG5pcDE5LnRzXG52YXIgbmlwMTlfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQobmlwMTlfZXhwb3J0cywge1xuICBCRUNIMzJfUkVHRVg6ICgpID0+IEJFQ0gzMl9SRUdFWCxcbiAgQmVjaDMyTWF4U2l6ZTogKCkgPT4gQmVjaDMyTWF4U2l6ZSxcbiAgTm9zdHJUeXBlR3VhcmQ6ICgpID0+IE5vc3RyVHlwZUd1YXJkLFxuICBkZWNvZGU6ICgpID0+IGRlY29kZSxcbiAgZGVjb2RlTm9zdHJVUkk6ICgpID0+IGRlY29kZU5vc3RyVVJJLFxuICBlbmNvZGVCeXRlczogKCkgPT4gZW5jb2RlQnl0ZXMsXG4gIG5hZGRyRW5jb2RlOiAoKSA9PiBuYWRkckVuY29kZSxcbiAgbmV2ZW50RW5jb2RlOiAoKSA9PiBuZXZlbnRFbmNvZGUsXG4gIG5vdGVFbmNvZGU6ICgpID0+IG5vdGVFbmNvZGUsXG4gIG5wcm9maWxlRW5jb2RlOiAoKSA9PiBucHJvZmlsZUVuY29kZSxcbiAgbnB1YkVuY29kZTogKCkgPT4gbnB1YkVuY29kZSxcbiAgbnNlY0VuY29kZTogKCkgPT4gbnNlY0VuY29kZVxufSk7XG5pbXBvcnQgeyBieXRlc1RvSGV4IGFzIGJ5dGVzVG9IZXgzLCBjb25jYXRCeXRlcywgaGV4VG9CeXRlcyBhcyBoZXhUb0J5dGVzMyB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBiZWNoMzIgfSBmcm9tIFwiQHNjdXJlL2Jhc2VcIjtcbnZhciBOb3N0clR5cGVHdWFyZCA9IHtcbiAgaXNOUHJvZmlsZTogKHZhbHVlKSA9PiAvXm5wcm9maWxlMVthLXpcXGRdKyQvLnRlc3QodmFsdWUgfHwgXCJcIiksXG4gIGlzTkV2ZW50OiAodmFsdWUpID0+IC9ebmV2ZW50MVthLXpcXGRdKyQvLnRlc3QodmFsdWUgfHwgXCJcIiksXG4gIGlzTkFkZHI6ICh2YWx1ZSkgPT4gL15uYWRkcjFbYS16XFxkXSskLy50ZXN0KHZhbHVlIHx8IFwiXCIpLFxuICBpc05TZWM6ICh2YWx1ZSkgPT4gL15uc2VjMVthLXpcXGRdezU4fSQvLnRlc3QodmFsdWUgfHwgXCJcIiksXG4gIGlzTlB1YjogKHZhbHVlKSA9PiAvXm5wdWIxW2EtelxcZF17NTh9JC8udGVzdCh2YWx1ZSB8fCBcIlwiKSxcbiAgaXNOb3RlOiAodmFsdWUpID0+IC9ebm90ZTFbYS16XFxkXSskLy50ZXN0KHZhbHVlIHx8IFwiXCIpLFxuICBpc05jcnlwdHNlYzogKHZhbHVlKSA9PiAvXm5jcnlwdHNlYzFbYS16XFxkXSskLy50ZXN0KHZhbHVlIHx8IFwiXCIpXG59O1xudmFyIEJlY2gzMk1heFNpemUgPSA1ZTM7XG52YXIgQkVDSDMyX1JFR0VYID0gL1tcXHgyMS1cXHg3RV17MSw4M30xWzAyMzQ1Njc4OWFjZGVmZ2hqa2xtbnBxcnN0dXZ3eHl6XXs2LH0vO1xuZnVuY3Rpb24gaW50ZWdlclRvVWludDhBcnJheShudW1iZXIpIHtcbiAgY29uc3QgdWludDhBcnJheSA9IG5ldyBVaW50OEFycmF5KDQpO1xuICB1aW50OEFycmF5WzBdID0gbnVtYmVyID4+IDI0ICYgMjU1O1xuICB1aW50OEFycmF5WzFdID0gbnVtYmVyID4+IDE2ICYgMjU1O1xuICB1aW50OEFycmF5WzJdID0gbnVtYmVyID4+IDggJiAyNTU7XG4gIHVpbnQ4QXJyYXlbM10gPSBudW1iZXIgJiAyNTU7XG4gIHJldHVybiB1aW50OEFycmF5O1xufVxuZnVuY3Rpb24gZGVjb2RlTm9zdHJVUkkobmlwMTljb2RlKSB7XG4gIHRyeSB7XG4gICAgaWYgKG5pcDE5Y29kZS5zdGFydHNXaXRoKFwibm9zdHI6XCIpKVxuICAgICAgbmlwMTljb2RlID0gbmlwMTljb2RlLnN1YnN0cmluZyg2KTtcbiAgICByZXR1cm4gZGVjb2RlKG5pcDE5Y29kZSk7XG4gIH0gY2F0Y2ggKF9lcnIpIHtcbiAgICByZXR1cm4geyB0eXBlOiBcImludmFsaWRcIiwgZGF0YTogbnVsbCB9O1xuICB9XG59XG5mdW5jdGlvbiBkZWNvZGUoY29kZSkge1xuICBsZXQgeyBwcmVmaXgsIHdvcmRzIH0gPSBiZWNoMzIuZGVjb2RlKGNvZGUsIEJlY2gzMk1heFNpemUpO1xuICBsZXQgZGF0YSA9IG5ldyBVaW50OEFycmF5KGJlY2gzMi5mcm9tV29yZHMod29yZHMpKTtcbiAgc3dpdGNoIChwcmVmaXgpIHtcbiAgICBjYXNlIFwibnByb2ZpbGVcIjoge1xuICAgICAgbGV0IHRsdiA9IHBhcnNlVExWKGRhdGEpO1xuICAgICAgaWYgKCF0bHZbMF0/LlswXSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWlzc2luZyBUTFYgMCBmb3IgbnByb2ZpbGVcIik7XG4gICAgICBpZiAodGx2WzBdWzBdLmxlbmd0aCAhPT0gMzIpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRMViAwIHNob3VsZCBiZSAzMiBieXRlc1wiKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwibnByb2ZpbGVcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHB1YmtleTogYnl0ZXNUb0hleDModGx2WzBdWzBdKSxcbiAgICAgICAgICByZWxheXM6IHRsdlsxXSA/IHRsdlsxXS5tYXAoKGQpID0+IHV0ZjhEZWNvZGVyLmRlY29kZShkKSkgOiBbXVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlIFwibmV2ZW50XCI6IHtcbiAgICAgIGxldCB0bHYgPSBwYXJzZVRMVihkYXRhKTtcbiAgICAgIGlmICghdGx2WzBdPy5bMF0pXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIm1pc3NpbmcgVExWIDAgZm9yIG5ldmVudFwiKTtcbiAgICAgIGlmICh0bHZbMF1bMF0ubGVuZ3RoICE9PSAzMilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVExWIDAgc2hvdWxkIGJlIDMyIGJ5dGVzXCIpO1xuICAgICAgaWYgKHRsdlsyXSAmJiB0bHZbMl1bMF0ubGVuZ3RoICE9PSAzMilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVExWIDIgc2hvdWxkIGJlIDMyIGJ5dGVzXCIpO1xuICAgICAgaWYgKHRsdlszXSAmJiB0bHZbM11bMF0ubGVuZ3RoICE9PSA0KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUTFYgMyBzaG91bGQgYmUgNCBieXRlc1wiKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwibmV2ZW50XCIsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogYnl0ZXNUb0hleDModGx2WzBdWzBdKSxcbiAgICAgICAgICByZWxheXM6IHRsdlsxXSA/IHRsdlsxXS5tYXAoKGQpID0+IHV0ZjhEZWNvZGVyLmRlY29kZShkKSkgOiBbXSxcbiAgICAgICAgICBhdXRob3I6IHRsdlsyXT8uWzBdID8gYnl0ZXNUb0hleDModGx2WzJdWzBdKSA6IHZvaWQgMCxcbiAgICAgICAgICBraW5kOiB0bHZbM10/LlswXSA/IHBhcnNlSW50KGJ5dGVzVG9IZXgzKHRsdlszXVswXSksIDE2KSA6IHZvaWQgMFxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlIFwibmFkZHJcIjoge1xuICAgICAgbGV0IHRsdiA9IHBhcnNlVExWKGRhdGEpO1xuICAgICAgaWYgKCF0bHZbMF0/LlswXSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWlzc2luZyBUTFYgMCBmb3IgbmFkZHJcIik7XG4gICAgICBpZiAoIXRsdlsyXT8uWzBdKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtaXNzaW5nIFRMViAyIGZvciBuYWRkclwiKTtcbiAgICAgIGlmICh0bHZbMl1bMF0ubGVuZ3RoICE9PSAzMilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVExWIDIgc2hvdWxkIGJlIDMyIGJ5dGVzXCIpO1xuICAgICAgaWYgKCF0bHZbM10/LlswXSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWlzc2luZyBUTFYgMyBmb3IgbmFkZHJcIik7XG4gICAgICBpZiAodGx2WzNdWzBdLmxlbmd0aCAhPT0gNClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVExWIDMgc2hvdWxkIGJlIDQgYnl0ZXNcIik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcIm5hZGRyXCIsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZGVudGlmaWVyOiB1dGY4RGVjb2Rlci5kZWNvZGUodGx2WzBdWzBdKSxcbiAgICAgICAgICBwdWJrZXk6IGJ5dGVzVG9IZXgzKHRsdlsyXVswXSksXG4gICAgICAgICAga2luZDogcGFyc2VJbnQoYnl0ZXNUb0hleDModGx2WzNdWzBdKSwgMTYpLFxuICAgICAgICAgIHJlbGF5czogdGx2WzFdID8gdGx2WzFdLm1hcCgoZCkgPT4gdXRmOERlY29kZXIuZGVjb2RlKGQpKSA6IFtdXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGNhc2UgXCJuc2VjXCI6XG4gICAgICByZXR1cm4geyB0eXBlOiBwcmVmaXgsIGRhdGEgfTtcbiAgICBjYXNlIFwibnB1YlwiOlxuICAgIGNhc2UgXCJub3RlXCI6XG4gICAgICByZXR1cm4geyB0eXBlOiBwcmVmaXgsIGRhdGE6IGJ5dGVzVG9IZXgzKGRhdGEpIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgdW5rbm93biBwcmVmaXggJHtwcmVmaXh9YCk7XG4gIH1cbn1cbmZ1bmN0aW9uIHBhcnNlVExWKGRhdGEpIHtcbiAgbGV0IHJlc3VsdCA9IHt9O1xuICBsZXQgcmVzdCA9IGRhdGE7XG4gIHdoaWxlIChyZXN0Lmxlbmd0aCA+IDApIHtcbiAgICBsZXQgdCA9IHJlc3RbMF07XG4gICAgbGV0IGwgPSByZXN0WzFdO1xuICAgIGxldCB2ID0gcmVzdC5zbGljZSgyLCAyICsgbCk7XG4gICAgcmVzdCA9IHJlc3Quc2xpY2UoMiArIGwpO1xuICAgIGlmICh2Lmxlbmd0aCA8IGwpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYG5vdCBlbm91Z2ggZGF0YSB0byByZWFkIG9uIFRMViAke3R9YCk7XG4gICAgcmVzdWx0W3RdID0gcmVzdWx0W3RdIHx8IFtdO1xuICAgIHJlc3VsdFt0XS5wdXNoKHYpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBuc2VjRW5jb2RlKGtleSkge1xuICByZXR1cm4gZW5jb2RlQnl0ZXMoXCJuc2VjXCIsIGtleSk7XG59XG5mdW5jdGlvbiBucHViRW5jb2RlKGhleCkge1xuICByZXR1cm4gZW5jb2RlQnl0ZXMoXCJucHViXCIsIGhleFRvQnl0ZXMzKGhleCkpO1xufVxuZnVuY3Rpb24gbm90ZUVuY29kZShoZXgpIHtcbiAgcmV0dXJuIGVuY29kZUJ5dGVzKFwibm90ZVwiLCBoZXhUb0J5dGVzMyhoZXgpKTtcbn1cbmZ1bmN0aW9uIGVuY29kZUJlY2gzMihwcmVmaXgsIGRhdGEpIHtcbiAgbGV0IHdvcmRzID0gYmVjaDMyLnRvV29yZHMoZGF0YSk7XG4gIHJldHVybiBiZWNoMzIuZW5jb2RlKHByZWZpeCwgd29yZHMsIEJlY2gzMk1heFNpemUpO1xufVxuZnVuY3Rpb24gZW5jb2RlQnl0ZXMocHJlZml4LCBieXRlcykge1xuICByZXR1cm4gZW5jb2RlQmVjaDMyKHByZWZpeCwgYnl0ZXMpO1xufVxuZnVuY3Rpb24gbnByb2ZpbGVFbmNvZGUocHJvZmlsZSkge1xuICBsZXQgZGF0YSA9IGVuY29kZVRMVih7XG4gICAgMDogW2hleFRvQnl0ZXMzKHByb2ZpbGUucHVia2V5KV0sXG4gICAgMTogKHByb2ZpbGUucmVsYXlzIHx8IFtdKS5tYXAoKHVybCkgPT4gdXRmOEVuY29kZXIuZW5jb2RlKHVybCkpXG4gIH0pO1xuICByZXR1cm4gZW5jb2RlQmVjaDMyKFwibnByb2ZpbGVcIiwgZGF0YSk7XG59XG5mdW5jdGlvbiBuZXZlbnRFbmNvZGUoZXZlbnQpIHtcbiAgbGV0IGtpbmRBcnJheTtcbiAgaWYgKGV2ZW50LmtpbmQgIT09IHZvaWQgMCkge1xuICAgIGtpbmRBcnJheSA9IGludGVnZXJUb1VpbnQ4QXJyYXkoZXZlbnQua2luZCk7XG4gIH1cbiAgbGV0IGRhdGEgPSBlbmNvZGVUTFYoe1xuICAgIDA6IFtoZXhUb0J5dGVzMyhldmVudC5pZCldLFxuICAgIDE6IChldmVudC5yZWxheXMgfHwgW10pLm1hcCgodXJsKSA9PiB1dGY4RW5jb2Rlci5lbmNvZGUodXJsKSksXG4gICAgMjogZXZlbnQuYXV0aG9yID8gW2hleFRvQnl0ZXMzKGV2ZW50LmF1dGhvcildIDogW10sXG4gICAgMzoga2luZEFycmF5ID8gW25ldyBVaW50OEFycmF5KGtpbmRBcnJheSldIDogW11cbiAgfSk7XG4gIHJldHVybiBlbmNvZGVCZWNoMzIoXCJuZXZlbnRcIiwgZGF0YSk7XG59XG5mdW5jdGlvbiBuYWRkckVuY29kZShhZGRyKSB7XG4gIGxldCBraW5kID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuICBuZXcgRGF0YVZpZXcoa2luZCkuc2V0VWludDMyKDAsIGFkZHIua2luZCwgZmFsc2UpO1xuICBsZXQgZGF0YSA9IGVuY29kZVRMVih7XG4gICAgMDogW3V0ZjhFbmNvZGVyLmVuY29kZShhZGRyLmlkZW50aWZpZXIpXSxcbiAgICAxOiAoYWRkci5yZWxheXMgfHwgW10pLm1hcCgodXJsKSA9PiB1dGY4RW5jb2Rlci5lbmNvZGUodXJsKSksXG4gICAgMjogW2hleFRvQnl0ZXMzKGFkZHIucHVia2V5KV0sXG4gICAgMzogW25ldyBVaW50OEFycmF5KGtpbmQpXVxuICB9KTtcbiAgcmV0dXJuIGVuY29kZUJlY2gzMihcIm5hZGRyXCIsIGRhdGEpO1xufVxuZnVuY3Rpb24gZW5jb2RlVExWKHRsdikge1xuICBsZXQgZW50cmllcyA9IFtdO1xuICBPYmplY3QuZW50cmllcyh0bHYpLnJldmVyc2UoKS5mb3JFYWNoKChbdCwgdnNdKSA9PiB7XG4gICAgdnMuZm9yRWFjaCgodikgPT4ge1xuICAgICAgbGV0IGVudHJ5ID0gbmV3IFVpbnQ4QXJyYXkodi5sZW5ndGggKyAyKTtcbiAgICAgIGVudHJ5LnNldChbcGFyc2VJbnQodCldLCAwKTtcbiAgICAgIGVudHJ5LnNldChbdi5sZW5ndGhdLCAxKTtcbiAgICAgIGVudHJ5LnNldCh2LCAyKTtcbiAgICAgIGVudHJpZXMucHVzaChlbnRyeSk7XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gY29uY2F0Qnl0ZXMoLi4uZW50cmllcyk7XG59XG5cbi8vIHJlZmVyZW5jZXMudHNcbnZhciBtZW50aW9uUmVnZXggPSAvXFxibm9zdHI6KChub3RlfG5wdWJ8bmFkZHJ8bmV2ZW50fG5wcm9maWxlKTFcXHcrKVxcYnwjXFxbKFxcZCspXFxdL2c7XG5mdW5jdGlvbiBwYXJzZVJlZmVyZW5jZXMoZXZ0KSB7XG4gIGxldCByZWZlcmVuY2VzID0gW107XG4gIGZvciAobGV0IHJlZiBvZiBldnQuY29udGVudC5tYXRjaEFsbChtZW50aW9uUmVnZXgpKSB7XG4gICAgaWYgKHJlZlsyXSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHsgdHlwZSwgZGF0YSB9ID0gZGVjb2RlKHJlZlsxXSk7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgIGNhc2UgXCJucHViXCI6IHtcbiAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgICAgIHRleHQ6IHJlZlswXSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogeyBwdWJrZXk6IGRhdGEsIHJlbGF5czogW10gfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBcIm5wcm9maWxlXCI6IHtcbiAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgICAgIHRleHQ6IHJlZlswXSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogZGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBcIm5vdGVcIjoge1xuICAgICAgICAgICAgcmVmZXJlbmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgdGV4dDogcmVmWzBdLFxuICAgICAgICAgICAgICBldmVudDogeyBpZDogZGF0YSwgcmVsYXlzOiBbXSB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFwibmV2ZW50XCI6IHtcbiAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgICAgIHRleHQ6IHJlZlswXSxcbiAgICAgICAgICAgICAgZXZlbnQ6IGRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgXCJuYWRkclwiOiB7XG4gICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe1xuICAgICAgICAgICAgICB0ZXh0OiByZWZbMF0sXG4gICAgICAgICAgICAgIGFkZHJlc3M6IGRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHJlZlszXSkge1xuICAgICAgbGV0IGlkeCA9IHBhcnNlSW50KHJlZlszXSwgMTApO1xuICAgICAgbGV0IHRhZyA9IGV2dC50YWdzW2lkeF07XG4gICAgICBpZiAoIXRhZylcbiAgICAgICAgY29udGludWU7XG4gICAgICBzd2l0Y2ggKHRhZ1swXSkge1xuICAgICAgICBjYXNlIFwicFwiOiB7XG4gICAgICAgICAgcmVmZXJlbmNlcy5wdXNoKHtcbiAgICAgICAgICAgIHRleHQ6IHJlZlswXSxcbiAgICAgICAgICAgIHByb2ZpbGU6IHsgcHVia2V5OiB0YWdbMV0sIHJlbGF5czogdGFnWzJdID8gW3RhZ1syXV0gOiBbXSB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcImVcIjoge1xuICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgICB0ZXh0OiByZWZbMF0sXG4gICAgICAgICAgICBldmVudDogeyBpZDogdGFnWzFdLCByZWxheXM6IHRhZ1syXSA/IFt0YWdbMl1dIDogW10gfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgXCJhXCI6IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IFtraW5kLCBwdWJrZXksIGlkZW50aWZpZXJdID0gdGFnWzFdLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgICAgIHRleHQ6IHJlZlswXSxcbiAgICAgICAgICAgICAgYWRkcmVzczoge1xuICAgICAgICAgICAgICAgIGlkZW50aWZpZXIsXG4gICAgICAgICAgICAgICAgcHVia2V5LFxuICAgICAgICAgICAgICAgIGtpbmQ6IHBhcnNlSW50KGtpbmQsIDEwKSxcbiAgICAgICAgICAgICAgICByZWxheXM6IHRhZ1syXSA/IFt0YWdbMl1dIDogW11cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiByZWZlcmVuY2VzO1xufVxuXG4vLyBuaXAwNC50c1xudmFyIG5pcDA0X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDA0X2V4cG9ydHMsIHtcbiAgZGVjcnlwdDogKCkgPT4gZGVjcnlwdCxcbiAgZW5jcnlwdDogKCkgPT4gZW5jcnlwdFxufSk7XG5pbXBvcnQgeyBoZXhUb0J5dGVzIGFzIGhleFRvQnl0ZXM0LCByYW5kb21CeXRlcyB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBzZWNwMjU2azEgfSBmcm9tIFwiQG5vYmxlL2N1cnZlcy9zZWNwMjU2azEuanNcIjtcbmltcG9ydCB7IGNiYyB9IGZyb20gXCJAbm9ibGUvY2lwaGVycy9hZXMuanNcIjtcbmltcG9ydCB7IGJhc2U2NCB9IGZyb20gXCJAc2N1cmUvYmFzZVwiO1xuZnVuY3Rpb24gZW5jcnlwdChzZWNyZXRLZXksIHB1YmtleSwgdGV4dCkge1xuICBjb25zdCBwcml2a2V5ID0gc2VjcmV0S2V5IGluc3RhbmNlb2YgVWludDhBcnJheSA/IHNlY3JldEtleSA6IGhleFRvQnl0ZXM0KHNlY3JldEtleSk7XG4gIGNvbnN0IGtleSA9IHNlY3AyNTZrMS5nZXRTaGFyZWRTZWNyZXQocHJpdmtleSwgaGV4VG9CeXRlczQoXCIwMlwiICsgcHVia2V5KSk7XG4gIGNvbnN0IG5vcm1hbGl6ZWRLZXkgPSBnZXROb3JtYWxpemVkWChrZXkpO1xuICBsZXQgaXYgPSBVaW50OEFycmF5LmZyb20ocmFuZG9tQnl0ZXMoMTYpKTtcbiAgbGV0IHBsYWludGV4dCA9IHV0ZjhFbmNvZGVyLmVuY29kZSh0ZXh0KTtcbiAgbGV0IGNpcGhlcnRleHQgPSBjYmMobm9ybWFsaXplZEtleSwgaXYpLmVuY3J5cHQocGxhaW50ZXh0KTtcbiAgbGV0IGN0YjY0ID0gYmFzZTY0LmVuY29kZShuZXcgVWludDhBcnJheShjaXBoZXJ0ZXh0KSk7XG4gIGxldCBpdmI2NCA9IGJhc2U2NC5lbmNvZGUobmV3IFVpbnQ4QXJyYXkoaXYuYnVmZmVyKSk7XG4gIHJldHVybiBgJHtjdGI2NH0/aXY9JHtpdmI2NH1gO1xufVxuZnVuY3Rpb24gZGVjcnlwdChzZWNyZXRLZXksIHB1YmtleSwgZGF0YSkge1xuICBjb25zdCBwcml2a2V5ID0gc2VjcmV0S2V5IGluc3RhbmNlb2YgVWludDhBcnJheSA/IHNlY3JldEtleSA6IGhleFRvQnl0ZXM0KHNlY3JldEtleSk7XG4gIGxldCBbY3RiNjQsIGl2YjY0XSA9IGRhdGEuc3BsaXQoXCI/aXY9XCIpO1xuICBsZXQga2V5ID0gc2VjcDI1NmsxLmdldFNoYXJlZFNlY3JldChwcml2a2V5LCBoZXhUb0J5dGVzNChcIjAyXCIgKyBwdWJrZXkpKTtcbiAgbGV0IG5vcm1hbGl6ZWRLZXkgPSBnZXROb3JtYWxpemVkWChrZXkpO1xuICBsZXQgaXYgPSBiYXNlNjQuZGVjb2RlKGl2YjY0KTtcbiAgbGV0IGNpcGhlcnRleHQgPSBiYXNlNjQuZGVjb2RlKGN0YjY0KTtcbiAgbGV0IHBsYWludGV4dCA9IGNiYyhub3JtYWxpemVkS2V5LCBpdikuZGVjcnlwdChjaXBoZXJ0ZXh0KTtcbiAgcmV0dXJuIHV0ZjhEZWNvZGVyLmRlY29kZShwbGFpbnRleHQpO1xufVxuZnVuY3Rpb24gZ2V0Tm9ybWFsaXplZFgoa2V5KSB7XG4gIHJldHVybiBrZXkuc2xpY2UoMSwgMzMpO1xufVxuXG4vLyBuaXAwNS50c1xudmFyIG5pcDA1X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDA1X2V4cG9ydHMsIHtcbiAgTklQMDVfUkVHRVg6ICgpID0+IE5JUDA1X1JFR0VYLFxuICBpc05pcDA1OiAoKSA9PiBpc05pcDA1LFxuICBpc1ZhbGlkOiAoKSA9PiBpc1ZhbGlkLFxuICBxdWVyeVByb2ZpbGU6ICgpID0+IHF1ZXJ5UHJvZmlsZSxcbiAgc2VhcmNoRG9tYWluOiAoKSA9PiBzZWFyY2hEb21haW4sXG4gIHVzZUZldGNoSW1wbGVtZW50YXRpb246ICgpID0+IHVzZUZldGNoSW1wbGVtZW50YXRpb25cbn0pO1xudmFyIE5JUDA1X1JFR0VYID0gL14oPzooW1xcdy4rLV0rKUApPyhbXFx3Xy1dKyhcXC5bXFx3Xy1dKykrKSQvO1xudmFyIGlzTmlwMDUgPSAodmFsdWUpID0+IE5JUDA1X1JFR0VYLnRlc3QodmFsdWUgfHwgXCJcIik7XG52YXIgX2ZldGNoO1xudHJ5IHtcbiAgX2ZldGNoID0gZmV0Y2g7XG59IGNhdGNoIChfKSB7XG4gIG51bGw7XG59XG5mdW5jdGlvbiB1c2VGZXRjaEltcGxlbWVudGF0aW9uKGZldGNoSW1wbGVtZW50YXRpb24pIHtcbiAgX2ZldGNoID0gZmV0Y2hJbXBsZW1lbnRhdGlvbjtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaERvbWFpbihkb21haW4sIHF1ZXJ5ID0gXCJcIikge1xuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IGBodHRwczovLyR7ZG9tYWlufS8ud2VsbC1rbm93bi9ub3N0ci5qc29uP25hbWU9JHtxdWVyeX1gO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IF9mZXRjaCh1cmwsIHsgcmVkaXJlY3Q6IFwibWFudWFsXCIgfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgdGhyb3cgRXJyb3IoXCJXcm9uZyByZXNwb25zZSBjb2RlXCIpO1xuICAgIH1cbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICByZXR1cm4ganNvbi5uYW1lcztcbiAgfSBjYXRjaCAoXykge1xuICAgIHJldHVybiB7fTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gcXVlcnlQcm9maWxlKGZ1bGxuYW1lKSB7XG4gIGNvbnN0IG1hdGNoID0gZnVsbG5hbWUubWF0Y2goTklQMDVfUkVHRVgpO1xuICBpZiAoIW1hdGNoKVxuICAgIHJldHVybiBudWxsO1xuICBjb25zdCBbLCBuYW1lID0gXCJfXCIsIGRvbWFpbl0gPSBtYXRjaDtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly8ke2RvbWFpbn0vLndlbGwta25vd24vbm9zdHIuanNvbj9uYW1lPSR7bmFtZX1gO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IF9mZXRjaCh1cmwsIHsgcmVkaXJlY3Q6IFwibWFudWFsXCIgfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgdGhyb3cgRXJyb3IoXCJXcm9uZyByZXNwb25zZSBjb2RlXCIpO1xuICAgIH1cbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICBjb25zdCBwdWJrZXkgPSBqc29uLm5hbWVzW25hbWVdO1xuICAgIHJldHVybiBwdWJrZXkgPyB7IHB1YmtleSwgcmVsYXlzOiBqc29uLnJlbGF5cz8uW3B1YmtleV0gfSA6IG51bGw7XG4gIH0gY2F0Y2ggKF9lKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGlzVmFsaWQocHVia2V5LCBuaXAwNSkge1xuICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeVByb2ZpbGUobmlwMDUpO1xuICByZXR1cm4gcmVzID8gcmVzLnB1YmtleSA9PT0gcHVia2V5IDogZmFsc2U7XG59XG5cbi8vIG5pcDEwLnRzXG52YXIgbmlwMTBfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQobmlwMTBfZXhwb3J0cywge1xuICBwYXJzZTogKCkgPT4gcGFyc2Vcbn0pO1xuZnVuY3Rpb24gcGFyc2UoZXZlbnQpIHtcbiAgY29uc3QgcmVzdWx0ID0ge1xuICAgIHJlcGx5OiB2b2lkIDAsXG4gICAgcm9vdDogdm9pZCAwLFxuICAgIG1lbnRpb25zOiBbXSxcbiAgICBwcm9maWxlczogW10sXG4gICAgcXVvdGVzOiBbXVxuICB9O1xuICBsZXQgbWF5YmVQYXJlbnQ7XG4gIGxldCBtYXliZVJvb3Q7XG4gIGZvciAobGV0IGkyID0gZXZlbnQudGFncy5sZW5ndGggLSAxOyBpMiA+PSAwOyBpMi0tKSB7XG4gICAgY29uc3QgdGFnID0gZXZlbnQudGFnc1tpMl07XG4gICAgaWYgKHRhZ1swXSA9PT0gXCJlXCIgJiYgdGFnWzFdKSB7XG4gICAgICBjb25zdCBbXywgZVRhZ0V2ZW50SWQsIGVUYWdSZWxheVVybCwgZVRhZ01hcmtlciwgZVRhZ0F1dGhvcl0gPSB0YWc7XG4gICAgICBjb25zdCBldmVudFBvaW50ZXIgPSB7XG4gICAgICAgIGlkOiBlVGFnRXZlbnRJZCxcbiAgICAgICAgcmVsYXlzOiBlVGFnUmVsYXlVcmwgPyBbZVRhZ1JlbGF5VXJsXSA6IFtdLFxuICAgICAgICBhdXRob3I6IGVUYWdBdXRob3JcbiAgICAgIH07XG4gICAgICBpZiAoZVRhZ01hcmtlciA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgcmVzdWx0LnJvb3QgPSBldmVudFBvaW50ZXI7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGVUYWdNYXJrZXIgPT09IFwicmVwbHlcIikge1xuICAgICAgICByZXN1bHQucmVwbHkgPSBldmVudFBvaW50ZXI7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGVUYWdNYXJrZXIgPT09IFwibWVudGlvblwiKSB7XG4gICAgICAgIHJlc3VsdC5tZW50aW9ucy5wdXNoKGV2ZW50UG9pbnRlcik7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKCFtYXliZVBhcmVudCkge1xuICAgICAgICBtYXliZVBhcmVudCA9IGV2ZW50UG9pbnRlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1heWJlUm9vdCA9IGV2ZW50UG9pbnRlcjtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC5tZW50aW9ucy5wdXNoKGV2ZW50UG9pbnRlcik7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHRhZ1swXSA9PT0gXCJxXCIgJiYgdGFnWzFdKSB7XG4gICAgICBjb25zdCBbXywgZVRhZ0V2ZW50SWQsIGVUYWdSZWxheVVybF0gPSB0YWc7XG4gICAgICByZXN1bHQucXVvdGVzLnB1c2goe1xuICAgICAgICBpZDogZVRhZ0V2ZW50SWQsXG4gICAgICAgIHJlbGF5czogZVRhZ1JlbGF5VXJsID8gW2VUYWdSZWxheVVybF0gOiBbXVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICh0YWdbMF0gPT09IFwicFwiICYmIHRhZ1sxXSkge1xuICAgICAgcmVzdWx0LnByb2ZpbGVzLnB1c2goe1xuICAgICAgICBwdWJrZXk6IHRhZ1sxXSxcbiAgICAgICAgcmVsYXlzOiB0YWdbMl0gPyBbdGFnWzJdXSA6IFtdXG4gICAgICB9KTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgfVxuICBpZiAoIXJlc3VsdC5yb290KSB7XG4gICAgcmVzdWx0LnJvb3QgPSBtYXliZVJvb3QgfHwgbWF5YmVQYXJlbnQgfHwgcmVzdWx0LnJlcGx5O1xuICB9XG4gIGlmICghcmVzdWx0LnJlcGx5KSB7XG4gICAgcmVzdWx0LnJlcGx5ID0gbWF5YmVQYXJlbnQgfHwgcmVzdWx0LnJvb3Q7XG4gIH1cbiAgO1xuICBbcmVzdWx0LnJlcGx5LCByZXN1bHQucm9vdF0uZm9yRWFjaCgocmVmKSA9PiB7XG4gICAgaWYgKCFyZWYpXG4gICAgICByZXR1cm47XG4gICAgbGV0IGlkeCA9IHJlc3VsdC5tZW50aW9ucy5pbmRleE9mKHJlZik7XG4gICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgIHJlc3VsdC5tZW50aW9ucy5zcGxpY2UoaWR4LCAxKTtcbiAgICB9XG4gICAgaWYgKHJlZi5hdXRob3IpIHtcbiAgICAgIGxldCBhdXRob3IgPSByZXN1bHQucHJvZmlsZXMuZmluZCgocCkgPT4gcC5wdWJrZXkgPT09IHJlZi5hdXRob3IpO1xuICAgICAgaWYgKGF1dGhvciAmJiBhdXRob3IucmVsYXlzKSB7XG4gICAgICAgIGlmICghcmVmLnJlbGF5cykge1xuICAgICAgICAgIHJlZi5yZWxheXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBhdXRob3IucmVsYXlzLmZvckVhY2goKHVybCkgPT4ge1xuICAgICAgICAgIGlmIChyZWYucmVsYXlzPy5pbmRleE9mKHVybCkgPT09IC0xKVxuICAgICAgICAgICAgcmVmLnJlbGF5cy5wdXNoKHVybCk7XG4gICAgICAgIH0pO1xuICAgICAgICBhdXRob3IucmVsYXlzID0gcmVmLnJlbGF5cztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXN1bHQubWVudGlvbnMuZm9yRWFjaCgocmVmKSA9PiB7XG4gICAgaWYgKHJlZi5hdXRob3IpIHtcbiAgICAgIGxldCBhdXRob3IgPSByZXN1bHQucHJvZmlsZXMuZmluZCgocCkgPT4gcC5wdWJrZXkgPT09IHJlZi5hdXRob3IpO1xuICAgICAgaWYgKGF1dGhvciAmJiBhdXRob3IucmVsYXlzKSB7XG4gICAgICAgIGlmICghcmVmLnJlbGF5cykge1xuICAgICAgICAgIHJlZi5yZWxheXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBhdXRob3IucmVsYXlzLmZvckVhY2goKHVybCkgPT4ge1xuICAgICAgICAgIGlmIChyZWYucmVsYXlzLmluZGV4T2YodXJsKSA9PT0gLTEpXG4gICAgICAgICAgICByZWYucmVsYXlzLnB1c2godXJsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGF1dGhvci5yZWxheXMgPSByZWYucmVsYXlzO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIG5pcDExLnRzXG52YXIgbmlwMTFfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQobmlwMTFfZXhwb3J0cywge1xuICBmZXRjaFJlbGF5SW5mb3JtYXRpb246ICgpID0+IGZldGNoUmVsYXlJbmZvcm1hdGlvbixcbiAgdXNlRmV0Y2hJbXBsZW1lbnRhdGlvbjogKCkgPT4gdXNlRmV0Y2hJbXBsZW1lbnRhdGlvbjJcbn0pO1xudmFyIF9mZXRjaDI7XG50cnkge1xuICBfZmV0Y2gyID0gZmV0Y2g7XG59IGNhdGNoIHtcbn1cbmZ1bmN0aW9uIHVzZUZldGNoSW1wbGVtZW50YXRpb24yKGZldGNoSW1wbGVtZW50YXRpb24pIHtcbiAgX2ZldGNoMiA9IGZldGNoSW1wbGVtZW50YXRpb247XG59XG5hc3luYyBmdW5jdGlvbiBmZXRjaFJlbGF5SW5mb3JtYXRpb24odXJsKSB7XG4gIHJldHVybiBhd2FpdCAoYXdhaXQgZmV0Y2godXJsLnJlcGxhY2UoXCJ3czovL1wiLCBcImh0dHA6Ly9cIikucmVwbGFjZShcIndzczovL1wiLCBcImh0dHBzOi8vXCIpLCB7XG4gICAgaGVhZGVyczogeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vbm9zdHIranNvblwiIH1cbiAgfSkpLmpzb24oKTtcbn1cblxuLy8gbmlwMTMudHNcbnZhciBuaXAxM19leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAxM19leHBvcnRzLCB7XG4gIGdldFBvdzogKCkgPT4gZ2V0UG93LFxuICBtaW5lUG93OiAoKSA9PiBtaW5lUG93XG59KTtcbmltcG9ydCB7IGJ5dGVzVG9IZXggYXMgYnl0ZXNUb0hleDQgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy91dGlscy5qc1wiO1xuaW1wb3J0IHsgc2hhMjU2IGFzIHNoYTI1NjIgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy9zaGEyLmpzXCI7XG5mdW5jdGlvbiBnZXRQb3coaGV4KSB7XG4gIGxldCBjb3VudCA9IDA7XG4gIGZvciAobGV0IGkyID0gMDsgaTIgPCA2NDsgaTIgKz0gOCkge1xuICAgIGNvbnN0IG5pYmJsZSA9IHBhcnNlSW50KGhleC5zdWJzdHJpbmcoaTIsIGkyICsgOCksIDE2KTtcbiAgICBpZiAobmliYmxlID09PSAwKSB7XG4gICAgICBjb3VudCArPSAzMjtcbiAgICB9IGVsc2Uge1xuICAgICAgY291bnQgKz0gTWF0aC5jbHozMihuaWJibGUpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiBjb3VudDtcbn1cbmZ1bmN0aW9uIGdldFBvd0Zyb21CeXRlcyhoYXNoKSB7XG4gIGxldCBjb3VudCA9IDA7XG4gIGZvciAobGV0IGkyID0gMDsgaTIgPCBoYXNoLmxlbmd0aDsgaTIrKykge1xuICAgIGNvbnN0IGJ5dGUgPSBoYXNoW2kyXTtcbiAgICBpZiAoYnl0ZSA9PT0gMCkge1xuICAgICAgY291bnQgKz0gODtcbiAgICB9IGVsc2Uge1xuICAgICAgY291bnQgKz0gTWF0aC5jbHozMihieXRlKSAtIDI0O1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiBjb3VudDtcbn1cbmZ1bmN0aW9uIG1pbmVQb3codW5zaWduZWQsIGRpZmZpY3VsdHkpIHtcbiAgbGV0IGNvdW50ID0gMDtcbiAgY29uc3QgZXZlbnQgPSB1bnNpZ25lZDtcbiAgY29uc3QgdGFnID0gW1wibm9uY2VcIiwgY291bnQudG9TdHJpbmcoKSwgZGlmZmljdWx0eS50b1N0cmluZygpXTtcbiAgZXZlbnQudGFncy5wdXNoKHRhZyk7XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgY29uc3Qgbm93MiA9IE1hdGguZmxvb3IobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxZTMpO1xuICAgIGlmIChub3cyICE9PSBldmVudC5jcmVhdGVkX2F0KSB7XG4gICAgICBjb3VudCA9IDA7XG4gICAgICBldmVudC5jcmVhdGVkX2F0ID0gbm93MjtcbiAgICB9XG4gICAgdGFnWzFdID0gKCsrY291bnQpLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgaGFzaCA9IHNoYTI1NjIoXG4gICAgICB1dGY4RW5jb2Rlci5lbmNvZGUoSlNPTi5zdHJpbmdpZnkoWzAsIGV2ZW50LnB1YmtleSwgZXZlbnQuY3JlYXRlZF9hdCwgZXZlbnQua2luZCwgZXZlbnQudGFncywgZXZlbnQuY29udGVudF0pKVxuICAgICk7XG4gICAgaWYgKGdldFBvd0Zyb21CeXRlcyhoYXNoKSA+PSBkaWZmaWN1bHR5KSB7XG4gICAgICBldmVudC5pZCA9IGJ5dGVzVG9IZXg0KGhhc2gpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiBldmVudDtcbn1cblxuLy8gbmlwMTcudHNcbnZhciBuaXAxN19leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAxN19leHBvcnRzLCB7XG4gIHVud3JhcEV2ZW50OiAoKSA9PiB1bndyYXBFdmVudDIsXG4gIHVud3JhcE1hbnlFdmVudHM6ICgpID0+IHVud3JhcE1hbnlFdmVudHMyLFxuICB3cmFwRXZlbnQ6ICgpID0+IHdyYXBFdmVudDIsXG4gIHdyYXBNYW55RXZlbnRzOiAoKSA9PiB3cmFwTWFueUV2ZW50czJcbn0pO1xuXG4vLyBuaXA1OS50c1xudmFyIG5pcDU5X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDU5X2V4cG9ydHMsIHtcbiAgY3JlYXRlUnVtb3I6ICgpID0+IGNyZWF0ZVJ1bW9yLFxuICBjcmVhdGVTZWFsOiAoKSA9PiBjcmVhdGVTZWFsLFxuICBjcmVhdGVXcmFwOiAoKSA9PiBjcmVhdGVXcmFwLFxuICB1bndyYXBFdmVudDogKCkgPT4gdW53cmFwRXZlbnQsXG4gIHVud3JhcE1hbnlFdmVudHM6ICgpID0+IHVud3JhcE1hbnlFdmVudHMsXG4gIHdyYXBFdmVudDogKCkgPT4gd3JhcEV2ZW50LFxuICB3cmFwTWFueUV2ZW50czogKCkgPT4gd3JhcE1hbnlFdmVudHNcbn0pO1xuXG4vLyBuaXA0NC50c1xudmFyIG5pcDQ0X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDQ0X2V4cG9ydHMsIHtcbiAgZGVjcnlwdDogKCkgPT4gZGVjcnlwdDIsXG4gIGVuY3J5cHQ6ICgpID0+IGVuY3J5cHQyLFxuICBnZXRDb252ZXJzYXRpb25LZXk6ICgpID0+IGdldENvbnZlcnNhdGlvbktleSxcbiAgdjI6ICgpID0+IHYyXG59KTtcbmltcG9ydCB7IGNoYWNoYTIwIH0gZnJvbSBcIkBub2JsZS9jaXBoZXJzL2NoYWNoYS5qc1wiO1xuaW1wb3J0IHsgZXF1YWxCeXRlcyB9IGZyb20gXCJAbm9ibGUvY2lwaGVycy91dGlscy5qc1wiO1xuaW1wb3J0IHsgc2VjcDI1NmsxIGFzIHNlY3AyNTZrMTIgfSBmcm9tIFwiQG5vYmxlL2N1cnZlcy9zZWNwMjU2azEuanNcIjtcbmltcG9ydCB7IGV4dHJhY3QgYXMgaGtkZl9leHRyYWN0LCBleHBhbmQgYXMgaGtkZl9leHBhbmQgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy9oa2RmLmpzXCI7XG5pbXBvcnQgeyBobWFjIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvaG1hYy5qc1wiO1xuaW1wb3J0IHsgc2hhMjU2IGFzIHNoYTI1NjMgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy9zaGEyLmpzXCI7XG5pbXBvcnQgeyBjb25jYXRCeXRlcyBhcyBjb25jYXRCeXRlczIsIGhleFRvQnl0ZXMgYXMgaGV4VG9CeXRlczUsIHJhbmRvbUJ5dGVzIGFzIHJhbmRvbUJ5dGVzMiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBiYXNlNjQgYXMgYmFzZTY0MiB9IGZyb20gXCJAc2N1cmUvYmFzZVwiO1xudmFyIG1pblBsYWludGV4dFNpemUgPSAxO1xudmFyIG1heFBsYWludGV4dFNpemUgPSA2NTUzNTtcbmZ1bmN0aW9uIGdldENvbnZlcnNhdGlvbktleShwcml2a2V5QSwgcHVia2V5Qikge1xuICBjb25zdCBzaGFyZWRYID0gc2VjcDI1NmsxMi5nZXRTaGFyZWRTZWNyZXQocHJpdmtleUEsIGhleFRvQnl0ZXM1KFwiMDJcIiArIHB1YmtleUIpKS5zdWJhcnJheSgxLCAzMyk7XG4gIHJldHVybiBoa2RmX2V4dHJhY3Qoc2hhMjU2Mywgc2hhcmVkWCwgdXRmOEVuY29kZXIuZW5jb2RlKFwibmlwNDQtdjJcIikpO1xufVxuZnVuY3Rpb24gZ2V0TWVzc2FnZUtleXMoY29udmVyc2F0aW9uS2V5LCBub25jZSkge1xuICBjb25zdCBrZXlzID0gaGtkZl9leHBhbmQoc2hhMjU2MywgY29udmVyc2F0aW9uS2V5LCBub25jZSwgNzYpO1xuICByZXR1cm4ge1xuICAgIGNoYWNoYV9rZXk6IGtleXMuc3ViYXJyYXkoMCwgMzIpLFxuICAgIGNoYWNoYV9ub25jZToga2V5cy5zdWJhcnJheSgzMiwgNDQpLFxuICAgIGhtYWNfa2V5OiBrZXlzLnN1YmFycmF5KDQ0LCA3NilcbiAgfTtcbn1cbmZ1bmN0aW9uIGNhbGNQYWRkZWRMZW4obGVuKSB7XG4gIGlmICghTnVtYmVyLmlzU2FmZUludGVnZXIobGVuKSB8fCBsZW4gPCAxKVxuICAgIHRocm93IG5ldyBFcnJvcihcImV4cGVjdGVkIHBvc2l0aXZlIGludGVnZXJcIik7XG4gIGlmIChsZW4gPD0gMzIpXG4gICAgcmV0dXJuIDMyO1xuICBjb25zdCBuZXh0UG93ZXIgPSAxIDw8IE1hdGguZmxvb3IoTWF0aC5sb2cyKGxlbiAtIDEpKSArIDE7XG4gIGNvbnN0IGNodW5rID0gbmV4dFBvd2VyIDw9IDI1NiA/IDMyIDogbmV4dFBvd2VyIC8gODtcbiAgcmV0dXJuIGNodW5rICogKE1hdGguZmxvb3IoKGxlbiAtIDEpIC8gY2h1bmspICsgMSk7XG59XG5mdW5jdGlvbiB3cml0ZVUxNkJFKG51bSkge1xuICBpZiAoIU51bWJlci5pc1NhZmVJbnRlZ2VyKG51bSkgfHwgbnVtIDwgbWluUGxhaW50ZXh0U2l6ZSB8fCBudW0gPiBtYXhQbGFpbnRleHRTaXplKVxuICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgcGxhaW50ZXh0IHNpemU6IG11c3QgYmUgYmV0d2VlbiAxIGFuZCA2NTUzNSBieXRlc1wiKTtcbiAgY29uc3QgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMik7XG4gIG5ldyBEYXRhVmlldyhhcnIuYnVmZmVyKS5zZXRVaW50MTYoMCwgbnVtLCBmYWxzZSk7XG4gIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiBwYWQocGxhaW50ZXh0KSB7XG4gIGNvbnN0IHVucGFkZGVkID0gdXRmOEVuY29kZXIuZW5jb2RlKHBsYWludGV4dCk7XG4gIGNvbnN0IHVucGFkZGVkTGVuID0gdW5wYWRkZWQubGVuZ3RoO1xuICBjb25zdCBwcmVmaXggPSB3cml0ZVUxNkJFKHVucGFkZGVkTGVuKTtcbiAgY29uc3Qgc3VmZml4ID0gbmV3IFVpbnQ4QXJyYXkoY2FsY1BhZGRlZExlbih1bnBhZGRlZExlbikgLSB1bnBhZGRlZExlbik7XG4gIHJldHVybiBjb25jYXRCeXRlczIocHJlZml4LCB1bnBhZGRlZCwgc3VmZml4KTtcbn1cbmZ1bmN0aW9uIHVucGFkKHBhZGRlZCkge1xuICBjb25zdCB1bnBhZGRlZExlbiA9IG5ldyBEYXRhVmlldyhwYWRkZWQuYnVmZmVyKS5nZXRVaW50MTYoMCk7XG4gIGNvbnN0IHVucGFkZGVkID0gcGFkZGVkLnN1YmFycmF5KDIsIDIgKyB1bnBhZGRlZExlbik7XG4gIGlmICh1bnBhZGRlZExlbiA8IG1pblBsYWludGV4dFNpemUgfHwgdW5wYWRkZWRMZW4gPiBtYXhQbGFpbnRleHRTaXplIHx8IHVucGFkZGVkLmxlbmd0aCAhPT0gdW5wYWRkZWRMZW4gfHwgcGFkZGVkLmxlbmd0aCAhPT0gMiArIGNhbGNQYWRkZWRMZW4odW5wYWRkZWRMZW4pKVxuICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgcGFkZGluZ1wiKTtcbiAgcmV0dXJuIHV0ZjhEZWNvZGVyLmRlY29kZSh1bnBhZGRlZCk7XG59XG5mdW5jdGlvbiBobWFjQWFkKGtleSwgbWVzc2FnZSwgYWFkKSB7XG4gIGlmIChhYWQubGVuZ3RoICE9PSAzMilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJBQUQgYXNzb2NpYXRlZCBkYXRhIG11c3QgYmUgMzIgYnl0ZXNcIik7XG4gIGNvbnN0IGNvbWJpbmVkID0gY29uY2F0Qnl0ZXMyKGFhZCwgbWVzc2FnZSk7XG4gIHJldHVybiBobWFjKHNoYTI1NjMsIGtleSwgY29tYmluZWQpO1xufVxuZnVuY3Rpb24gZGVjb2RlUGF5bG9hZChwYXlsb2FkKSB7XG4gIGlmICh0eXBlb2YgcGF5bG9hZCAhPT0gXCJzdHJpbmdcIilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJwYXlsb2FkIG11c3QgYmUgYSB2YWxpZCBzdHJpbmdcIik7XG4gIGNvbnN0IHBsZW4gPSBwYXlsb2FkLmxlbmd0aDtcbiAgaWYgKHBsZW4gPCAxMzIgfHwgcGxlbiA+IDg3NDcyKVxuICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgcGF5bG9hZCBsZW5ndGg6IFwiICsgcGxlbik7XG4gIGlmIChwYXlsb2FkWzBdID09PSBcIiNcIilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1bmtub3duIGVuY3J5cHRpb24gdmVyc2lvblwiKTtcbiAgbGV0IGRhdGE7XG4gIHRyeSB7XG4gICAgZGF0YSA9IGJhc2U2NDIuZGVjb2RlKHBheWxvYWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgYmFzZTY0OiBcIiArIGVycm9yLm1lc3NhZ2UpO1xuICB9XG4gIGNvbnN0IGRsZW4gPSBkYXRhLmxlbmd0aDtcbiAgaWYgKGRsZW4gPCA5OSB8fCBkbGVuID4gNjU2MDMpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBkYXRhIGxlbmd0aDogXCIgKyBkbGVuKTtcbiAgY29uc3QgdmVycyA9IGRhdGFbMF07XG4gIGlmICh2ZXJzICE9PSAyKVxuICAgIHRocm93IG5ldyBFcnJvcihcInVua25vd24gZW5jcnlwdGlvbiB2ZXJzaW9uIFwiICsgdmVycyk7XG4gIHJldHVybiB7XG4gICAgbm9uY2U6IGRhdGEuc3ViYXJyYXkoMSwgMzMpLFxuICAgIGNpcGhlcnRleHQ6IGRhdGEuc3ViYXJyYXkoMzMsIC0zMiksXG4gICAgbWFjOiBkYXRhLnN1YmFycmF5KC0zMilcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY3J5cHQyKHBsYWludGV4dCwgY29udmVyc2F0aW9uS2V5LCBub25jZSA9IHJhbmRvbUJ5dGVzMigzMikpIHtcbiAgY29uc3QgeyBjaGFjaGFfa2V5LCBjaGFjaGFfbm9uY2UsIGhtYWNfa2V5IH0gPSBnZXRNZXNzYWdlS2V5cyhjb252ZXJzYXRpb25LZXksIG5vbmNlKTtcbiAgY29uc3QgcGFkZGVkID0gcGFkKHBsYWludGV4dCk7XG4gIGNvbnN0IGNpcGhlcnRleHQgPSBjaGFjaGEyMChjaGFjaGFfa2V5LCBjaGFjaGFfbm9uY2UsIHBhZGRlZCk7XG4gIGNvbnN0IG1hYyA9IGhtYWNBYWQoaG1hY19rZXksIGNpcGhlcnRleHQsIG5vbmNlKTtcbiAgcmV0dXJuIGJhc2U2NDIuZW5jb2RlKGNvbmNhdEJ5dGVzMihuZXcgVWludDhBcnJheShbMl0pLCBub25jZSwgY2lwaGVydGV4dCwgbWFjKSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0MihwYXlsb2FkLCBjb252ZXJzYXRpb25LZXkpIHtcbiAgY29uc3QgeyBub25jZSwgY2lwaGVydGV4dCwgbWFjIH0gPSBkZWNvZGVQYXlsb2FkKHBheWxvYWQpO1xuICBjb25zdCB7IGNoYWNoYV9rZXksIGNoYWNoYV9ub25jZSwgaG1hY19rZXkgfSA9IGdldE1lc3NhZ2VLZXlzKGNvbnZlcnNhdGlvbktleSwgbm9uY2UpO1xuICBjb25zdCBjYWxjdWxhdGVkTWFjID0gaG1hY0FhZChobWFjX2tleSwgY2lwaGVydGV4dCwgbm9uY2UpO1xuICBpZiAoIWVxdWFsQnl0ZXMoY2FsY3VsYXRlZE1hYywgbWFjKSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIE1BQ1wiKTtcbiAgY29uc3QgcGFkZGVkID0gY2hhY2hhMjAoY2hhY2hhX2tleSwgY2hhY2hhX25vbmNlLCBjaXBoZXJ0ZXh0KTtcbiAgcmV0dXJuIHVucGFkKHBhZGRlZCk7XG59XG52YXIgdjIgPSB7XG4gIHV0aWxzOiB7XG4gICAgZ2V0Q29udmVyc2F0aW9uS2V5LFxuICAgIGNhbGNQYWRkZWRMZW5cbiAgfSxcbiAgZW5jcnlwdDogZW5jcnlwdDIsXG4gIGRlY3J5cHQ6IGRlY3J5cHQyXG59O1xuXG4vLyBuaXA1OS50c1xudmFyIFRXT19EQVlTID0gMiAqIDI0ICogNjAgKiA2MDtcbnZhciBub3cgPSAoKSA9PiBNYXRoLnJvdW5kKERhdGUubm93KCkgLyAxZTMpO1xudmFyIHJhbmRvbU5vdyA9ICgpID0+IE1hdGgucm91bmQobm93KCkgLSBNYXRoLnJhbmRvbSgpICogVFdPX0RBWVMpO1xudmFyIG5pcDQ0Q29udmVyc2F0aW9uS2V5ID0gKHByaXZhdGVLZXksIHB1YmxpY0tleSkgPT4gZ2V0Q29udmVyc2F0aW9uS2V5KHByaXZhdGVLZXksIHB1YmxpY0tleSk7XG52YXIgbmlwNDRFbmNyeXB0ID0gKGRhdGEsIHByaXZhdGVLZXksIHB1YmxpY0tleSkgPT4gZW5jcnlwdDIoSlNPTi5zdHJpbmdpZnkoZGF0YSksIG5pcDQ0Q29udmVyc2F0aW9uS2V5KHByaXZhdGVLZXksIHB1YmxpY0tleSkpO1xudmFyIG5pcDQ0RGVjcnlwdCA9IChkYXRhLCBwcml2YXRlS2V5KSA9PiBKU09OLnBhcnNlKGRlY3J5cHQyKGRhdGEuY29udGVudCwgbmlwNDRDb252ZXJzYXRpb25LZXkocHJpdmF0ZUtleSwgZGF0YS5wdWJrZXkpKSk7XG5mdW5jdGlvbiBjcmVhdGVSdW1vcihldmVudCwgcHJpdmF0ZUtleSkge1xuICBjb25zdCBydW1vciA9IHtcbiAgICBjcmVhdGVkX2F0OiBub3coKSxcbiAgICBjb250ZW50OiBcIlwiLFxuICAgIHRhZ3M6IFtdLFxuICAgIC4uLmV2ZW50LFxuICAgIHB1YmtleTogZ2V0UHVibGljS2V5KHByaXZhdGVLZXkpXG4gIH07XG4gIHJ1bW9yLmlkID0gZ2V0RXZlbnRIYXNoKHJ1bW9yKTtcbiAgcmV0dXJuIHJ1bW9yO1xufVxuZnVuY3Rpb24gY3JlYXRlU2VhbChydW1vciwgcHJpdmF0ZUtleSwgcmVjaXBpZW50UHVibGljS2V5KSB7XG4gIHJldHVybiBmaW5hbGl6ZUV2ZW50KFxuICAgIHtcbiAgICAgIGtpbmQ6IFNlYWwsXG4gICAgICBjb250ZW50OiBuaXA0NEVuY3J5cHQocnVtb3IsIHByaXZhdGVLZXksIHJlY2lwaWVudFB1YmxpY0tleSksXG4gICAgICBjcmVhdGVkX2F0OiByYW5kb21Ob3coKSxcbiAgICAgIHRhZ3M6IFtdXG4gICAgfSxcbiAgICBwcml2YXRlS2V5XG4gICk7XG59XG5mdW5jdGlvbiBjcmVhdGVXcmFwKHNlYWwsIHJlY2lwaWVudFB1YmxpY0tleSkge1xuICBjb25zdCByYW5kb21LZXkgPSBnZW5lcmF0ZVNlY3JldEtleSgpO1xuICByZXR1cm4gZmluYWxpemVFdmVudChcbiAgICB7XG4gICAgICBraW5kOiBHaWZ0V3JhcCxcbiAgICAgIGNvbnRlbnQ6IG5pcDQ0RW5jcnlwdChzZWFsLCByYW5kb21LZXksIHJlY2lwaWVudFB1YmxpY0tleSksXG4gICAgICBjcmVhdGVkX2F0OiByYW5kb21Ob3coKSxcbiAgICAgIHRhZ3M6IFtbXCJwXCIsIHJlY2lwaWVudFB1YmxpY0tleV1dXG4gICAgfSxcbiAgICByYW5kb21LZXlcbiAgKTtcbn1cbmZ1bmN0aW9uIHdyYXBFdmVudChldmVudCwgc2VuZGVyUHJpdmF0ZUtleSwgcmVjaXBpZW50UHVibGljS2V5KSB7XG4gIGNvbnN0IHJ1bW9yID0gY3JlYXRlUnVtb3IoZXZlbnQsIHNlbmRlclByaXZhdGVLZXkpO1xuICBjb25zdCBzZWFsID0gY3JlYXRlU2VhbChydW1vciwgc2VuZGVyUHJpdmF0ZUtleSwgcmVjaXBpZW50UHVibGljS2V5KTtcbiAgcmV0dXJuIGNyZWF0ZVdyYXAoc2VhbCwgcmVjaXBpZW50UHVibGljS2V5KTtcbn1cbmZ1bmN0aW9uIHdyYXBNYW55RXZlbnRzKGV2ZW50LCBzZW5kZXJQcml2YXRlS2V5LCByZWNpcGllbnRzUHVibGljS2V5cykge1xuICBpZiAoIXJlY2lwaWVudHNQdWJsaWNLZXlzIHx8IHJlY2lwaWVudHNQdWJsaWNLZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkF0IGxlYXN0IG9uZSByZWNpcGllbnQgaXMgcmVxdWlyZWQuXCIpO1xuICB9XG4gIGNvbnN0IHNlbmRlclB1YmxpY0tleSA9IGdldFB1YmxpY0tleShzZW5kZXJQcml2YXRlS2V5KTtcbiAgY29uc3Qgd3JhcHBlZHMgPSBbd3JhcEV2ZW50KGV2ZW50LCBzZW5kZXJQcml2YXRlS2V5LCBzZW5kZXJQdWJsaWNLZXkpXTtcbiAgcmVjaXBpZW50c1B1YmxpY0tleXMuZm9yRWFjaCgocmVjaXBpZW50UHVibGljS2V5KSA9PiB7XG4gICAgd3JhcHBlZHMucHVzaCh3cmFwRXZlbnQoZXZlbnQsIHNlbmRlclByaXZhdGVLZXksIHJlY2lwaWVudFB1YmxpY0tleSkpO1xuICB9KTtcbiAgcmV0dXJuIHdyYXBwZWRzO1xufVxuZnVuY3Rpb24gdW53cmFwRXZlbnQod3JhcCwgcmVjaXBpZW50UHJpdmF0ZUtleSkge1xuICBjb25zdCB1bndyYXBwZWRTZWFsID0gbmlwNDREZWNyeXB0KHdyYXAsIHJlY2lwaWVudFByaXZhdGVLZXkpO1xuICByZXR1cm4gbmlwNDREZWNyeXB0KHVud3JhcHBlZFNlYWwsIHJlY2lwaWVudFByaXZhdGVLZXkpO1xufVxuZnVuY3Rpb24gdW53cmFwTWFueUV2ZW50cyh3cmFwcGVkRXZlbnRzLCByZWNpcGllbnRQcml2YXRlS2V5KSB7XG4gIGxldCB1bndyYXBwZWRFdmVudHMgPSBbXTtcbiAgd3JhcHBlZEV2ZW50cy5mb3JFYWNoKChlKSA9PiB7XG4gICAgdW53cmFwcGVkRXZlbnRzLnB1c2godW53cmFwRXZlbnQoZSwgcmVjaXBpZW50UHJpdmF0ZUtleSkpO1xuICB9KTtcbiAgdW53cmFwcGVkRXZlbnRzLnNvcnQoKGEsIGIpID0+IGEuY3JlYXRlZF9hdCAtIGIuY3JlYXRlZF9hdCk7XG4gIHJldHVybiB1bndyYXBwZWRFdmVudHM7XG59XG5cbi8vIG5pcDE3LnRzXG5mdW5jdGlvbiBjcmVhdGVFdmVudChyZWNpcGllbnRzLCBtZXNzYWdlLCBjb252ZXJzYXRpb25UaXRsZSwgcmVwbHlUbykge1xuICBjb25zdCBiYXNlRXZlbnQgPSB7XG4gICAgY3JlYXRlZF9hdDogTWF0aC5jZWlsKERhdGUubm93KCkgLyAxZTMpLFxuICAgIGtpbmQ6IFByaXZhdGVEaXJlY3RNZXNzYWdlLFxuICAgIHRhZ3M6IFtdLFxuICAgIGNvbnRlbnQ6IG1lc3NhZ2VcbiAgfTtcbiAgY29uc3QgcmVjaXBpZW50c0FycmF5ID0gQXJyYXkuaXNBcnJheShyZWNpcGllbnRzKSA/IHJlY2lwaWVudHMgOiBbcmVjaXBpZW50c107XG4gIHJlY2lwaWVudHNBcnJheS5mb3JFYWNoKCh7IHB1YmxpY0tleSwgcmVsYXlVcmwgfSkgPT4ge1xuICAgIGJhc2VFdmVudC50YWdzLnB1c2gocmVsYXlVcmwgPyBbXCJwXCIsIHB1YmxpY0tleSwgcmVsYXlVcmxdIDogW1wicFwiLCBwdWJsaWNLZXldKTtcbiAgfSk7XG4gIGlmIChyZXBseVRvKSB7XG4gICAgYmFzZUV2ZW50LnRhZ3MucHVzaChbXCJlXCIsIHJlcGx5VG8uZXZlbnRJZCwgcmVwbHlUby5yZWxheVVybCB8fCBcIlwiLCBcInJlcGx5XCJdKTtcbiAgfVxuICBpZiAoY29udmVyc2F0aW9uVGl0bGUpIHtcbiAgICBiYXNlRXZlbnQudGFncy5wdXNoKFtcInN1YmplY3RcIiwgY29udmVyc2F0aW9uVGl0bGVdKTtcbiAgfVxuICByZXR1cm4gYmFzZUV2ZW50O1xufVxuZnVuY3Rpb24gd3JhcEV2ZW50MihzZW5kZXJQcml2YXRlS2V5LCByZWNpcGllbnQsIG1lc3NhZ2UsIGNvbnZlcnNhdGlvblRpdGxlLCByZXBseVRvKSB7XG4gIGNvbnN0IGV2ZW50ID0gY3JlYXRlRXZlbnQocmVjaXBpZW50LCBtZXNzYWdlLCBjb252ZXJzYXRpb25UaXRsZSwgcmVwbHlUbyk7XG4gIHJldHVybiB3cmFwRXZlbnQoZXZlbnQsIHNlbmRlclByaXZhdGVLZXksIHJlY2lwaWVudC5wdWJsaWNLZXkpO1xufVxuZnVuY3Rpb24gd3JhcE1hbnlFdmVudHMyKHNlbmRlclByaXZhdGVLZXksIHJlY2lwaWVudHMsIG1lc3NhZ2UsIGNvbnZlcnNhdGlvblRpdGxlLCByZXBseVRvKSB7XG4gIGlmICghcmVjaXBpZW50cyB8fCByZWNpcGllbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkF0IGxlYXN0IG9uZSByZWNpcGllbnQgaXMgcmVxdWlyZWQuXCIpO1xuICB9XG4gIGNvbnN0IHNlbmRlclB1YmxpY0tleSA9IGdldFB1YmxpY0tleShzZW5kZXJQcml2YXRlS2V5KTtcbiAgcmV0dXJuIFt7IHB1YmxpY0tleTogc2VuZGVyUHVibGljS2V5IH0sIC4uLnJlY2lwaWVudHNdLm1hcChcbiAgICAocmVjaXBpZW50KSA9PiB3cmFwRXZlbnQyKHNlbmRlclByaXZhdGVLZXksIHJlY2lwaWVudCwgbWVzc2FnZSwgY29udmVyc2F0aW9uVGl0bGUsIHJlcGx5VG8pXG4gICk7XG59XG52YXIgdW53cmFwRXZlbnQyID0gdW53cmFwRXZlbnQ7XG52YXIgdW53cmFwTWFueUV2ZW50czIgPSB1bndyYXBNYW55RXZlbnRzO1xuXG4vLyBuaXAxOC50c1xudmFyIG5pcDE4X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDE4X2V4cG9ydHMsIHtcbiAgZmluaXNoUmVwb3N0RXZlbnQ6ICgpID0+IGZpbmlzaFJlcG9zdEV2ZW50LFxuICBnZXRSZXBvc3RlZEV2ZW50OiAoKSA9PiBnZXRSZXBvc3RlZEV2ZW50LFxuICBnZXRSZXBvc3RlZEV2ZW50UG9pbnRlcjogKCkgPT4gZ2V0UmVwb3N0ZWRFdmVudFBvaW50ZXJcbn0pO1xuZnVuY3Rpb24gZmluaXNoUmVwb3N0RXZlbnQodCwgcmVwb3N0ZWQsIHJlbGF5VXJsLCBwcml2YXRlS2V5KSB7XG4gIGxldCBraW5kO1xuICBjb25zdCB0YWdzID0gWy4uLnQudGFncyA/PyBbXSwgW1wiZVwiLCByZXBvc3RlZC5pZCwgcmVsYXlVcmxdLCBbXCJwXCIsIHJlcG9zdGVkLnB1YmtleV1dO1xuICBpZiAocmVwb3N0ZWQua2luZCA9PT0gU2hvcnRUZXh0Tm90ZSkge1xuICAgIGtpbmQgPSBSZXBvc3Q7XG4gIH0gZWxzZSB7XG4gICAga2luZCA9IEdlbmVyaWNSZXBvc3Q7XG4gICAgdGFncy5wdXNoKFtcImtcIiwgU3RyaW5nKHJlcG9zdGVkLmtpbmQpXSk7XG4gIH1cbiAgcmV0dXJuIGZpbmFsaXplRXZlbnQoXG4gICAge1xuICAgICAga2luZCxcbiAgICAgIHRhZ3MsXG4gICAgICBjb250ZW50OiB0LmNvbnRlbnQgPT09IFwiXCIgfHwgcmVwb3N0ZWQudGFncz8uZmluZCgodGFnKSA9PiB0YWdbMF0gPT09IFwiLVwiKSA/IFwiXCIgOiBKU09OLnN0cmluZ2lmeShyZXBvc3RlZCksXG4gICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRfYXRcbiAgICB9LFxuICAgIHByaXZhdGVLZXlcbiAgKTtcbn1cbmZ1bmN0aW9uIGdldFJlcG9zdGVkRXZlbnRQb2ludGVyKGV2ZW50KSB7XG4gIGlmICghW1JlcG9zdCwgR2VuZXJpY1JlcG9zdF0uaW5jbHVkZXMoZXZlbnQua2luZCkpIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGxldCBsYXN0RVRhZztcbiAgbGV0IGxhc3RQVGFnO1xuICBmb3IgKGxldCBpMiA9IGV2ZW50LnRhZ3MubGVuZ3RoIC0gMTsgaTIgPj0gMCAmJiAobGFzdEVUYWcgPT09IHZvaWQgMCB8fCBsYXN0UFRhZyA9PT0gdm9pZCAwKTsgaTItLSkge1xuICAgIGNvbnN0IHRhZyA9IGV2ZW50LnRhZ3NbaTJdO1xuICAgIGlmICh0YWcubGVuZ3RoID49IDIpIHtcbiAgICAgIGlmICh0YWdbMF0gPT09IFwiZVwiICYmIGxhc3RFVGFnID09PSB2b2lkIDApIHtcbiAgICAgICAgbGFzdEVUYWcgPSB0YWc7XG4gICAgICB9IGVsc2UgaWYgKHRhZ1swXSA9PT0gXCJwXCIgJiYgbGFzdFBUYWcgPT09IHZvaWQgMCkge1xuICAgICAgICBsYXN0UFRhZyA9IHRhZztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGxhc3RFVGFnID09PSB2b2lkIDApIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIHJldHVybiB7XG4gICAgaWQ6IGxhc3RFVGFnWzFdLFxuICAgIHJlbGF5czogW2xhc3RFVGFnWzJdLCBsYXN0UFRhZz8uWzJdXS5maWx0ZXIoKHgpID0+IHR5cGVvZiB4ID09PSBcInN0cmluZ1wiKSxcbiAgICBhdXRob3I6IGxhc3RQVGFnPy5bMV1cbiAgfTtcbn1cbmZ1bmN0aW9uIGdldFJlcG9zdGVkRXZlbnQoZXZlbnQsIHsgc2tpcFZlcmlmaWNhdGlvbiB9ID0ge30pIHtcbiAgY29uc3QgcG9pbnRlciA9IGdldFJlcG9zdGVkRXZlbnRQb2ludGVyKGV2ZW50KTtcbiAgaWYgKHBvaW50ZXIgPT09IHZvaWQgMCB8fCBldmVudC5jb250ZW50ID09PSBcIlwiKSB7XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxuICBsZXQgcmVwb3N0ZWRFdmVudDtcbiAgdHJ5IHtcbiAgICByZXBvc3RlZEV2ZW50ID0gSlNPTi5wYXJzZShldmVudC5jb250ZW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGlmIChyZXBvc3RlZEV2ZW50LmlkICE9PSBwb2ludGVyLmlkKSB7XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxuICBpZiAoIXNraXBWZXJpZmljYXRpb24gJiYgIXZlcmlmeUV2ZW50KHJlcG9zdGVkRXZlbnQpKSB7XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxuICByZXR1cm4gcmVwb3N0ZWRFdmVudDtcbn1cblxuLy8gbmlwMjEudHNcbnZhciBuaXAyMV9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAyMV9leHBvcnRzLCB7XG4gIE5PU1RSX1VSSV9SRUdFWDogKCkgPT4gTk9TVFJfVVJJX1JFR0VYLFxuICBwYXJzZTogKCkgPT4gcGFyc2UyLFxuICB0ZXN0OiAoKSA9PiB0ZXN0XG59KTtcbnZhciBOT1NUUl9VUklfUkVHRVggPSBuZXcgUmVnRXhwKGBub3N0cjooJHtCRUNIMzJfUkVHRVguc291cmNlfSlgKTtcbmZ1bmN0aW9uIHRlc3QodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBuZXcgUmVnRXhwKGBeJHtOT1NUUl9VUklfUkVHRVguc291cmNlfSRgKS50ZXN0KHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHBhcnNlMih1cmkpIHtcbiAgY29uc3QgbWF0Y2ggPSB1cmkubWF0Y2gobmV3IFJlZ0V4cChgXiR7Tk9TVFJfVVJJX1JFR0VYLnNvdXJjZX0kYCkpO1xuICBpZiAoIW1hdGNoKVxuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBOb3N0ciBVUkk6ICR7dXJpfWApO1xuICByZXR1cm4ge1xuICAgIHVyaTogbWF0Y2hbMF0sXG4gICAgdmFsdWU6IG1hdGNoWzFdLFxuICAgIGRlY29kZWQ6IGRlY29kZShtYXRjaFsxXSlcbiAgfTtcbn1cblxuLy8gbmlwMjUudHNcbnZhciBuaXAyNV9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAyNV9leHBvcnRzLCB7XG4gIGZpbmlzaFJlYWN0aW9uRXZlbnQ6ICgpID0+IGZpbmlzaFJlYWN0aW9uRXZlbnQsXG4gIGdldFJlYWN0ZWRFdmVudFBvaW50ZXI6ICgpID0+IGdldFJlYWN0ZWRFdmVudFBvaW50ZXJcbn0pO1xuZnVuY3Rpb24gZmluaXNoUmVhY3Rpb25FdmVudCh0LCByZWFjdGVkLCBwcml2YXRlS2V5KSB7XG4gIGNvbnN0IGluaGVyaXRlZFRhZ3MgPSByZWFjdGVkLnRhZ3MuZmlsdGVyKCh0YWcpID0+IHRhZy5sZW5ndGggPj0gMiAmJiAodGFnWzBdID09PSBcImVcIiB8fCB0YWdbMF0gPT09IFwicFwiKSk7XG4gIHJldHVybiBmaW5hbGl6ZUV2ZW50KFxuICAgIHtcbiAgICAgIC4uLnQsXG4gICAgICBraW5kOiBSZWFjdGlvbixcbiAgICAgIHRhZ3M6IFsuLi50LnRhZ3MgPz8gW10sIC4uLmluaGVyaXRlZFRhZ3MsIFtcImVcIiwgcmVhY3RlZC5pZF0sIFtcInBcIiwgcmVhY3RlZC5wdWJrZXldXSxcbiAgICAgIGNvbnRlbnQ6IHQuY29udGVudCA/PyBcIitcIlxuICAgIH0sXG4gICAgcHJpdmF0ZUtleVxuICApO1xufVxuZnVuY3Rpb24gZ2V0UmVhY3RlZEV2ZW50UG9pbnRlcihldmVudCkge1xuICBpZiAoZXZlbnQua2luZCAhPT0gUmVhY3Rpb24pIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGxldCBsYXN0RVRhZztcbiAgbGV0IGxhc3RQVGFnO1xuICBmb3IgKGxldCBpMiA9IGV2ZW50LnRhZ3MubGVuZ3RoIC0gMTsgaTIgPj0gMCAmJiAobGFzdEVUYWcgPT09IHZvaWQgMCB8fCBsYXN0UFRhZyA9PT0gdm9pZCAwKTsgaTItLSkge1xuICAgIGNvbnN0IHRhZyA9IGV2ZW50LnRhZ3NbaTJdO1xuICAgIGlmICh0YWcubGVuZ3RoID49IDIpIHtcbiAgICAgIGlmICh0YWdbMF0gPT09IFwiZVwiICYmIGxhc3RFVGFnID09PSB2b2lkIDApIHtcbiAgICAgICAgbGFzdEVUYWcgPSB0YWc7XG4gICAgICB9IGVsc2UgaWYgKHRhZ1swXSA9PT0gXCJwXCIgJiYgbGFzdFBUYWcgPT09IHZvaWQgMCkge1xuICAgICAgICBsYXN0UFRhZyA9IHRhZztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGxhc3RFVGFnID09PSB2b2lkIDAgfHwgbGFzdFBUYWcgPT09IHZvaWQgMCkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBpZDogbGFzdEVUYWdbMV0sXG4gICAgcmVsYXlzOiBbbGFzdEVUYWdbMl0sIGxhc3RQVGFnWzJdXS5maWx0ZXIoKHgpID0+IHggIT09IHZvaWQgMCksXG4gICAgYXV0aG9yOiBsYXN0UFRhZ1sxXVxuICB9O1xufVxuXG4vLyBuaXAyNy50c1xudmFyIG5pcDI3X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDI3X2V4cG9ydHMsIHtcbiAgcGFyc2U6ICgpID0+IHBhcnNlM1xufSk7XG52YXIgbm9DaGFyYWN0ZXIgPSAvXFxXL207XG52YXIgbm9VUkxDaGFyYWN0ZXIgPSAvW15cXHdcXC9dIHxbXlxcd1xcL10kfCR8LHwgL207XG52YXIgTUFYX0hBU0hUQUdfTEVOR1RIID0gNDI7XG5mdW5jdGlvbiogcGFyc2UzKGNvbnRlbnQpIHtcbiAgbGV0IGVtb2ppcyA9IFtdO1xuICBpZiAodHlwZW9mIGNvbnRlbnQgIT09IFwic3RyaW5nXCIpIHtcbiAgICBmb3IgKGxldCBpMiA9IDA7IGkyIDwgY29udGVudC50YWdzLmxlbmd0aDsgaTIrKykge1xuICAgICAgY29uc3QgdGFnID0gY29udGVudC50YWdzW2kyXTtcbiAgICAgIGlmICh0YWdbMF0gPT09IFwiZW1vamlcIiAmJiB0YWcubGVuZ3RoID49IDMpIHtcbiAgICAgICAgZW1vamlzLnB1c2goeyB0eXBlOiBcImVtb2ppXCIsIHNob3J0Y29kZTogdGFnWzFdLCB1cmw6IHRhZ1syXSB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29udGVudCA9IGNvbnRlbnQuY29udGVudDtcbiAgfVxuICBjb25zdCBtYXggPSBjb250ZW50Lmxlbmd0aDtcbiAgbGV0IHByZXZJbmRleCA9IDA7XG4gIGxldCBpbmRleCA9IDA7XG4gIG1haW5sb29wOlxuICAgIHdoaWxlIChpbmRleCA8IG1heCkge1xuICAgICAgY29uc3QgdSA9IGNvbnRlbnQuaW5kZXhPZihcIjpcIiwgaW5kZXgpO1xuICAgICAgY29uc3QgaCA9IGNvbnRlbnQuaW5kZXhPZihcIiNcIiwgaW5kZXgpO1xuICAgICAgaWYgKHUgPT09IC0xICYmIGggPT09IC0xKSB7XG4gICAgICAgIGJyZWFrIG1haW5sb29wO1xuICAgICAgfVxuICAgICAgaWYgKHUgPT09IC0xIHx8IGggPj0gMCAmJiBoIDwgdSkge1xuICAgICAgICBpZiAoaCA9PT0gMCB8fCBjb250ZW50W2ggLSAxXS5tYXRjaChub0NoYXJhY3RlcikpIHtcbiAgICAgICAgICBjb25zdCBtID0gY29udGVudC5zbGljZShoICsgMSwgaCArIE1BWF9IQVNIVEFHX0xFTkdUSCkubWF0Y2gobm9DaGFyYWN0ZXIpO1xuICAgICAgICAgIGNvbnN0IGVuZCA9IG0gPyBoICsgMSArIG0uaW5kZXggOiBtYXg7XG4gICAgICAgICAgeWllbGQgeyB0eXBlOiBcInRleHRcIiwgdGV4dDogY29udGVudC5zbGljZShwcmV2SW5kZXgsIGgpIH07XG4gICAgICAgICAgeWllbGQgeyB0eXBlOiBcImhhc2h0YWdcIiwgdmFsdWU6IGNvbnRlbnQuc2xpY2UoaCArIDEsIGVuZCkgfTtcbiAgICAgICAgICBpbmRleCA9IGVuZDtcbiAgICAgICAgICBwcmV2SW5kZXggPSBpbmRleDtcbiAgICAgICAgICBjb250aW51ZSBtYWlubG9vcDtcbiAgICAgICAgfVxuICAgICAgICBpbmRleCA9IGggKyAxO1xuICAgICAgICBjb250aW51ZSBtYWlubG9vcDtcbiAgICAgIH1cbiAgICAgIGlmIChjb250ZW50LnNsaWNlKHUgLSA1LCB1KSA9PT0gXCJub3N0clwiKSB7XG4gICAgICAgIGNvbnN0IG0gPSBjb250ZW50LnNsaWNlKHUgKyA2MCkubWF0Y2gobm9DaGFyYWN0ZXIpO1xuICAgICAgICBjb25zdCBlbmQgPSBtID8gdSArIDYwICsgbS5pbmRleCA6IG1heDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsZXQgcG9pbnRlcjtcbiAgICAgICAgICBsZXQgeyBkYXRhLCB0eXBlIH0gPSBkZWNvZGUoY29udGVudC5zbGljZSh1ICsgMSwgZW5kKSk7XG4gICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwibnB1YlwiOlxuICAgICAgICAgICAgICBwb2ludGVyID0geyBwdWJrZXk6IGRhdGEgfTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm90ZVwiOlxuICAgICAgICAgICAgICBwb2ludGVyID0geyBpZDogZGF0YSB9O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJuc2VjXCI6XG4gICAgICAgICAgICAgIGluZGV4ID0gZW5kICsgMTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICBwb2ludGVyID0gZGF0YTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByZXZJbmRleCAhPT0gdSAtIDUpIHtcbiAgICAgICAgICAgIHlpZWxkIHsgdHlwZTogXCJ0ZXh0XCIsIHRleHQ6IGNvbnRlbnQuc2xpY2UocHJldkluZGV4LCB1IC0gNSkgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgeWllbGQgeyB0eXBlOiBcInJlZmVyZW5jZVwiLCBwb2ludGVyIH07XG4gICAgICAgICAgaW5kZXggPSBlbmQ7XG4gICAgICAgICAgcHJldkluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgIH0gY2F0Y2ggKF9lcnIpIHtcbiAgICAgICAgICBpbmRleCA9IHUgKyAxO1xuICAgICAgICAgIGNvbnRpbnVlIG1haW5sb29wO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNvbnRlbnQuc2xpY2UodSAtIDUsIHUpID09PSBcImh0dHBzXCIgfHwgY29udGVudC5zbGljZSh1IC0gNCwgdSkgPT09IFwiaHR0cFwiKSB7XG4gICAgICAgIGNvbnN0IG0gPSBjb250ZW50LnNsaWNlKHUgKyA0KS5tYXRjaChub1VSTENoYXJhY3Rlcik7XG4gICAgICAgIGNvbnN0IGVuZCA9IG0gPyB1ICsgNCArIG0uaW5kZXggOiBtYXg7XG4gICAgICAgIGNvbnN0IHByZWZpeExlbiA9IGNvbnRlbnRbdSAtIDFdID09PSBcInNcIiA/IDUgOiA0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGxldCB1cmwgPSBuZXcgVVJMKGNvbnRlbnQuc2xpY2UodSAtIHByZWZpeExlbiwgZW5kKSk7XG4gICAgICAgICAgaWYgKHVybC5ob3N0bmFtZS5pbmRleE9mKFwiLlwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgdXJsXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocHJldkluZGV4ICE9PSB1IC0gcHJlZml4TGVuKSB7XG4gICAgICAgICAgICB5aWVsZCB7IHR5cGU6IFwidGV4dFwiLCB0ZXh0OiBjb250ZW50LnNsaWNlKHByZXZJbmRleCwgdSAtIHByZWZpeExlbikgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKC9cXC4ocG5nfGpwZT9nfGdpZnx3ZWJwfGhlaWN8c3ZnKSQvaS50ZXN0KHVybC5wYXRobmFtZSkpIHtcbiAgICAgICAgICAgIHlpZWxkIHsgdHlwZTogXCJpbWFnZVwiLCB1cmw6IHVybC50b1N0cmluZygpIH07XG4gICAgICAgICAgICBpbmRleCA9IGVuZDtcbiAgICAgICAgICAgIHByZXZJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgvXFwuKG1wNHxhdml8d2VibXxta3Z8bW92KSQvaS50ZXN0KHVybC5wYXRobmFtZSkpIHtcbiAgICAgICAgICAgIHlpZWxkIHsgdHlwZTogXCJ2aWRlb1wiLCB1cmw6IHVybC50b1N0cmluZygpIH07XG4gICAgICAgICAgICBpbmRleCA9IGVuZDtcbiAgICAgICAgICAgIHByZXZJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgvXFwuKG1wM3xhYWN8b2dnfG9wdXN8d2F2fGZsYWMpJC9pLnRlc3QodXJsLnBhdGhuYW1lKSkge1xuICAgICAgICAgICAgeWllbGQgeyB0eXBlOiBcImF1ZGlvXCIsIHVybDogdXJsLnRvU3RyaW5nKCkgfTtcbiAgICAgICAgICAgIGluZGV4ID0gZW5kO1xuICAgICAgICAgICAgcHJldkluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICBjb250aW51ZSBtYWlubG9vcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgeWllbGQgeyB0eXBlOiBcInVybFwiLCB1cmw6IHVybC50b1N0cmluZygpIH07XG4gICAgICAgICAgaW5kZXggPSBlbmQ7XG4gICAgICAgICAgcHJldkluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgIH0gY2F0Y2ggKF9lcnIpIHtcbiAgICAgICAgICBpbmRleCA9IGVuZCArIDE7XG4gICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29udGVudC5zbGljZSh1IC0gMywgdSkgPT09IFwid3NzXCIgfHwgY29udGVudC5zbGljZSh1IC0gMiwgdSkgPT09IFwid3NcIikge1xuICAgICAgICBjb25zdCBtID0gY29udGVudC5zbGljZSh1ICsgNCkubWF0Y2gobm9VUkxDaGFyYWN0ZXIpO1xuICAgICAgICBjb25zdCBlbmQgPSBtID8gdSArIDQgKyBtLmluZGV4IDogbWF4O1xuICAgICAgICBjb25zdCBwcmVmaXhMZW4gPSBjb250ZW50W3UgLSAxXSA9PT0gXCJzXCIgPyAzIDogMjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsZXQgdXJsID0gbmV3IFVSTChjb250ZW50LnNsaWNlKHUgLSBwcmVmaXhMZW4sIGVuZCkpO1xuICAgICAgICAgIGlmICh1cmwuaG9zdG5hbWUuaW5kZXhPZihcIi5cIikgPT09IC0xKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIHdzIHVybFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByZXZJbmRleCAhPT0gdSAtIHByZWZpeExlbikge1xuICAgICAgICAgICAgeWllbGQgeyB0eXBlOiBcInRleHRcIiwgdGV4dDogY29udGVudC5zbGljZShwcmV2SW5kZXgsIHUgLSBwcmVmaXhMZW4pIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHlpZWxkIHsgdHlwZTogXCJyZWxheVwiLCB1cmw6IHVybC50b1N0cmluZygpIH07XG4gICAgICAgICAgaW5kZXggPSBlbmQ7XG4gICAgICAgICAgcHJldkluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgIH0gY2F0Y2ggKF9lcnIpIHtcbiAgICAgICAgICBpbmRleCA9IGVuZCArIDE7XG4gICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgZW1vamlzLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgICAgY29uc3QgZW1vamkgPSBlbW9qaXNbZV07XG4gICAgICAgICAgaWYgKGNvbnRlbnRbdSArIGVtb2ppLnNob3J0Y29kZS5sZW5ndGggKyAxXSA9PT0gXCI6XCIgJiYgY29udGVudC5zbGljZSh1ICsgMSwgdSArIGVtb2ppLnNob3J0Y29kZS5sZW5ndGggKyAxKSA9PT0gZW1vamkuc2hvcnRjb2RlKSB7XG4gICAgICAgICAgICBpZiAocHJldkluZGV4ICE9PSB1KSB7XG4gICAgICAgICAgICAgIHlpZWxkIHsgdHlwZTogXCJ0ZXh0XCIsIHRleHQ6IGNvbnRlbnQuc2xpY2UocHJldkluZGV4LCB1KSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgZW1vamk7XG4gICAgICAgICAgICBpbmRleCA9IHUgKyBlbW9qaS5zaG9ydGNvZGUubGVuZ3RoICsgMjtcbiAgICAgICAgICAgIHByZXZJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgY29udGludWUgbWFpbmxvb3A7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGluZGV4ID0gdSArIDE7XG4gICAgICAgIGNvbnRpbnVlIG1haW5sb29wO1xuICAgICAgfVxuICAgIH1cbiAgaWYgKHByZXZJbmRleCAhPT0gbWF4KSB7XG4gICAgeWllbGQgeyB0eXBlOiBcInRleHRcIiwgdGV4dDogY29udGVudC5zbGljZShwcmV2SW5kZXgpIH07XG4gIH1cbn1cblxuLy8gbmlwMjgudHNcbnZhciBuaXAyOF9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAyOF9leHBvcnRzLCB7XG4gIGNoYW5uZWxDcmVhdGVFdmVudDogKCkgPT4gY2hhbm5lbENyZWF0ZUV2ZW50LFxuICBjaGFubmVsSGlkZU1lc3NhZ2VFdmVudDogKCkgPT4gY2hhbm5lbEhpZGVNZXNzYWdlRXZlbnQsXG4gIGNoYW5uZWxNZXNzYWdlRXZlbnQ6ICgpID0+IGNoYW5uZWxNZXNzYWdlRXZlbnQsXG4gIGNoYW5uZWxNZXRhZGF0YUV2ZW50OiAoKSA9PiBjaGFubmVsTWV0YWRhdGFFdmVudCxcbiAgY2hhbm5lbE11dGVVc2VyRXZlbnQ6ICgpID0+IGNoYW5uZWxNdXRlVXNlckV2ZW50XG59KTtcbnZhciBjaGFubmVsQ3JlYXRlRXZlbnQgPSAodCwgcHJpdmF0ZUtleSkgPT4ge1xuICBsZXQgY29udGVudDtcbiAgaWYgKHR5cGVvZiB0LmNvbnRlbnQgPT09IFwib2JqZWN0XCIpIHtcbiAgICBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkodC5jb250ZW50KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgdC5jb250ZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgY29udGVudCA9IHQuY29udGVudDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIHJldHVybiBmaW5hbGl6ZUV2ZW50KFxuICAgIHtcbiAgICAgIGtpbmQ6IENoYW5uZWxDcmVhdGlvbixcbiAgICAgIHRhZ3M6IFsuLi50LnRhZ3MgPz8gW11dLFxuICAgICAgY29udGVudCxcbiAgICAgIGNyZWF0ZWRfYXQ6IHQuY3JlYXRlZF9hdFxuICAgIH0sXG4gICAgcHJpdmF0ZUtleVxuICApO1xufTtcbnZhciBjaGFubmVsTWV0YWRhdGFFdmVudCA9ICh0LCBwcml2YXRlS2V5KSA9PiB7XG4gIGxldCBjb250ZW50O1xuICBpZiAodHlwZW9mIHQuY29udGVudCA9PT0gXCJvYmplY3RcIikge1xuICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh0LmNvbnRlbnQpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiB0LmNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjb250ZW50ID0gdC5jb250ZW50O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIGZpbmFsaXplRXZlbnQoXG4gICAge1xuICAgICAga2luZDogQ2hhbm5lbE1ldGFkYXRhLFxuICAgICAgdGFnczogW1tcImVcIiwgdC5jaGFubmVsX2NyZWF0ZV9ldmVudF9pZF0sIC4uLnQudGFncyA/PyBbXV0sXG4gICAgICBjb250ZW50LFxuICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkX2F0XG4gICAgfSxcbiAgICBwcml2YXRlS2V5XG4gICk7XG59O1xudmFyIGNoYW5uZWxNZXNzYWdlRXZlbnQgPSAodCwgcHJpdmF0ZUtleSkgPT4ge1xuICBjb25zdCB0YWdzID0gW1tcImVcIiwgdC5jaGFubmVsX2NyZWF0ZV9ldmVudF9pZCwgdC5yZWxheV91cmwsIFwicm9vdFwiXV07XG4gIGlmICh0LnJlcGx5X3RvX2NoYW5uZWxfbWVzc2FnZV9ldmVudF9pZCkge1xuICAgIHRhZ3MucHVzaChbXCJlXCIsIHQucmVwbHlfdG9fY2hhbm5lbF9tZXNzYWdlX2V2ZW50X2lkLCB0LnJlbGF5X3VybCwgXCJyZXBseVwiXSk7XG4gIH1cbiAgcmV0dXJuIGZpbmFsaXplRXZlbnQoXG4gICAge1xuICAgICAga2luZDogQ2hhbm5lbE1lc3NhZ2UsXG4gICAgICB0YWdzOiBbLi4udGFncywgLi4udC50YWdzID8/IFtdXSxcbiAgICAgIGNvbnRlbnQ6IHQuY29udGVudCxcbiAgICAgIGNyZWF0ZWRfYXQ6IHQuY3JlYXRlZF9hdFxuICAgIH0sXG4gICAgcHJpdmF0ZUtleVxuICApO1xufTtcbnZhciBjaGFubmVsSGlkZU1lc3NhZ2VFdmVudCA9ICh0LCBwcml2YXRlS2V5KSA9PiB7XG4gIGxldCBjb250ZW50O1xuICBpZiAodHlwZW9mIHQuY29udGVudCA9PT0gXCJvYmplY3RcIikge1xuICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh0LmNvbnRlbnQpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiB0LmNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjb250ZW50ID0gdC5jb250ZW50O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIGZpbmFsaXplRXZlbnQoXG4gICAge1xuICAgICAga2luZDogQ2hhbm5lbEhpZGVNZXNzYWdlLFxuICAgICAgdGFnczogW1tcImVcIiwgdC5jaGFubmVsX21lc3NhZ2VfZXZlbnRfaWRdLCAuLi50LnRhZ3MgPz8gW11dLFxuICAgICAgY29udGVudCxcbiAgICAgIGNyZWF0ZWRfYXQ6IHQuY3JlYXRlZF9hdFxuICAgIH0sXG4gICAgcHJpdmF0ZUtleVxuICApO1xufTtcbnZhciBjaGFubmVsTXV0ZVVzZXJFdmVudCA9ICh0LCBwcml2YXRlS2V5KSA9PiB7XG4gIGxldCBjb250ZW50O1xuICBpZiAodHlwZW9mIHQuY29udGVudCA9PT0gXCJvYmplY3RcIikge1xuICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh0LmNvbnRlbnQpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiB0LmNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICBjb250ZW50ID0gdC5jb250ZW50O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIGZpbmFsaXplRXZlbnQoXG4gICAge1xuICAgICAga2luZDogQ2hhbm5lbE11dGVVc2VyLFxuICAgICAgdGFnczogW1tcInBcIiwgdC5wdWJrZXlfdG9fbXV0ZV0sIC4uLnQudGFncyA/PyBbXV0sXG4gICAgICBjb250ZW50LFxuICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkX2F0XG4gICAgfSxcbiAgICBwcml2YXRlS2V5XG4gICk7XG59O1xuXG4vLyBuaXAzMC50c1xudmFyIG5pcDMwX2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDMwX2V4cG9ydHMsIHtcbiAgRU1PSklfU0hPUlRDT0RFX1JFR0VYOiAoKSA9PiBFTU9KSV9TSE9SVENPREVfUkVHRVgsXG4gIG1hdGNoQWxsOiAoKSA9PiBtYXRjaEFsbCxcbiAgcmVnZXg6ICgpID0+IHJlZ2V4LFxuICByZXBsYWNlQWxsOiAoKSA9PiByZXBsYWNlQWxsXG59KTtcbnZhciBFTU9KSV9TSE9SVENPREVfUkVHRVggPSAvOihcXHcrKTovO1xudmFyIHJlZ2V4ID0gKCkgPT4gbmV3IFJlZ0V4cChgXFxcXEIke0VNT0pJX1NIT1JUQ09ERV9SRUdFWC5zb3VyY2V9XFxcXEJgLCBcImdcIik7XG5mdW5jdGlvbiogbWF0Y2hBbGwoY29udGVudCkge1xuICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaEFsbChyZWdleCgpKTtcbiAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFtzaG9ydGNvZGUsIG5hbWVdID0gbWF0Y2g7XG4gICAgICB5aWVsZCB7XG4gICAgICAgIHNob3J0Y29kZSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc3RhcnQ6IG1hdGNoLmluZGV4LFxuICAgICAgICBlbmQ6IG1hdGNoLmluZGV4ICsgc2hvcnRjb2RlLmxlbmd0aFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChfZSkge1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gcmVwbGFjZUFsbChjb250ZW50LCByZXBsYWNlcikge1xuICByZXR1cm4gY29udGVudC5yZXBsYWNlQWxsKHJlZ2V4KCksIChzaG9ydGNvZGUsIG5hbWUpID0+IHtcbiAgICByZXR1cm4gcmVwbGFjZXIoe1xuICAgICAgc2hvcnRjb2RlLFxuICAgICAgbmFtZVxuICAgIH0pO1xuICB9KTtcbn1cblxuLy8gbmlwMzkudHNcbnZhciBuaXAzOV9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXAzOV9leHBvcnRzLCB7XG4gIHVzZUZldGNoSW1wbGVtZW50YXRpb246ICgpID0+IHVzZUZldGNoSW1wbGVtZW50YXRpb24zLFxuICB2YWxpZGF0ZUdpdGh1YjogKCkgPT4gdmFsaWRhdGVHaXRodWJcbn0pO1xudmFyIF9mZXRjaDM7XG50cnkge1xuICBfZmV0Y2gzID0gZmV0Y2g7XG59IGNhdGNoIHtcbn1cbmZ1bmN0aW9uIHVzZUZldGNoSW1wbGVtZW50YXRpb24zKGZldGNoSW1wbGVtZW50YXRpb24pIHtcbiAgX2ZldGNoMyA9IGZldGNoSW1wbGVtZW50YXRpb247XG59XG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUdpdGh1YihwdWJrZXksIHVzZXJuYW1lLCBwcm9vZikge1xuICB0cnkge1xuICAgIGxldCByZXMgPSBhd2FpdCAoYXdhaXQgX2ZldGNoMyhgaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vJHt1c2VybmFtZX0vJHtwcm9vZn0vcmF3YCkpLnRleHQoKTtcbiAgICByZXR1cm4gcmVzID09PSBgVmVyaWZ5aW5nIHRoYXQgSSBjb250cm9sIHRoZSBmb2xsb3dpbmcgTm9zdHIgcHVibGljIGtleTogJHtwdWJrZXl9YDtcbiAgfSBjYXRjaCAoXykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBuaXA0Ny50c1xudmFyIG5pcDQ3X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDQ3X2V4cG9ydHMsIHtcbiAgbWFrZU53Y1JlcXVlc3RFdmVudDogKCkgPT4gbWFrZU53Y1JlcXVlc3RFdmVudCxcbiAgcGFyc2VDb25uZWN0aW9uU3RyaW5nOiAoKSA9PiBwYXJzZUNvbm5lY3Rpb25TdHJpbmdcbn0pO1xuZnVuY3Rpb24gcGFyc2VDb25uZWN0aW9uU3RyaW5nKGNvbm5lY3Rpb25TdHJpbmcpIHtcbiAgY29uc3QgeyBob3N0LCBwYXRobmFtZSwgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKGNvbm5lY3Rpb25TdHJpbmcpO1xuICBjb25zdCBwdWJrZXkgPSBwYXRobmFtZSB8fCBob3N0O1xuICBjb25zdCByZWxheSA9IHNlYXJjaFBhcmFtcy5nZXQoXCJyZWxheVwiKTtcbiAgY29uc3Qgc2VjcmV0ID0gc2VhcmNoUGFyYW1zLmdldChcInNlY3JldFwiKTtcbiAgaWYgKCFwdWJrZXkgfHwgIXJlbGF5IHx8ICFzZWNyZXQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIGNvbm5lY3Rpb24gc3RyaW5nXCIpO1xuICB9XG4gIHJldHVybiB7IHB1YmtleSwgcmVsYXksIHNlY3JldCB9O1xufVxuYXN5bmMgZnVuY3Rpb24gbWFrZU53Y1JlcXVlc3RFdmVudChwdWJrZXksIHNlY3JldEtleSwgaW52b2ljZSkge1xuICBjb25zdCBjb250ZW50ID0ge1xuICAgIG1ldGhvZDogXCJwYXlfaW52b2ljZVwiLFxuICAgIHBhcmFtczoge1xuICAgICAgaW52b2ljZVxuICAgIH1cbiAgfTtcbiAgY29uc3QgZW5jcnlwdGVkQ29udGVudCA9IGVuY3J5cHQoc2VjcmV0S2V5LCBwdWJrZXksIEpTT04uc3RyaW5naWZ5KGNvbnRlbnQpKTtcbiAgY29uc3QgZXZlbnRUZW1wbGF0ZSA9IHtcbiAgICBraW5kOiBOV0NXYWxsZXRSZXF1ZXN0LFxuICAgIGNyZWF0ZWRfYXQ6IE1hdGgucm91bmQoRGF0ZS5ub3coKSAvIDFlMyksXG4gICAgY29udGVudDogZW5jcnlwdGVkQ29udGVudCxcbiAgICB0YWdzOiBbW1wicFwiLCBwdWJrZXldXVxuICB9O1xuICByZXR1cm4gZmluYWxpemVFdmVudChldmVudFRlbXBsYXRlLCBzZWNyZXRLZXkpO1xufVxuXG4vLyBuaXA1NC50c1xudmFyIG5pcDU0X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDU0X2V4cG9ydHMsIHtcbiAgbm9ybWFsaXplSWRlbnRpZmllcjogKCkgPT4gbm9ybWFsaXplSWRlbnRpZmllclxufSk7XG5mdW5jdGlvbiBub3JtYWxpemVJZGVudGlmaWVyKG5hbWUpIHtcbiAgbmFtZSA9IG5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIG5hbWUgPSBuYW1lLm5vcm1hbGl6ZShcIk5GS0NcIik7XG4gIHJldHVybiBBcnJheS5mcm9tKG5hbWUpLm1hcCgoY2hhcikgPT4ge1xuICAgIGlmICgvXFxwe0xldHRlcn0vdS50ZXN0KGNoYXIpIHx8IC9cXHB7TnVtYmVyfS91LnRlc3QoY2hhcikpIHtcbiAgICAgIHJldHVybiBjaGFyO1xuICAgIH1cbiAgICByZXR1cm4gXCItXCI7XG4gIH0pLmpvaW4oXCJcIik7XG59XG5cbi8vIG5pcDU3LnRzXG52YXIgbmlwNTdfZXhwb3J0cyA9IHt9O1xuX19leHBvcnQobmlwNTdfZXhwb3J0cywge1xuICBnZXRTYXRvc2hpc0Ftb3VudEZyb21Cb2x0MTE6ICgpID0+IGdldFNhdG9zaGlzQW1vdW50RnJvbUJvbHQxMSxcbiAgZ2V0WmFwRW5kcG9pbnQ6ICgpID0+IGdldFphcEVuZHBvaW50LFxuICBtYWtlWmFwUmVjZWlwdDogKCkgPT4gbWFrZVphcFJlY2VpcHQsXG4gIG1ha2VaYXBSZXF1ZXN0OiAoKSA9PiBtYWtlWmFwUmVxdWVzdCxcbiAgdXNlRmV0Y2hJbXBsZW1lbnRhdGlvbjogKCkgPT4gdXNlRmV0Y2hJbXBsZW1lbnRhdGlvbjQsXG4gIHZhbGlkYXRlWmFwUmVxdWVzdDogKCkgPT4gdmFsaWRhdGVaYXBSZXF1ZXN0XG59KTtcbmltcG9ydCB7IGJlY2gzMiBhcyBiZWNoMzIyIH0gZnJvbSBcIkBzY3VyZS9iYXNlXCI7XG52YXIgX2ZldGNoNDtcbnRyeSB7XG4gIF9mZXRjaDQgPSBmZXRjaDtcbn0gY2F0Y2gge1xufVxuZnVuY3Rpb24gdXNlRmV0Y2hJbXBsZW1lbnRhdGlvbjQoZmV0Y2hJbXBsZW1lbnRhdGlvbikge1xuICBfZmV0Y2g0ID0gZmV0Y2hJbXBsZW1lbnRhdGlvbjtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFphcEVuZHBvaW50KG1ldGFkYXRhKSB7XG4gIHRyeSB7XG4gICAgbGV0IGxudXJsID0gXCJcIjtcbiAgICBsZXQgeyBsdWQwNiwgbHVkMTYgfSA9IEpTT04ucGFyc2UobWV0YWRhdGEuY29udGVudCk7XG4gICAgaWYgKGx1ZDE2KSB7XG4gICAgICBsZXQgW25hbWUsIGRvbWFpbl0gPSBsdWQxNi5zcGxpdChcIkBcIik7XG4gICAgICBsbnVybCA9IG5ldyBVUkwoYC8ud2VsbC1rbm93bi9sbnVybHAvJHtuYW1lfWAsIGBodHRwczovLyR7ZG9tYWlufWApLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIGlmIChsdWQwNikge1xuICAgICAgbGV0IHsgd29yZHMgfSA9IGJlY2gzMjIuZGVjb2RlKGx1ZDA2LCAxZTMpO1xuICAgICAgbGV0IGRhdGEgPSBiZWNoMzIyLmZyb21Xb3Jkcyh3b3Jkcyk7XG4gICAgICBsbnVybCA9IHV0ZjhEZWNvZGVyLmRlY29kZShkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGxldCByZXMgPSBhd2FpdCBfZmV0Y2g0KGxudXJsKTtcbiAgICBsZXQgYm9keSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgaWYgKGJvZHkuYWxsb3dzTm9zdHIgJiYgYm9keS5ub3N0clB1YmtleSkge1xuICAgICAgcmV0dXJuIGJvZHkuY2FsbGJhY2s7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIG1ha2VaYXBSZXF1ZXN0KHBhcmFtcykge1xuICBsZXQgenIgPSB7XG4gICAga2luZDogOTczNCxcbiAgICBjcmVhdGVkX2F0OiBNYXRoLnJvdW5kKERhdGUubm93KCkgLyAxZTMpLFxuICAgIGNvbnRlbnQ6IHBhcmFtcy5jb21tZW50IHx8IFwiXCIsXG4gICAgdGFnczogW1xuICAgICAgW1wicFwiLCBcInB1YmtleVwiIGluIHBhcmFtcyA/IHBhcmFtcy5wdWJrZXkgOiBwYXJhbXMuZXZlbnQucHVia2V5XSxcbiAgICAgIFtcImFtb3VudFwiLCBwYXJhbXMuYW1vdW50LnRvU3RyaW5nKCldLFxuICAgICAgW1wicmVsYXlzXCIsIC4uLnBhcmFtcy5yZWxheXNdXG4gICAgXVxuICB9O1xuICBpZiAoXCJldmVudFwiIGluIHBhcmFtcykge1xuICAgIHpyLnRhZ3MucHVzaChbXCJlXCIsIHBhcmFtcy5ldmVudC5pZF0pO1xuICAgIGlmIChpc1JlcGxhY2VhYmxlS2luZChwYXJhbXMuZXZlbnQua2luZCkpIHtcbiAgICAgIGNvbnN0IGEgPSBbXCJhXCIsIGAke3BhcmFtcy5ldmVudC5raW5kfToke3BhcmFtcy5ldmVudC5wdWJrZXl9OmBdO1xuICAgICAgenIudGFncy5wdXNoKGEpO1xuICAgIH0gZWxzZSBpZiAoaXNBZGRyZXNzYWJsZUtpbmQocGFyYW1zLmV2ZW50LmtpbmQpKSB7XG4gICAgICBsZXQgZCA9IHBhcmFtcy5ldmVudC50YWdzLmZpbmQoKFt0LCB2XSkgPT4gdCA9PT0gXCJkXCIgJiYgdik7XG4gICAgICBpZiAoIWQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImQgdGFnIG5vdCBmb3VuZCBvciBpcyBlbXB0eVwiKTtcbiAgICAgIGNvbnN0IGEgPSBbXCJhXCIsIGAke3BhcmFtcy5ldmVudC5raW5kfToke3BhcmFtcy5ldmVudC5wdWJrZXl9OiR7ZFsxXX1gXTtcbiAgICAgIHpyLnRhZ3MucHVzaChhKTtcbiAgICB9XG4gICAgenIudGFncy5wdXNoKFtcImtcIiwgcGFyYW1zLmV2ZW50LmtpbmQudG9TdHJpbmcoKV0pO1xuICB9XG4gIHJldHVybiB6cjtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlWmFwUmVxdWVzdCh6YXBSZXF1ZXN0U3RyaW5nKSB7XG4gIGxldCB6YXBSZXF1ZXN0O1xuICB0cnkge1xuICAgIHphcFJlcXVlc3QgPSBKU09OLnBhcnNlKHphcFJlcXVlc3RTdHJpbmcpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gXCJJbnZhbGlkIHphcCByZXF1ZXN0IEpTT04uXCI7XG4gIH1cbiAgaWYgKCF2YWxpZGF0ZUV2ZW50KHphcFJlcXVlc3QpKVxuICAgIHJldHVybiBcIlphcCByZXF1ZXN0IGlzIG5vdCBhIHZhbGlkIE5vc3RyIGV2ZW50LlwiO1xuICBpZiAoIXZlcmlmeUV2ZW50KHphcFJlcXVlc3QpKVxuICAgIHJldHVybiBcIkludmFsaWQgc2lnbmF0dXJlIG9uIHphcCByZXF1ZXN0LlwiO1xuICBsZXQgcCA9IHphcFJlcXVlc3QudGFncy5maW5kKChbdCwgdl0pID0+IHQgPT09IFwicFwiICYmIHYpO1xuICBpZiAoIXApXG4gICAgcmV0dXJuIFwiWmFwIHJlcXVlc3QgZG9lc24ndCBoYXZlIGEgJ3AnIHRhZy5cIjtcbiAgaWYgKCFwWzFdLm1hdGNoKC9eW2EtZjAtOV17NjR9JC8pKVxuICAgIHJldHVybiBcIlphcCByZXF1ZXN0ICdwJyB0YWcgaXMgbm90IHZhbGlkIGhleC5cIjtcbiAgbGV0IGUgPSB6YXBSZXF1ZXN0LnRhZ3MuZmluZCgoW3QsIHZdKSA9PiB0ID09PSBcImVcIiAmJiB2KTtcbiAgaWYgKGUgJiYgIWVbMV0ubWF0Y2goL15bYS1mMC05XXs2NH0kLykpXG4gICAgcmV0dXJuIFwiWmFwIHJlcXVlc3QgJ2UnIHRhZyBpcyBub3QgdmFsaWQgaGV4LlwiO1xuICBsZXQgcmVsYXlzID0gemFwUmVxdWVzdC50YWdzLmZpbmQoKFt0LCB2XSkgPT4gdCA9PT0gXCJyZWxheXNcIiAmJiB2KTtcbiAgaWYgKCFyZWxheXMpXG4gICAgcmV0dXJuIFwiWmFwIHJlcXVlc3QgZG9lc24ndCBoYXZlIGEgJ3JlbGF5cycgdGFnLlwiO1xuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIG1ha2VaYXBSZWNlaXB0KHtcbiAgemFwUmVxdWVzdCxcbiAgcHJlaW1hZ2UsXG4gIGJvbHQxMSxcbiAgcGFpZEF0XG59KSB7XG4gIGxldCB6ciA9IEpTT04ucGFyc2UoemFwUmVxdWVzdCk7XG4gIGxldCB0YWdzRnJvbVphcFJlcXVlc3QgPSB6ci50YWdzLmZpbHRlcigoW3RdKSA9PiB0ID09PSBcImVcIiB8fCB0ID09PSBcInBcIiB8fCB0ID09PSBcImFcIik7XG4gIGxldCB6YXAgPSB7XG4gICAga2luZDogOTczNSxcbiAgICBjcmVhdGVkX2F0OiBNYXRoLnJvdW5kKHBhaWRBdC5nZXRUaW1lKCkgLyAxZTMpLFxuICAgIGNvbnRlbnQ6IFwiXCIsXG4gICAgdGFnczogWy4uLnRhZ3NGcm9tWmFwUmVxdWVzdCwgW1wiUFwiLCB6ci5wdWJrZXldLCBbXCJib2x0MTFcIiwgYm9sdDExXSwgW1wiZGVzY3JpcHRpb25cIiwgemFwUmVxdWVzdF1dXG4gIH07XG4gIGlmIChwcmVpbWFnZSkge1xuICAgIHphcC50YWdzLnB1c2goW1wicHJlaW1hZ2VcIiwgcHJlaW1hZ2VdKTtcbiAgfVxuICByZXR1cm4gemFwO1xufVxuZnVuY3Rpb24gZ2V0U2F0b3NoaXNBbW91bnRGcm9tQm9sdDExKGJvbHQxMSkge1xuICBpZiAoYm9sdDExLmxlbmd0aCA8IDUwKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgYm9sdDExID0gYm9sdDExLnN1YnN0cmluZygwLCA1MCk7XG4gIGNvbnN0IGlkeCA9IGJvbHQxMS5sYXN0SW5kZXhPZihcIjFcIik7XG4gIGlmIChpZHggPT09IC0xKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgY29uc3QgaHJwID0gYm9sdDExLnN1YnN0cmluZygwLCBpZHgpO1xuICBpZiAoIWhycC5zdGFydHNXaXRoKFwibG5iY1wiKSkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIGNvbnN0IGFtb3VudCA9IGhycC5zdWJzdHJpbmcoNCk7XG4gIGlmIChhbW91bnQubGVuZ3RoIDwgMSkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIGNvbnN0IGNoYXIgPSBhbW91bnRbYW1vdW50Lmxlbmd0aCAtIDFdO1xuICBjb25zdCBkaWdpdCA9IGNoYXIuY2hhckNvZGVBdCgwKSAtIFwiMFwiLmNoYXJDb2RlQXQoMCk7XG4gIGNvbnN0IGlzRGlnaXQgPSBkaWdpdCA+PSAwICYmIGRpZ2l0IDw9IDk7XG4gIGxldCBjdXRQb2ludCA9IGFtb3VudC5sZW5ndGggLSAxO1xuICBpZiAoaXNEaWdpdCkge1xuICAgIGN1dFBvaW50Kys7XG4gIH1cbiAgaWYgKGN1dFBvaW50IDwgMSkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIGNvbnN0IG51bSA9IHBhcnNlSW50KGFtb3VudC5zdWJzdHJpbmcoMCwgY3V0UG9pbnQpKTtcbiAgc3dpdGNoIChjaGFyKSB7XG4gICAgY2FzZSBcIm1cIjpcbiAgICAgIHJldHVybiBudW0gKiAxZTU7XG4gICAgY2FzZSBcInVcIjpcbiAgICAgIHJldHVybiBudW0gKiAxMDA7XG4gICAgY2FzZSBcIm5cIjpcbiAgICAgIHJldHVybiBudW0gLyAxMDtcbiAgICBjYXNlIFwicFwiOlxuICAgICAgcmV0dXJuIG51bSAvIDFlNDtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIG51bSAqIDFlODtcbiAgfVxufVxuXG4vLyBuaXA3Ny50c1xudmFyIG5pcDc3X2V4cG9ydHMgPSB7fTtcbl9fZXhwb3J0KG5pcDc3X2V4cG9ydHMsIHtcbiAgTmVnZW50cm9weTogKCkgPT4gTmVnZW50cm9weSxcbiAgTmVnZW50cm9weVN0b3JhZ2VWZWN0b3I6ICgpID0+IE5lZ2VudHJvcHlTdG9yYWdlVmVjdG9yLFxuICBOZWdlbnRyb3B5U3luYzogKCkgPT4gTmVnZW50cm9weVN5bmNcbn0pO1xuaW1wb3J0IHsgYnl0ZXNUb0hleCBhcyBieXRlc1RvSGV4NSwgaGV4VG9CeXRlcyBhcyBoZXhUb0J5dGVzNiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBzaGEyNTYgYXMgc2hhMjU2NCB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTIuanNcIjtcbnZhciBQUk9UT0NPTF9WRVJTSU9OID0gOTc7XG52YXIgSURfU0laRSA9IDMyO1xudmFyIEZJTkdFUlBSSU5UX1NJWkUgPSAxNjtcbnZhciBNb2RlID0ge1xuICBTa2lwOiAwLFxuICBGaW5nZXJwcmludDogMSxcbiAgSWRMaXN0OiAyXG59O1xudmFyIFdyYXBwZWRCdWZmZXIgPSBjbGFzcyB7XG4gIF9yYXc7XG4gIGxlbmd0aDtcbiAgY29uc3RydWN0b3IoYnVmZmVyKSB7XG4gICAgaWYgKHR5cGVvZiBidWZmZXIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHRoaXMuX3JhdyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgfSBlbHNlIGlmIChidWZmZXIgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICB0aGlzLl9yYXcgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgdGhpcy5sZW5ndGggPSBidWZmZXIubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9yYXcgPSBuZXcgVWludDhBcnJheSg1MTIpO1xuICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgIH1cbiAgfVxuICB1bndyYXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jhdy5zdWJhcnJheSgwLCB0aGlzLmxlbmd0aCk7XG4gIH1cbiAgZ2V0IGNhcGFjaXR5KCkge1xuICAgIHJldHVybiB0aGlzLl9yYXcuYnl0ZUxlbmd0aDtcbiAgfVxuICBleHRlbmQoYnVmKSB7XG4gICAgaWYgKGJ1ZiBpbnN0YW5jZW9mIFdyYXBwZWRCdWZmZXIpXG4gICAgICBidWYgPSBidWYudW53cmFwKCk7XG4gICAgaWYgKHR5cGVvZiBidWYubGVuZ3RoICE9PSBcIm51bWJlclwiKVxuICAgICAgdGhyb3cgRXJyb3IoXCJiYWQgbGVuZ3RoXCIpO1xuICAgIGNvbnN0IHRhcmdldFNpemUgPSBidWYubGVuZ3RoICsgdGhpcy5sZW5ndGg7XG4gICAgaWYgKHRoaXMuY2FwYWNpdHkgPCB0YXJnZXRTaXplKSB7XG4gICAgICBjb25zdCBvbGRSYXcgPSB0aGlzLl9yYXc7XG4gICAgICBjb25zdCBuZXdDYXBhY2l0eSA9IE1hdGgubWF4KHRoaXMuY2FwYWNpdHkgKiAyLCB0YXJnZXRTaXplKTtcbiAgICAgIHRoaXMuX3JhdyA9IG5ldyBVaW50OEFycmF5KG5ld0NhcGFjaXR5KTtcbiAgICAgIHRoaXMuX3Jhdy5zZXQob2xkUmF3KTtcbiAgICB9XG4gICAgdGhpcy5fcmF3LnNldChidWYsIHRoaXMubGVuZ3RoKTtcbiAgICB0aGlzLmxlbmd0aCArPSBidWYubGVuZ3RoO1xuICB9XG4gIHNoaWZ0KCkge1xuICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5fcmF3WzBdO1xuICAgIHRoaXMuX3JhdyA9IHRoaXMuX3Jhdy5zdWJhcnJheSgxKTtcbiAgICB0aGlzLmxlbmd0aC0tO1xuICAgIHJldHVybiBmaXJzdDtcbiAgfVxuICBzaGlmdE4obiA9IDEpIHtcbiAgICBjb25zdCBmaXJzdFN1YmFycmF5ID0gdGhpcy5fcmF3LnN1YmFycmF5KDAsIG4pO1xuICAgIHRoaXMuX3JhdyA9IHRoaXMuX3Jhdy5zdWJhcnJheShuKTtcbiAgICB0aGlzLmxlbmd0aCAtPSBuO1xuICAgIHJldHVybiBmaXJzdFN1YmFycmF5O1xuICB9XG59O1xuZnVuY3Rpb24gZGVjb2RlVmFySW50KGJ1Zikge1xuICBsZXQgcmVzID0gMDtcbiAgd2hpbGUgKDEpIHtcbiAgICBpZiAoYnVmLmxlbmd0aCA9PT0gMClcbiAgICAgIHRocm93IEVycm9yKFwicGFyc2UgZW5kcyBwcmVtYXR1cmVseVwiKTtcbiAgICBsZXQgYnl0ZSA9IGJ1Zi5zaGlmdCgpO1xuICAgIHJlcyA9IHJlcyA8PCA3IHwgYnl0ZSAmIDEyNztcbiAgICBpZiAoKGJ5dGUgJiAxMjgpID09PSAwKVxuICAgICAgYnJlYWs7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cbmZ1bmN0aW9uIGVuY29kZVZhckludChuKSB7XG4gIGlmIChuID09PSAwKVxuICAgIHJldHVybiBuZXcgV3JhcHBlZEJ1ZmZlcihuZXcgVWludDhBcnJheShbMF0pKTtcbiAgbGV0IG8gPSBbXTtcbiAgd2hpbGUgKG4gIT09IDApIHtcbiAgICBvLnB1c2gobiAmIDEyNyk7XG4gICAgbiA+Pj49IDc7XG4gIH1cbiAgby5yZXZlcnNlKCk7XG4gIGZvciAobGV0IGkyID0gMDsgaTIgPCBvLmxlbmd0aCAtIDE7IGkyKyspXG4gICAgb1tpMl0gfD0gMTI4O1xuICByZXR1cm4gbmV3IFdyYXBwZWRCdWZmZXIobmV3IFVpbnQ4QXJyYXkobykpO1xufVxuZnVuY3Rpb24gZ2V0Qnl0ZShidWYpIHtcbiAgcmV0dXJuIGdldEJ5dGVzKGJ1ZiwgMSlbMF07XG59XG5mdW5jdGlvbiBnZXRCeXRlcyhidWYsIG4pIHtcbiAgaWYgKGJ1Zi5sZW5ndGggPCBuKVxuICAgIHRocm93IEVycm9yKFwicGFyc2UgZW5kcyBwcmVtYXR1cmVseVwiKTtcbiAgcmV0dXJuIGJ1Zi5zaGlmdE4obik7XG59XG52YXIgQWNjdW11bGF0b3IgPSBjbGFzcyB7XG4gIGJ1ZjtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zZXRUb1plcm8oKTtcbiAgfVxuICBzZXRUb1plcm8oKSB7XG4gICAgdGhpcy5idWYgPSBuZXcgVWludDhBcnJheShJRF9TSVpFKTtcbiAgfVxuICBhZGQob3RoZXJCdWYpIHtcbiAgICBsZXQgY3VyckNhcnJ5ID0gMCwgbmV4dENhcnJ5ID0gMDtcbiAgICBsZXQgcCA9IG5ldyBEYXRhVmlldyh0aGlzLmJ1Zi5idWZmZXIpO1xuICAgIGxldCBwbyA9IG5ldyBEYXRhVmlldyhvdGhlckJ1Zi5idWZmZXIpO1xuICAgIGZvciAobGV0IGkyID0gMDsgaTIgPCA4OyBpMisrKSB7XG4gICAgICBsZXQgb2Zmc2V0ID0gaTIgKiA0O1xuICAgICAgbGV0IG9yaWcgPSBwLmdldFVpbnQzMihvZmZzZXQsIHRydWUpO1xuICAgICAgbGV0IG90aGVyViA9IHBvLmdldFVpbnQzMihvZmZzZXQsIHRydWUpO1xuICAgICAgbGV0IG5leHQgPSBvcmlnO1xuICAgICAgbmV4dCArPSBjdXJyQ2Fycnk7XG4gICAgICBuZXh0ICs9IG90aGVyVjtcbiAgICAgIGlmIChuZXh0ID4gNDI5NDk2NzI5NSlcbiAgICAgICAgbmV4dENhcnJ5ID0gMTtcbiAgICAgIHAuc2V0VWludDMyKG9mZnNldCwgbmV4dCAmIDQyOTQ5NjcyOTUsIHRydWUpO1xuICAgICAgY3VyckNhcnJ5ID0gbmV4dENhcnJ5O1xuICAgICAgbmV4dENhcnJ5ID0gMDtcbiAgICB9XG4gIH1cbiAgbmVnYXRlKCkge1xuICAgIGxldCBwID0gbmV3IERhdGFWaWV3KHRoaXMuYnVmLmJ1ZmZlcik7XG4gICAgZm9yIChsZXQgaTIgPSAwOyBpMiA8IDg7IGkyKyspIHtcbiAgICAgIGxldCBvZmZzZXQgPSBpMiAqIDQ7XG4gICAgICBwLnNldFVpbnQzMihvZmZzZXQsIH5wLmdldFVpbnQzMihvZmZzZXQsIHRydWUpKTtcbiAgICB9XG4gICAgbGV0IG9uZSA9IG5ldyBVaW50OEFycmF5KElEX1NJWkUpO1xuICAgIG9uZVswXSA9IDE7XG4gICAgdGhpcy5hZGQob25lKTtcbiAgfVxuICBnZXRGaW5nZXJwcmludChuKSB7XG4gICAgbGV0IGlucHV0ID0gbmV3IFdyYXBwZWRCdWZmZXIoKTtcbiAgICBpbnB1dC5leHRlbmQodGhpcy5idWYpO1xuICAgIGlucHV0LmV4dGVuZChlbmNvZGVWYXJJbnQobikpO1xuICAgIGxldCBoYXNoID0gc2hhMjU2NChpbnB1dC51bndyYXAoKSk7XG4gICAgcmV0dXJuIGhhc2guc3ViYXJyYXkoMCwgRklOR0VSUFJJTlRfU0laRSk7XG4gIH1cbn07XG52YXIgTmVnZW50cm9weVN0b3JhZ2VWZWN0b3IgPSBjbGFzcyB7XG4gIGl0ZW1zO1xuICBzZWFsZWQ7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaXRlbXMgPSBbXTtcbiAgICB0aGlzLnNlYWxlZCA9IGZhbHNlO1xuICB9XG4gIGluc2VydCh0aW1lc3RhbXAsIGlkKSB7XG4gICAgaWYgKHRoaXMuc2VhbGVkKVxuICAgICAgdGhyb3cgRXJyb3IoXCJhbHJlYWR5IHNlYWxlZFwiKTtcbiAgICBjb25zdCBpZGIgPSBoZXhUb0J5dGVzNihpZCk7XG4gICAgaWYgKGlkYi5ieXRlTGVuZ3RoICE9PSBJRF9TSVpFKVxuICAgICAgdGhyb3cgRXJyb3IoXCJiYWQgaWQgc2l6ZSBmb3IgYWRkZWQgaXRlbVwiKTtcbiAgICB0aGlzLml0ZW1zLnB1c2goeyB0aW1lc3RhbXAsIGlkOiBpZGIgfSk7XG4gIH1cbiAgc2VhbCgpIHtcbiAgICBpZiAodGhpcy5zZWFsZWQpXG4gICAgICB0aHJvdyBFcnJvcihcImFscmVhZHkgc2VhbGVkXCIpO1xuICAgIHRoaXMuc2VhbGVkID0gdHJ1ZTtcbiAgICB0aGlzLml0ZW1zLnNvcnQoaXRlbUNvbXBhcmUpO1xuICAgIGZvciAobGV0IGkyID0gMTsgaTIgPCB0aGlzLml0ZW1zLmxlbmd0aDsgaTIrKykge1xuICAgICAgaWYgKGl0ZW1Db21wYXJlKHRoaXMuaXRlbXNbaTIgLSAxXSwgdGhpcy5pdGVtc1tpMl0pID09PSAwKVxuICAgICAgICB0aHJvdyBFcnJvcihcImR1cGxpY2F0ZSBpdGVtIGluc2VydGVkXCIpO1xuICAgIH1cbiAgfVxuICB1bnNlYWwoKSB7XG4gICAgdGhpcy5zZWFsZWQgPSBmYWxzZTtcbiAgfVxuICBzaXplKCkge1xuICAgIHRoaXMuX2NoZWNrU2VhbGVkKCk7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXMubGVuZ3RoO1xuICB9XG4gIGdldEl0ZW0oaTIpIHtcbiAgICB0aGlzLl9jaGVja1NlYWxlZCgpO1xuICAgIGlmIChpMiA+PSB0aGlzLml0ZW1zLmxlbmd0aClcbiAgICAgIHRocm93IEVycm9yKFwib3V0IG9mIHJhbmdlXCIpO1xuICAgIHJldHVybiB0aGlzLml0ZW1zW2kyXTtcbiAgfVxuICBpdGVyYXRlKGJlZ2luLCBlbmQsIGNiKSB7XG4gICAgdGhpcy5fY2hlY2tTZWFsZWQoKTtcbiAgICB0aGlzLl9jaGVja0JvdW5kcyhiZWdpbiwgZW5kKTtcbiAgICBmb3IgKGxldCBpMiA9IGJlZ2luOyBpMiA8IGVuZDsgKytpMikge1xuICAgICAgaWYgKCFjYih0aGlzLml0ZW1zW2kyXSwgaTIpKVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgZmluZExvd2VyQm91bmQoYmVnaW4sIGVuZCwgYm91bmQpIHtcbiAgICB0aGlzLl9jaGVja1NlYWxlZCgpO1xuICAgIHRoaXMuX2NoZWNrQm91bmRzKGJlZ2luLCBlbmQpO1xuICAgIHJldHVybiB0aGlzLl9iaW5hcnlTZWFyY2godGhpcy5pdGVtcywgYmVnaW4sIGVuZCwgKGEpID0+IGl0ZW1Db21wYXJlKGEsIGJvdW5kKSA8IDApO1xuICB9XG4gIGZpbmdlcnByaW50KGJlZ2luLCBlbmQpIHtcbiAgICBsZXQgb3V0ID0gbmV3IEFjY3VtdWxhdG9yKCk7XG4gICAgb3V0LnNldFRvWmVybygpO1xuICAgIHRoaXMuaXRlcmF0ZShiZWdpbiwgZW5kLCAoaXRlbSkgPT4ge1xuICAgICAgb3V0LmFkZChpdGVtLmlkKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXQuZ2V0RmluZ2VycHJpbnQoZW5kIC0gYmVnaW4pO1xuICB9XG4gIF9jaGVja1NlYWxlZCgpIHtcbiAgICBpZiAoIXRoaXMuc2VhbGVkKVxuICAgICAgdGhyb3cgRXJyb3IoXCJub3Qgc2VhbGVkXCIpO1xuICB9XG4gIF9jaGVja0JvdW5kcyhiZWdpbiwgZW5kKSB7XG4gICAgaWYgKGJlZ2luID4gZW5kIHx8IGVuZCA+IHRoaXMuaXRlbXMubGVuZ3RoKVxuICAgICAgdGhyb3cgRXJyb3IoXCJiYWQgcmFuZ2VcIik7XG4gIH1cbiAgX2JpbmFyeVNlYXJjaChhcnIsIGZpcnN0LCBsYXN0LCBjbXApIHtcbiAgICBsZXQgY291bnQgPSBsYXN0IC0gZmlyc3Q7XG4gICAgd2hpbGUgKGNvdW50ID4gMCkge1xuICAgICAgbGV0IGl0ID0gZmlyc3Q7XG4gICAgICBsZXQgc3RlcCA9IE1hdGguZmxvb3IoY291bnQgLyAyKTtcbiAgICAgIGl0ICs9IHN0ZXA7XG4gICAgICBpZiAoY21wKGFycltpdF0pKSB7XG4gICAgICAgIGZpcnN0ID0gKytpdDtcbiAgICAgICAgY291bnQgLT0gc3RlcCArIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3VudCA9IHN0ZXA7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaXJzdDtcbiAgfVxufTtcbnZhciBOZWdlbnRyb3B5ID0gY2xhc3Mge1xuICBzdG9yYWdlO1xuICBmcmFtZVNpemVMaW1pdDtcbiAgbGFzdFRpbWVzdGFtcEluO1xuICBsYXN0VGltZXN0YW1wT3V0O1xuICBjb25zdHJ1Y3RvcihzdG9yYWdlLCBmcmFtZVNpemVMaW1pdCA9IDZlNCkge1xuICAgIGlmIChmcmFtZVNpemVMaW1pdCA8IDQwOTYpXG4gICAgICB0aHJvdyBFcnJvcihcImZyYW1lU2l6ZUxpbWl0IHRvbyBzbWFsbFwiKTtcbiAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIHRoaXMuZnJhbWVTaXplTGltaXQgPSBmcmFtZVNpemVMaW1pdDtcbiAgICB0aGlzLmxhc3RUaW1lc3RhbXBJbiA9IDA7XG4gICAgdGhpcy5sYXN0VGltZXN0YW1wT3V0ID0gMDtcbiAgfVxuICBfYm91bmQodGltZXN0YW1wLCBpZCkge1xuICAgIHJldHVybiB7IHRpbWVzdGFtcCwgaWQ6IGlkIHx8IG5ldyBVaW50OEFycmF5KDApIH07XG4gIH1cbiAgaW5pdGlhdGUoKSB7XG4gICAgbGV0IG91dHB1dCA9IG5ldyBXcmFwcGVkQnVmZmVyKCk7XG4gICAgb3V0cHV0LmV4dGVuZChuZXcgVWludDhBcnJheShbUFJPVE9DT0xfVkVSU0lPTl0pKTtcbiAgICB0aGlzLnNwbGl0UmFuZ2UoMCwgdGhpcy5zdG9yYWdlLnNpemUoKSwgdGhpcy5fYm91bmQoTnVtYmVyLk1BWF9WQUxVRSksIG91dHB1dCk7XG4gICAgcmV0dXJuIGJ5dGVzVG9IZXg1KG91dHB1dC51bndyYXAoKSk7XG4gIH1cbiAgcmVjb25jaWxlKHF1ZXJ5TXNnLCBvbmhhdmUsIG9ubmVlZCkge1xuICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IFdyYXBwZWRCdWZmZXIoaGV4VG9CeXRlczYocXVlcnlNc2cpKTtcbiAgICB0aGlzLmxhc3RUaW1lc3RhbXBJbiA9IHRoaXMubGFzdFRpbWVzdGFtcE91dCA9IDA7XG4gICAgbGV0IGZ1bGxPdXRwdXQgPSBuZXcgV3JhcHBlZEJ1ZmZlcigpO1xuICAgIGZ1bGxPdXRwdXQuZXh0ZW5kKG5ldyBVaW50OEFycmF5KFtQUk9UT0NPTF9WRVJTSU9OXSkpO1xuICAgIGxldCBwcm90b2NvbFZlcnNpb24gPSBnZXRCeXRlKHF1ZXJ5KTtcbiAgICBpZiAocHJvdG9jb2xWZXJzaW9uIDwgOTYgfHwgcHJvdG9jb2xWZXJzaW9uID4gMTExKVxuICAgICAgdGhyb3cgRXJyb3IoXCJpbnZhbGlkIG5lZ2VudHJvcHkgcHJvdG9jb2wgdmVyc2lvbiBieXRlXCIpO1xuICAgIGlmIChwcm90b2NvbFZlcnNpb24gIT09IFBST1RPQ09MX1ZFUlNJT04pIHtcbiAgICAgIHRocm93IEVycm9yKFwidW5zdXBwb3J0ZWQgbmVnZW50cm9weSBwcm90b2NvbCB2ZXJzaW9uIHJlcXVlc3RlZDogXCIgKyAocHJvdG9jb2xWZXJzaW9uIC0gOTYpKTtcbiAgICB9XG4gICAgbGV0IHN0b3JhZ2VTaXplID0gdGhpcy5zdG9yYWdlLnNpemUoKTtcbiAgICBsZXQgcHJldkJvdW5kID0gdGhpcy5fYm91bmQoMCk7XG4gICAgbGV0IHByZXZJbmRleCA9IDA7XG4gICAgbGV0IHNraXAgPSBmYWxzZTtcbiAgICB3aGlsZSAocXVlcnkubGVuZ3RoICE9PSAwKSB7XG4gICAgICBsZXQgbyA9IG5ldyBXcmFwcGVkQnVmZmVyKCk7XG4gICAgICBsZXQgZG9Ta2lwID0gKCkgPT4ge1xuICAgICAgICBpZiAoc2tpcCkge1xuICAgICAgICAgIHNraXAgPSBmYWxzZTtcbiAgICAgICAgICBvLmV4dGVuZCh0aGlzLmVuY29kZUJvdW5kKHByZXZCb3VuZCkpO1xuICAgICAgICAgIG8uZXh0ZW5kKGVuY29kZVZhckludChNb2RlLlNraXApKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGxldCBjdXJyQm91bmQgPSB0aGlzLmRlY29kZUJvdW5kKHF1ZXJ5KTtcbiAgICAgIGxldCBtb2RlID0gZGVjb2RlVmFySW50KHF1ZXJ5KTtcbiAgICAgIGxldCBsb3dlciA9IHByZXZJbmRleDtcbiAgICAgIGxldCB1cHBlciA9IHRoaXMuc3RvcmFnZS5maW5kTG93ZXJCb3VuZChwcmV2SW5kZXgsIHN0b3JhZ2VTaXplLCBjdXJyQm91bmQpO1xuICAgICAgaWYgKG1vZGUgPT09IE1vZGUuU2tpcCkge1xuICAgICAgICBza2lwID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gTW9kZS5GaW5nZXJwcmludCkge1xuICAgICAgICBsZXQgdGhlaXJGaW5nZXJwcmludCA9IGdldEJ5dGVzKHF1ZXJ5LCBGSU5HRVJQUklOVF9TSVpFKTtcbiAgICAgICAgbGV0IG91ckZpbmdlcnByaW50ID0gdGhpcy5zdG9yYWdlLmZpbmdlcnByaW50KGxvd2VyLCB1cHBlcik7XG4gICAgICAgIGlmIChjb21wYXJlVWludDhBcnJheSh0aGVpckZpbmdlcnByaW50LCBvdXJGaW5nZXJwcmludCkgIT09IDApIHtcbiAgICAgICAgICBkb1NraXAoKTtcbiAgICAgICAgICB0aGlzLnNwbGl0UmFuZ2UobG93ZXIsIHVwcGVyLCBjdXJyQm91bmQsIG8pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNraXAgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG1vZGUgPT09IE1vZGUuSWRMaXN0KSB7XG4gICAgICAgIGxldCBudW1JZHMgPSBkZWNvZGVWYXJJbnQocXVlcnkpO1xuICAgICAgICBsZXQgdGhlaXJFbGVtcyA9IHt9O1xuICAgICAgICBmb3IgKGxldCBpMiA9IDA7IGkyIDwgbnVtSWRzOyBpMisrKSB7XG4gICAgICAgICAgbGV0IGUgPSBnZXRCeXRlcyhxdWVyeSwgSURfU0laRSk7XG4gICAgICAgICAgdGhlaXJFbGVtc1tieXRlc1RvSGV4NShlKV0gPSBlO1xuICAgICAgICB9XG4gICAgICAgIHNraXAgPSB0cnVlO1xuICAgICAgICB0aGlzLnN0b3JhZ2UuaXRlcmF0ZShsb3dlciwgdXBwZXIsIChpdGVtKSA9PiB7XG4gICAgICAgICAgbGV0IGsgPSBpdGVtLmlkO1xuICAgICAgICAgIGNvbnN0IGlkID0gYnl0ZXNUb0hleDUoayk7XG4gICAgICAgICAgaWYgKCF0aGVpckVsZW1zW2lkXSkge1xuICAgICAgICAgICAgb25oYXZlPy4oaWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgdGhlaXJFbGVtc1tieXRlc1RvSGV4NShrKV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG9ubmVlZCkge1xuICAgICAgICAgIGZvciAobGV0IHYgb2YgT2JqZWN0LnZhbHVlcyh0aGVpckVsZW1zKSkge1xuICAgICAgICAgICAgb25uZWVkKGJ5dGVzVG9IZXg1KHYpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IEVycm9yKFwidW5leHBlY3RlZCBtb2RlXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuZXhjZWVkZWRGcmFtZVNpemVMaW1pdChmdWxsT3V0cHV0Lmxlbmd0aCArIG8ubGVuZ3RoKSkge1xuICAgICAgICBsZXQgcmVtYWluaW5nRmluZ2VycHJpbnQgPSB0aGlzLnN0b3JhZ2UuZmluZ2VycHJpbnQodXBwZXIsIHN0b3JhZ2VTaXplKTtcbiAgICAgICAgZnVsbE91dHB1dC5leHRlbmQodGhpcy5lbmNvZGVCb3VuZCh0aGlzLl9ib3VuZChOdW1iZXIuTUFYX1ZBTFVFKSkpO1xuICAgICAgICBmdWxsT3V0cHV0LmV4dGVuZChlbmNvZGVWYXJJbnQoTW9kZS5GaW5nZXJwcmludCkpO1xuICAgICAgICBmdWxsT3V0cHV0LmV4dGVuZChyZW1haW5pbmdGaW5nZXJwcmludCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVsbE91dHB1dC5leHRlbmQobyk7XG4gICAgICB9XG4gICAgICBwcmV2SW5kZXggPSB1cHBlcjtcbiAgICAgIHByZXZCb3VuZCA9IGN1cnJCb3VuZDtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bGxPdXRwdXQubGVuZ3RoID09PSAxID8gbnVsbCA6IGJ5dGVzVG9IZXg1KGZ1bGxPdXRwdXQudW53cmFwKCkpO1xuICB9XG4gIHNwbGl0UmFuZ2UobG93ZXIsIHVwcGVyLCB1cHBlckJvdW5kLCBvKSB7XG4gICAgbGV0IG51bUVsZW1zID0gdXBwZXIgLSBsb3dlcjtcbiAgICBsZXQgYnVja2V0cyA9IDE2O1xuICAgIGlmIChudW1FbGVtcyA8IGJ1Y2tldHMgKiAyKSB7XG4gICAgICBvLmV4dGVuZCh0aGlzLmVuY29kZUJvdW5kKHVwcGVyQm91bmQpKTtcbiAgICAgIG8uZXh0ZW5kKGVuY29kZVZhckludChNb2RlLklkTGlzdCkpO1xuICAgICAgby5leHRlbmQoZW5jb2RlVmFySW50KG51bUVsZW1zKSk7XG4gICAgICB0aGlzLnN0b3JhZ2UuaXRlcmF0ZShsb3dlciwgdXBwZXIsIChpdGVtKSA9PiB7XG4gICAgICAgIG8uZXh0ZW5kKGl0ZW0uaWQpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgaXRlbXNQZXJCdWNrZXQgPSBNYXRoLmZsb29yKG51bUVsZW1zIC8gYnVja2V0cyk7XG4gICAgICBsZXQgYnVja2V0c1dpdGhFeHRyYSA9IG51bUVsZW1zICUgYnVja2V0cztcbiAgICAgIGxldCBjdXJyID0gbG93ZXI7XG4gICAgICBmb3IgKGxldCBpMiA9IDA7IGkyIDwgYnVja2V0czsgaTIrKykge1xuICAgICAgICBsZXQgYnVja2V0U2l6ZSA9IGl0ZW1zUGVyQnVja2V0ICsgKGkyIDwgYnVja2V0c1dpdGhFeHRyYSA/IDEgOiAwKTtcbiAgICAgICAgbGV0IG91ckZpbmdlcnByaW50ID0gdGhpcy5zdG9yYWdlLmZpbmdlcnByaW50KGN1cnIsIGN1cnIgKyBidWNrZXRTaXplKTtcbiAgICAgICAgY3VyciArPSBidWNrZXRTaXplO1xuICAgICAgICBsZXQgbmV4dEJvdW5kO1xuICAgICAgICBpZiAoY3VyciA9PT0gdXBwZXIpIHtcbiAgICAgICAgICBuZXh0Qm91bmQgPSB1cHBlckJvdW5kO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxldCBwcmV2SXRlbTtcbiAgICAgICAgICBsZXQgY3Vyckl0ZW07XG4gICAgICAgICAgdGhpcy5zdG9yYWdlLml0ZXJhdGUoY3VyciAtIDEsIGN1cnIgKyAxLCAoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gY3VyciAtIDEpXG4gICAgICAgICAgICAgIHByZXZJdGVtID0gaXRlbTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgY3Vyckl0ZW0gPSBpdGVtO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbmV4dEJvdW5kID0gdGhpcy5nZXRNaW5pbWFsQm91bmQocHJldkl0ZW0sIGN1cnJJdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBvLmV4dGVuZCh0aGlzLmVuY29kZUJvdW5kKG5leHRCb3VuZCkpO1xuICAgICAgICBvLmV4dGVuZChlbmNvZGVWYXJJbnQoTW9kZS5GaW5nZXJwcmludCkpO1xuICAgICAgICBvLmV4dGVuZChvdXJGaW5nZXJwcmludCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGV4Y2VlZGVkRnJhbWVTaXplTGltaXQobikge1xuICAgIHJldHVybiBuID4gdGhpcy5mcmFtZVNpemVMaW1pdCAtIDIwMDtcbiAgfVxuICBkZWNvZGVUaW1lc3RhbXBJbihlbmNvZGVkKSB7XG4gICAgbGV0IHRpbWVzdGFtcCA9IGRlY29kZVZhckludChlbmNvZGVkKTtcbiAgICB0aW1lc3RhbXAgPSB0aW1lc3RhbXAgPT09IDAgPyBOdW1iZXIuTUFYX1ZBTFVFIDogdGltZXN0YW1wIC0gMTtcbiAgICBpZiAodGhpcy5sYXN0VGltZXN0YW1wSW4gPT09IE51bWJlci5NQVhfVkFMVUUgfHwgdGltZXN0YW1wID09PSBOdW1iZXIuTUFYX1ZBTFVFKSB7XG4gICAgICB0aGlzLmxhc3RUaW1lc3RhbXBJbiA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICByZXR1cm4gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICB9XG4gICAgdGltZXN0YW1wICs9IHRoaXMubGFzdFRpbWVzdGFtcEluO1xuICAgIHRoaXMubGFzdFRpbWVzdGFtcEluID0gdGltZXN0YW1wO1xuICAgIHJldHVybiB0aW1lc3RhbXA7XG4gIH1cbiAgZGVjb2RlQm91bmQoZW5jb2RlZCkge1xuICAgIGxldCB0aW1lc3RhbXAgPSB0aGlzLmRlY29kZVRpbWVzdGFtcEluKGVuY29kZWQpO1xuICAgIGxldCBsZW4gPSBkZWNvZGVWYXJJbnQoZW5jb2RlZCk7XG4gICAgaWYgKGxlbiA+IElEX1NJWkUpXG4gICAgICB0aHJvdyBFcnJvcihcImJvdW5kIGtleSB0b28gbG9uZ1wiKTtcbiAgICBsZXQgaWQgPSBnZXRCeXRlcyhlbmNvZGVkLCBsZW4pO1xuICAgIHJldHVybiB7IHRpbWVzdGFtcCwgaWQgfTtcbiAgfVxuICBlbmNvZGVUaW1lc3RhbXBPdXQodGltZXN0YW1wKSB7XG4gICAgaWYgKHRpbWVzdGFtcCA9PT0gTnVtYmVyLk1BWF9WQUxVRSkge1xuICAgICAgdGhpcy5sYXN0VGltZXN0YW1wT3V0ID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgIHJldHVybiBlbmNvZGVWYXJJbnQoMCk7XG4gICAgfVxuICAgIGxldCB0ZW1wID0gdGltZXN0YW1wO1xuICAgIHRpbWVzdGFtcCAtPSB0aGlzLmxhc3RUaW1lc3RhbXBPdXQ7XG4gICAgdGhpcy5sYXN0VGltZXN0YW1wT3V0ID0gdGVtcDtcbiAgICByZXR1cm4gZW5jb2RlVmFySW50KHRpbWVzdGFtcCArIDEpO1xuICB9XG4gIGVuY29kZUJvdW5kKGtleSkge1xuICAgIGxldCBvdXRwdXQgPSBuZXcgV3JhcHBlZEJ1ZmZlcigpO1xuICAgIG91dHB1dC5leHRlbmQodGhpcy5lbmNvZGVUaW1lc3RhbXBPdXQoa2V5LnRpbWVzdGFtcCkpO1xuICAgIG91dHB1dC5leHRlbmQoZW5jb2RlVmFySW50KGtleS5pZC5sZW5ndGgpKTtcbiAgICBvdXRwdXQuZXh0ZW5kKGtleS5pZCk7XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBnZXRNaW5pbWFsQm91bmQocHJldiwgY3Vycikge1xuICAgIGlmIChjdXJyLnRpbWVzdGFtcCAhPT0gcHJldi50aW1lc3RhbXApIHtcbiAgICAgIHJldHVybiB0aGlzLl9ib3VuZChjdXJyLnRpbWVzdGFtcCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBzaGFyZWRQcmVmaXhCeXRlcyA9IDA7XG4gICAgICBsZXQgY3VycktleSA9IGN1cnIuaWQ7XG4gICAgICBsZXQgcHJldktleSA9IHByZXYuaWQ7XG4gICAgICBmb3IgKGxldCBpMiA9IDA7IGkyIDwgSURfU0laRTsgaTIrKykge1xuICAgICAgICBpZiAoY3VycktleVtpMl0gIT09IHByZXZLZXlbaTJdKVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBzaGFyZWRQcmVmaXhCeXRlcysrO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kKGN1cnIudGltZXN0YW1wLCBjdXJyLmlkLnN1YmFycmF5KDAsIHNoYXJlZFByZWZpeEJ5dGVzICsgMSkpO1xuICAgIH1cbiAgfVxufTtcbmZ1bmN0aW9uIGNvbXBhcmVVaW50OEFycmF5KGEsIGIpIHtcbiAgZm9yIChsZXQgaTIgPSAwOyBpMiA8IGEuYnl0ZUxlbmd0aDsgaTIrKykge1xuICAgIGlmIChhW2kyXSA8IGJbaTJdKVxuICAgICAgcmV0dXJuIC0xO1xuICAgIGlmIChhW2kyXSA+IGJbaTJdKVxuICAgICAgcmV0dXJuIDE7XG4gIH1cbiAgaWYgKGEuYnl0ZUxlbmd0aCA+IGIuYnl0ZUxlbmd0aClcbiAgICByZXR1cm4gMTtcbiAgaWYgKGEuYnl0ZUxlbmd0aCA8IGIuYnl0ZUxlbmd0aClcbiAgICByZXR1cm4gLTE7XG4gIHJldHVybiAwO1xufVxuZnVuY3Rpb24gaXRlbUNvbXBhcmUoYSwgYikge1xuICBpZiAoYS50aW1lc3RhbXAgPT09IGIudGltZXN0YW1wKSB7XG4gICAgcmV0dXJuIGNvbXBhcmVVaW50OEFycmF5KGEuaWQsIGIuaWQpO1xuICB9XG4gIHJldHVybiBhLnRpbWVzdGFtcCAtIGIudGltZXN0YW1wO1xufVxudmFyIE5lZ2VudHJvcHlTeW5jID0gY2xhc3Mge1xuICByZWxheTtcbiAgc3RvcmFnZTtcbiAgbmVnO1xuICBmaWx0ZXI7XG4gIHN1YnNjcmlwdGlvbjtcbiAgb25oYXZlO1xuICBvbm5lZWQ7XG4gIGNvbnN0cnVjdG9yKHJlbGF5LCBzdG9yYWdlLCBmaWx0ZXIsIHBhcmFtcyA9IHt9KSB7XG4gICAgdGhpcy5yZWxheSA9IHJlbGF5O1xuICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgdGhpcy5uZWcgPSBuZXcgTmVnZW50cm9weShzdG9yYWdlKTtcbiAgICB0aGlzLm9uaGF2ZSA9IHBhcmFtcy5vbmhhdmU7XG4gICAgdGhpcy5vbm5lZWQgPSBwYXJhbXMub25uZWVkO1xuICAgIHRoaXMuZmlsdGVyID0gZmlsdGVyO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5yZWxheS5wcmVwYXJlU3Vic2NyaXB0aW9uKFt7fV0sIHsgbGFiZWw6IHBhcmFtcy5sYWJlbCB8fCBcIm5lZ2VudHJvcHlcIiB9KTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbi5vbmN1c3RvbSA9IChkYXRhKSA9PiB7XG4gICAgICBzd2l0Y2ggKGRhdGFbMF0pIHtcbiAgICAgICAgY2FzZSBcIk5FRy1NU0dcIjoge1xuICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgZ290IGludmFsaWQgTkVHLU1TRyBmcm9tICR7dGhpcy5yZWxheS51cmx9OiAke2RhdGF9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHRoaXMubmVnLnJlY29uY2lsZShkYXRhWzJdLCB0aGlzLm9uaGF2ZSwgdGhpcy5vbm5lZWQpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIHRoaXMucmVsYXkuc2VuZChgW1wiTkVHLU1TR1wiLCBcIiR7dGhpcy5zdWJzY3JpcHRpb24uaWR9XCIsIFwiJHtyZXNwb25zZX1cIl1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgcGFyYW1zLm9uY2xvc2U/LigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwibmVnZW50cm9weSByZWNvbmNpbGUgZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHBhcmFtcz8ub25jbG9zZT8uKGByZWNvbmNpbGUgZXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgXCJORUctQ0xPU0VcIjoge1xuICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IGRhdGFbMl07XG4gICAgICAgICAgY29uc29sZS53YXJuKFwibmVnZW50cm9weSBlcnJvcjpcIiwgcmVhc29uKTtcbiAgICAgICAgICBwYXJhbXMub25jbG9zZT8uKHJlYXNvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcIk5FRy1FUlJcIjoge1xuICAgICAgICAgIHBhcmFtcy5vbmNsb3NlPy4oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgYXN5bmMgc3RhcnQoKSB7XG4gICAgY29uc3QgaW5pdE1zZyA9IHRoaXMubmVnLmluaXRpYXRlKCk7XG4gICAgdGhpcy5yZWxheS5zZW5kKGBbXCJORUctT1BFTlwiLFwiJHt0aGlzLnN1YnNjcmlwdGlvbi5pZH1cIiwke0pTT04uc3RyaW5naWZ5KHRoaXMuZmlsdGVyKX0sXCIke2luaXRNc2d9XCJdYCk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5yZWxheS5zZW5kKGBbXCJORUctQ0xPU0VcIixcIiR7dGhpcy5zdWJzY3JpcHRpb24uaWR9XCJdYCk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb24uY2xvc2UoKTtcbiAgfVxufTtcblxuLy8gbmlwOTgudHNcbnZhciBuaXA5OF9leHBvcnRzID0ge307XG5fX2V4cG9ydChuaXA5OF9leHBvcnRzLCB7XG4gIGdldFRva2VuOiAoKSA9PiBnZXRUb2tlbixcbiAgaGFzaFBheWxvYWQ6ICgpID0+IGhhc2hQYXlsb2FkLFxuICB1bnBhY2tFdmVudEZyb21Ub2tlbjogKCkgPT4gdW5wYWNrRXZlbnRGcm9tVG9rZW4sXG4gIHZhbGlkYXRlRXZlbnQ6ICgpID0+IHZhbGlkYXRlRXZlbnQyLFxuICB2YWxpZGF0ZUV2ZW50S2luZDogKCkgPT4gdmFsaWRhdGVFdmVudEtpbmQsXG4gIHZhbGlkYXRlRXZlbnRNZXRob2RUYWc6ICgpID0+IHZhbGlkYXRlRXZlbnRNZXRob2RUYWcsXG4gIHZhbGlkYXRlRXZlbnRQYXlsb2FkVGFnOiAoKSA9PiB2YWxpZGF0ZUV2ZW50UGF5bG9hZFRhZyxcbiAgdmFsaWRhdGVFdmVudFRpbWVzdGFtcDogKCkgPT4gdmFsaWRhdGVFdmVudFRpbWVzdGFtcCxcbiAgdmFsaWRhdGVFdmVudFVybFRhZzogKCkgPT4gdmFsaWRhdGVFdmVudFVybFRhZyxcbiAgdmFsaWRhdGVUb2tlbjogKCkgPT4gdmFsaWRhdGVUb2tlblxufSk7XG5pbXBvcnQgeyBzaGEyNTYgYXMgc2hhMjU2NSB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTIuanNcIjtcbmltcG9ydCB7IGJ5dGVzVG9IZXggYXMgYnl0ZXNUb0hleDYgfSBmcm9tIFwiQG5vYmxlL2hhc2hlcy91dGlscy5qc1wiO1xuaW1wb3J0IHsgYmFzZTY0IGFzIGJhc2U2NDMgfSBmcm9tIFwiQHNjdXJlL2Jhc2VcIjtcbnZhciBfYXV0aG9yaXphdGlvblNjaGVtZSA9IFwiTm9zdHIgXCI7XG5hc3luYyBmdW5jdGlvbiBnZXRUb2tlbihsb2dpblVybCwgaHR0cE1ldGhvZCwgc2lnbiwgaW5jbHVkZUF1dGhvcml6YXRpb25TY2hlbWUgPSBmYWxzZSwgcGF5bG9hZCkge1xuICBjb25zdCBldmVudCA9IHtcbiAgICBraW5kOiBIVFRQQXV0aCxcbiAgICB0YWdzOiBbXG4gICAgICBbXCJ1XCIsIGxvZ2luVXJsXSxcbiAgICAgIFtcIm1ldGhvZFwiLCBodHRwTWV0aG9kXVxuICAgIF0sXG4gICAgY3JlYXRlZF9hdDogTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDFlMyksXG4gICAgY29udGVudDogXCJcIlxuICB9O1xuICBpZiAocGF5bG9hZCkge1xuICAgIGV2ZW50LnRhZ3MucHVzaChbXCJwYXlsb2FkXCIsIGhhc2hQYXlsb2FkKHBheWxvYWQpXSk7XG4gIH1cbiAgY29uc3Qgc2lnbmVkRXZlbnQgPSBhd2FpdCBzaWduKGV2ZW50KTtcbiAgY29uc3QgYXV0aG9yaXphdGlvblNjaGVtZSA9IGluY2x1ZGVBdXRob3JpemF0aW9uU2NoZW1lID8gX2F1dGhvcml6YXRpb25TY2hlbWUgOiBcIlwiO1xuICByZXR1cm4gYXV0aG9yaXphdGlvblNjaGVtZSArIGJhc2U2NDMuZW5jb2RlKHV0ZjhFbmNvZGVyLmVuY29kZShKU09OLnN0cmluZ2lmeShzaWduZWRFdmVudCkpKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlVG9rZW4odG9rZW4sIHVybCwgbWV0aG9kKSB7XG4gIGNvbnN0IGV2ZW50ID0gYXdhaXQgdW5wYWNrRXZlbnRGcm9tVG9rZW4odG9rZW4pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgIHRocm93IGVycm9yO1xuICB9KTtcbiAgY29uc3QgdmFsaWQgPSBhd2FpdCB2YWxpZGF0ZUV2ZW50MihldmVudCwgdXJsLCBtZXRob2QpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgIHRocm93IGVycm9yO1xuICB9KTtcbiAgcmV0dXJuIHZhbGlkO1xufVxuYXN5bmMgZnVuY3Rpb24gdW5wYWNrRXZlbnRGcm9tVG9rZW4odG9rZW4pIHtcbiAgaWYgKCF0b2tlbikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdG9rZW5cIik7XG4gIH1cbiAgdG9rZW4gPSB0b2tlbi5yZXBsYWNlKF9hdXRob3JpemF0aW9uU2NoZW1lLCBcIlwiKTtcbiAgY29uc3QgZXZlbnRCNjQgPSB1dGY4RGVjb2Rlci5kZWNvZGUoYmFzZTY0My5kZWNvZGUodG9rZW4pKTtcbiAgaWYgKCFldmVudEI2NCB8fCBldmVudEI2NC5sZW5ndGggPT09IDAgfHwgIWV2ZW50QjY0LnN0YXJ0c1dpdGgoXCJ7XCIpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0b2tlblwiKTtcbiAgfVxuICBjb25zdCBldmVudCA9IEpTT04ucGFyc2UoZXZlbnRCNjQpO1xuICByZXR1cm4gZXZlbnQ7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUV2ZW50VGltZXN0YW1wKGV2ZW50KSB7XG4gIGlmICghZXZlbnQuY3JlYXRlZF9hdCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDFlMykgLSBldmVudC5jcmVhdGVkX2F0IDwgNjA7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUV2ZW50S2luZChldmVudCkge1xuICByZXR1cm4gZXZlbnQua2luZCA9PT0gSFRUUEF1dGg7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUV2ZW50VXJsVGFnKGV2ZW50LCB1cmwpIHtcbiAgY29uc3QgdXJsVGFnID0gZXZlbnQudGFncy5maW5kKCh0KSA9PiB0WzBdID09PSBcInVcIik7XG4gIGlmICghdXJsVGFnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB1cmxUYWcubGVuZ3RoID4gMCAmJiB1cmxUYWdbMV0gPT09IHVybDtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlRXZlbnRNZXRob2RUYWcoZXZlbnQsIG1ldGhvZCkge1xuICBjb25zdCBtZXRob2RUYWcgPSBldmVudC50YWdzLmZpbmQoKHQpID0+IHRbMF0gPT09IFwibWV0aG9kXCIpO1xuICBpZiAoIW1ldGhvZFRhZykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gbWV0aG9kVGFnLmxlbmd0aCA+IDAgJiYgbWV0aG9kVGFnWzFdLnRvTG93ZXJDYXNlKCkgPT09IG1ldGhvZC50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gaGFzaFBheWxvYWQocGF5bG9hZCkge1xuICBjb25zdCBoYXNoID0gc2hhMjU2NSh1dGY4RW5jb2Rlci5lbmNvZGUoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpKTtcbiAgcmV0dXJuIGJ5dGVzVG9IZXg2KGhhc2gpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVFdmVudFBheWxvYWRUYWcoZXZlbnQsIHBheWxvYWQpIHtcbiAgY29uc3QgcGF5bG9hZFRhZyA9IGV2ZW50LnRhZ3MuZmluZCgodCkgPT4gdFswXSA9PT0gXCJwYXlsb2FkXCIpO1xuICBpZiAoIXBheWxvYWRUYWcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3QgcGF5bG9hZEhhc2ggPSBoYXNoUGF5bG9hZChwYXlsb2FkKTtcbiAgcmV0dXJuIHBheWxvYWRUYWcubGVuZ3RoID4gMCAmJiBwYXlsb2FkVGFnWzFdID09PSBwYXlsb2FkSGFzaDtcbn1cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlRXZlbnQyKGV2ZW50LCB1cmwsIG1ldGhvZCwgYm9keSkge1xuICBpZiAoIXZlcmlmeUV2ZW50KGV2ZW50KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbm9zdHIgZXZlbnQsIHNpZ25hdHVyZSBpbnZhbGlkXCIpO1xuICB9XG4gIGlmICghdmFsaWRhdGVFdmVudEtpbmQoZXZlbnQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBub3N0ciBldmVudCwga2luZCBpbnZhbGlkXCIpO1xuICB9XG4gIGlmICghdmFsaWRhdGVFdmVudFRpbWVzdGFtcChldmVudCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIG5vc3RyIGV2ZW50LCBjcmVhdGVkX2F0IHRpbWVzdGFtcCBpbnZhbGlkXCIpO1xuICB9XG4gIGlmICghdmFsaWRhdGVFdmVudFVybFRhZyhldmVudCwgdXJsKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbm9zdHIgZXZlbnQsIHVybCB0YWcgaW52YWxpZFwiKTtcbiAgfVxuICBpZiAoIXZhbGlkYXRlRXZlbnRNZXRob2RUYWcoZXZlbnQsIG1ldGhvZCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIG5vc3RyIGV2ZW50LCBtZXRob2QgdGFnIGludmFsaWRcIik7XG4gIH1cbiAgaWYgKEJvb2xlYW4oYm9keSkgJiYgdHlwZW9mIGJvZHkgPT09IFwib2JqZWN0XCIgJiYgT2JqZWN0LmtleXMoYm9keSkubGVuZ3RoID4gMCkge1xuICAgIGlmICghdmFsaWRhdGVFdmVudFBheWxvYWRUYWcoZXZlbnQsIGJvZHkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIG5vc3RyIGV2ZW50LCBwYXlsb2FkIHRhZyBkb2VzIG5vdCBtYXRjaCByZXF1ZXN0IGJvZHkgaGFzaFwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5leHBvcnQge1xuICBSZWxheSxcbiAgU2ltcGxlUG9vbCxcbiAgZmluYWxpemVFdmVudCxcbiAgZmFrZWpzb25fZXhwb3J0cyBhcyBmaixcbiAgZ2VuZXJhdGVTZWNyZXRLZXksXG4gIGdldEV2ZW50SGFzaCxcbiAgZ2V0RmlsdGVyTGltaXQsXG4gIGdldFB1YmxpY0tleSxcbiAga2luZHNfZXhwb3J0cyBhcyBraW5kcyxcbiAgbWF0Y2hGaWx0ZXIsXG4gIG1hdGNoRmlsdGVycyxcbiAgbWVyZ2VGaWx0ZXJzLFxuICBuaXAwNF9leHBvcnRzIGFzIG5pcDA0LFxuICBuaXAwNV9leHBvcnRzIGFzIG5pcDA1LFxuICBuaXAxMF9leHBvcnRzIGFzIG5pcDEwLFxuICBuaXAxMV9leHBvcnRzIGFzIG5pcDExLFxuICBuaXAxM19leHBvcnRzIGFzIG5pcDEzLFxuICBuaXAxN19leHBvcnRzIGFzIG5pcDE3LFxuICBuaXAxOF9leHBvcnRzIGFzIG5pcDE4LFxuICBuaXAxOV9leHBvcnRzIGFzIG5pcDE5LFxuICBuaXAyMV9leHBvcnRzIGFzIG5pcDIxLFxuICBuaXAyNV9leHBvcnRzIGFzIG5pcDI1LFxuICBuaXAyN19leHBvcnRzIGFzIG5pcDI3LFxuICBuaXAyOF9leHBvcnRzIGFzIG5pcDI4LFxuICBuaXAzMF9leHBvcnRzIGFzIG5pcDMwLFxuICBuaXAzOV9leHBvcnRzIGFzIG5pcDM5LFxuICBuaXA0Ml9leHBvcnRzIGFzIG5pcDQyLFxuICBuaXA0NF9leHBvcnRzIGFzIG5pcDQ0LFxuICBuaXA0N19leHBvcnRzIGFzIG5pcDQ3LFxuICBuaXA1NF9leHBvcnRzIGFzIG5pcDU0LFxuICBuaXA1N19leHBvcnRzIGFzIG5pcDU3LFxuICBuaXA1OV9leHBvcnRzIGFzIG5pcDU5LFxuICBuaXA3N19leHBvcnRzIGFzIG5pcDc3LFxuICBuaXA5OF9leHBvcnRzIGFzIG5pcDk4LFxuICBwYXJzZVJlZmVyZW5jZXMsXG4gIHNlcmlhbGl6ZUV2ZW50LFxuICBzb3J0RXZlbnRzLFxuICB1dGlsc19leHBvcnRzIGFzIHV0aWxzLFxuICB2YWxpZGF0ZUV2ZW50LFxuICB2ZXJpZmllZFN5bWJvbCxcbiAgdmVyaWZ5RXZlbnRcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/nostr-tools/lib/esm/index.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hkdf.js":
/*!*********************************************************************!*\
  !*** ./node_modules/nostr-tools/node_modules/@noble/hashes/hkdf.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   expand: function() { return /* binding */ expand; },\n/* harmony export */   extract: function() { return /* binding */ extract; },\n/* harmony export */   hkdf: function() { return /* binding */ hkdf; }\n/* harmony export */ });\n/* harmony import */ var _hmac_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./hmac.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hmac.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/utils.js\");\n/**\n * HKDF (RFC 5869): extract + expand in one step.\n * See https://soatok.blog/2021/11/17/understanding-hkdf/.\n * @module\n */\n\n\n/**\n * HKDF-extract from spec. Less important part. `HKDF-Extract(IKM, salt) -> PRK`\n * Arguments position differs from spec (IKM is first one, since it is not optional)\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n */\nfunction extract(hash, ikm, salt) {\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.ahash)(hash);\n    // NOTE: some libraries treat zero-length array as 'not provided';\n    // we don't, since we have undefined as 'not provided'\n    // https://github.com/RustCrypto/KDFs/issues/15\n    if (salt === undefined)\n        salt = new Uint8Array(hash.outputLen);\n    return (0,_hmac_js__WEBPACK_IMPORTED_MODULE_1__.hmac)(hash, salt, ikm);\n}\nconst HKDF_COUNTER = /* @__PURE__ */ Uint8Array.of(0);\nconst EMPTY_BUFFER = /* @__PURE__ */ Uint8Array.of();\n/**\n * HKDF-expand from the spec. The most important part. `HKDF-Expand(PRK, info, L) -> OKM`\n * @param hash - hash function that would be used (e.g. sha256)\n * @param prk - a pseudorandom key of at least HashLen octets (usually, the output from the extract step)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in bytes\n */\nfunction expand(hash, prk, info, length = 32) {\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.ahash)(hash);\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.anumber)(length, 'length');\n    const olen = hash.outputLen;\n    if (length > 255 * olen)\n        throw new Error('Length must be <= 255*HashLen');\n    const blocks = Math.ceil(length / olen);\n    if (info === undefined)\n        info = EMPTY_BUFFER;\n    else\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(info, undefined, 'info');\n    // first L(ength) octets of T\n    const okm = new Uint8Array(blocks * olen);\n    // Re-use HMAC instance between blocks\n    const HMAC = _hmac_js__WEBPACK_IMPORTED_MODULE_1__.hmac.create(hash, prk);\n    const HMACTmp = HMAC._cloneInto();\n    const T = new Uint8Array(HMAC.outputLen);\n    for (let counter = 0; counter < blocks; counter++) {\n        HKDF_COUNTER[0] = counter + 1;\n        // T(0) = empty string (zero length)\n        // T(N) = HMAC-Hash(PRK, T(N-1) | info | N)\n        HMACTmp.update(counter === 0 ? EMPTY_BUFFER : T)\n            .update(info)\n            .update(HKDF_COUNTER)\n            .digestInto(T);\n        okm.set(T, olen * counter);\n        HMAC._cloneInto(HMACTmp);\n    }\n    HMAC.destroy();\n    HMACTmp.destroy();\n    (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.clean)(T, HKDF_COUNTER);\n    return okm.slice(0, length);\n}\n/**\n * HKDF (RFC 5869): derive keys from an initial input.\n * Combines hkdf_extract + hkdf_expand in one step\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in bytes\n * @example\n * import { hkdf } from '@noble/hashes/hkdf';\n * import { sha256 } from '@noble/hashes/sha2';\n * import { randomBytes } from '@noble/hashes/utils';\n * const inputKey = randomBytes(32);\n * const salt = randomBytes(32);\n * const info = 'application-key';\n * const hk1 = hkdf(sha256, inputKey, salt, info, 32);\n */\nconst hkdf = (hash, ikm, salt, info, length) => expand(hash, extract(hash, ikm, salt), info, length);\n//# sourceMappingURL=hkdf.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9ub3N0ci10b29scy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9oa2RmLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNpQztBQUMwQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsSUFBSSxnREFBSztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDhDQUFJO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLElBQUksZ0RBQUs7QUFDVCxJQUFJLGtEQUFPO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlEQUFNO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDBDQUFJO0FBQ3JCO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksZ0RBQUs7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CLFlBQVksU0FBUztBQUNyQixZQUFZLGNBQWM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL25vc3RyLXRvb2xzL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2hrZGYuanM/OTM2NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEhLREYgKFJGQyA1ODY5KTogZXh0cmFjdCArIGV4cGFuZCBpbiBvbmUgc3RlcC5cbiAqIFNlZSBodHRwczovL3NvYXRvay5ibG9nLzIwMjEvMTEvMTcvdW5kZXJzdGFuZGluZy1oa2RmLy5cbiAqIEBtb2R1bGVcbiAqL1xuaW1wb3J0IHsgaG1hYyB9IGZyb20gXCIuL2htYWMuanNcIjtcbmltcG9ydCB7IGFieXRlcywgYWhhc2gsIGFudW1iZXIsIGNsZWFuIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbi8qKlxuICogSEtERi1leHRyYWN0IGZyb20gc3BlYy4gTGVzcyBpbXBvcnRhbnQgcGFydC4gYEhLREYtRXh0cmFjdChJS00sIHNhbHQpIC0+IFBSS2BcbiAqIEFyZ3VtZW50cyBwb3NpdGlvbiBkaWZmZXJzIGZyb20gc3BlYyAoSUtNIGlzIGZpcnN0IG9uZSwgc2luY2UgaXQgaXMgbm90IG9wdGlvbmFsKVxuICogQHBhcmFtIGhhc2ggLSBoYXNoIGZ1bmN0aW9uIHRoYXQgd291bGQgYmUgdXNlZCAoZS5nLiBzaGEyNTYpXG4gKiBAcGFyYW0gaWttIC0gaW5wdXQga2V5aW5nIG1hdGVyaWFsLCB0aGUgaW5pdGlhbCBrZXlcbiAqIEBwYXJhbSBzYWx0IC0gb3B0aW9uYWwgc2FsdCB2YWx1ZSAoYSBub24tc2VjcmV0IHJhbmRvbSB2YWx1ZSlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3QoaGFzaCwgaWttLCBzYWx0KSB7XG4gICAgYWhhc2goaGFzaCk7XG4gICAgLy8gTk9URTogc29tZSBsaWJyYXJpZXMgdHJlYXQgemVyby1sZW5ndGggYXJyYXkgYXMgJ25vdCBwcm92aWRlZCc7XG4gICAgLy8gd2UgZG9uJ3QsIHNpbmNlIHdlIGhhdmUgdW5kZWZpbmVkIGFzICdub3QgcHJvdmlkZWQnXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1J1c3RDcnlwdG8vS0RGcy9pc3N1ZXMvMTVcbiAgICBpZiAoc2FsdCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICBzYWx0ID0gbmV3IFVpbnQ4QXJyYXkoaGFzaC5vdXRwdXRMZW4pO1xuICAgIHJldHVybiBobWFjKGhhc2gsIHNhbHQsIGlrbSk7XG59XG5jb25zdCBIS0RGX0NPVU5URVIgPSAvKiBAX19QVVJFX18gKi8gVWludDhBcnJheS5vZigwKTtcbmNvbnN0IEVNUFRZX0JVRkZFUiA9IC8qIEBfX1BVUkVfXyAqLyBVaW50OEFycmF5Lm9mKCk7XG4vKipcbiAqIEhLREYtZXhwYW5kIGZyb20gdGhlIHNwZWMuIFRoZSBtb3N0IGltcG9ydGFudCBwYXJ0LiBgSEtERi1FeHBhbmQoUFJLLCBpbmZvLCBMKSAtPiBPS01gXG4gKiBAcGFyYW0gaGFzaCAtIGhhc2ggZnVuY3Rpb24gdGhhdCB3b3VsZCBiZSB1c2VkIChlLmcuIHNoYTI1NilcbiAqIEBwYXJhbSBwcmsgLSBhIHBzZXVkb3JhbmRvbSBrZXkgb2YgYXQgbGVhc3QgSGFzaExlbiBvY3RldHMgKHVzdWFsbHksIHRoZSBvdXRwdXQgZnJvbSB0aGUgZXh0cmFjdCBzdGVwKVxuICogQHBhcmFtIGluZm8gLSBvcHRpb25hbCBjb250ZXh0IGFuZCBhcHBsaWNhdGlvbiBzcGVjaWZpYyBpbmZvcm1hdGlvbiAoY2FuIGJlIGEgemVyby1sZW5ndGggc3RyaW5nKVxuICogQHBhcmFtIGxlbmd0aCAtIGxlbmd0aCBvZiBvdXRwdXQga2V5aW5nIG1hdGVyaWFsIGluIGJ5dGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmQoaGFzaCwgcHJrLCBpbmZvLCBsZW5ndGggPSAzMikge1xuICAgIGFoYXNoKGhhc2gpO1xuICAgIGFudW1iZXIobGVuZ3RoLCAnbGVuZ3RoJyk7XG4gICAgY29uc3Qgb2xlbiA9IGhhc2gub3V0cHV0TGVuO1xuICAgIGlmIChsZW5ndGggPiAyNTUgKiBvbGVuKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xlbmd0aCBtdXN0IGJlIDw9IDI1NSpIYXNoTGVuJyk7XG4gICAgY29uc3QgYmxvY2tzID0gTWF0aC5jZWlsKGxlbmd0aCAvIG9sZW4pO1xuICAgIGlmIChpbmZvID09PSB1bmRlZmluZWQpXG4gICAgICAgIGluZm8gPSBFTVBUWV9CVUZGRVI7XG4gICAgZWxzZVxuICAgICAgICBhYnl0ZXMoaW5mbywgdW5kZWZpbmVkLCAnaW5mbycpO1xuICAgIC8vIGZpcnN0IEwoZW5ndGgpIG9jdGV0cyBvZiBUXG4gICAgY29uc3Qgb2ttID0gbmV3IFVpbnQ4QXJyYXkoYmxvY2tzICogb2xlbik7XG4gICAgLy8gUmUtdXNlIEhNQUMgaW5zdGFuY2UgYmV0d2VlbiBibG9ja3NcbiAgICBjb25zdCBITUFDID0gaG1hYy5jcmVhdGUoaGFzaCwgcHJrKTtcbiAgICBjb25zdCBITUFDVG1wID0gSE1BQy5fY2xvbmVJbnRvKCk7XG4gICAgY29uc3QgVCA9IG5ldyBVaW50OEFycmF5KEhNQUMub3V0cHV0TGVuKTtcbiAgICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IGJsb2NrczsgY291bnRlcisrKSB7XG4gICAgICAgIEhLREZfQ09VTlRFUlswXSA9IGNvdW50ZXIgKyAxO1xuICAgICAgICAvLyBUKDApID0gZW1wdHkgc3RyaW5nICh6ZXJvIGxlbmd0aClcbiAgICAgICAgLy8gVChOKSA9IEhNQUMtSGFzaChQUkssIFQoTi0xKSB8IGluZm8gfCBOKVxuICAgICAgICBITUFDVG1wLnVwZGF0ZShjb3VudGVyID09PSAwID8gRU1QVFlfQlVGRkVSIDogVClcbiAgICAgICAgICAgIC51cGRhdGUoaW5mbylcbiAgICAgICAgICAgIC51cGRhdGUoSEtERl9DT1VOVEVSKVxuICAgICAgICAgICAgLmRpZ2VzdEludG8oVCk7XG4gICAgICAgIG9rbS5zZXQoVCwgb2xlbiAqIGNvdW50ZXIpO1xuICAgICAgICBITUFDLl9jbG9uZUludG8oSE1BQ1RtcCk7XG4gICAgfVxuICAgIEhNQUMuZGVzdHJveSgpO1xuICAgIEhNQUNUbXAuZGVzdHJveSgpO1xuICAgIGNsZWFuKFQsIEhLREZfQ09VTlRFUik7XG4gICAgcmV0dXJuIG9rbS5zbGljZSgwLCBsZW5ndGgpO1xufVxuLyoqXG4gKiBIS0RGIChSRkMgNTg2OSk6IGRlcml2ZSBrZXlzIGZyb20gYW4gaW5pdGlhbCBpbnB1dC5cbiAqIENvbWJpbmVzIGhrZGZfZXh0cmFjdCArIGhrZGZfZXhwYW5kIGluIG9uZSBzdGVwXG4gKiBAcGFyYW0gaGFzaCAtIGhhc2ggZnVuY3Rpb24gdGhhdCB3b3VsZCBiZSB1c2VkIChlLmcuIHNoYTI1NilcbiAqIEBwYXJhbSBpa20gLSBpbnB1dCBrZXlpbmcgbWF0ZXJpYWwsIHRoZSBpbml0aWFsIGtleVxuICogQHBhcmFtIHNhbHQgLSBvcHRpb25hbCBzYWx0IHZhbHVlIChhIG5vbi1zZWNyZXQgcmFuZG9tIHZhbHVlKVxuICogQHBhcmFtIGluZm8gLSBvcHRpb25hbCBjb250ZXh0IGFuZCBhcHBsaWNhdGlvbiBzcGVjaWZpYyBpbmZvcm1hdGlvbiAoY2FuIGJlIGEgemVyby1sZW5ndGggc3RyaW5nKVxuICogQHBhcmFtIGxlbmd0aCAtIGxlbmd0aCBvZiBvdXRwdXQga2V5aW5nIG1hdGVyaWFsIGluIGJ5dGVzXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGtkZiB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvaGtkZic7XG4gKiBpbXBvcnQgeyBzaGEyNTYgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NoYTInO1xuICogaW1wb3J0IHsgcmFuZG9tQnl0ZXMgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3V0aWxzJztcbiAqIGNvbnN0IGlucHV0S2V5ID0gcmFuZG9tQnl0ZXMoMzIpO1xuICogY29uc3Qgc2FsdCA9IHJhbmRvbUJ5dGVzKDMyKTtcbiAqIGNvbnN0IGluZm8gPSAnYXBwbGljYXRpb24ta2V5JztcbiAqIGNvbnN0IGhrMSA9IGhrZGYoc2hhMjU2LCBpbnB1dEtleSwgc2FsdCwgaW5mbywgMzIpO1xuICovXG5leHBvcnQgY29uc3QgaGtkZiA9IChoYXNoLCBpa20sIHNhbHQsIGluZm8sIGxlbmd0aCkgPT4gZXhwYW5kKGhhc2gsIGV4dHJhY3QoaGFzaCwgaWttLCBzYWx0KSwgaW5mbywgbGVuZ3RoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhrZGYuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hkdf.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hmac.js":
/*!*********************************************************************!*\
  !*** ./node_modules/nostr-tools/node_modules/@noble/hashes/hmac.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _HMAC: function() { return /* binding */ _HMAC; },\n/* harmony export */   hmac: function() { return /* binding */ hmac; }\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/utils.js\");\n/**\n * HMAC: RFC2104 message authentication code.\n * @module\n */\n\n/** Internal class for HMAC. */\nclass _HMAC {\n    oHash;\n    iHash;\n    blockLen;\n    outputLen;\n    finished = false;\n    destroyed = false;\n    constructor(hash, key) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.ahash)(hash);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(key, undefined, 'key');\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.clean)(pad);\n    }\n    update(buf) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.aexists)(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.aexists)(this);\n        (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.abytes)(out, this.outputLen, 'output');\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to ||= Object.create(Object.getPrototypeOf(this), {});\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    clone() {\n        return this._cloneInto();\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n * @example\n * import { hmac } from '@noble/hashes/hmac';\n * import { sha256 } from '@noble/hashes/sha2';\n * const mac1 = hmac(sha256, 'key', 'message');\n */\nconst hmac = (hash, key, message) => new _HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new _HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9ub3N0ci10b29scy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9obWFjLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzJEO0FBQzNEO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0RBQUs7QUFDYixRQUFRLGlEQUFNO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0EsUUFBUSxnREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLGtEQUFPO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGtEQUFPO0FBQ2YsUUFBUSxpREFBTTtBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVELGdCQUFnQix5REFBeUQ7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxPQUFPO0FBQ25CLFlBQVksU0FBUztBQUNyQjtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9ub3N0ci10b29scy9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9obWFjLmpzPzNiZjYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBITUFDOiBSRkMyMTA0IG1lc3NhZ2UgYXV0aGVudGljYXRpb24gY29kZS5cbiAqIEBtb2R1bGVcbiAqL1xuaW1wb3J0IHsgYWJ5dGVzLCBhZXhpc3RzLCBhaGFzaCwgY2xlYW4gfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuLyoqIEludGVybmFsIGNsYXNzIGZvciBITUFDLiAqL1xuZXhwb3J0IGNsYXNzIF9ITUFDIHtcbiAgICBvSGFzaDtcbiAgICBpSGFzaDtcbiAgICBibG9ja0xlbjtcbiAgICBvdXRwdXRMZW47XG4gICAgZmluaXNoZWQgPSBmYWxzZTtcbiAgICBkZXN0cm95ZWQgPSBmYWxzZTtcbiAgICBjb25zdHJ1Y3RvcihoYXNoLCBrZXkpIHtcbiAgICAgICAgYWhhc2goaGFzaCk7XG4gICAgICAgIGFieXRlcyhrZXksIHVuZGVmaW5lZCwgJ2tleScpO1xuICAgICAgICB0aGlzLmlIYXNoID0gaGFzaC5jcmVhdGUoKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmlIYXNoLnVwZGF0ZSAhPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgaW5zdGFuY2Ugb2YgY2xhc3Mgd2hpY2ggZXh0ZW5kcyB1dGlscy5IYXNoJyk7XG4gICAgICAgIHRoaXMuYmxvY2tMZW4gPSB0aGlzLmlIYXNoLmJsb2NrTGVuO1xuICAgICAgICB0aGlzLm91dHB1dExlbiA9IHRoaXMuaUhhc2gub3V0cHV0TGVuO1xuICAgICAgICBjb25zdCBibG9ja0xlbiA9IHRoaXMuYmxvY2tMZW47XG4gICAgICAgIGNvbnN0IHBhZCA9IG5ldyBVaW50OEFycmF5KGJsb2NrTGVuKTtcbiAgICAgICAgLy8gYmxvY2tMZW4gY2FuIGJlIGJpZ2dlciB0aGFuIG91dHB1dExlblxuICAgICAgICBwYWQuc2V0KGtleS5sZW5ndGggPiBibG9ja0xlbiA/IGhhc2guY3JlYXRlKCkudXBkYXRlKGtleSkuZGlnZXN0KCkgOiBrZXkpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZC5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHBhZFtpXSBePSAweDM2O1xuICAgICAgICB0aGlzLmlIYXNoLnVwZGF0ZShwYWQpO1xuICAgICAgICAvLyBCeSBkb2luZyB1cGRhdGUgKHByb2Nlc3Npbmcgb2YgZmlyc3QgYmxvY2spIG9mIG91dGVyIGhhc2ggaGVyZSB3ZSBjYW4gcmUtdXNlIGl0IGJldHdlZW4gbXVsdGlwbGUgY2FsbHMgdmlhIGNsb25lXG4gICAgICAgIHRoaXMub0hhc2ggPSBoYXNoLmNyZWF0ZSgpO1xuICAgICAgICAvLyBVbmRvIGludGVybmFsIFhPUiAmJiBhcHBseSBvdXRlciBYT1JcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWQubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICBwYWRbaV0gXj0gMHgzNiBeIDB4NWM7XG4gICAgICAgIHRoaXMub0hhc2gudXBkYXRlKHBhZCk7XG4gICAgICAgIGNsZWFuKHBhZCk7XG4gICAgfVxuICAgIHVwZGF0ZShidWYpIHtcbiAgICAgICAgYWV4aXN0cyh0aGlzKTtcbiAgICAgICAgdGhpcy5pSGFzaC51cGRhdGUoYnVmKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGRpZ2VzdEludG8ob3V0KSB7XG4gICAgICAgIGFleGlzdHModGhpcyk7XG4gICAgICAgIGFieXRlcyhvdXQsIHRoaXMub3V0cHV0TGVuLCAnb3V0cHV0Jyk7XG4gICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmlIYXNoLmRpZ2VzdEludG8ob3V0KTtcbiAgICAgICAgdGhpcy5vSGFzaC51cGRhdGUob3V0KTtcbiAgICAgICAgdGhpcy5vSGFzaC5kaWdlc3RJbnRvKG91dCk7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgIH1cbiAgICBkaWdlc3QoKSB7XG4gICAgICAgIGNvbnN0IG91dCA9IG5ldyBVaW50OEFycmF5KHRoaXMub0hhc2gub3V0cHV0TGVuKTtcbiAgICAgICAgdGhpcy5kaWdlc3RJbnRvKG91dCk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfVxuICAgIF9jbG9uZUludG8odG8pIHtcbiAgICAgICAgLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZSB3aXRob3V0IGNhbGxpbmcgY29uc3RydWN0b3Igc2luY2Uga2V5IGFscmVhZHkgaW4gc3RhdGUgYW5kIHdlIGRvbid0IGtub3cgaXQuXG4gICAgICAgIHRvIHx8PSBPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSwge30pO1xuICAgICAgICBjb25zdCB7IG9IYXNoLCBpSGFzaCwgZmluaXNoZWQsIGRlc3Ryb3llZCwgYmxvY2tMZW4sIG91dHB1dExlbiB9ID0gdGhpcztcbiAgICAgICAgdG8gPSB0bztcbiAgICAgICAgdG8uZmluaXNoZWQgPSBmaW5pc2hlZDtcbiAgICAgICAgdG8uZGVzdHJveWVkID0gZGVzdHJveWVkO1xuICAgICAgICB0by5ibG9ja0xlbiA9IGJsb2NrTGVuO1xuICAgICAgICB0by5vdXRwdXRMZW4gPSBvdXRwdXRMZW47XG4gICAgICAgIHRvLm9IYXNoID0gb0hhc2guX2Nsb25lSW50byh0by5vSGFzaCk7XG4gICAgICAgIHRvLmlIYXNoID0gaUhhc2guX2Nsb25lSW50byh0by5pSGFzaCk7XG4gICAgICAgIHJldHVybiB0bztcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZUludG8oKTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm9IYXNoLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5pSGFzaC5kZXN0cm95KCk7XG4gICAgfVxufVxuLyoqXG4gKiBITUFDOiBSRkMyMTA0IG1lc3NhZ2UgYXV0aGVudGljYXRpb24gY29kZS5cbiAqIEBwYXJhbSBoYXNoIC0gZnVuY3Rpb24gdGhhdCB3b3VsZCBiZSB1c2VkIGUuZy4gc2hhMjU2XG4gKiBAcGFyYW0ga2V5IC0gbWVzc2FnZSBrZXlcbiAqIEBwYXJhbSBtZXNzYWdlIC0gbWVzc2FnZSBkYXRhXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaG1hYyB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvaG1hYyc7XG4gKiBpbXBvcnQgeyBzaGEyNTYgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NoYTInO1xuICogY29uc3QgbWFjMSA9IGhtYWMoc2hhMjU2LCAna2V5JywgJ21lc3NhZ2UnKTtcbiAqL1xuZXhwb3J0IGNvbnN0IGhtYWMgPSAoaGFzaCwga2V5LCBtZXNzYWdlKSA9PiBuZXcgX0hNQUMoaGFzaCwga2V5KS51cGRhdGUobWVzc2FnZSkuZGlnZXN0KCk7XG5obWFjLmNyZWF0ZSA9IChoYXNoLCBrZXkpID0+IG5ldyBfSE1BQyhoYXNoLCBrZXkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aG1hYy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/nostr-tools/node_modules/@noble/hashes/hmac.js\n"));

/***/ })

});